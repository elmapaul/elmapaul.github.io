var mre=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var wje=mre((ko,zo)=>{function gre(t,e){for(var i=0;i<e.length;i++){const n=e[i];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();function UO(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function vre(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var i=function n(){if(this instanceof n){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),i}var N7={exports:{}},SE={},k7={exports:{}},ci={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_=Symbol.for("react.element"),yre=Symbol.for("react.portal"),xre=Symbol.for("react.fragment"),_re=Symbol.for("react.strict_mode"),wre=Symbol.for("react.profiler"),bre=Symbol.for("react.provider"),Sre=Symbol.for("react.context"),Are=Symbol.for("react.forward_ref"),Mre=Symbol.for("react.suspense"),Cre=Symbol.for("react.memo"),Ere=Symbol.for("react.lazy"),z4=Symbol.iterator;function Tre(t){return t===null||typeof t!="object"?null:(t=z4&&t[z4]||t["@@iterator"],typeof t=="function"?t:null)}var z7={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U7=Object.assign,G7={};function _0(t,e,i){this.props=t,this.context=e,this.refs=G7,this.updater=i||z7}_0.prototype.isReactComponent={};_0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function V7(){}V7.prototype=_0.prototype;function GO(t,e,i){this.props=t,this.context=e,this.refs=G7,this.updater=i||z7}var VO=GO.prototype=new V7;VO.constructor=GO;U7(VO,_0.prototype);VO.isPureReactComponent=!0;var U4=Array.isArray,H7=Object.prototype.hasOwnProperty,HO={current:null},j7={key:!0,ref:!0,__self:!0,__source:!0};function W7(t,e,i){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)H7.call(e,n)&&!j7.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:I_,type:t,key:s,ref:o,props:r,_owner:HO.current}}function Pre(t,e){return{$$typeof:I_,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jO(t){return typeof t=="object"&&t!==null&&t.$$typeof===I_}function Dre(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(i){return e[i]})}var G4=/\/+/g;function q2(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Dre(""+t.key):e.toString(36)}function KA(t,e,i,n,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case I_:case yre:o=!0}}if(o)return o=t,r=r(o),t=n===""?"."+q2(o,0):n,U4(r)?(i="",t!=null&&(i=t.replace(G4,"$&/")+"/"),KA(r,e,i,"",function(c){return c})):r!=null&&(jO(r)&&(r=Pre(r,i+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(G4,"$&/")+"/")+t)),e.push(r)),1;if(o=0,n=n===""?".":n+":",U4(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+q2(s,a);o+=KA(s,e,i,l,r)}else if(l=Tre(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+q2(s,a++),o+=KA(s,e,i,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Sb(t,e,i){if(t==null)return t;var n=[],r=0;return KA(t,n,"","",function(s){return e.call(i,s,r++)}),n}function Ire(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(i){(t._status===0||t._status===-1)&&(t._status=1,t._result=i)},function(i){(t._status===0||t._status===-1)&&(t._status=2,t._result=i)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Fs={current:null},ZA={transition:null},Lre={ReactCurrentDispatcher:Fs,ReactCurrentBatchConfig:ZA,ReactCurrentOwner:HO};ci.Children={map:Sb,forEach:function(t,e,i){Sb(t,function(){e.apply(this,arguments)},i)},count:function(t){var e=0;return Sb(t,function(){e++}),e},toArray:function(t){return Sb(t,function(e){return e})||[]},only:function(t){if(!jO(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ci.Component=_0;ci.Fragment=xre;ci.Profiler=wre;ci.PureComponent=GO;ci.StrictMode=_re;ci.Suspense=Mre;ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lre;ci.cloneElement=function(t,e,i){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=U7({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=HO.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)H7.call(e,l)&&!j7.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:I_,type:t.type,key:r,ref:s,props:n,_owner:o}};ci.createContext=function(t){return t={$$typeof:Sre,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bre,_context:t},t.Consumer=t};ci.createElement=W7;ci.createFactory=function(t){var e=W7.bind(null,t);return e.type=t,e};ci.createRef=function(){return{current:null}};ci.forwardRef=function(t){return{$$typeof:Are,render:t}};ci.isValidElement=jO;ci.lazy=function(t){return{$$typeof:Ere,_payload:{_status:-1,_result:t},_init:Ire}};ci.memo=function(t,e){return{$$typeof:Cre,type:t,compare:e===void 0?null:e}};ci.startTransition=function(t){var e=ZA.transition;ZA.transition={};try{t()}finally{ZA.transition=e}};ci.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ci.useCallback=function(t,e){return Fs.current.useCallback(t,e)};ci.useContext=function(t){return Fs.current.useContext(t)};ci.useDebugValue=function(){};ci.useDeferredValue=function(t){return Fs.current.useDeferredValue(t)};ci.useEffect=function(t,e){return Fs.current.useEffect(t,e)};ci.useId=function(){return Fs.current.useId()};ci.useImperativeHandle=function(t,e,i){return Fs.current.useImperativeHandle(t,e,i)};ci.useInsertionEffect=function(t,e){return Fs.current.useInsertionEffect(t,e)};ci.useLayoutEffect=function(t,e){return Fs.current.useLayoutEffect(t,e)};ci.useMemo=function(t,e){return Fs.current.useMemo(t,e)};ci.useReducer=function(t,e,i){return Fs.current.useReducer(t,e,i)};ci.useRef=function(t){return Fs.current.useRef(t)};ci.useState=function(t){return Fs.current.useState(t)};ci.useSyncExternalStore=function(t,e,i){return Fs.current.useSyncExternalStore(t,e,i)};ci.useTransition=function(){return Fs.current.useTransition()};ci.version="18.2.0";k7.exports=ci;var me=k7.exports;const w0=UO(me),Bre=gre({__proto__:null,default:w0},[me]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rre=me,Ore=Symbol.for("react.element"),Fre=Symbol.for("react.fragment"),Nre=Object.prototype.hasOwnProperty,kre=Rre.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zre={key:!0,ref:!0,__self:!0,__source:!0};function X7(t,e,i){var n,r={},s=null,o=null;i!==void 0&&(s=""+i),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Nre.call(e,n)&&!zre.hasOwnProperty(n)&&(r[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:Ore,type:t,key:s,ref:o,props:r,_owner:kre.current}}SE.Fragment=Fre;SE.jsx=X7;SE.jsxs=X7;N7.exports=SE;var WO=N7.exports;const XO=WO.Fragment,Ye=WO.jsx,ei=WO.jsxs;var EI={},q7={exports:{}},Qo={},Y7={exports:{}},Q7={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,Y){var j=z.length;z.push(Y);e:for(;0<j;){var J=j-1>>>1,H=z[J];if(0<r(H,Y))z[J]=Y,z[j]=H,j=J;else break e}}function i(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var Y=z[0],j=z.pop();if(j!==Y){z[0]=j;e:for(var J=0,H=z.length,Z=H>>>1;J<Z;){var K=2*(J+1)-1,ne=z[K],W=K+1,ve=z[W];if(0>r(ne,j))W<H&&0>r(ve,ne)?(z[J]=ve,z[W]=j,J=W):(z[J]=ne,z[K]=j,J=K);else if(W<H&&0>r(ve,j))z[J]=ve,z[W]=j,J=W;else break e}}return Y}function r(z,Y){var j=z.sortIndex-Y.sortIndex;return j!==0?j:z.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(z){for(var Y=i(c);Y!==null;){if(Y.callback===null)n(c);else if(Y.startTime<=z)n(c),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=i(c)}}function b(z){if(m=!1,x(z),!p)if(i(l)!==null)p=!0,Q(S);else{var Y=i(c);Y!==null&&X(b,Y.startTime-z)}}function S(z,Y){p=!1,m&&(m=!1,v(M),M=-1),f=!0;var j=d;try{for(x(Y),u=i(l);u!==null&&(!(u.expirationTime>Y)||z&&!I());){var J=u.callback;if(typeof J=="function"){u.callback=null,d=u.priorityLevel;var H=J(u.expirationTime<=Y);Y=t.unstable_now(),typeof H=="function"?u.callback=H:u===i(l)&&n(l),x(Y)}else n(l);u=i(l)}if(u!==null)var Z=!0;else{var K=i(c);K!==null&&X(b,K.startTime-Y),Z=!1}return Z}finally{u=null,d=j,f=!1}}var A=!1,E=null,M=-1,T=5,P=-1;function I(){return!(t.unstable_now()-P<T)}function k(){if(E!==null){var z=t.unstable_now();P=z;var Y=!0;try{Y=E(!0,z)}finally{Y?R():(A=!1,E=null)}}else A=!1}var R;if(typeof y=="function")R=function(){y(k)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=k,R=function(){V.postMessage(null)}}else R=function(){g(k,0)};function Q(z){E=z,A||(A=!0,R())}function X(z,Y){M=g(function(){z(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(z){switch(d){case 1:case 2:case 3:var Y=3;break;default:Y=d}var j=d;d=Y;try{return z()}finally{d=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,Y){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var j=d;d=z;try{return Y()}finally{d=j}},t.unstable_scheduleCallback=function(z,Y,j){var J=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?J+j:J):j=J,z){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=j+H,z={id:h++,callback:Y,priorityLevel:z,startTime:j,expirationTime:H,sortIndex:-1},j>J?(z.sortIndex=j,e(c,z),i(l)===null&&z===i(c)&&(m?(v(M),M=-1):m=!0,X(b,j-J))):(z.sortIndex=H,e(l,z),p||f||(p=!0,Q(S))),z},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(z){var Y=d;return function(){var j=d;d=Y;try{return z.apply(this,arguments)}finally{d=j}}}})(Q7);Y7.exports=Q7;var Ure=Y7.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J7=me,Ho=Ure;function Ze(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K7=new Set,A1={};function Kp(t,e){Ov(t,e),Ov(t+"Capture",e)}function Ov(t,e){for(A1[t]=e,t=0;t<e.length;t++)K7.add(e[t])}var Vu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),TI=Object.prototype.hasOwnProperty,Gre=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V4={},H4={};function Vre(t){return TI.call(H4,t)?!0:TI.call(V4,t)?!1:Gre.test(t)?H4[t]=!0:(V4[t]=!0,!1)}function Hre(t,e,i,n){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jre(t,e,i,n){if(e===null||typeof e>"u"||Hre(t,e,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ns(t,e,i,n,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xr[t]=new Ns(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xr[e]=new Ns(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xr[t]=new Ns(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xr[t]=new Ns(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xr[t]=new Ns(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xr[t]=new Ns(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xr[t]=new Ns(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xr[t]=new Ns(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xr[t]=new Ns(t,5,!1,t.toLowerCase(),null,!1,!1)});var qO=/[\-:]([a-z])/g;function YO(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qO,YO);Xr[e]=new Ns(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qO,YO);Xr[e]=new Ns(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qO,YO);Xr[e]=new Ns(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xr[t]=new Ns(t,1,!1,t.toLowerCase(),null,!1,!1)});Xr.xlinkHref=new Ns("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xr[t]=new Ns(t,1,!1,t.toLowerCase(),null,!0,!0)});function QO(t,e,i,n){var r=Xr.hasOwnProperty(e)?Xr[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jre(e,i,r,n)&&(i=null),n||r===null?Vre(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=i===null?r.type===3?!1:"":i:(e=r.attributeName,n=r.attributeNamespace,i===null?t.removeAttribute(e):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}var $u=J7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ab=Symbol.for("react.element"),Ig=Symbol.for("react.portal"),Lg=Symbol.for("react.fragment"),JO=Symbol.for("react.strict_mode"),PI=Symbol.for("react.profiler"),Z7=Symbol.for("react.provider"),$7=Symbol.for("react.context"),KO=Symbol.for("react.forward_ref"),DI=Symbol.for("react.suspense"),II=Symbol.for("react.suspense_list"),ZO=Symbol.for("react.memo"),Fh=Symbol.for("react.lazy"),eX=Symbol.for("react.offscreen"),j4=Symbol.iterator;function my(t){return t===null||typeof t!="object"?null:(t=j4&&t[j4]||t["@@iterator"],typeof t=="function"?t:null)}var mn=Object.assign,Y2;function bx(t){if(Y2===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);Y2=e&&e[1]||""}return`
`+Y2+t}var Q2=!1;function J2(t,e){if(!t||Q2)return"";Q2=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=n.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Q2=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?bx(t):""}function Wre(t){switch(t.tag){case 5:return bx(t.type);case 16:return bx("Lazy");case 13:return bx("Suspense");case 19:return bx("SuspenseList");case 0:case 2:case 15:return t=J2(t.type,!1),t;case 11:return t=J2(t.type.render,!1),t;case 1:return t=J2(t.type,!0),t;default:return""}}function LI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Lg:return"Fragment";case Ig:return"Portal";case PI:return"Profiler";case JO:return"StrictMode";case DI:return"Suspense";case II:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $7:return(t.displayName||"Context")+".Consumer";case Z7:return(t._context.displayName||"Context")+".Provider";case KO:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ZO:return e=t.displayName||null,e!==null?e:LI(t.type)||"Memo";case Fh:e=t._payload,t=t._init;try{return LI(t(e))}catch{}}return null}function Xre(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return LI(e);case 8:return e===JO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Md(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function tX(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qre(t){var e=tX(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Mb(t){t._valueTracker||(t._valueTracker=qre(t))}function iX(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=tX(t)?t.checked?"true":"false":t.value),t=n,t!==i?(e.setValue(t),!0):!1}function RM(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function BI(t,e){var i=e.checked;return mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??t._wrapperState.initialChecked})}function W4(t,e){var i=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;i=Md(e.value!=null?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nX(t,e){e=e.checked,e!=null&&QO(t,"checked",e,!1)}function RI(t,e){nX(t,e);var i=Md(e.value),n=e.type;if(i!=null)n==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?OI(t,e.type,i):e.hasOwnProperty("defaultValue")&&OI(t,e.type,Md(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function X4(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function OI(t,e,i){(e!=="number"||RM(t.ownerDocument)!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var Sx=Array.isArray;function av(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+Md(i),e=null,r=0;r<t.length;r++){if(t[r].value===i){t[r].selected=!0,n&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function FI(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ze(91));return mn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function q4(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(Ze(92));if(Sx(i)){if(1<i.length)throw Error(Ze(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:Md(i)}}function rX(t,e){var i=Md(e.value),n=Md(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),n!=null&&(t.defaultValue=""+n)}function Y4(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function sX(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function NI(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?sX(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cb,oX=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,n,r){MSApp.execUnsafeLocalFunction(function(){return t(e,i,n,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cb=Cb||document.createElement("div"),Cb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function M1(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}var Ux={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yre=["Webkit","ms","Moz","O"];Object.keys(Ux).forEach(function(t){Yre.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ux[e]=Ux[t]})});function aX(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||Ux.hasOwnProperty(t)&&Ux[t]?(""+e).trim():e+"px"}function lX(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=aX(i,e[i],n);i==="float"&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}var Qre=mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kI(t,e){if(e){if(Qre[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ze(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ze(62))}}function zI(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var UI=null;function $O(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var GI=null,lv=null,cv=null;function Q4(t){if(t=R_(t)){if(typeof GI!="function")throw Error(Ze(280));var e=t.stateNode;e&&(e=TE(e),GI(t.stateNode,t.type,e))}}function cX(t){lv?cv?cv.push(t):cv=[t]:lv=t}function uX(){if(lv){var t=lv,e=cv;if(cv=lv=null,Q4(t),e)for(t=0;t<e.length;t++)Q4(e[t])}}function hX(t,e){return t(e)}function dX(){}var K2=!1;function fX(t,e,i){if(K2)return t(e,i);K2=!0;try{return hX(t,e,i)}finally{K2=!1,(lv!==null||cv!==null)&&(dX(),uX())}}function C1(t,e){var i=t.stateNode;if(i===null)return null;var n=TE(i);if(n===null)return null;i=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(Ze(231,e,typeof i));return i}var VI=!1;if(Vu)try{var gy={};Object.defineProperty(gy,"passive",{get:function(){VI=!0}}),window.addEventListener("test",gy,gy),window.removeEventListener("test",gy,gy)}catch{VI=!1}function Jre(t,e,i,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(i,c)}catch(h){this.onError(h)}}var Gx=!1,OM=null,FM=!1,HI=null,Kre={onError:function(t){Gx=!0,OM=t}};function Zre(t,e,i,n,r,s,o,a,l){Gx=!1,OM=null,Jre.apply(Kre,arguments)}function $re(t,e,i,n,r,s,o,a,l){if(Zre.apply(this,arguments),Gx){if(Gx){var c=OM;Gx=!1,OM=null}else throw Error(Ze(198));FM||(FM=!0,HI=c)}}function Zp(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function pX(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function J4(t){if(Zp(t)!==t)throw Error(Ze(188))}function ese(t){var e=t.alternate;if(!e){if(e=Zp(t),e===null)throw Error(Ze(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return J4(r),t;if(s===n)return J4(r),e;s=s.sibling}throw Error(Ze(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(Ze(189))}}if(i.alternate!==n)throw Error(Ze(190))}if(i.tag!==3)throw Error(Ze(188));return i.stateNode.current===i?t:e}function mX(t){return t=ese(t),t!==null?gX(t):null}function gX(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gX(t);if(e!==null)return e;t=t.sibling}return null}var vX=Ho.unstable_scheduleCallback,K4=Ho.unstable_cancelCallback,tse=Ho.unstable_shouldYield,ise=Ho.unstable_requestPaint,Fn=Ho.unstable_now,nse=Ho.unstable_getCurrentPriorityLevel,eF=Ho.unstable_ImmediatePriority,yX=Ho.unstable_UserBlockingPriority,NM=Ho.unstable_NormalPriority,rse=Ho.unstable_LowPriority,xX=Ho.unstable_IdlePriority,AE=null,xc=null;function sse(t){if(xc&&typeof xc.onCommitFiberRoot=="function")try{xc.onCommitFiberRoot(AE,t,void 0,(t.current.flags&128)===128)}catch{}}var wl=Math.clz32?Math.clz32:lse,ose=Math.log,ase=Math.LN2;function lse(t){return t>>>=0,t===0?32:31-(ose(t)/ase|0)|0}var Eb=64,Tb=4194304;function Ax(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kM(t,e){var i=t.pendingLanes;if(i===0)return 0;var n=0,r=t.suspendedLanes,s=t.pingedLanes,o=i&268435455;if(o!==0){var a=o&~r;a!==0?n=Ax(a):(s&=o,s!==0&&(n=Ax(s)))}else o=i&~r,o!==0?n=Ax(o):s!==0&&(n=Ax(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(n&4&&(n|=i&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)i=31-wl(e),r=1<<i,n|=t[i],e&=~r;return n}function cse(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function use(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-wl(s),a=1<<o,l=r[o];l===-1?(!(a&i)||a&n)&&(r[o]=cse(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function jI(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _X(){var t=Eb;return Eb<<=1,!(Eb&4194240)&&(Eb=64),t}function Z2(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function L_(t,e,i){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wl(e),t[e]=i}function hse(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<i;){var r=31-wl(i),s=1<<r;e[r]=0,n[r]=-1,t[r]=-1,i&=~s}}function tF(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-wl(i),r=1<<n;r&e|t[n]&e&&(t[n]|=e),i&=~r}}var Bi=0;function wX(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bX,iF,SX,AX,MX,WI=!1,Pb=[],ad=null,ld=null,cd=null,E1=new Map,T1=new Map,Vh=[],dse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z4(t,e){switch(t){case"focusin":case"focusout":ad=null;break;case"dragenter":case"dragleave":ld=null;break;case"mouseover":case"mouseout":cd=null;break;case"pointerover":case"pointerout":E1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":T1.delete(e.pointerId)}}function vy(t,e,i,n,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=R_(e),e!==null&&iF(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function fse(t,e,i,n,r){switch(e){case"focusin":return ad=vy(ad,t,e,i,n,r),!0;case"dragenter":return ld=vy(ld,t,e,i,n,r),!0;case"mouseover":return cd=vy(cd,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return E1.set(s,vy(E1.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,T1.set(s,vy(T1.get(s)||null,t,e,i,n,r)),!0}return!1}function CX(t){var e=Kf(t.target);if(e!==null){var i=Zp(e);if(i!==null){if(e=i.tag,e===13){if(e=pX(i),e!==null){t.blockedOn=e,MX(t.priority,function(){SX(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $A(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var i=XI(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(i===null){i=t.nativeEvent;var n=new i.constructor(i.type,i);UI=n,i.target.dispatchEvent(n),UI=null}else return e=R_(i),e!==null&&iF(e),t.blockedOn=i,!1;e.shift()}return!0}function $4(t,e,i){$A(t)&&i.delete(e)}function pse(){WI=!1,ad!==null&&$A(ad)&&(ad=null),ld!==null&&$A(ld)&&(ld=null),cd!==null&&$A(cd)&&(cd=null),E1.forEach($4),T1.forEach($4)}function yy(t,e){t.blockedOn===e&&(t.blockedOn=null,WI||(WI=!0,Ho.unstable_scheduleCallback(Ho.unstable_NormalPriority,pse)))}function P1(t){function e(r){return yy(r,t)}if(0<Pb.length){yy(Pb[0],t);for(var i=1;i<Pb.length;i++){var n=Pb[i];n.blockedOn===t&&(n.blockedOn=null)}}for(ad!==null&&yy(ad,t),ld!==null&&yy(ld,t),cd!==null&&yy(cd,t),E1.forEach(e),T1.forEach(e),i=0;i<Vh.length;i++)n=Vh[i],n.blockedOn===t&&(n.blockedOn=null);for(;0<Vh.length&&(i=Vh[0],i.blockedOn===null);)CX(i),i.blockedOn===null&&Vh.shift()}var uv=$u.ReactCurrentBatchConfig,zM=!0;function mse(t,e,i,n){var r=Bi,s=uv.transition;uv.transition=null;try{Bi=1,nF(t,e,i,n)}finally{Bi=r,uv.transition=s}}function gse(t,e,i,n){var r=Bi,s=uv.transition;uv.transition=null;try{Bi=4,nF(t,e,i,n)}finally{Bi=r,uv.transition=s}}function nF(t,e,i,n){if(zM){var r=XI(t,e,i,n);if(r===null)lP(t,e,n,UM,i),Z4(t,n);else if(fse(r,t,e,i,n))n.stopPropagation();else if(Z4(t,n),e&4&&-1<dse.indexOf(t)){for(;r!==null;){var s=R_(r);if(s!==null&&bX(s),s=XI(t,e,i,n),s===null&&lP(t,e,n,UM,i),s===r)break;r=s}r!==null&&n.stopPropagation()}else lP(t,e,n,null,i)}}var UM=null;function XI(t,e,i,n){if(UM=null,t=$O(n),t=Kf(t),t!==null)if(e=Zp(t),e===null)t=null;else if(i=e.tag,i===13){if(t=pX(e),t!==null)return t;t=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return UM=t,null}function EX(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nse()){case eF:return 1;case yX:return 4;case NM:case rse:return 16;case xX:return 536870912;default:return 16}default:return 16}}var qh=null,rF=null,eM=null;function TX(){if(eM)return eM;var t,e=rF,i=e.length,n,r="value"in qh?qh.value:qh.textContent,s=r.length;for(t=0;t<i&&e[t]===r[t];t++);var o=i-t;for(n=1;n<=o&&e[i-n]===r[s-n];n++);return eM=r.slice(t,1<n?1-n:void 0)}function tM(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Db(){return!0}function eG(){return!1}function Jo(t){function e(i,n,r,s,o){this._reactName=i,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(i=t[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Db:eG,this.isPropagationStopped=eG,this}return mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Db)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Db)},persist:function(){},isPersistent:Db}),e}var b0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sF=Jo(b0),B_=mn({},b0,{view:0,detail:0}),vse=Jo(B_),$2,eP,xy,ME=mn({},B_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oF,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xy&&(xy&&t.type==="mousemove"?($2=t.screenX-xy.screenX,eP=t.screenY-xy.screenY):eP=$2=0,xy=t),$2)},movementY:function(t){return"movementY"in t?t.movementY:eP}}),tG=Jo(ME),yse=mn({},ME,{dataTransfer:0}),xse=Jo(yse),_se=mn({},B_,{relatedTarget:0}),tP=Jo(_se),wse=mn({},b0,{animationName:0,elapsedTime:0,pseudoElement:0}),bse=Jo(wse),Sse=mn({},b0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ase=Jo(Sse),Mse=mn({},b0,{data:0}),iG=Jo(Mse),Cse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ese={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pse(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Tse[t])?!!e[t]:!1}function oF(){return Pse}var Dse=mn({},B_,{key:function(t){if(t.key){var e=Cse[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tM(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ese[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oF,charCode:function(t){return t.type==="keypress"?tM(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tM(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ise=Jo(Dse),Lse=mn({},ME,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nG=Jo(Lse),Bse=mn({},B_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oF}),Rse=Jo(Bse),Ose=mn({},b0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fse=Jo(Ose),Nse=mn({},ME,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kse=Jo(Nse),zse=[9,13,27,32],aF=Vu&&"CompositionEvent"in window,Vx=null;Vu&&"documentMode"in document&&(Vx=document.documentMode);var Use=Vu&&"TextEvent"in window&&!Vx,PX=Vu&&(!aF||Vx&&8<Vx&&11>=Vx),rG=String.fromCharCode(32),sG=!1;function DX(t,e){switch(t){case"keyup":return zse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function IX(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bg=!1;function Gse(t,e){switch(t){case"compositionend":return IX(e);case"keypress":return e.which!==32?null:(sG=!0,rG);case"textInput":return t=e.data,t===rG&&sG?null:t;default:return null}}function Vse(t,e){if(Bg)return t==="compositionend"||!aF&&DX(t,e)?(t=TX(),eM=rF=qh=null,Bg=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PX&&e.locale!=="ko"?null:e.data;default:return null}}var Hse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oG(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Hse[t.type]:e==="textarea"}function LX(t,e,i,n){cX(n),e=GM(e,"onChange"),0<e.length&&(i=new sF("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var Hx=null,D1=null;function jse(t){HX(t,0)}function CE(t){var e=Fg(t);if(iX(e))return t}function Wse(t,e){if(t==="change")return e}var BX=!1;if(Vu){var iP;if(Vu){var nP="oninput"in document;if(!nP){var aG=document.createElement("div");aG.setAttribute("oninput","return;"),nP=typeof aG.oninput=="function"}iP=nP}else iP=!1;BX=iP&&(!document.documentMode||9<document.documentMode)}function lG(){Hx&&(Hx.detachEvent("onpropertychange",RX),D1=Hx=null)}function RX(t){if(t.propertyName==="value"&&CE(D1)){var e=[];LX(e,D1,t,$O(t)),fX(jse,e)}}function Xse(t,e,i){t==="focusin"?(lG(),Hx=e,D1=i,Hx.attachEvent("onpropertychange",RX)):t==="focusout"&&lG()}function qse(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return CE(D1)}function Yse(t,e){if(t==="click")return CE(e)}function Qse(t,e){if(t==="input"||t==="change")return CE(e)}function Jse(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var El=typeof Object.is=="function"?Object.is:Jse;function I1(t,e){if(El(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!TI.call(e,r)||!El(t[r],e[r]))return!1}return!0}function cG(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function uG(t,e){var i=cG(t);t=0;for(var n;i;){if(i.nodeType===3){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=cG(i)}}function OX(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?OX(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function FX(){for(var t=window,e=RM();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=RM(t.document)}return e}function lF(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Kse(t){var e=FX(),i=t.focusedElem,n=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&OX(i.ownerDocument.documentElement,i)){if(n!==null&&lF(i)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if(t=(e=i.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!t.extend&&s>n&&(r=n,n=s,s=r),r=uG(i,s);var o=uG(i,n);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=i;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)t=e[i],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Zse=Vu&&"documentMode"in document&&11>=document.documentMode,Rg=null,qI=null,jx=null,YI=!1;function hG(t,e,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;YI||Rg==null||Rg!==RM(n)||(n=Rg,"selectionStart"in n&&lF(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),jx&&I1(jx,n)||(jx=n,n=GM(qI,"onSelect"),0<n.length&&(e=new sF("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=Rg)))}function Ib(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Og={animationend:Ib("Animation","AnimationEnd"),animationiteration:Ib("Animation","AnimationIteration"),animationstart:Ib("Animation","AnimationStart"),transitionend:Ib("Transition","TransitionEnd")},rP={},NX={};Vu&&(NX=document.createElement("div").style,"AnimationEvent"in window||(delete Og.animationend.animation,delete Og.animationiteration.animation,delete Og.animationstart.animation),"TransitionEvent"in window||delete Og.transitionend.transition);function EE(t){if(rP[t])return rP[t];if(!Og[t])return t;var e=Og[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in NX)return rP[t]=e[i];return t}var kX=EE("animationend"),zX=EE("animationiteration"),UX=EE("animationstart"),GX=EE("transitionend"),VX=new Map,dG="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ud(t,e){VX.set(t,e),Kp(e,[t])}for(var sP=0;sP<dG.length;sP++){var oP=dG[sP],$se=oP.toLowerCase(),eoe=oP[0].toUpperCase()+oP.slice(1);Ud($se,"on"+eoe)}Ud(kX,"onAnimationEnd");Ud(zX,"onAnimationIteration");Ud(UX,"onAnimationStart");Ud("dblclick","onDoubleClick");Ud("focusin","onFocus");Ud("focusout","onBlur");Ud(GX,"onTransitionEnd");Ov("onMouseEnter",["mouseout","mouseover"]);Ov("onMouseLeave",["mouseout","mouseover"]);Ov("onPointerEnter",["pointerout","pointerover"]);Ov("onPointerLeave",["pointerout","pointerover"]);Kp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Kp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Kp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Kp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Kp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Kp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),toe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mx));function fG(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,$re(n,e,void 0,t),t.currentTarget=null}function HX(t,e){e=(e&4)!==0;for(var i=0;i<t.length;i++){var n=t[i],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;fG(r,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;fG(r,a,c),s=l}}}if(FM)throw t=HI,FM=!1,HI=null,t}function Ki(t,e){var i=e[$I];i===void 0&&(i=e[$I]=new Set);var n=t+"__bubble";i.has(n)||(jX(e,t,2,!1),i.add(n))}function aP(t,e,i){var n=0;e&&(n|=4),jX(i,t,n,e)}var Lb="_reactListening"+Math.random().toString(36).slice(2);function L1(t){if(!t[Lb]){t[Lb]=!0,K7.forEach(function(i){i!=="selectionchange"&&(toe.has(i)||aP(i,!1,t),aP(i,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Lb]||(e[Lb]=!0,aP("selectionchange",!1,e))}}function jX(t,e,i,n){switch(EX(e)){case 1:var r=mse;break;case 4:r=gse;break;default:r=nF}i=r.bind(null,e,i,t),r=void 0,!VI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?t.addEventListener(e,i,{capture:!0,passive:r}):t.addEventListener(e,i,!0):r!==void 0?t.addEventListener(e,i,{passive:r}):t.addEventListener(e,i,!1)}function lP(t,e,i,n,r){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Kf(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}fX(function(){var c=s,h=$O(i),u=[];e:{var d=VX.get(t);if(d!==void 0){var f=sF,p=t;switch(t){case"keypress":if(tM(i)===0)break e;case"keydown":case"keyup":f=Ise;break;case"focusin":p="focus",f=tP;break;case"focusout":p="blur",f=tP;break;case"beforeblur":case"afterblur":f=tP;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=tG;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=xse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Rse;break;case kX:case zX:case UX:f=bse;break;case GX:f=Fse;break;case"scroll":f=vse;break;case"wheel":f=kse;break;case"copy":case"cut":case"paste":f=Ase;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=nG}var m=(e&4)!==0,g=!m&&t==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,x;y!==null;){x=y;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,v!==null&&(b=C1(y,v),b!=null&&m.push(B1(y,b,x)))),g)break;y=y.return}0<m.length&&(d=new f(d,p,null,i,h),u.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&i!==UI&&(p=i.relatedTarget||i.fromElement)&&(Kf(p)||p[Hu]))break e;if((f||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=i.relatedTarget||i.toElement,f=c,p=p?Kf(p):null,p!==null&&(g=Zp(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=tG,b="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=nG,b="onPointerLeave",v="onPointerEnter",y="pointer"),g=f==null?d:Fg(f),x=p==null?d:Fg(p),d=new m(b,y+"leave",f,i,h),d.target=g,d.relatedTarget=x,b=null,Kf(h)===c&&(m=new m(v,y+"enter",p,i,h),m.target=x,m.relatedTarget=g,b=m),g=b,f&&p)t:{for(m=f,v=p,y=0,x=m;x;x=Mm(x))y++;for(x=0,b=v;b;b=Mm(b))x++;for(;0<y-x;)m=Mm(m),y--;for(;0<x-y;)v=Mm(v),x--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Mm(m),v=Mm(v)}m=null}else m=null;f!==null&&pG(u,d,f,m,!1),p!==null&&g!==null&&pG(u,g,p,m,!0)}}e:{if(d=c?Fg(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var S=Wse;else if(oG(d))if(BX)S=Qse;else{S=qse;var A=Xse}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=Yse);if(S&&(S=S(t,c))){LX(u,S,i,h);break e}A&&A(t,d,c),t==="focusout"&&(A=d._wrapperState)&&A.controlled&&d.type==="number"&&OI(d,"number",d.value)}switch(A=c?Fg(c):window,t){case"focusin":(oG(A)||A.contentEditable==="true")&&(Rg=A,qI=c,jx=null);break;case"focusout":jx=qI=Rg=null;break;case"mousedown":YI=!0;break;case"contextmenu":case"mouseup":case"dragend":YI=!1,hG(u,i,h);break;case"selectionchange":if(Zse)break;case"keydown":case"keyup":hG(u,i,h)}var E;if(aF)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Bg?DX(t,i)&&(M="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(M="onCompositionStart");M&&(PX&&i.locale!=="ko"&&(Bg||M!=="onCompositionStart"?M==="onCompositionEnd"&&Bg&&(E=TX()):(qh=h,rF="value"in qh?qh.value:qh.textContent,Bg=!0)),A=GM(c,M),0<A.length&&(M=new iG(M,t,null,i,h),u.push({event:M,listeners:A}),E?M.data=E:(E=IX(i),E!==null&&(M.data=E)))),(E=Use?Gse(t,i):Vse(t,i))&&(c=GM(c,"onBeforeInput"),0<c.length&&(h=new iG("onBeforeInput","beforeinput",null,i,h),u.push({event:h,listeners:c}),h.data=E))}HX(u,e)})}function B1(t,e,i){return{instance:t,listener:e,currentTarget:i}}function GM(t,e){for(var i=e+"Capture",n=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=C1(t,i),s!=null&&n.unshift(B1(t,s,r)),s=C1(t,e),s!=null&&n.push(B1(t,s,r))),t=t.return}return n}function Mm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function pG(t,e,i,n,r){for(var s=e._reactName,o=[];i!==null&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,r?(l=C1(i,s),l!=null&&o.unshift(B1(i,l,a))):r||(l=C1(i,s),l!=null&&o.push(B1(i,l,a)))),i=i.return}o.length!==0&&t.push({event:e,listeners:o})}var ioe=/\r\n?/g,noe=/\u0000|\uFFFD/g;function mG(t){return(typeof t=="string"?t:""+t).replace(ioe,`
`).replace(noe,"")}function Bb(t,e,i){if(e=mG(e),mG(t)!==e&&i)throw Error(Ze(425))}function VM(){}var QI=null,JI=null;function KI(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ZI=typeof setTimeout=="function"?setTimeout:void 0,roe=typeof clearTimeout=="function"?clearTimeout:void 0,gG=typeof Promise=="function"?Promise:void 0,soe=typeof queueMicrotask=="function"?queueMicrotask:typeof gG<"u"?function(t){return gG.resolve(null).then(t).catch(ooe)}:ZI;function ooe(t){setTimeout(function(){throw t})}function cP(t,e){var i=e,n=0;do{var r=i.nextSibling;if(t.removeChild(i),r&&r.nodeType===8)if(i=r.data,i==="/$"){if(n===0){t.removeChild(r),P1(e);return}n--}else i!=="$"&&i!=="$?"&&i!=="$!"||n++;i=r}while(i);P1(e)}function ud(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vG(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return t;e--}else i==="/$"&&e++}t=t.previousSibling}return null}var S0=Math.random().toString(36).slice(2),hc="__reactFiber$"+S0,R1="__reactProps$"+S0,Hu="__reactContainer$"+S0,$I="__reactEvents$"+S0,aoe="__reactListeners$"+S0,loe="__reactHandles$"+S0;function Kf(t){var e=t[hc];if(e)return e;for(var i=t.parentNode;i;){if(e=i[Hu]||i[hc]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=vG(t);t!==null;){if(i=t[hc])return i;t=vG(t)}return e}t=i,i=t.parentNode}return null}function R_(t){return t=t[hc]||t[Hu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ze(33))}function TE(t){return t[R1]||null}var eL=[],Ng=-1;function Gd(t){return{current:t}}function en(t){0>Ng||(t.current=eL[Ng],eL[Ng]=null,Ng--)}function Ji(t,e){Ng++,eL[Ng]=t.current,t.current=e}var Cd={},ds=Gd(Cd),io=Gd(!1),Rp=Cd;function Fv(t,e){var i=t.type.contextTypes;if(!i)return Cd;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function no(t){return t=t.childContextTypes,t!=null}function HM(){en(io),en(ds)}function yG(t,e,i){if(ds.current!==Cd)throw Error(Ze(168));Ji(ds,e),Ji(io,i)}function WX(t,e,i){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(Ze(108,Xre(t)||"Unknown",r));return mn({},i,n)}function jM(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Cd,Rp=ds.current,Ji(ds,t),Ji(io,io.current),!0}function xG(t,e,i){var n=t.stateNode;if(!n)throw Error(Ze(169));i?(t=WX(t,e,Rp),n.__reactInternalMemoizedMergedChildContext=t,en(io),en(ds),Ji(ds,t)):en(io),Ji(io,i)}var xu=null,PE=!1,uP=!1;function XX(t){xu===null?xu=[t]:xu.push(t)}function coe(t){PE=!0,XX(t)}function Vd(){if(!uP&&xu!==null){uP=!0;var t=0,e=Bi;try{var i=xu;for(Bi=1;t<i.length;t++){var n=i[t];do n=n(!0);while(n!==null)}xu=null,PE=!1}catch(r){throw xu!==null&&(xu=xu.slice(t+1)),vX(eF,Vd),r}finally{Bi=e,uP=!1}}return null}var kg=[],zg=0,WM=null,XM=0,Sa=[],Aa=0,Op=null,Mu=1,Cu="";function Lf(t,e){kg[zg++]=XM,kg[zg++]=WM,WM=t,XM=e}function qX(t,e,i){Sa[Aa++]=Mu,Sa[Aa++]=Cu,Sa[Aa++]=Op,Op=t;var n=Mu;t=Cu;var r=32-wl(n)-1;n&=~(1<<r),i+=1;var s=32-wl(e)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Mu=1<<32-wl(e)+r|i<<r|n,Cu=s+t}else Mu=1<<s|i<<r|n,Cu=t}function cF(t){t.return!==null&&(Lf(t,1),qX(t,1,0))}function uF(t){for(;t===WM;)WM=kg[--zg],kg[zg]=null,XM=kg[--zg],kg[zg]=null;for(;t===Op;)Op=Sa[--Aa],Sa[Aa]=null,Cu=Sa[--Aa],Sa[Aa]=null,Mu=Sa[--Aa],Sa[Aa]=null}var Uo=null,Lo=null,rn=!1,dl=null;function YX(t,e){var i=Pa(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,e=t.deletions,e===null?(t.deletions=[i],t.flags|=16):e.push(i)}function _G(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Uo=t,Lo=ud(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Uo=t,Lo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Op!==null?{id:Mu,overflow:Cu}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Pa(18,null,null,0),i.stateNode=e,i.return=t,t.child=i,Uo=t,Lo=null,!0):!1;default:return!1}}function tL(t){return(t.mode&1)!==0&&(t.flags&128)===0}function iL(t){if(rn){var e=Lo;if(e){var i=e;if(!_G(t,e)){if(tL(t))throw Error(Ze(418));e=ud(i.nextSibling);var n=Uo;e&&_G(t,e)?YX(n,i):(t.flags=t.flags&-4097|2,rn=!1,Uo=t)}}else{if(tL(t))throw Error(Ze(418));t.flags=t.flags&-4097|2,rn=!1,Uo=t}}}function wG(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Uo=t}function Rb(t){if(t!==Uo)return!1;if(!rn)return wG(t),rn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!KI(t.type,t.memoizedProps)),e&&(e=Lo)){if(tL(t))throw QX(),Error(Ze(418));for(;e;)YX(t,e),e=ud(e.nextSibling)}if(wG(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ze(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"){if(e===0){Lo=ud(t.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}t=t.nextSibling}Lo=null}}else Lo=Uo?ud(t.stateNode.nextSibling):null;return!0}function QX(){for(var t=Lo;t;)t=ud(t.nextSibling)}function Nv(){Lo=Uo=null,rn=!1}function hF(t){dl===null?dl=[t]:dl.push(t)}var uoe=$u.ReactCurrentBatchConfig;function cl(t,e){if(t&&t.defaultProps){e=mn({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e}return e}var qM=Gd(null),YM=null,Ug=null,dF=null;function fF(){dF=Ug=YM=null}function pF(t){var e=qM.current;en(qM),t._currentValue=e}function nL(t,e,i){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function hv(t,e){YM=t,dF=Ug=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zs=!0),t.firstContext=null)}function za(t){var e=t._currentValue;if(dF!==t)if(t={context:t,memoizedValue:e,next:null},Ug===null){if(YM===null)throw Error(Ze(308));Ug=t,YM.dependencies={lanes:0,firstContext:t}}else Ug=Ug.next=t;return e}var Zf=null;function mF(t){Zf===null?Zf=[t]:Zf.push(t)}function JX(t,e,i,n){var r=e.interleaved;return r===null?(i.next=i,mF(e)):(i.next=r.next,r.next=i),e.interleaved=i,ju(t,n)}function ju(t,e){t.lanes|=e;var i=t.alternate;for(i!==null&&(i.lanes|=e),i=t,t=t.return;t!==null;)t.childLanes|=e,i=t.alternate,i!==null&&(i.childLanes|=e),i=t,t=t.return;return i.tag===3?i.stateNode:null}var Nh=!1;function gF(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KX(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ru(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hd(t,e,i){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,yi&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,ju(t,i)}return r=n.interleaved,r===null?(e.next=e,mF(n)):(e.next=r.next,r.next=e),n.interleaved=e,ju(t,i)}function iM(t,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,i|=n,e.lanes=i,tF(t,i)}}function bG(t,e){var i=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var r=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?r=s=o:s=s.next=o,i=i.next}while(i!==null);s===null?r=s=e:s=s.next=e}else r=s=e;i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function QM(t,e,i,n){var r=t.updateQueue;Nh=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,h=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((n&d)===d){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=i,m.tag){case 1:if(p=m.payload,typeof p=="function"){u=p.call(f,u,d);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,u,d):p,d==null)break e;u=mn({},u,d);break e;case 2:Nh=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=f,l=u):h=h.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(h===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Np|=o,t.lanes=o,t.memoizedState=u}}function SG(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(r!==null){if(n.callback=null,n=i,typeof r!="function")throw Error(Ze(191,r));r.call(n)}}}var ZX=new J7.Component().refs;function rL(t,e,i,n){e=t.memoizedState,i=i(n,e),i=i==null?e:mn({},e,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var DE={isMounted:function(t){return(t=t._reactInternals)?Zp(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=Is(),r=fd(t),s=Ru(n,r);s.payload=e,i!=null&&(s.callback=i),e=hd(t,s,r),e!==null&&(bl(e,t,r,n),iM(e,t,r))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=Is(),r=fd(t),s=Ru(n,r);s.tag=1,s.payload=e,i!=null&&(s.callback=i),e=hd(t,s,r),e!==null&&(bl(e,t,r,n),iM(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Is(),n=fd(t),r=Ru(i,n);r.tag=2,e!=null&&(r.callback=e),e=hd(t,r,n),e!==null&&(bl(e,t,n,i),iM(e,t,n))}};function AG(t,e,i,n,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!I1(i,n)||!I1(r,s):!0}function $X(t,e,i){var n=!1,r=Cd,s=e.contextType;return typeof s=="object"&&s!==null?s=za(s):(r=no(e)?Rp:ds.current,n=e.contextTypes,s=(n=n!=null)?Fv(t,r):Cd),e=new e(i,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=DE,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function MG(t,e,i,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&DE.enqueueReplaceState(e,e.state,null)}function sL(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs=ZX,gF(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=za(s):(s=no(e)?Rp:ds.current,r.context=Fv(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(rL(t,e,s,i),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&DE.enqueueReplaceState(r,r.state,null),QM(t,i,r,n),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function _y(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Ze(309));var n=i.stateNode}if(!n)throw Error(Ze(147,t));var r=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===ZX&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Ze(284));if(!i._owner)throw Error(Ze(290,t))}return t}function Ob(t,e){throw t=Object.prototype.toString.call(e),Error(Ze(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function CG(t){var e=t._init;return e(t._payload)}function eq(t){function e(v,y){if(t){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function i(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function r(v,y){return v=pd(v,y),v.index=0,v.sibling=null,v}function s(v,y,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,x,b){return y===null||y.tag!==6?(y=vP(x,v.mode,b),y.return=v,y):(y=r(y,x),y.return=v,y)}function l(v,y,x,b){var S=x.type;return S===Lg?h(v,y,x.props.children,b,x.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Fh&&CG(S)===y.type)?(b=r(y,x.props),b.ref=_y(v,y,x),b.return=v,b):(b=lM(x.type,x.key,x.props,null,v.mode,b),b.ref=_y(v,y,x),b.return=v,b)}function c(v,y,x,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=yP(x,v.mode,b),y.return=v,y):(y=r(y,x.children||[]),y.return=v,y)}function h(v,y,x,b,S){return y===null||y.tag!==7?(y=mp(x,v.mode,b,S),y.return=v,y):(y=r(y,x),y.return=v,y)}function u(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=vP(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ab:return x=lM(y.type,y.key,y.props,null,v.mode,x),x.ref=_y(v,null,y),x.return=v,x;case Ig:return y=yP(y,v.mode,x),y.return=v,y;case Fh:var b=y._init;return u(v,b(y._payload),x)}if(Sx(y)||my(y))return y=mp(y,v.mode,x,null),y.return=v,y;Ob(v,y)}return null}function d(v,y,x,b){var S=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:a(v,y,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ab:return x.key===S?l(v,y,x,b):null;case Ig:return x.key===S?c(v,y,x,b):null;case Fh:return S=x._init,d(v,y,S(x._payload),b)}if(Sx(x)||my(x))return S!==null?null:h(v,y,x,b,null);Ob(v,x)}return null}function f(v,y,x,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(x)||null,a(y,v,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ab:return v=v.get(b.key===null?x:b.key)||null,l(y,v,b,S);case Ig:return v=v.get(b.key===null?x:b.key)||null,c(y,v,b,S);case Fh:var A=b._init;return f(v,y,x,A(b._payload),S)}if(Sx(b)||my(b))return v=v.get(x)||null,h(y,v,b,S,null);Ob(y,b)}return null}function p(v,y,x,b){for(var S=null,A=null,E=y,M=y=0,T=null;E!==null&&M<x.length;M++){E.index>M?(T=E,E=null):T=E.sibling;var P=d(v,E,x[M],b);if(P===null){E===null&&(E=T);break}t&&E&&P.alternate===null&&e(v,E),y=s(P,y,M),A===null?S=P:A.sibling=P,A=P,E=T}if(M===x.length)return i(v,E),rn&&Lf(v,M),S;if(E===null){for(;M<x.length;M++)E=u(v,x[M],b),E!==null&&(y=s(E,y,M),A===null?S=E:A.sibling=E,A=E);return rn&&Lf(v,M),S}for(E=n(v,E);M<x.length;M++)T=f(E,v,M,x[M],b),T!==null&&(t&&T.alternate!==null&&E.delete(T.key===null?M:T.key),y=s(T,y,M),A===null?S=T:A.sibling=T,A=T);return t&&E.forEach(function(I){return e(v,I)}),rn&&Lf(v,M),S}function m(v,y,x,b){var S=my(x);if(typeof S!="function")throw Error(Ze(150));if(x=S.call(x),x==null)throw Error(Ze(151));for(var A=S=null,E=y,M=y=0,T=null,P=x.next();E!==null&&!P.done;M++,P=x.next()){E.index>M?(T=E,E=null):T=E.sibling;var I=d(v,E,P.value,b);if(I===null){E===null&&(E=T);break}t&&E&&I.alternate===null&&e(v,E),y=s(I,y,M),A===null?S=I:A.sibling=I,A=I,E=T}if(P.done)return i(v,E),rn&&Lf(v,M),S;if(E===null){for(;!P.done;M++,P=x.next())P=u(v,P.value,b),P!==null&&(y=s(P,y,M),A===null?S=P:A.sibling=P,A=P);return rn&&Lf(v,M),S}for(E=n(v,E);!P.done;M++,P=x.next())P=f(E,v,M,P.value,b),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?M:P.key),y=s(P,y,M),A===null?S=P:A.sibling=P,A=P);return t&&E.forEach(function(k){return e(v,k)}),rn&&Lf(v,M),S}function g(v,y,x,b){if(typeof x=="object"&&x!==null&&x.type===Lg&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ab:e:{for(var S=x.key,A=y;A!==null;){if(A.key===S){if(S=x.type,S===Lg){if(A.tag===7){i(v,A.sibling),y=r(A,x.props.children),y.return=v,v=y;break e}}else if(A.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Fh&&CG(S)===A.type){i(v,A.sibling),y=r(A,x.props),y.ref=_y(v,A,x),y.return=v,v=y;break e}i(v,A);break}else e(v,A);A=A.sibling}x.type===Lg?(y=mp(x.props.children,v.mode,b,x.key),y.return=v,v=y):(b=lM(x.type,x.key,x.props,null,v.mode,b),b.ref=_y(v,y,x),b.return=v,v=b)}return o(v);case Ig:e:{for(A=x.key;y!==null;){if(y.key===A)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){i(v,y.sibling),y=r(y,x.children||[]),y.return=v,v=y;break e}else{i(v,y);break}else e(v,y);y=y.sibling}y=yP(x,v.mode,b),y.return=v,v=y}return o(v);case Fh:return A=x._init,g(v,y,A(x._payload),b)}if(Sx(x))return p(v,y,x,b);if(my(x))return m(v,y,x,b);Ob(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(i(v,y.sibling),y=r(y,x),y.return=v,v=y):(i(v,y),y=vP(x,v.mode,b),y.return=v,v=y),o(v)):i(v,y)}return g}var kv=eq(!0),tq=eq(!1),O_={},_c=Gd(O_),O1=Gd(O_),F1=Gd(O_);function $f(t){if(t===O_)throw Error(Ze(174));return t}function vF(t,e){switch(Ji(F1,e),Ji(O1,t),Ji(_c,O_),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:NI(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=NI(e,t)}en(_c),Ji(_c,e)}function zv(){en(_c),en(O1),en(F1)}function iq(t){$f(F1.current);var e=$f(_c.current),i=NI(e,t.type);e!==i&&(Ji(O1,t),Ji(_c,i))}function yF(t){O1.current===t&&(en(_c),en(O1))}var ln=Gd(0);function JM(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hP=[];function xF(){for(var t=0;t<hP.length;t++)hP[t]._workInProgressVersionPrimary=null;hP.length=0}var nM=$u.ReactCurrentDispatcher,dP=$u.ReactCurrentBatchConfig,Fp=0,pn=null,or=null,Cr=null,KM=!1,Wx=!1,N1=0,hoe=0;function es(){throw Error(Ze(321))}function _F(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!El(t[i],e[i]))return!1;return!0}function wF(t,e,i,n,r,s){if(Fp=s,pn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nM.current=t===null||t.memoizedState===null?moe:goe,t=i(n,r),Wx){s=0;do{if(Wx=!1,N1=0,25<=s)throw Error(Ze(301));s+=1,Cr=or=null,e.updateQueue=null,nM.current=voe,t=i(n,r)}while(Wx)}if(nM.current=ZM,e=or!==null&&or.next!==null,Fp=0,Cr=or=pn=null,KM=!1,e)throw Error(Ze(300));return t}function bF(){var t=N1!==0;return N1=0,t}function sc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cr===null?pn.memoizedState=Cr=t:Cr=Cr.next=t,Cr}function Ua(){if(or===null){var t=pn.alternate;t=t!==null?t.memoizedState:null}else t=or.next;var e=Cr===null?pn.memoizedState:Cr.next;if(e!==null)Cr=e,or=t;else{if(t===null)throw Error(Ze(310));or=t,t={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},Cr===null?pn.memoizedState=Cr=t:Cr=Cr.next=t}return Cr}function k1(t,e){return typeof e=="function"?e(t):e}function fP(t){var e=Ua(),i=e.queue;if(i===null)throw Error(Ze(311));i.lastRenderedReducer=t;var n=or,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(r!==null){s=r.next,n=n.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((Fp&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=n):l=l.next=u,pn.lanes|=h,Np|=h}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,El(n,e.memoizedState)||(Zs=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,i.lastRenderedState=n}if(t=i.interleaved,t!==null){r=t;do s=r.lane,pn.lanes|=s,Np|=s,r=r.next;while(r!==t)}else r===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function pP(t){var e=Ua(),i=e.queue;if(i===null)throw Error(Ze(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,s=e.memoizedState;if(r!==null){i.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);El(s,e.memoizedState)||(Zs=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),i.lastRenderedState=s}return[s,n]}function nq(){}function rq(t,e){var i=pn,n=Ua(),r=e(),s=!El(n.memoizedState,r);if(s&&(n.memoizedState=r,Zs=!0),n=n.queue,SF(aq.bind(null,i,n,t),[t]),n.getSnapshot!==e||s||Cr!==null&&Cr.memoizedState.tag&1){if(i.flags|=2048,z1(9,oq.bind(null,i,n,r,e),void 0,null),Dr===null)throw Error(Ze(349));Fp&30||sq(i,e,r)}return r}function sq(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.stores=[t]):(i=e.stores,i===null?e.stores=[t]:i.push(t))}function oq(t,e,i,n){e.value=i,e.getSnapshot=n,lq(e)&&cq(t)}function aq(t,e,i){return i(function(){lq(e)&&cq(t)})}function lq(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!El(t,i)}catch{return!0}}function cq(t){var e=ju(t,1);e!==null&&bl(e,t,1,-1)}function EG(t){var e=sc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:k1,lastRenderedState:t},e.queue=t,t=t.dispatch=poe.bind(null,pn,t),[e.memoizedState,t]}function z1(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t)),t}function uq(){return Ua().memoizedState}function rM(t,e,i,n){var r=sc();pn.flags|=t,r.memoizedState=z1(1|e,i,void 0,n===void 0?null:n)}function IE(t,e,i,n){var r=Ua();n=n===void 0?null:n;var s=void 0;if(or!==null){var o=or.memoizedState;if(s=o.destroy,n!==null&&_F(n,o.deps)){r.memoizedState=z1(e,i,s,n);return}}pn.flags|=t,r.memoizedState=z1(1|e,i,s,n)}function TG(t,e){return rM(8390656,8,t,e)}function SF(t,e){return IE(2048,8,t,e)}function hq(t,e){return IE(4,2,t,e)}function dq(t,e){return IE(4,4,t,e)}function fq(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pq(t,e,i){return i=i!=null?i.concat([t]):null,IE(4,4,fq.bind(null,e,t),i)}function AF(){}function mq(t,e){var i=Ua();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&_F(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function gq(t,e){var i=Ua();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&_F(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function vq(t,e,i){return Fp&21?(El(i,e)||(i=_X(),pn.lanes|=i,Np|=i,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zs=!0),t.memoizedState=i)}function doe(t,e){var i=Bi;Bi=i!==0&&4>i?i:4,t(!0);var n=dP.transition;dP.transition={};try{t(!1),e()}finally{Bi=i,dP.transition=n}}function yq(){return Ua().memoizedState}function foe(t,e,i){var n=fd(t);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},xq(t))_q(e,i);else if(i=JX(t,e,i,n),i!==null){var r=Is();bl(i,t,n,r),wq(i,e,n)}}function poe(t,e,i){var n=fd(t),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(xq(t))_q(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,i);if(r.hasEagerState=!0,r.eagerState=a,El(a,o)){var l=e.interleaved;l===null?(r.next=r,mF(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}i=JX(t,e,r,n),i!==null&&(r=Is(),bl(i,t,n,r),wq(i,e,n))}}function xq(t){var e=t.alternate;return t===pn||e!==null&&e===pn}function _q(t,e){Wx=KM=!0;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function wq(t,e,i){if(i&4194240){var n=e.lanes;n&=t.pendingLanes,i|=n,e.lanes=i,tF(t,i)}}var ZM={readContext:za,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},moe={readContext:za,useCallback:function(t,e){return sc().memoizedState=[t,e===void 0?null:e],t},useContext:za,useEffect:TG,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,rM(4194308,4,fq.bind(null,e,t),i)},useLayoutEffect:function(t,e){return rM(4194308,4,t,e)},useInsertionEffect:function(t,e){return rM(4,2,t,e)},useMemo:function(t,e){var i=sc();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=sc();return e=i!==void 0?i(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=foe.bind(null,pn,t),[n.memoizedState,t]},useRef:function(t){var e=sc();return t={current:t},e.memoizedState=t},useState:EG,useDebugValue:AF,useDeferredValue:function(t){return sc().memoizedState=t},useTransition:function(){var t=EG(!1),e=t[0];return t=doe.bind(null,t[1]),sc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var n=pn,r=sc();if(rn){if(i===void 0)throw Error(Ze(407));i=i()}else{if(i=e(),Dr===null)throw Error(Ze(349));Fp&30||sq(n,e,i)}r.memoizedState=i;var s={value:i,getSnapshot:e};return r.queue=s,TG(aq.bind(null,n,s,t),[t]),n.flags|=2048,z1(9,oq.bind(null,n,s,i,e),void 0,null),i},useId:function(){var t=sc(),e=Dr.identifierPrefix;if(rn){var i=Cu,n=Mu;i=(n&~(1<<32-wl(n)-1)).toString(32)+i,e=":"+e+"R"+i,i=N1++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=hoe++,e=":"+e+"r"+i.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},goe={readContext:za,useCallback:mq,useContext:za,useEffect:SF,useImperativeHandle:pq,useInsertionEffect:hq,useLayoutEffect:dq,useMemo:gq,useReducer:fP,useRef:uq,useState:function(){return fP(k1)},useDebugValue:AF,useDeferredValue:function(t){var e=Ua();return vq(e,or.memoizedState,t)},useTransition:function(){var t=fP(k1)[0],e=Ua().memoizedState;return[t,e]},useMutableSource:nq,useSyncExternalStore:rq,useId:yq,unstable_isNewReconciler:!1},voe={readContext:za,useCallback:mq,useContext:za,useEffect:SF,useImperativeHandle:pq,useInsertionEffect:hq,useLayoutEffect:dq,useMemo:gq,useReducer:pP,useRef:uq,useState:function(){return pP(k1)},useDebugValue:AF,useDeferredValue:function(t){var e=Ua();return or===null?e.memoizedState=t:vq(e,or.memoizedState,t)},useTransition:function(){var t=pP(k1)[0],e=Ua().memoizedState;return[t,e]},useMutableSource:nq,useSyncExternalStore:rq,useId:yq,unstable_isNewReconciler:!1};function Uv(t,e){try{var i="",n=e;do i+=Wre(n),n=n.return;while(n);var r=i}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function mP(t,e,i){return{value:t,source:null,stack:i??null,digest:e??null}}function oL(t,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var yoe=typeof WeakMap=="function"?WeakMap:Map;function bq(t,e,i){i=Ru(-1,i),i.tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){eC||(eC=!0,gL=n),oL(t,e)},i}function Sq(t,e,i){i=Ru(-1,i),i.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;i.payload=function(){return n(r)},i.callback=function(){oL(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){oL(t,e),typeof n!="function"&&(dd===null?dd=new Set([this]):dd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),i}function PG(t,e,i){var n=t.pingCache;if(n===null){n=t.pingCache=new yoe;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(i)||(r.add(i),t=Loe.bind(null,t,e,i),e.then(t,t))}function DG(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function IG(t,e,i,n,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=Ru(-1,1),e.tag=2,hd(i,e,1))),i.lanes|=1),t)}var xoe=$u.ReactCurrentOwner,Zs=!1;function Ms(t,e,i,n){e.child=t===null?tq(e,null,i,n):kv(e,t.child,i,n)}function LG(t,e,i,n,r){i=i.render;var s=e.ref;return hv(e,r),n=wF(t,e,i,n,s,r),i=bF(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wu(t,e,r)):(rn&&i&&cF(e),e.flags|=1,Ms(t,e,n,r),e.child)}function BG(t,e,i,n,r){if(t===null){var s=i.type;return typeof s=="function"&&!LF(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=s,Aq(t,e,s,n,r)):(t=lM(i.type,null,n,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(i=i.compare,i=i!==null?i:I1,i(o,n)&&t.ref===e.ref)return Wu(t,e,r)}return e.flags|=1,t=pd(s,n),t.ref=e.ref,t.return=e,e.child=t}function Aq(t,e,i,n,r){if(t!==null){var s=t.memoizedProps;if(I1(s,n)&&t.ref===e.ref)if(Zs=!1,e.pendingProps=n=s,(t.lanes&r)!==0)t.flags&131072&&(Zs=!0);else return e.lanes=t.lanes,Wu(t,e,r)}return aL(t,e,i,n,r)}function Mq(t,e,i){var n=e.pendingProps,r=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ji(Vg,Eo),Eo|=i;else{if(!(i&1073741824))return t=s!==null?s.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ji(Vg,Eo),Eo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:i,Ji(Vg,Eo),Eo|=n}else s!==null?(n=s.baseLanes|i,e.memoizedState=null):n=i,Ji(Vg,Eo),Eo|=n;return Ms(t,e,r,i),e.child}function Cq(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function aL(t,e,i,n,r){var s=no(i)?Rp:ds.current;return s=Fv(e,s),hv(e,r),i=wF(t,e,i,n,s,r),n=bF(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wu(t,e,r)):(rn&&n&&cF(e),e.flags|=1,Ms(t,e,i,r),e.child)}function RG(t,e,i,n,r){if(no(i)){var s=!0;jM(e)}else s=!1;if(hv(e,r),e.stateNode===null)sM(t,e),$X(e,i,n),sL(e,i,n,r),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=i.contextType;typeof c=="object"&&c!==null?c=za(c):(c=no(i)?Rp:ds.current,c=Fv(e,c));var h=i.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&MG(e,o,n,c),Nh=!1;var d=e.memoizedState;o.state=d,QM(e,n,o,r),l=e.memoizedState,a!==n||d!==l||io.current||Nh?(typeof h=="function"&&(rL(e,i,h,n),l=e.memoizedState),(a=Nh||AG(e,i,a,n,d,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,KX(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:cl(e.type,a),o.props=c,u=e.pendingProps,d=o.context,l=i.contextType,typeof l=="object"&&l!==null?l=za(l):(l=no(i)?Rp:ds.current,l=Fv(e,l));var f=i.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||d!==l)&&MG(e,o,n,l),Nh=!1,d=e.memoizedState,o.state=d,QM(e,n,o,r);var p=e.memoizedState;a!==u||d!==p||io.current||Nh?(typeof f=="function"&&(rL(e,i,f,n),p=e.memoizedState),(c=Nh||AG(e,i,c,n,d,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),o.props=n,o.state=p,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return lL(t,e,i,n,s,r)}function lL(t,e,i,n,r,s){Cq(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return r&&xG(e,i,!1),Wu(t,e,s);n=e.stateNode,xoe.current=e;var a=o&&typeof i.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=kv(e,t.child,null,s),e.child=kv(e,null,a,s)):Ms(t,e,a,s),e.memoizedState=n.state,r&&xG(e,i,!0),e.child}function Eq(t){var e=t.stateNode;e.pendingContext?yG(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yG(t,e.context,!1),vF(t,e.containerInfo)}function OG(t,e,i,n,r){return Nv(),hF(r),e.flags|=256,Ms(t,e,i,n),e.child}var cL={dehydrated:null,treeContext:null,retryLane:0};function uL(t){return{baseLanes:t,cachePool:null,transitions:null}}function Tq(t,e,i){var n=e.pendingProps,r=ln.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Ji(ln,r&1),t===null)return iL(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=RE(o,n,0,null),t=mp(t,n,i,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=uL(i),e.memoizedState=cL,t):MF(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return _oe(t,e,o,n,a,r,i);if(s){s=n.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=pd(r,l),n.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=pd(a,s):(s=mp(s,o,i,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?uL(i):{baseLanes:o.baseLanes|i,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~i,e.memoizedState=cL,n}return s=t.child,t=s.sibling,n=pd(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=i),n.return=e,n.sibling=null,t!==null&&(i=e.deletions,i===null?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=n,e.memoizedState=null,n}function MF(t,e){return e=RE({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fb(t,e,i,n){return n!==null&&hF(n),kv(e,t.child,null,i),t=MF(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _oe(t,e,i,n,r,s,o){if(i)return e.flags&256?(e.flags&=-257,n=mP(Error(Ze(422))),Fb(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=RE({mode:"visible",children:n.children},r,0,null),s=mp(s,r,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&kv(e,t.child,null,o),e.child.memoizedState=uL(o),e.memoizedState=cL,s);if(!(e.mode&1))return Fb(t,e,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Ze(419)),n=mP(s,n,void 0),Fb(t,e,o,n)}if(a=(o&t.childLanes)!==0,Zs||a){if(n=Dr,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,ju(t,r),bl(n,t,r,-1))}return IF(),n=mP(Error(Ze(421))),Fb(t,e,o,n)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Boe.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Lo=ud(r.nextSibling),Uo=e,rn=!0,dl=null,t!==null&&(Sa[Aa++]=Mu,Sa[Aa++]=Cu,Sa[Aa++]=Op,Mu=t.id,Cu=t.overflow,Op=e),e=MF(e,n.children),e.flags|=4096,e)}function FG(t,e,i){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),nL(t.return,e,i)}function gP(t,e,i,n,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function Pq(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(Ms(t,e,n.children,i),n=ln.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&FG(t,i,e);else if(t.tag===19)FG(t,i,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Ji(ln,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;i!==null;)t=i.alternate,t!==null&&JM(t)===null&&(r=i),i=i.sibling;i=r,i===null?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),gP(e,!1,r,i,s);break;case"backwards":for(i=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&JM(t)===null){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}gP(e,!0,i,null,s);break;case"together":gP(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sM(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wu(t,e,i){if(t!==null&&(e.dependencies=t.dependencies),Np|=e.lanes,!(i&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ze(153));if(e.child!==null){for(t=e.child,i=pd(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=pd(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}function woe(t,e,i){switch(e.tag){case 3:Eq(e),Nv();break;case 5:iq(e);break;case 1:no(e.type)&&jM(e);break;case 4:vF(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;Ji(qM,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ji(ln,ln.current&1),e.flags|=128,null):i&e.child.childLanes?Tq(t,e,i):(Ji(ln,ln.current&1),t=Wu(t,e,i),t!==null?t.sibling:null);Ji(ln,ln.current&1);break;case 19:if(n=(i&e.childLanes)!==0,t.flags&128){if(n)return Pq(t,e,i);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ji(ln,ln.current),n)break;return null;case 22:case 23:return e.lanes=0,Mq(t,e,i)}return Wu(t,e,i)}var Dq,hL,Iq,Lq;Dq=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};hL=function(){};Iq=function(t,e,i,n){var r=t.memoizedProps;if(r!==n){t=e.stateNode,$f(_c.current);var s=null;switch(i){case"input":r=BI(t,r),n=BI(t,n),s=[];break;case"select":r=mn({},r,{value:void 0}),n=mn({},n,{value:void 0}),s=[];break;case"textarea":r=FI(t,r),n=FI(t,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=VM)}kI(i,n);var o;i=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(A1.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(i||(i={}),i[o]=l[o])}else i||(s||(s=[]),s.push(c,i)),i=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(A1.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ki("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}i&&(s=s||[]).push("style",i);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Lq=function(t,e,i,n){i!==n&&(e.flags|=4)};function wy(t,e){if(!rn)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,i=0,n=0;if(e)for(var r=t.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function boe(t,e,i){var n=e.pendingProps;switch(uF(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return no(e.type)&&HM(),ts(e),null;case 3:return n=e.stateNode,zv(),en(io),en(ds),xF(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Rb(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,dl!==null&&(xL(dl),dl=null))),hL(t,e),ts(e),null;case 5:yF(e);var r=$f(F1.current);if(i=e.type,t!==null&&e.stateNode!=null)Iq(t,e,i,n,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Ze(166));return ts(e),null}if(t=$f(_c.current),Rb(e)){n=e.stateNode,i=e.type;var s=e.memoizedProps;switch(n[hc]=e,n[R1]=s,t=(e.mode&1)!==0,i){case"dialog":Ki("cancel",n),Ki("close",n);break;case"iframe":case"object":case"embed":Ki("load",n);break;case"video":case"audio":for(r=0;r<Mx.length;r++)Ki(Mx[r],n);break;case"source":Ki("error",n);break;case"img":case"image":case"link":Ki("error",n),Ki("load",n);break;case"details":Ki("toggle",n);break;case"input":W4(n,s),Ki("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ki("invalid",n);break;case"textarea":q4(n,s),Ki("invalid",n)}kI(i,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Bb(n.textContent,a,t),r=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Bb(n.textContent,a,t),r=["children",""+a]):A1.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ki("scroll",n)}switch(i){case"input":Mb(n),X4(n,s,!0);break;case"textarea":Mb(n),Y4(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=VM)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=sX(i)),t==="http://www.w3.org/1999/xhtml"?i==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(i,{is:n.is}):(t=o.createElement(i),i==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,i),t[hc]=e,t[R1]=n,Dq(t,e,!1,!1),e.stateNode=t;e:{switch(o=zI(i,n),i){case"dialog":Ki("cancel",t),Ki("close",t),r=n;break;case"iframe":case"object":case"embed":Ki("load",t),r=n;break;case"video":case"audio":for(r=0;r<Mx.length;r++)Ki(Mx[r],t);r=n;break;case"source":Ki("error",t),r=n;break;case"img":case"image":case"link":Ki("error",t),Ki("load",t),r=n;break;case"details":Ki("toggle",t),r=n;break;case"input":W4(t,n),r=BI(t,n),Ki("invalid",t);break;case"option":r=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},r=mn({},n,{value:void 0}),Ki("invalid",t);break;case"textarea":q4(t,n),r=FI(t,n),Ki("invalid",t);break;default:r=n}kI(i,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?lX(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&oX(t,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&M1(t,l):typeof l=="number"&&M1(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(A1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ki("scroll",t):l!=null&&QO(t,s,l,o))}switch(i){case"input":Mb(t),X4(t,n,!1);break;case"textarea":Mb(t),Y4(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Md(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?av(t,!!n.multiple,s,!1):n.defaultValue!=null&&av(t,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=VM)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)Lq(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Ze(166));if(i=$f(F1.current),$f(_c.current),Rb(e)){if(n=e.stateNode,i=e.memoizedProps,n[hc]=e,(s=n.nodeValue!==i)&&(t=Uo,t!==null))switch(t.tag){case 3:Bb(n.nodeValue,i,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bb(n.nodeValue,i,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),n[hc]=e,e.stateNode=n}return ts(e),null;case 13:if(en(ln),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rn&&Lo!==null&&e.mode&1&&!(e.flags&128))QX(),Nv(),e.flags|=98560,s=!1;else if(s=Rb(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Ze(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ze(317));s[hc]=e}else Nv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),s=!1}else dl!==null&&(xL(dl),dl=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ln.current&1?lr===0&&(lr=3):IF())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return zv(),hL(t,e),t===null&&L1(e.stateNode.containerInfo),ts(e),null;case 10:return pF(e.type._context),ts(e),null;case 17:return no(e.type)&&HM(),ts(e),null;case 19:if(en(ln),s=e.memoizedState,s===null)return ts(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)wy(s,!1);else{if(lr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=JM(t),o!==null){for(e.flags|=128,wy(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=i,i=e.child;i!==null;)s=i,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Ji(ln,ln.current&1|2),e.child}t=t.sibling}s.tail!==null&&Fn()>Gv&&(e.flags|=128,n=!0,wy(s,!1),e.lanes=4194304)}else{if(!n)if(t=JM(o),t!==null){if(e.flags|=128,n=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),wy(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rn)return ts(e),null}else 2*Fn()-s.renderingStartTime>Gv&&i!==1073741824&&(e.flags|=128,n=!0,wy(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(i=s.last,i!==null?i.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Fn(),e.sibling=null,i=ln.current,Ji(ln,n?i&1|2:i&1),e):(ts(e),null);case 22:case 23:return DF(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Eo&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(Ze(156,e.tag))}function Soe(t,e){switch(uF(e),e.tag){case 1:return no(e.type)&&HM(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zv(),en(io),en(ds),xF(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return yF(e),null;case 13:if(en(ln),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ze(340));Nv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return en(ln),null;case 4:return zv(),null;case 10:return pF(e.type._context),null;case 22:case 23:return DF(),null;case 24:return null;default:return null}}var Nb=!1,ss=!1,Aoe=typeof WeakSet=="function"?WeakSet:Set,vt=null;function Gg(t,e){var i=t.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(n){bn(t,e,n)}else i.current=null}function dL(t,e,i){try{i()}catch(n){bn(t,e,n)}}var NG=!1;function Moe(t,e){if(QI=zM,t=FX(),lF(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var o=0,a=-1,l=-1,c=0,h=0,u=t,d=null;t:for(;;){for(var f;u!==i||r!==0&&u.nodeType!==3||(a=o+r),u!==s||n!==0&&u.nodeType!==3||(l=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(f=u.firstChild)!==null;)d=u,u=f;for(;;){if(u===t)break t;if(d===i&&++c===r&&(a=o),d===s&&++h===n&&(l=o),(f=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=f}i=a===-1||l===-1?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(JI={focusedElem:t,selectionRange:i},zM=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){e=vt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:cl(e.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ze(163))}}catch(b){bn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}return p=NG,NG=!1,p}function Xx(t,e,i){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&dL(e,i,s)}r=r.next}while(r!==n)}}function LE(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function fL(t){var e=t.ref;if(e!==null){var i=t.stateNode;switch(t.tag){case 5:t=i;break;default:t=i}typeof e=="function"?e(t):e.current=t}}function Bq(t){var e=t.alternate;e!==null&&(t.alternate=null,Bq(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hc],delete e[R1],delete e[$I],delete e[aoe],delete e[loe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Rq(t){return t.tag===5||t.tag===3||t.tag===4}function kG(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Rq(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pL(t,e,i){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=VM));else if(n!==4&&(t=t.child,t!==null))for(pL(t,e,i),t=t.sibling;t!==null;)pL(t,e,i),t=t.sibling}function mL(t,e,i){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(mL(t,e,i),t=t.sibling;t!==null;)mL(t,e,i),t=t.sibling}var Ur=null,ul=!1;function dh(t,e,i){for(i=i.child;i!==null;)Oq(t,e,i),i=i.sibling}function Oq(t,e,i){if(xc&&typeof xc.onCommitFiberUnmount=="function")try{xc.onCommitFiberUnmount(AE,i)}catch{}switch(i.tag){case 5:ss||Gg(i,e);case 6:var n=Ur,r=ul;Ur=null,dh(t,e,i),Ur=n,ul=r,Ur!==null&&(ul?(t=Ur,i=i.stateNode,t.nodeType===8?t.parentNode.removeChild(i):t.removeChild(i)):Ur.removeChild(i.stateNode));break;case 18:Ur!==null&&(ul?(t=Ur,i=i.stateNode,t.nodeType===8?cP(t.parentNode,i):t.nodeType===1&&cP(t,i),P1(t)):cP(Ur,i.stateNode));break;case 4:n=Ur,r=ul,Ur=i.stateNode.containerInfo,ul=!0,dh(t,e,i),Ur=n,ul=r;break;case 0:case 11:case 14:case 15:if(!ss&&(n=i.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&dL(i,e,o),r=r.next}while(r!==n)}dh(t,e,i);break;case 1:if(!ss&&(Gg(i,e),n=i.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){bn(i,e,a)}dh(t,e,i);break;case 21:dh(t,e,i);break;case 22:i.mode&1?(ss=(n=ss)||i.memoizedState!==null,dh(t,e,i),ss=n):dh(t,e,i);break;default:dh(t,e,i)}}function zG(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new Aoe),e.forEach(function(n){var r=Roe.bind(null,t,n);i.has(n)||(i.add(n),n.then(r,r))})}}function Ka(t,e){var i=e.deletions;if(i!==null)for(var n=0;n<i.length;n++){var r=i[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ur=a.stateNode,ul=!1;break e;case 3:Ur=a.stateNode.containerInfo,ul=!0;break e;case 4:Ur=a.stateNode.containerInfo,ul=!0;break e}a=a.return}if(Ur===null)throw Error(Ze(160));Oq(s,o,r),Ur=null,ul=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){bn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Fq(e,t),e=e.sibling}function Fq(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ka(e,t),Wl(t),n&4){try{Xx(3,t,t.return),LE(3,t)}catch(m){bn(t,t.return,m)}try{Xx(5,t,t.return)}catch(m){bn(t,t.return,m)}}break;case 1:Ka(e,t),Wl(t),n&512&&i!==null&&Gg(i,i.return);break;case 5:if(Ka(e,t),Wl(t),n&512&&i!==null&&Gg(i,i.return),t.flags&32){var r=t.stateNode;try{M1(r,"")}catch(m){bn(t,t.return,m)}}if(n&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=i!==null?i.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&nX(r,s),zI(a,o);var c=zI(a,s);for(o=0;o<l.length;o+=2){var h=l[o],u=l[o+1];h==="style"?lX(r,u):h==="dangerouslySetInnerHTML"?oX(r,u):h==="children"?M1(r,u):QO(r,h,u,c)}switch(a){case"input":RI(r,s);break;case"textarea":rX(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?av(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?av(r,!!s.multiple,s.defaultValue,!0):av(r,!!s.multiple,s.multiple?[]:"",!1))}r[R1]=s}catch(m){bn(t,t.return,m)}}break;case 6:if(Ka(e,t),Wl(t),n&4){if(t.stateNode===null)throw Error(Ze(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(m){bn(t,t.return,m)}}break;case 3:if(Ka(e,t),Wl(t),n&4&&i!==null&&i.memoizedState.isDehydrated)try{P1(e.containerInfo)}catch(m){bn(t,t.return,m)}break;case 4:Ka(e,t),Wl(t);break;case 13:Ka(e,t),Wl(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(TF=Fn())),n&4&&zG(t);break;case 22:if(h=i!==null&&i.memoizedState!==null,t.mode&1?(ss=(c=ss)||h,Ka(e,t),ss=c):Ka(e,t),Wl(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(vt=t,h=t.child;h!==null;){for(u=vt=h;vt!==null;){switch(d=vt,f=d.child,d.tag){case 0:case 11:case 14:case 15:Xx(4,d,d.return);break;case 1:Gg(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,i=d.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){bn(n,i,m)}}break;case 5:Gg(d,d.return);break;case 22:if(d.memoizedState!==null){GG(u);continue}}f!==null?(f.return=d,vt=f):GG(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=aX("display",o))}catch(m){bn(t,t.return,m)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(m){bn(t,t.return,m)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Ka(e,t),Wl(t),n&4&&zG(t);break;case 21:break;default:Ka(e,t),Wl(t)}}function Wl(t){var e=t.flags;if(e&2){try{e:{for(var i=t.return;i!==null;){if(Rq(i)){var n=i;break e}i=i.return}throw Error(Ze(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(M1(r,""),n.flags&=-33);var s=kG(t);mL(t,s,r);break;case 3:case 4:var o=n.stateNode.containerInfo,a=kG(t);pL(t,a,o);break;default:throw Error(Ze(161))}}catch(l){bn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Coe(t,e,i){vt=t,Nq(t)}function Nq(t,e,i){for(var n=(t.mode&1)!==0;vt!==null;){var r=vt,s=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Nb;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||ss;a=Nb;var c=ss;if(Nb=o,(ss=l)&&!c)for(vt=r;vt!==null;)o=vt,l=o.child,o.tag===22&&o.memoizedState!==null?VG(r):l!==null?(l.return=o,vt=l):VG(r);for(;s!==null;)vt=s,Nq(s),s=s.sibling;vt=r,Nb=a,ss=c}UG(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,vt=s):UG(t)}}function UG(t){for(;vt!==null;){var e=vt;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ss||LE(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ss)if(i===null)n.componentDidMount();else{var r=e.elementType===e.type?i.memoizedProps:cl(e.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&SG(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}SG(e,o,i)}break;case 5:var a=e.stateNode;if(i===null&&e.flags&4){i=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&P1(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ze(163))}ss||e.flags&512&&fL(e)}catch(d){bn(e,e.return,d)}}if(e===t){vt=null;break}if(i=e.sibling,i!==null){i.return=e.return,vt=i;break}vt=e.return}}function GG(t){for(;vt!==null;){var e=vt;if(e===t){vt=null;break}var i=e.sibling;if(i!==null){i.return=e.return,vt=i;break}vt=e.return}}function VG(t){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{LE(4,e)}catch(l){bn(e,i,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){bn(e,r,l)}}var s=e.return;try{fL(e)}catch(l){bn(e,s,l)}break;case 5:var o=e.return;try{fL(e)}catch(l){bn(e,o,l)}}}catch(l){bn(e,e.return,l)}if(e===t){vt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,vt=a;break}vt=e.return}}var Eoe=Math.ceil,$M=$u.ReactCurrentDispatcher,CF=$u.ReactCurrentOwner,Ba=$u.ReactCurrentBatchConfig,yi=0,Dr=null,Jn=null,Wr=0,Eo=0,Vg=Gd(0),lr=0,U1=null,Np=0,BE=0,EF=0,qx=null,Ws=null,TF=0,Gv=1/0,pu=null,eC=!1,gL=null,dd=null,kb=!1,Yh=null,tC=0,Yx=0,vL=null,oM=-1,aM=0;function Is(){return yi&6?Fn():oM!==-1?oM:oM=Fn()}function fd(t){return t.mode&1?yi&2&&Wr!==0?Wr&-Wr:uoe.transition!==null?(aM===0&&(aM=_X()),aM):(t=Bi,t!==0||(t=window.event,t=t===void 0?16:EX(t.type)),t):1}function bl(t,e,i,n){if(50<Yx)throw Yx=0,vL=null,Error(Ze(185));L_(t,i,n),(!(yi&2)||t!==Dr)&&(t===Dr&&(!(yi&2)&&(BE|=i),lr===4&&Hh(t,Wr)),ro(t,n),i===1&&yi===0&&!(e.mode&1)&&(Gv=Fn()+500,PE&&Vd()))}function ro(t,e){var i=t.callbackNode;use(t,e);var n=kM(t,t===Dr?Wr:0);if(n===0)i!==null&&K4(i),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(i!=null&&K4(i),e===1)t.tag===0?coe(HG.bind(null,t)):XX(HG.bind(null,t)),soe(function(){!(yi&6)&&Vd()}),i=null;else{switch(wX(n)){case 1:i=eF;break;case 4:i=yX;break;case 16:i=NM;break;case 536870912:i=xX;break;default:i=NM}i=Wq(i,kq.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function kq(t,e){if(oM=-1,aM=0,yi&6)throw Error(Ze(327));var i=t.callbackNode;if(dv()&&t.callbackNode!==i)return null;var n=kM(t,t===Dr?Wr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=iC(t,n);else{e=n;var r=yi;yi|=2;var s=Uq();(Dr!==t||Wr!==e)&&(pu=null,Gv=Fn()+500,pp(t,e));do try{Doe();break}catch(a){zq(t,a)}while(1);fF(),$M.current=s,yi=r,Jn!==null?e=0:(Dr=null,Wr=0,e=lr)}if(e!==0){if(e===2&&(r=jI(t),r!==0&&(n=r,e=yL(t,r))),e===1)throw i=U1,pp(t,0),Hh(t,n),ro(t,Fn()),i;if(e===6)Hh(t,n);else{if(r=t.current.alternate,!(n&30)&&!Toe(r)&&(e=iC(t,n),e===2&&(s=jI(t),s!==0&&(n=s,e=yL(t,s))),e===1))throw i=U1,pp(t,0),Hh(t,n),ro(t,Fn()),i;switch(t.finishedWork=r,t.finishedLanes=n,e){case 0:case 1:throw Error(Ze(345));case 2:Bf(t,Ws,pu);break;case 3:if(Hh(t,n),(n&130023424)===n&&(e=TF+500-Fn(),10<e)){if(kM(t,0)!==0)break;if(r=t.suspendedLanes,(r&n)!==n){Is(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ZI(Bf.bind(null,t,Ws,pu),e);break}Bf(t,Ws,pu);break;case 4:if(Hh(t,n),(n&4194240)===n)break;for(e=t.eventTimes,r=-1;0<n;){var o=31-wl(n);s=1<<o,o=e[o],o>r&&(r=o),n&=~s}if(n=r,n=Fn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Eoe(n/1960))-n,10<n){t.timeoutHandle=ZI(Bf.bind(null,t,Ws,pu),n);break}Bf(t,Ws,pu);break;case 5:Bf(t,Ws,pu);break;default:throw Error(Ze(329))}}}return ro(t,Fn()),t.callbackNode===i?kq.bind(null,t):null}function yL(t,e){var i=qx;return t.current.memoizedState.isDehydrated&&(pp(t,e).flags|=256),t=iC(t,e),t!==2&&(e=Ws,Ws=i,e!==null&&xL(e)),t}function xL(t){Ws===null?Ws=t:Ws.push.apply(Ws,t)}function Toe(t){for(var e=t;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!El(s(),r))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hh(t,e){for(e&=~EF,e&=~BE,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-wl(e),n=1<<i;t[i]=-1,e&=~n}}function HG(t){if(yi&6)throw Error(Ze(327));dv();var e=kM(t,0);if(!(e&1))return ro(t,Fn()),null;var i=iC(t,e);if(t.tag!==0&&i===2){var n=jI(t);n!==0&&(e=n,i=yL(t,n))}if(i===1)throw i=U1,pp(t,0),Hh(t,e),ro(t,Fn()),i;if(i===6)throw Error(Ze(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Bf(t,Ws,pu),ro(t,Fn()),null}function PF(t,e){var i=yi;yi|=1;try{return t(e)}finally{yi=i,yi===0&&(Gv=Fn()+500,PE&&Vd())}}function kp(t){Yh!==null&&Yh.tag===0&&!(yi&6)&&dv();var e=yi;yi|=1;var i=Ba.transition,n=Bi;try{if(Ba.transition=null,Bi=1,t)return t()}finally{Bi=n,Ba.transition=i,yi=e,!(yi&6)&&Vd()}}function DF(){Eo=Vg.current,en(Vg)}function pp(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,roe(i)),Jn!==null)for(i=Jn.return;i!==null;){var n=i;switch(uF(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&HM();break;case 3:zv(),en(io),en(ds),xF();break;case 5:yF(n);break;case 4:zv();break;case 13:en(ln);break;case 19:en(ln);break;case 10:pF(n.type._context);break;case 22:case 23:DF()}i=i.return}if(Dr=t,Jn=t=pd(t.current,null),Wr=Eo=e,lr=0,U1=null,EF=BE=Np=0,Ws=qx=null,Zf!==null){for(e=0;e<Zf.length;e++)if(i=Zf[e],n=i.interleaved,n!==null){i.interleaved=null;var r=n.next,s=i.pending;if(s!==null){var o=s.next;s.next=r,n.next=o}i.pending=n}Zf=null}return t}function zq(t,e){do{var i=Jn;try{if(fF(),nM.current=ZM,KM){for(var n=pn.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}KM=!1}if(Fp=0,Cr=or=pn=null,Wx=!1,N1=0,CF.current=null,i===null||i.return===null){lr=1,U1=e,Jn=null;break}e:{var s=t,o=i.return,a=i,l=e;if(e=Wr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=DG(o);if(f!==null){f.flags&=-257,IG(f,o,a,s,e),f.mode&1&&PG(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){PG(s,c,e),IF();break e}l=Error(Ze(426))}}else if(rn&&a.mode&1){var g=DG(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),IG(g,o,a,s,e),hF(Uv(l,a));break e}}s=l=Uv(l,a),lr!==4&&(lr=2),qx===null?qx=[s]:qx.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=bq(s,l,e);bG(s,v);break e;case 1:a=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(dd===null||!dd.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=Sq(s,a,e);bG(s,b);break e}}s=s.return}while(s!==null)}Vq(i)}catch(S){e=S,Jn===i&&i!==null&&(Jn=i=i.return);continue}break}while(1)}function Uq(){var t=$M.current;return $M.current=ZM,t===null?ZM:t}function IF(){(lr===0||lr===3||lr===2)&&(lr=4),Dr===null||!(Np&268435455)&&!(BE&268435455)||Hh(Dr,Wr)}function iC(t,e){var i=yi;yi|=2;var n=Uq();(Dr!==t||Wr!==e)&&(pu=null,pp(t,e));do try{Poe();break}catch(r){zq(t,r)}while(1);if(fF(),yi=i,$M.current=n,Jn!==null)throw Error(Ze(261));return Dr=null,Wr=0,lr}function Poe(){for(;Jn!==null;)Gq(Jn)}function Doe(){for(;Jn!==null&&!tse();)Gq(Jn)}function Gq(t){var e=jq(t.alternate,t,Eo);t.memoizedProps=t.pendingProps,e===null?Vq(t):Jn=e,CF.current=null}function Vq(t){var e=t;do{var i=e.alternate;if(t=e.return,e.flags&32768){if(i=Soe(i,e),i!==null){i.flags&=32767,Jn=i;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lr=6,Jn=null;return}}else if(i=boe(i,e,Eo),i!==null){Jn=i;return}if(e=e.sibling,e!==null){Jn=e;return}Jn=e=t}while(e!==null);lr===0&&(lr=5)}function Bf(t,e,i){var n=Bi,r=Ba.transition;try{Ba.transition=null,Bi=1,Ioe(t,e,i,n)}finally{Ba.transition=r,Bi=n}return null}function Ioe(t,e,i,n){do dv();while(Yh!==null);if(yi&6)throw Error(Ze(327));i=t.finishedWork;var r=t.finishedLanes;if(i===null)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(Ze(177));t.callbackNode=null,t.callbackPriority=0;var s=i.lanes|i.childLanes;if(hse(t,s),t===Dr&&(Jn=Dr=null,Wr=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||kb||(kb=!0,Wq(NM,function(){return dv(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=Ba.transition,Ba.transition=null;var o=Bi;Bi=1;var a=yi;yi|=4,CF.current=null,Moe(t,i),Fq(i,t),Kse(JI),zM=!!QI,JI=QI=null,t.current=i,Coe(i),ise(),yi=a,Bi=o,Ba.transition=s}else t.current=i;if(kb&&(kb=!1,Yh=t,tC=r),s=t.pendingLanes,s===0&&(dd=null),sse(i.stateNode),ro(t,Fn()),e!==null)for(n=t.onRecoverableError,i=0;i<e.length;i++)r=e[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(eC)throw eC=!1,t=gL,gL=null,t;return tC&1&&t.tag!==0&&dv(),s=t.pendingLanes,s&1?t===vL?Yx++:(Yx=0,vL=t):Yx=0,Vd(),null}function dv(){if(Yh!==null){var t=wX(tC),e=Ba.transition,i=Bi;try{if(Ba.transition=null,Bi=16>t?16:t,Yh===null)var n=!1;else{if(t=Yh,Yh=null,tC=0,yi&6)throw Error(Ze(331));var r=yi;for(yi|=4,vt=t.current;vt!==null;){var s=vt,o=s.child;if(vt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(vt=c;vt!==null;){var h=vt;switch(h.tag){case 0:case 11:case 15:Xx(8,h,s)}var u=h.child;if(u!==null)u.return=h,vt=u;else for(;vt!==null;){h=vt;var d=h.sibling,f=h.return;if(Bq(h),h===c){vt=null;break}if(d!==null){d.return=f,vt=d;break}vt=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}vt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,vt=o;else e:for(;vt!==null;){if(s=vt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xx(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,vt=v;break e}vt=s.return}}var y=t.current;for(vt=y;vt!==null;){o=vt;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,vt=x;else e:for(o=y;vt!==null;){if(a=vt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:LE(9,a)}}catch(S){bn(a,a.return,S)}if(a===o){vt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,vt=b;break e}vt=a.return}}if(yi=r,Vd(),xc&&typeof xc.onPostCommitFiberRoot=="function")try{xc.onPostCommitFiberRoot(AE,t)}catch{}n=!0}return n}finally{Bi=i,Ba.transition=e}}return!1}function jG(t,e,i){e=Uv(i,e),e=bq(t,e,1),t=hd(t,e,1),e=Is(),t!==null&&(L_(t,1,e),ro(t,e))}function bn(t,e,i){if(t.tag===3)jG(t,t,i);else for(;e!==null;){if(e.tag===3){jG(e,t,i);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(dd===null||!dd.has(n))){t=Uv(i,t),t=Sq(e,t,1),e=hd(e,t,1),t=Is(),e!==null&&(L_(e,1,t),ro(e,t));break}}e=e.return}}function Loe(t,e,i){var n=t.pingCache;n!==null&&n.delete(e),e=Is(),t.pingedLanes|=t.suspendedLanes&i,Dr===t&&(Wr&i)===i&&(lr===4||lr===3&&(Wr&130023424)===Wr&&500>Fn()-TF?pp(t,0):EF|=i),ro(t,e)}function Hq(t,e){e===0&&(t.mode&1?(e=Tb,Tb<<=1,!(Tb&130023424)&&(Tb=4194304)):e=1);var i=Is();t=ju(t,e),t!==null&&(L_(t,e,i),ro(t,i))}function Boe(t){var e=t.memoizedState,i=0;e!==null&&(i=e.retryLane),Hq(t,i)}function Roe(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,r=t.memoizedState;r!==null&&(i=r.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ze(314))}n!==null&&n.delete(e),Hq(t,i)}var jq;jq=function(t,e,i){if(t!==null)if(t.memoizedProps!==e.pendingProps||io.current)Zs=!0;else{if(!(t.lanes&i)&&!(e.flags&128))return Zs=!1,woe(t,e,i);Zs=!!(t.flags&131072)}else Zs=!1,rn&&e.flags&1048576&&qX(e,XM,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;sM(t,e),t=e.pendingProps;var r=Fv(e,ds.current);hv(e,i),r=wF(null,e,n,t,r,i);var s=bF();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,no(n)?(s=!0,jM(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,gF(e),r.updater=DE,e.stateNode=r,r._reactInternals=e,sL(e,n,t,i),e=lL(null,e,n,!0,s,i)):(e.tag=0,rn&&s&&cF(e),Ms(null,e,r,i),e=e.child),e;case 16:n=e.elementType;e:{switch(sM(t,e),t=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=Foe(n),t=cl(n,t),r){case 0:e=aL(null,e,n,t,i);break e;case 1:e=RG(null,e,n,t,i);break e;case 11:e=LG(null,e,n,t,i);break e;case 14:e=BG(null,e,n,cl(n.type,t),i);break e}throw Error(Ze(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:cl(n,r),aL(t,e,n,r,i);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:cl(n,r),RG(t,e,n,r,i);case 3:e:{if(Eq(e),t===null)throw Error(Ze(387));n=e.pendingProps,s=e.memoizedState,r=s.element,KX(t,e),QM(e,n,null,i);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Uv(Error(Ze(423)),e),e=OG(t,e,n,i,r);break e}else if(n!==r){r=Uv(Error(Ze(424)),e),e=OG(t,e,n,i,r);break e}else for(Lo=ud(e.stateNode.containerInfo.firstChild),Uo=e,rn=!0,dl=null,i=tq(e,null,n,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Nv(),n===r){e=Wu(t,e,i);break e}Ms(t,e,n,i)}e=e.child}return e;case 5:return iq(e),t===null&&iL(e),n=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,KI(n,r)?o=null:s!==null&&KI(n,s)&&(e.flags|=32),Cq(t,e),Ms(t,e,o,i),e.child;case 6:return t===null&&iL(e),null;case 13:return Tq(t,e,i);case 4:return vF(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=kv(e,null,n,i):Ms(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:cl(n,r),LG(t,e,n,r,i);case 7:return Ms(t,e,e.pendingProps,i),e.child;case 8:return Ms(t,e,e.pendingProps.children,i),e.child;case 12:return Ms(t,e,e.pendingProps.children,i),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Ji(qM,n._currentValue),n._currentValue=o,s!==null)if(El(s.value,o)){if(s.children===r.children&&!io.current){e=Wu(t,e,i);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ru(-1,i&-i),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),nL(s.return,i,e),a.lanes|=i;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ze(341));o.lanes|=i,a=o.alternate,a!==null&&(a.lanes|=i),nL(o,i,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ms(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,hv(e,i),r=za(r),n=n(r),e.flags|=1,Ms(t,e,n,i),e.child;case 14:return n=e.type,r=cl(n,e.pendingProps),r=cl(n.type,r),BG(t,e,n,r,i);case 15:return Aq(t,e,e.type,e.pendingProps,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:cl(n,r),sM(t,e),e.tag=1,no(n)?(t=!0,jM(e)):t=!1,hv(e,i),$X(e,n,r),sL(e,n,r,i),lL(null,e,n,!0,t,i);case 19:return Pq(t,e,i);case 22:return Mq(t,e,i)}throw Error(Ze(156,e.tag))};function Wq(t,e){return vX(t,e)}function Ooe(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pa(t,e,i,n){return new Ooe(t,e,i,n)}function LF(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Foe(t){if(typeof t=="function")return LF(t)?1:0;if(t!=null){if(t=t.$$typeof,t===KO)return 11;if(t===ZO)return 14}return 2}function pd(t,e){var i=t.alternate;return i===null?(i=Pa(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&14680064,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function lM(t,e,i,n,r,s){var o=2;if(n=t,typeof t=="function")LF(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Lg:return mp(i.children,r,s,e);case JO:o=8,r|=8;break;case PI:return t=Pa(12,i,e,r|2),t.elementType=PI,t.lanes=s,t;case DI:return t=Pa(13,i,e,r),t.elementType=DI,t.lanes=s,t;case II:return t=Pa(19,i,e,r),t.elementType=II,t.lanes=s,t;case eX:return RE(i,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Z7:o=10;break e;case $7:o=9;break e;case KO:o=11;break e;case ZO:o=14;break e;case Fh:o=16,n=null;break e}throw Error(Ze(130,t==null?t:typeof t,""))}return e=Pa(o,i,e,r),e.elementType=t,e.type=n,e.lanes=s,e}function mp(t,e,i,n){return t=Pa(7,t,n,e),t.lanes=i,t}function RE(t,e,i,n){return t=Pa(22,t,n,e),t.elementType=eX,t.lanes=i,t.stateNode={isHidden:!1},t}function vP(t,e,i){return t=Pa(6,t,null,e),t.lanes=i,t}function yP(t,e,i){return e=Pa(4,t.children!==null?t.children:[],t.key,e),e.lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Noe(t,e,i,n,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Z2(0),this.expirationTimes=Z2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Z2(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function BF(t,e,i,n,r,s,o,a,l){return t=new Noe(t,e,i,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Pa(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},gF(s),t}function koe(t,e,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ig,key:n==null?null:""+n,children:t,containerInfo:e,implementation:i}}function Xq(t){if(!t)return Cd;t=t._reactInternals;e:{if(Zp(t)!==t||t.tag!==1)throw Error(Ze(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(no(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ze(171))}if(t.tag===1){var i=t.type;if(no(i))return WX(t,i,e)}return e}function qq(t,e,i,n,r,s,o,a,l){return t=BF(i,n,!0,t,r,s,o,a,l),t.context=Xq(null),i=t.current,n=Is(),r=fd(i),s=Ru(n,r),s.callback=e??null,hd(i,s,r),t.current.lanes=r,L_(t,r,n),ro(t,n),t}function OE(t,e,i,n){var r=e.current,s=Is(),o=fd(r);return i=Xq(i),e.context===null?e.context=i:e.pendingContext=i,e=Ru(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=hd(r,e,o),t!==null&&(bl(t,r,o,s),iM(t,r,o)),o}function nC(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function WG(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<e?i:e}}function RF(t,e){WG(t,e),(t=t.alternate)&&WG(t,e)}function zoe(){return null}var Yq=typeof reportError=="function"?reportError:function(t){console.error(t)};function OF(t){this._internalRoot=t}FE.prototype.render=OF.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ze(409));OE(t,e,null,null)};FE.prototype.unmount=OF.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;kp(function(){OE(null,t,null,null)}),e[Hu]=null}};function FE(t){this._internalRoot=t}FE.prototype.unstable_scheduleHydration=function(t){if(t){var e=AX();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Vh.length&&e!==0&&e<Vh[i].priority;i++);Vh.splice(i,0,t),i===0&&CX(t)}};function FF(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function NE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function XG(){}function Uoe(t,e,i,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var c=nC(o);s.call(c)}}var o=qq(e,n,t,0,null,!1,!1,"",XG);return t._reactRootContainer=o,t[Hu]=o.current,L1(t.nodeType===8?t.parentNode:t),kp(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof n=="function"){var a=n;n=function(){var c=nC(l);a.call(c)}}var l=BF(t,0,!1,null,null,!1,!1,"",XG);return t._reactRootContainer=l,t[Hu]=l.current,L1(t.nodeType===8?t.parentNode:t),kp(function(){OE(e,l,i,n)}),l}function kE(t,e,i,n,r){var s=i._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=nC(o);a.call(l)}}OE(e,o,t,r)}else o=Uoe(i,e,t,r,n);return nC(o)}bX=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=Ax(e.pendingLanes);i!==0&&(tF(e,i|1),ro(e,Fn()),!(yi&6)&&(Gv=Fn()+500,Vd()))}break;case 13:kp(function(){var n=ju(t,1);if(n!==null){var r=Is();bl(n,t,1,r)}}),RF(t,1)}};iF=function(t){if(t.tag===13){var e=ju(t,134217728);if(e!==null){var i=Is();bl(e,t,134217728,i)}RF(t,134217728)}};SX=function(t){if(t.tag===13){var e=fd(t),i=ju(t,e);if(i!==null){var n=Is();bl(i,t,e,n)}RF(t,e)}};AX=function(){return Bi};MX=function(t,e){var i=Bi;try{return Bi=t,e()}finally{Bi=i}};GI=function(t,e,i){switch(e){case"input":if(RI(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=TE(n);if(!r)throw Error(Ze(90));iX(n),RI(n,r)}}}break;case"textarea":rX(t,i);break;case"select":e=i.value,e!=null&&av(t,!!i.multiple,e,!1)}};hX=PF;dX=kp;var Goe={usingClientEntryPoint:!1,Events:[R_,Fg,TE,cX,uX,PF]},by={findFiberByHostInstance:Kf,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Voe={bundleType:by.bundleType,version:by.version,rendererPackageName:by.rendererPackageName,rendererConfig:by.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$u.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=mX(t),t===null?null:t.stateNode},findFiberByHostInstance:by.findFiberByHostInstance||zoe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zb.isDisabled&&zb.supportsFiber)try{AE=zb.inject(Voe),xc=zb}catch{}}Qo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Goe;Qo.createPortal=function(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!FF(e))throw Error(Ze(200));return koe(t,e,null,i)};Qo.createRoot=function(t,e){if(!FF(t))throw Error(Ze(299));var i=!1,n="",r=Yq;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=BF(t,1,!1,null,null,i,!1,n,r),t[Hu]=e.current,L1(t.nodeType===8?t.parentNode:t),new OF(e)};Qo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ze(188)):(t=Object.keys(t).join(","),Error(Ze(268,t)));return t=mX(e),t=t===null?null:t.stateNode,t};Qo.flushSync=function(t){return kp(t)};Qo.hydrate=function(t,e,i){if(!NE(e))throw Error(Ze(200));return kE(null,t,e,!0,i)};Qo.hydrateRoot=function(t,e,i){if(!FF(t))throw Error(Ze(405));var n=i!=null&&i.hydratedSources||null,r=!1,s="",o=Yq;if(i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),e=qq(e,null,t,1,i??null,r,!1,s,o),t[Hu]=e.current,L1(t),n)for(t=0;t<n.length;t++)i=n[t],r=i._getVersion,r=r(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,r]:e.mutableSourceEagerHydrationData.push(i,r);return new FE(e)};Qo.render=function(t,e,i){if(!NE(e))throw Error(Ze(200));return kE(null,t,e,!1,i)};Qo.unmountComponentAtNode=function(t){if(!NE(t))throw Error(Ze(40));return t._reactRootContainer?(kp(function(){kE(null,null,t,!1,function(){t._reactRootContainer=null,t[Hu]=null})}),!0):!1};Qo.unstable_batchedUpdates=PF;Qo.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!NE(i))throw Error(Ze(200));if(t==null||t._reactInternals===void 0)throw Error(Ze(38));return kE(t,e,i,!1,n)};Qo.version="18.2.0-next-9e3b772b8-20220608";function Qq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Qq)}catch(t){console.error(t)}}Qq(),q7.exports=Qo;var Hoe=q7.exports,Jq,qG=Hoe;Jq=EI.createRoot=qG.createRoot,EI.hydrateRoot=qG.hydrateRoot;/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function G1(){return G1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},G1.apply(this,arguments)}var ep;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ep||(ep={}));const YG="popstate";function joe(t){t===void 0&&(t={});function e(n,r){let{pathname:s,search:o,hash:a}=n.location;return _L("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function i(n,r){return typeof r=="string"?r:rC(r)}return Xoe(e,i,null,t)}function Sl(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Woe(){return Math.random().toString(36).substr(2,8)}function QG(t,e){return{usr:t.state,key:t.key,idx:e}}function _L(t,e,i,n){return i===void 0&&(i=null),G1({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?zE(e):e,{state:i,key:e&&e.key||n||Woe()})}function rC(t){let{pathname:e="/",search:i="",hash:n=""}=t;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function zE(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Xoe(t,e,i,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:s=!1}=n,o=r.history,a=ep.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(G1({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function u(){a=ep.Pop;let g=h(),v=g==null?null:g-c;c=g,l&&l({action:a,location:m.location,delta:v})}function d(g,v){a=ep.Push;let y=_L(m.location,g,v);i&&i(y,g),c=h()+1;let x=QG(y,c),b=m.createHref(y);try{o.pushState(x,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;r.location.assign(b)}s&&l&&l({action:a,location:m.location,delta:1})}function f(g,v){a=ep.Replace;let y=_L(m.location,g,v);i&&i(y,g),c=h();let x=QG(y,c),b=m.createHref(y);o.replaceState(x,"",b),s&&l&&l({action:a,location:m.location,delta:0})}function p(g){let v=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof g=="string"?g:rC(g);return Sl(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return a},get location(){return t(r,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(YG,u),l=g,()=>{r.removeEventListener(YG,u),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(g){return o.go(g)}};return m}var JG;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(JG||(JG={}));function Kq(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,n=t.charAt(i);return n&&n!=="/"?null:t.slice(i)||"/"}function qoe(t,e){e===void 0&&(e="/");let{pathname:i,search:n="",hash:r=""}=typeof t=="string"?zE(t):t;return{pathname:i?i.startsWith("/")?i:Yoe(i,e):e,search:Qoe(n),hash:Joe(r)}}function Yoe(t,e){let i=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?i.length>1&&i.pop():r!=="."&&i.push(r)}),i.length>1?i.join("/"):"/"}function xP(t,e,i,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Zq(t){return t.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function $q(t,e,i,n){n===void 0&&(n=!1);let r;typeof t=="string"?r=zE(t):(r=G1({},t),Sl(!r.pathname||!r.pathname.includes("?"),xP("?","pathname","search",r)),Sl(!r.pathname||!r.pathname.includes("#"),xP("#","pathname","hash",r)),Sl(!r.search||!r.search.includes("#"),xP("#","search","hash",r)));let s=t===""||r.pathname==="",o=s?"/":r.pathname,a;if(n||o==null)a=i;else{let u=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;r.pathname=d.join("/")}a=u>=0?e[u]:"/"}let l=qoe(r,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&i.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const eY=t=>t.join("/").replace(/\/\/+/g,"/"),Qoe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Joe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,tY=["post","put","patch","delete"];new Set(tY);const Koe=["get",...tY];new Set(Koe);/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wL(){return wL=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},wL.apply(this,arguments)}const iY=me.createContext(null),F_=me.createContext(null),NF=me.createContext(null),UE=me.createContext({outlet:null,matches:[],isDataRoute:!1});function Zoe(t,e){let{relative:i}=e===void 0?{}:e;GE()||Sl(!1);let{basename:n,navigator:r}=me.useContext(F_),{hash:s,pathname:o,search:a}=rY(t,{relative:i}),l=o;return n!=="/"&&(l=o==="/"?n:eY([n,o])),r.createHref({pathname:l,search:a,hash:s})}function GE(){return me.useContext(NF)!=null}function kF(){return GE()||Sl(!1),me.useContext(NF).location}function nY(t){me.useContext(F_).static||me.useLayoutEffect(t)}function $oe(){let{isDataRoute:t}=me.useContext(UE);return t?rae():eae()}function eae(){GE()||Sl(!1);let t=me.useContext(iY),{basename:e,navigator:i}=me.useContext(F_),{matches:n}=me.useContext(UE),{pathname:r}=kF(),s=JSON.stringify(Zq(n).map(l=>l.pathnameBase)),o=me.useRef(!1);return nY(()=>{o.current=!0}),me.useCallback(function(l,c){if(c===void 0&&(c={}),!o.current)return;if(typeof l=="number"){i.go(l);return}let h=$q(l,JSON.parse(s),r,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:eY([e,h.pathname])),(c.replace?i.replace:i.push)(h,c.state,c)},[e,i,s,r,t])}function rY(t,e){let{relative:i}=e===void 0?{}:e,{matches:n}=me.useContext(UE),{pathname:r}=kF(),s=JSON.stringify(Zq(n).map(o=>o.pathnameBase));return me.useMemo(()=>$q(t,JSON.parse(s),r,i==="path"),[t,s,r,i])}var bL;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(bL||(bL={}));var SL;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(SL||(SL={}));function tae(t){let e=me.useContext(iY);return e||Sl(!1),e}function iae(t){let e=me.useContext(UE);return e||Sl(!1),e}function nae(t){let e=iae(),i=e.matches[e.matches.length-1];return i.route.id||Sl(!1),i.route.id}function rae(){let{router:t}=tae(bL.UseNavigateStable),e=nae(SL.UseNavigateStable),i=me.useRef(!1);return nY(()=>{i.current=!0}),me.useCallback(function(r,s){s===void 0&&(s={}),i.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,wL({fromRouteId:e},s)))},[t,e])}function sae(t){let{basename:e="/",children:i=null,location:n,navigationType:r=ep.Pop,navigator:s,static:o=!1}=t;GE()&&Sl(!1);let a=e.replace(/^\/*/,"/"),l=me.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof n=="string"&&(n=zE(n));let{pathname:c="/",search:h="",hash:u="",state:d=null,key:f="default"}=n,p=me.useMemo(()=>{let m=Kq(c,a);return m==null?null:{location:{pathname:m,search:h,hash:u,state:d,key:f},navigationType:r}},[a,c,h,u,d,f,r]);return p==null?null:me.createElement(F_.Provider,{value:l},me.createElement(NF.Provider,{children:i,value:p}))}var KG;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(KG||(KG={}));new Promise(()=>{});/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function AL(){return AL=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},AL.apply(this,arguments)}function oae(t,e){if(t==null)return{};var i={},n=Object.keys(t),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(i[r]=t[r]);return i}function aae(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function lae(t,e){return t.button===0&&(!e||e==="_self")&&!aae(t)}const cae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],uae="startTransition",ZG=Bre[uae];function hae(t){let{basename:e,children:i,future:n,window:r}=t,s=me.useRef();s.current==null&&(s.current=joe({window:r,v5Compat:!0}));let o=s.current,[a,l]=me.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},h=me.useCallback(u=>{c&&ZG?ZG(()=>l(u)):l(u)},[l,c]);return me.useLayoutEffect(()=>o.listen(h),[o,h]),me.createElement(sae,{basename:e,children:i,location:a.location,navigationType:a.action,navigator:o})}const dae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fae=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pae=me.forwardRef(function(e,i){let{onClick:n,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h}=e,u=oae(e,cae),{basename:d}=me.useContext(F_),f,p=!1;if(typeof c=="string"&&fae.test(c)&&(f=c,dae))try{let y=new URL(window.location.href),x=c.startsWith("//")?new URL(y.protocol+c):new URL(c),b=Kq(x.pathname,d);x.origin===y.origin&&b!=null?c=b+x.search+x.hash:p=!0}catch{}let m=Zoe(c,{relative:r}),g=mae(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:r});function v(y){n&&n(y),y.defaultPrevented||g(y)}return me.createElement("a",AL({},u,{href:f||m,onClick:p||s?n:v,ref:i,target:l}))});var $G;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher"})($G||($G={}));var e5;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(e5||(e5={}));function mae(t,e){let{target:i,replace:n,state:r,preventScrollReset:s,relative:o}=e===void 0?{}:e,a=$oe(),l=kF(),c=rY(t,{relative:o});return me.useCallback(h=>{if(lae(h,i)){h.preventDefault();let u=n!==void 0?n:rC(l)===rC(c);a(t,{replace:u,state:r,preventScrollReset:s,relative:o})}},[l,a,c,n,r,i,t,s,o])}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const N_="149",Rf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Of={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},sY=0,ML=1,oY=2,gae=3,aY=0,VE=1,Qx=2,tp=3,Ec=0,so=1,ml=2,vae=2,Ou=0,gp=1,CL=2,EL=3,TL=4,lY=5,jf=100,cY=101,uY=102,PL=103,DL=104,hY=200,dY=201,fY=202,pY=203,zF=204,UF=205,mY=206,gY=207,vY=208,yY=209,xY=210,_Y=0,wY=1,bY=2,sC=3,SY=4,AY=5,MY=6,CY=7,k_=0,EY=1,TY=2,Al=0,PY=1,DY=2,IY=3,GF=4,LY=5,HE=300,Ed=301,Td=302,V1=303,H1=304,A0=306,Pd=1e3,Hr=1001,Vv=1002,Sn=1003,j1=1004,yae=1004,fv=1005,xae=1005,bi=1006,jE=1007,_ae=1007,Tc=1008,wae=1008,Xu=1009,BY=1010,RY=1011,VF=1012,OY=1013,Qh=1014,Eu=1015,Hv=1016,FY=1017,NY=1018,vp=1020,kY=1021,Ys=1023,zY=1024,UY=1025,md=1026,zp=1027,GY=1028,VY=1029,HY=1030,jY=1031,WY=1033,cM=33776,uM=33777,hM=33778,dM=33779,IL=35840,LL=35841,BL=35842,RL=35843,XY=36196,OL=37492,FL=37496,NL=37808,kL=37809,zL=37810,UL=37811,GL=37812,VL=37813,HL=37814,jL=37815,WL=37816,XL=37817,qL=37818,YL=37819,QL=37820,JL=37821,fM=36492,qY=36283,KL=36284,ZL=36285,$L=36286,YY=2200,QY=2201,JY=2202,jv=2300,Up=2301,pM=2302,ip=2400,np=2401,W1=2402,WE=2500,HF=2501,KY=0,jF=1,oC=2,Dd=3e3,Yi=3001,ZY=3200,$Y=3201,Hd=0,eQ=1,bae="",hl="srgb",Wv="srgb-linear",Sae=0,mM=7680,Aae=7681,Mae=7682,Cae=7683,Eae=34055,Tae=34056,Pae=5386,Dae=512,Iae=513,Lae=514,Bae=515,Rae=516,Oae=517,Fae=518,tQ=519,X1=35044,yp=35048,Nae=35040,kae=35045,zae=35049,Uae=35041,Gae=35046,Vae=35050,Hae=35042,jae="100",eB="300 es",aC=1035;class Oc{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const is=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let t5=1234567;const xp=Math.PI/180,q1=180/Math.PI;function Go(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(is[t&255]+is[t>>8&255]+is[t>>16&255]+is[t>>24&255]+"-"+is[e&255]+is[e>>8&255]+"-"+is[e>>16&15|64]+is[e>>24&255]+"-"+is[i&63|128]+is[i>>8&255]+"-"+is[i>>16&255]+is[i>>24&255]+is[n&255]+is[n>>8&255]+is[n>>16&255]+is[n>>24&255]).toLowerCase()}function Nn(t,e,i){return Math.max(e,Math.min(i,t))}function WF(t,e){return(t%e+e)%e}function Wae(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)}function Xae(t,e,i){return t!==e?(i-t)/(e-t):0}function Jx(t,e,i){return(1-i)*t+i*e}function qae(t,e,i,n){return Jx(t,e,1-Math.exp(-i*n))}function Yae(t,e=1){return e-Math.abs(WF(t,e*2)-e)}function Qae(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function Jae(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function Kae(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Zae(t,e){return t+Math.random()*(e-t)}function $ae(t){return t*(.5-Math.random())}function ele(t){t!==void 0&&(t5=t);let e=t5+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function tle(t){return t*xp}function ile(t){return t*q1}function tB(t){return(t&t-1)===0&&t!==0}function iQ(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function lC(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function nle(t,e,i,n,r){const s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((e+n)/2),h=o((e+n)/2),u=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Tu(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Gi(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var nQ=Object.freeze({__proto__:null,DEG2RAD:xp,RAD2DEG:q1,ceilPowerOfTwo:iQ,clamp:Nn,damp:qae,degToRad:tle,denormalize:Tu,euclideanModulo:WF,floorPowerOfTwo:lC,generateUUID:Go,inverseLerp:Xae,isPowerOfTwo:tB,lerp:Jx,mapLinear:Wae,normalize:Gi,pingpong:Yae,radToDeg:ile,randFloat:Zae,randFloatSpread:$ae,randInt:Kae,seededRandom:ele,setQuaternionFromProperEuler:nle,smootherstep:Jae,smoothstep:Qae});class Ve{constructor(e=0,i=0){Ve.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,r=e.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),r=Math.sin(i),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ps{constructor(){Ps.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,i,n,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=i,h[4]=s,h[5]=l,h[6]=n,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],h=n[4],u=n[7],d=n[2],f=n[5],p=n[8],m=r[0],g=r[3],v=r[6],y=r[1],x=r[4],b=r[7],S=r[2],A=r[5],E=r[8];return s[0]=o*m+a*y+l*S,s[3]=o*g+a*x+l*A,s[6]=o*v+a*b+l*E,s[1]=c*m+h*y+u*S,s[4]=c*g+h*x+u*A,s[7]=c*v+h*b+u*E,s[2]=d*m+f*y+p*S,s[5]=d*g+f*x+p*A,s[8]=d*v+f*b+p*E,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return i*o*h-i*a*c-n*s*h+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=h*o-a*c,d=a*l-h*s,f=c*s-o*l,p=i*u+n*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=u*m,e[1]=(r*c-h*n)*m,e[2]=(a*n-r*o)*m,e[3]=d*m,e[4]=(h*i-r*l)*m,e[5]=(r*s-a*i)*m,e[6]=f*m,e[7]=(n*l-c*i)*m,e[8]=(o*i-n*s)*m,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+i,0,0,1),this}scale(e,i){return this.premultiply(_P.makeScale(e,i)),this}rotate(e){return this.premultiply(_P.makeRotation(-e)),this}translate(e,i){return this.premultiply(_P.makeTranslation(e,i)),this}makeTranslation(e,i){return this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _P=new Ps;function rQ(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const rle={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Hg(t,e){return new rle[t](e)}function Y1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function _p(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function gM(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const wP={[hl]:{[Wv]:_p},[Wv]:{[hl]:gM}},rs={legacyMode:!0,get workingColorSpace(){return Wv},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(wP[e]&&wP[e][i]!==void 0){const n=wP[e][i];return t.r=n(t.r),t.g=n(t.g),t.b=n(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},sQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tr={r:0,g:0,b:0},Za={h:0,s:0,l:0},Ub={h:0,s:0,l:0};function bP(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}function Gb(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class ct{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,i===void 0&&n===void 0?this.set(e):this.setRGB(e,i,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=hl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,rs.toWorkingColorSpace(this,i),this}setRGB(e,i,n,r=rs.workingColorSpace){return this.r=e,this.g=i,this.b=n,rs.toWorkingColorSpace(this,r),this}setHSL(e,i,n,r=rs.workingColorSpace){if(e=WF(e,1),i=Nn(i,0,1),n=Nn(n,0,1),i===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;this.r=bP(o,s,e+1/3),this.g=bP(o,s,e),this.b=bP(o,s,e-1/3)}return rs.toWorkingColorSpace(this,r),this}setStyle(e,i=hl){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,rs.toWorkingColorSpace(this,i),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,rs.toWorkingColorSpace(this,i),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return n(s[4]),this.setHSL(l,c,h,i)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,rs.toWorkingColorSpace(this,i),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,rs.toWorkingColorSpace(this,i),this}return e&&e.length>0?this.setColorName(e,i):this}setColorName(e,i=hl){const n=sQ[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=_p(e.r),this.g=_p(e.g),this.b=_p(e.b),this}copyLinearToSRGB(e){return this.r=gM(e.r),this.g=gM(e.g),this.b=gM(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=hl){return rs.fromWorkingColorSpace(Gb(this,tr),e),Nn(tr.r*255,0,255)<<16^Nn(tr.g*255,0,255)<<8^Nn(tr.b*255,0,255)<<0}getHexString(e=hl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=rs.workingColorSpace){rs.fromWorkingColorSpace(Gb(this,tr),i);const n=tr.r,r=tr.g,s=tr.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,i=rs.workingColorSpace){return rs.fromWorkingColorSpace(Gb(this,tr),i),e.r=tr.r,e.g=tr.g,e.b=tr.b,e}getStyle(e=hl){return rs.fromWorkingColorSpace(Gb(this,tr),e),e!==hl?`color(${e} ${tr.r} ${tr.g} ${tr.b})`:`rgb(${tr.r*255|0},${tr.g*255|0},${tr.b*255|0})`}offsetHSL(e,i,n){return this.getHSL(Za),Za.h+=e,Za.s+=i,Za.l+=n,this.setHSL(Za.h,Za.s,Za.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(Za),e.getHSL(Ub);const n=Jx(Za.h,Ub.h,i),r=Jx(Za.s,Ub.s,i),s=Jx(Za.l,Ub.l,i);return this.setHSL(n,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}ct.NAMES=sQ;let Cm;class XF{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Cm===void 0&&(Cm=Y1("canvas")),Cm.width=e.width,Cm.height=e.height;const n=Cm.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=Cm}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=Y1("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=_p(s[o]/255)*255;return n.putImageData(r,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(_p(i[n]/255)*255):i[n]=_p(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class rp{constructor(e=null){this.isSource=!0,this.uuid=Go(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(SP(r[o].image)):s.push(SP(r[o]))}else s=SP(r);n.url=s}return i||(e.images[this.uuid]=n),n}}function SP(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?XF.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let sle=0;class on extends Oc{constructor(e=on.DEFAULT_IMAGE,i=on.DEFAULT_MAPPING,n=Hr,r=Hr,s=bi,o=Tc,a=Ys,l=Xu,c=on.DEFAULT_ANISOTROPY,h=Dd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sle++}),this.uuid=Go(),this.name="",this.source=new rp(e),this.mipmaps=[],this.mapping=i,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ve(0,0),this.repeat=new Ve(1,1),this.center=new Ve(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ps,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==HE)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Pd:e.x=e.x-Math.floor(e.x);break;case Hr:e.x=e.x<0?0:1;break;case Vv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Pd:e.y=e.y-Math.floor(e.y);break;case Hr:e.y=e.y<0?0:1;break;case Vv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}on.DEFAULT_IMAGE=null;on.DEFAULT_MAPPING=HE;on.DEFAULT_ANISOTROPY=1;class Ci{constructor(e=0,i=0,n=0,r=1){Ci.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,r){return this.x=e,this.y=i,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*i+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*i+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*i+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,r,s;const l=e.elements,c=l[0],h=l[4],u=l[8],d=l[1],f=l[5],p=l[9],m=l[2],g=l[6],v=l[10];if(Math.abs(h-d)<.01&&Math.abs(u-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(h+d)<.1&&Math.abs(u+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const x=(c+1)/2,b=(f+1)/2,S=(v+1)/2,A=(h+d)/4,E=(u+m)/4,M=(p+g)/4;return x>b&&x>S?x<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(x),r=A/n,s=E/n):b>S?b<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),n=A/r,s=M/r):S<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(S),n=E/s,r=M/s),this.set(n,r,s,i),this}let y=Math.sqrt((g-p)*(g-p)+(u-m)*(u-m)+(d-h)*(d-h));return Math.abs(y)<.001&&(y=1),this.x=(g-p)/y,this.y=(u-m)/y,this.z=(d-h)/y,this.w=Math.acos((c+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Tl extends Oc{constructor(e=1,i=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new Ci(0,0,e,i),this.scissorTest=!1,this.viewport=new Ci(0,0,e,i);const r={width:e,height:i,depth:1};this.texture=new on(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:bi,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,i,n=1){(this.width!==e||this.height!==i||this.depth!==n)&&(this.width=e,this.height=i,this.depth=n,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new rp(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class XE extends on{constructor(e=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Sn,this.minFilter=Sn,this.wrapR=Hr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ole extends Tl{constructor(e=1,i=1,n=1){super(e,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new XE(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class qF extends on{constructor(e=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Sn,this.minFilter=Sn,this.wrapR=Hr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ale extends Tl{constructor(e=1,i=1,n=1){super(e,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new qF(null,e,i,n),this.texture.isRenderTargetTexture=!0}}class lle extends Tl{constructor(e=1,i=1,n=1,r={}){super(e,i,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<n;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,i,n=1){if(this.width!==e||this.height!==i||this.depth!==n){this.width=e,this.height=i,this.depth=n;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=i,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let i=0,n=e.texture.length;i<n;i++)this.texture[i]=e.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class Ir{constructor(e=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=r}static slerpFlat(e,i,n,r,s,o,a){let l=n[r+0],c=n[r+1],h=n[r+2],u=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(a===0){e[i+0]=l,e[i+1]=c,e[i+2]=h,e[i+3]=u;return}if(a===1){e[i+0]=d,e[i+1]=f,e[i+2]=p,e[i+3]=m;return}if(u!==m||l!==d||c!==f||h!==p){let g=1-a;const v=l*d+c*f+h*p+u*m,y=v>=0?1:-1,x=1-v*v;if(x>Number.EPSILON){const S=Math.sqrt(x),A=Math.atan2(S,v*y);g=Math.sin(g*A)/S,a=Math.sin(a*A)/S}const b=a*y;if(l=l*g+d*b,c=c*g+f*b,h=h*g+p*b,u=u*g+m*b,g===1-a){const S=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=S,c*=S,h*=S,u*=S}}e[i]=l,e[i+1]=c,e[i+2]=h,e[i+3]=u}static multiplyQuaternionsFlat(e,i,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],h=n[r+3],u=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[i]=a*p+h*u+l*f-c*d,e[i+1]=l*p+h*d+c*u-a*f,e[i+2]=c*p+h*f+a*d-l*u,e[i+3]=h*p-a*u-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,r){return this._x=e,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),h=a(r/2),u=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"YXZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"ZXY":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"ZYX":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"YZX":this._x=d*h*u+c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u-d*f*p;break;case"XZY":this._x=d*h*u-c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],r=i[4],s=i[8],o=i[1],a=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+a+u;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(h-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>u){const f=2*Math.sqrt(1+n-a-u);this._w=(h-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-n-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+h)/f}else{const f=2*Math.sqrt(1+u-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+h)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Nn(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,r=e._y,s=e._z,o=e._w,a=i._x,l=i._y,c=i._z,h=i._w;return this._x=n*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-n*c,this._z=s*h+o*c+n*l-r*a,this._w=o*h-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-i;return this._w=f*o+i*this._w,this._x=f*n+i*this._x,this._y=f*r+i*this._y,this._z=f*s+i*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),u=Math.sin((1-i)*h)/c,d=Math.sin(i*h)/c;return this._w=o*u+this._w*d,this._x=n*u+this._x*d,this._y=r*u+this._y*d,this._z=s*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=Math.random(),i=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(r),n*Math.sin(s),n*Math.cos(s),i*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ie{constructor(e=0,i=0,n=0){ie.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(i5.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(i5.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6]*r,this.y=s[1]*i+s[4]*n+s[7]*r,this.z=s[2]*i+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*i+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*i+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*i+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*i+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const i=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*i+o*r-a*n,h=l*n+a*i-s*r,u=l*r+s*n-o*i,d=-s*i-o*n-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[4]*n+s[8]*r,this.y=s[1]*i+s[5]*n+s[9]*r,this.z=s[2]*i+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,r=e.y,s=e.z,o=i.x,a=i.y,l=i.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return AP.copy(this).projectOnVector(e),this.sub(AP)}reflect(e){return this.sub(AP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(Nn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return i*i+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const r=Math.sin(i)*e;return this.x=r*Math.sin(n),this.y=Math.cos(i)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const AP=new ie,i5=new Ir;class jd{constructor(e=new ie(1/0,1/0,1/0),i=new ie(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){let i=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const h=e[l],u=e[l+1],d=e[l+2];h<i&&(i=h),u<n&&(n=u),d<r&&(r=d),h>s&&(s=h),u>o&&(o=u),d>a&&(a=d)}return this.min.set(i,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let i=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const h=e.getX(l),u=e.getY(l),d=e.getZ(l);h<i&&(i=h),u<n&&(n=u),d<r&&(r=d),h>s&&(s=h),u>o&&(o=u),d>a&&(a=d)}return this.min.set(i,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=hf.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(i&&n.attributes!=null&&n.attributes.position!==void 0){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)hf.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(hf)}else n.boundingBox===null&&n.computeBoundingBox(),MP.copy(n.boundingBox),MP.applyMatrix4(e.matrixWorld),this.union(MP);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,hf),hf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sy),Vb.subVectors(this.max,Sy),Em.subVectors(e.a,Sy),Tm.subVectors(e.b,Sy),Pm.subVectors(e.c,Sy),fh.subVectors(Tm,Em),ph.subVectors(Pm,Tm),df.subVectors(Em,Pm);let i=[0,-fh.z,fh.y,0,-ph.z,ph.y,0,-df.z,df.y,fh.z,0,-fh.x,ph.z,0,-ph.x,df.z,0,-df.x,-fh.y,fh.x,0,-ph.y,ph.x,0,-df.y,df.x,0];return!CP(i,Em,Tm,Pm,Vb)||(i=[1,0,0,0,1,0,0,0,1],!CP(i,Em,Tm,Pm,Vb))?!1:(Hb.crossVectors(fh,ph),i=[Hb.x,Hb.y,Hb.z],CP(i,Em,Tm,Pm,Vb))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return hf.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(hf).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(qc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const qc=[new ie,new ie,new ie,new ie,new ie,new ie,new ie,new ie],hf=new ie,MP=new jd,Em=new ie,Tm=new ie,Pm=new ie,fh=new ie,ph=new ie,df=new ie,Sy=new ie,Vb=new ie,Hb=new ie,ff=new ie;function CP(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){ff.fromArray(t,s);const a=r.x*Math.abs(ff.x)+r.y*Math.abs(ff.y)+r.z*Math.abs(ff.z),l=e.dot(ff),c=i.dot(ff),h=n.dot(ff);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const cle=new jd,Ay=new ie,EP=new ie;class Wd{constructor(e=new ie,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):cle.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ay.subVectors(e,this.center);const i=Ay.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector(Ay,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(EP.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ay.copy(e.center).add(EP)),this.expandByPoint(Ay.copy(e.center).sub(EP))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Yc=new ie,TP=new ie,jb=new ie,mh=new ie,PP=new ie,Wb=new ie,DP=new ie;class z_{constructor(e=new ie,i=new ie(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Yc)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=Yc.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(Yc.copy(this.direction).multiplyScalar(i).add(this.origin),Yc.distanceToSquared(e))}distanceSqToSegment(e,i,n,r){TP.copy(e).add(i).multiplyScalar(.5),jb.copy(i).sub(e).normalize(),mh.copy(this.origin).sub(TP);const s=e.distanceTo(i)*.5,o=-this.direction.dot(jb),a=mh.dot(this.direction),l=-mh.dot(jb),c=mh.lengthSq(),h=Math.abs(1-o*o);let u,d,f,p;if(h>0)if(u=o*l-a,d=o*a-l,p=s*h,u>=0)if(d>=-p)if(d<=p){const m=1/h;u*=m,d*=m,f=u*(u+o*d+2*a)+d*(o*u+d+2*l)+c}else d=s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d=-s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d<=-p?(u=Math.max(0,-(-o*s+a)),d=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c):d<=p?(u=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(u=Math.max(0,-(o*s+a)),d=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c);else d=o>0?-s:s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(jb).multiplyScalar(d).add(TP),f}intersectSphere(e,i){Yc.subVectors(e.center,this.origin);const n=Yc.dot(this.direction),r=Yc.dot(Yc)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),h>=0?(s=(e.min.y-d.y)*h,o=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,o=(e.min.y-d.y)*h),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(e){return this.intersectBox(e,Yc)!==null}intersectTriangle(e,i,n,r,s){PP.subVectors(i,e),Wb.subVectors(n,e),DP.crossVectors(PP,Wb);let o=this.direction.dot(DP),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;mh.subVectors(this.origin,e);const l=a*this.direction.dot(Wb.crossVectors(mh,Wb));if(l<0)return null;const c=a*this.direction.dot(PP.cross(mh));if(c<0||l+c>o)return null;const h=-a*mh.dot(DP);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Nt{constructor(){Nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g){const v=this.elements;return v[0]=e,v[4]=i,v[8]=n,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=h,v[10]=u,v[14]=d,v[3]=f,v[7]=p,v[11]=m,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Nt().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,r=1/Dm.setFromMatrixColumn(e,0).length(),s=1/Dm.setFromMatrixColumn(e,1).length(),o=1/Dm.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[7]=0,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){const d=o*h,f=o*u,p=a*h,m=a*u;i[0]=l*h,i[4]=-l*u,i[8]=c,i[1]=f+p*c,i[5]=d-m*c,i[9]=-a*l,i[2]=m-d*c,i[6]=p+f*c,i[10]=o*l}else if(e.order==="YXZ"){const d=l*h,f=l*u,p=c*h,m=c*u;i[0]=d+m*a,i[4]=p*a-f,i[8]=o*c,i[1]=o*u,i[5]=o*h,i[9]=-a,i[2]=f*a-p,i[6]=m+d*a,i[10]=o*l}else if(e.order==="ZXY"){const d=l*h,f=l*u,p=c*h,m=c*u;i[0]=d-m*a,i[4]=-o*u,i[8]=p+f*a,i[1]=f+p*a,i[5]=o*h,i[9]=m-d*a,i[2]=-o*c,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){const d=o*h,f=o*u,p=a*h,m=a*u;i[0]=l*h,i[4]=p*c-f,i[8]=d*c+m,i[1]=l*u,i[5]=m*c+d,i[9]=f*c-p,i[2]=-c,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,m=a*c;i[0]=l*h,i[4]=m-d*u,i[8]=p*u+f,i[1]=u,i[5]=o*h,i[9]=-a*h,i[2]=-c*h,i[6]=f*u+p,i[10]=d-m*u}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,m=a*c;i[0]=l*h,i[4]=-u,i[8]=c*h,i[1]=d*u+m,i[5]=o*h,i[9]=f*u-p,i[2]=p*u-f,i[6]=a*h,i[10]=m*u+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ule,e,hle)}lookAt(e,i,n){const r=this.elements;return bo.subVectors(e,i),bo.lengthSq()===0&&(bo.z=1),bo.normalize(),gh.crossVectors(n,bo),gh.lengthSq()===0&&(Math.abs(n.z)===1?bo.x+=1e-4:bo.z+=1e-4,bo.normalize(),gh.crossVectors(n,bo)),gh.normalize(),Xb.crossVectors(bo,gh),r[0]=gh.x,r[4]=Xb.x,r[8]=bo.x,r[1]=gh.y,r[5]=Xb.y,r[9]=bo.y,r[2]=gh.z,r[6]=Xb.z,r[10]=bo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],h=n[1],u=n[5],d=n[9],f=n[13],p=n[2],m=n[6],g=n[10],v=n[14],y=n[3],x=n[7],b=n[11],S=n[15],A=r[0],E=r[4],M=r[8],T=r[12],P=r[1],I=r[5],k=r[9],R=r[13],F=r[2],V=r[6],Q=r[10],X=r[14],z=r[3],Y=r[7],j=r[11],J=r[15];return s[0]=o*A+a*P+l*F+c*z,s[4]=o*E+a*I+l*V+c*Y,s[8]=o*M+a*k+l*Q+c*j,s[12]=o*T+a*R+l*X+c*J,s[1]=h*A+u*P+d*F+f*z,s[5]=h*E+u*I+d*V+f*Y,s[9]=h*M+u*k+d*Q+f*j,s[13]=h*T+u*R+d*X+f*J,s[2]=p*A+m*P+g*F+v*z,s[6]=p*E+m*I+g*V+v*Y,s[10]=p*M+m*k+g*Q+v*j,s[14]=p*T+m*R+g*X+v*J,s[3]=y*A+x*P+b*F+S*z,s[7]=y*E+x*I+b*V+S*Y,s[11]=y*M+x*k+b*Q+S*j,s[15]=y*T+x*R+b*X+S*J,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],m=e[7],g=e[11],v=e[15];return p*(+s*l*u-r*c*u-s*a*d+n*c*d+r*a*f-n*l*f)+m*(+i*l*f-i*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+g*(+i*c*u-i*a*f-s*o*u+n*o*f+s*a*h-n*c*h)+v*(-r*a*h-i*l*u+i*a*d+r*o*u-n*o*d+n*l*h)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=i,r[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],v=e[15],y=u*g*c-m*d*c+m*l*f-a*g*f-u*l*v+a*d*v,x=p*d*c-h*g*c-p*l*f+o*g*f+h*l*v-o*d*v,b=h*m*c-p*u*c+p*a*f-o*m*f-h*a*v+o*u*v,S=p*u*l-h*m*l-p*a*d+o*m*d+h*a*g-o*u*g,A=i*y+n*x+r*b+s*S;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/A;return e[0]=y*E,e[1]=(m*d*s-u*g*s-m*r*f+n*g*f+u*r*v-n*d*v)*E,e[2]=(a*g*s-m*l*s+m*r*c-n*g*c-a*r*v+n*l*v)*E,e[3]=(u*l*s-a*d*s-u*r*c+n*d*c+a*r*f-n*l*f)*E,e[4]=x*E,e[5]=(h*g*s-p*d*s+p*r*f-i*g*f-h*r*v+i*d*v)*E,e[6]=(p*l*s-o*g*s-p*r*c+i*g*c+o*r*v-i*l*v)*E,e[7]=(o*d*s-h*l*s+h*r*c-i*d*c-o*r*f+i*l*f)*E,e[8]=b*E,e[9]=(p*u*s-h*m*s-p*n*f+i*m*f+h*n*v-i*u*v)*E,e[10]=(o*m*s-p*a*s+p*n*c-i*m*c-o*n*v+i*a*v)*E,e[11]=(h*a*s-o*u*s-h*n*c+i*u*c+o*n*f-i*a*f)*E,e[12]=S*E,e[13]=(h*m*r-p*u*r+p*n*d-i*m*d-h*n*g+i*u*g)*E,e[14]=(p*a*r-o*m*r-p*n*l+i*m*l+o*n*g-i*a*g)*E,e[15]=(o*u*r-h*a*r+h*n*l-i*u*l-o*n*d+i*a*d)*E,this}scale(e){const i=this.elements,n=e.x,r=e.y,s=e.z;return i[0]*=n,i[4]*=r,i[8]*=s,i[1]*=n,i[5]*=r,i[9]*=s,i[2]*=n,i[6]*=r,i[10]*=s,i[3]*=n,i[7]*=r,i[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(e,i,n){return this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),r=Math.sin(i),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+n,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,i,r,1,0,0,0,0,1),this}compose(e,i,n){const r=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,m=o*h,g=o*u,v=a*u,y=l*c,x=l*h,b=l*u,S=n.x,A=n.y,E=n.z;return r[0]=(1-(m+v))*S,r[1]=(f+b)*S,r[2]=(p-x)*S,r[3]=0,r[4]=(f-b)*A,r[5]=(1-(d+v))*A,r[6]=(g+y)*A,r[7]=0,r[8]=(p+x)*E,r[9]=(g-y)*E,r[10]=(1-(d+m))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,i,n){const r=this.elements;let s=Dm.set(r[0],r[1],r[2]).length();const o=Dm.set(r[4],r[5],r[6]).length(),a=Dm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],$a.copy(this);const c=1/s,h=1/o,u=1/a;return $a.elements[0]*=c,$a.elements[1]*=c,$a.elements[2]*=c,$a.elements[4]*=h,$a.elements[5]*=h,$a.elements[6]*=h,$a.elements[8]*=u,$a.elements[9]*=u,$a.elements[10]*=u,i.setFromRotationMatrix($a),n.x=s,n.y=o,n.z=a,this}makePerspective(e,i,n,r,s,o){const a=this.elements,l=2*s/(i-e),c=2*s/(n-r),h=(i+e)/(i-e),u=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,i,n,r,s,o){const a=this.elements,l=1/(i-e),c=1/(n-r),h=1/(o-s),u=(i+e)*l,d=(n+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const Dm=new ie,$a=new Nt,ule=new ie(0,0,0),hle=new ie(1,1,1),gh=new ie,Xb=new ie,bo=new ie,n5=new Nt,r5=new Ir;class U_{constructor(e=0,i=0,n=0,r=U_.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,r=this._order){return this._x=e,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],f=r[10];switch(i){case"XYZ":this._y=Math.asin(Nn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Nn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(Nn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Nn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(Nn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Nn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return n5.makeRotationFromQuaternion(e),this.setFromRotationMatrix(n5,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return r5.setFromEuler(this),this.setFromQuaternion(r5,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}U_.DEFAULT_ORDER="XYZ";class wp{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let dle=0;const s5=new ie,Im=new Ir,Qc=new Nt,qb=new ie,My=new ie,fle=new ie,ple=new Ir,o5=new ie(1,0,0),a5=new ie(0,1,0),l5=new ie(0,0,1),mle={type:"added"},c5={type:"removed"};class vi extends Oc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dle++}),this.uuid=Go(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vi.DEFAULT_UP.clone();const e=new ie,i=new U_,n=new Ir,r=new ie(1,1,1);function s(){n.setFromEuler(i,!1)}function o(){i.setFromQuaternion(n,void 0,!1)}i._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Nt},normalMatrix:{value:new Ps}}),this.matrix=new Nt,this.matrixWorld=new Nt,this.matrixAutoUpdate=vi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=vi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new wp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Im.setFromAxisAngle(e,i),this.quaternion.multiply(Im),this}rotateOnWorldAxis(e,i){return Im.setFromAxisAngle(e,i),this.quaternion.premultiply(Im),this}rotateX(e){return this.rotateOnAxis(o5,e)}rotateY(e){return this.rotateOnAxis(a5,e)}rotateZ(e){return this.rotateOnAxis(l5,e)}translateOnAxis(e,i){return s5.copy(e).applyQuaternion(this.quaternion),this.position.add(s5.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(o5,e)}translateY(e){return this.translateOnAxis(a5,e)}translateZ(e){return this.translateOnAxis(l5,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Qc.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?qb.copy(e):qb.set(e,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),My.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qc.lookAt(My,qb,this.up):Qc.lookAt(qb,My,this.up),this.quaternion.setFromRotationMatrix(Qc),r&&(Qc.extractRotation(r.matrixWorld),Im.setFromRotationMatrix(Qc),this.quaternion.premultiply(Im.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(mle)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(c5)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const i=this.children[e];i.parent=null,i.dispatchEvent(c5)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Qc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Qc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Qc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i){let n=[];this[e]===i&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,i);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(My,e,fle),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(My,ple,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const s=i[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];s(e.shapes,u)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(i){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),u=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),h.length>0&&(n.images=h),u.length>0&&(n.shapes=u),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),p.length>0&&(n.nodes=p)}return n.object=r,n;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}vi.DEFAULT_UP=new ie(0,1,0);vi.DEFAULT_MATRIX_AUTO_UPDATE=!0;vi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const el=new ie,Jc=new ie,IP=new ie,Kc=new ie,Lm=new ie,Bm=new ie,u5=new ie,LP=new ie,BP=new ie,RP=new ie;class Ca{constructor(e=new ie,i=new ie,n=new ie){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,r){r.subVectors(n,i),el.subVectors(e,i),r.cross(el);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,i,n,r,s){el.subVectors(r,i),Jc.subVectors(n,i),IP.subVectors(e,i);const o=el.dot(el),a=el.dot(Jc),l=el.dot(IP),c=Jc.dot(Jc),h=Jc.dot(IP),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const d=1/u,f=(c*l-a*h)*d,p=(o*h-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,i,n,r){return this.getBarycoord(e,i,n,r,Kc),Kc.x>=0&&Kc.y>=0&&Kc.x+Kc.y<=1}static getUV(e,i,n,r,s,o,a,l){return this.getBarycoord(e,i,n,r,Kc),l.set(0,0),l.addScaledVector(s,Kc.x),l.addScaledVector(o,Kc.y),l.addScaledVector(a,Kc.z),l}static isFrontFacing(e,i,n,r){return el.subVectors(n,i),Jc.subVectors(e,i),el.cross(Jc).dot(r)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,r){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,i,n,r){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return el.subVectors(this.c,this.b),Jc.subVectors(this.a,this.b),el.cross(Jc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ca.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return Ca.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,n,r,s){return Ca.getUV(e,this.a,this.b,this.c,i,n,r,s)}containsPoint(e){return Ca.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ca.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,r=this.b,s=this.c;let o,a;Lm.subVectors(r,n),Bm.subVectors(s,n),LP.subVectors(e,n);const l=Lm.dot(LP),c=Bm.dot(LP);if(l<=0&&c<=0)return i.copy(n);BP.subVectors(e,r);const h=Lm.dot(BP),u=Bm.dot(BP);if(h>=0&&u<=h)return i.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return o=l/(l-h),i.copy(n).addScaledVector(Lm,o);RP.subVectors(e,s);const f=Lm.dot(RP),p=Bm.dot(RP);if(p>=0&&f<=p)return i.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),i.copy(n).addScaledVector(Bm,a);const g=h*p-f*u;if(g<=0&&u-h>=0&&f-p>=0)return u5.subVectors(s,r),a=(u-h)/(u-h+(f-p)),i.copy(r).addScaledVector(u5,a);const v=1/(g+m+d);return o=m*v,a=d*v,i.copy(n).addScaledVector(Lm,o).addScaledVector(Bm,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let gle=0;class Zn extends Oc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gle++}),this.uuid=Go(),this.name="",this.type="Material",this.blending=gp,this.side=Ec,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=zF,this.blendDst=UF,this.blendEquation=jf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=sC,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=tQ,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mM,this.stencilZFail=mM,this.stencilZPass=mM,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}const r=this[i];if(r===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==gp&&(n.blending=this.blending),this.side!==Ec&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=i[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Bo extends Zn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ct(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const jn=new ie,Yb=new Ve;class Ai{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=X1,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=i.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)Yb.fromBufferAttribute(this,i),Yb.applyMatrix3(e),this.setXY(i,Yb.x,Yb.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)jn.fromBufferAttribute(this,i),jn.applyMatrix3(e),this.setXYZ(i,jn.x,jn.y,jn.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)jn.fromBufferAttribute(this,i),jn.applyMatrix4(e),this.setXYZ(i,jn.x,jn.y,jn.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)jn.fromBufferAttribute(this,i),jn.applyNormalMatrix(e),this.setXYZ(i,jn.x,jn.y,jn.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)jn.fromBufferAttribute(this,i),jn.transformDirection(e),this.setXYZ(i,jn.x,jn.y,jn.z);return this}set(e,i=0){return this.array.set(e,i),this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=Tu(i,this.array)),i}setX(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=Tu(i,this.array)),i}setY(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=Tu(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=Tu(i,this.array)),i}setW(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array),r=Gi(r,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,i,n,r,s){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array),r=Gi(r,this.array),s=Gi(s,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==X1&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class vle extends Ai{constructor(e,i,n){super(new Int8Array(e),i,n)}}class yle extends Ai{constructor(e,i,n){super(new Uint8Array(e),i,n)}}class xle extends Ai{constructor(e,i,n){super(new Uint8ClampedArray(e),i,n)}}class _le extends Ai{constructor(e,i,n){super(new Int16Array(e),i,n)}}class YF extends Ai{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class wle extends Ai{constructor(e,i,n){super(new Int32Array(e),i,n)}}class QF extends Ai{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class ble extends Ai{constructor(e,i,n){super(new Uint16Array(e),i,n),this.isFloat16BufferAttribute=!0}}class wt extends Ai{constructor(e,i,n){super(new Float32Array(e),i,n)}}class Sle extends Ai{constructor(e,i,n){super(new Float64Array(e),i,n)}}let Ale=0;const oa=new Nt,OP=new vi,Rm=new ie,So=new jd,Cy=new jd,br=new ie;class $t extends Oc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ale++}),this.uuid=Go(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(rQ(e)?QF:YF)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Ps().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return oa.makeRotationFromQuaternion(e),this.applyMatrix4(oa),this}rotateX(e){return oa.makeRotationX(e),this.applyMatrix4(oa),this}rotateY(e){return oa.makeRotationY(e),this.applyMatrix4(oa),this}rotateZ(e){return oa.makeRotationZ(e),this.applyMatrix4(oa),this}translate(e,i,n){return oa.makeTranslation(e,i,n),this.applyMatrix4(oa),this}scale(e,i,n){return oa.makeScale(e,i,n),this.applyMatrix4(oa),this}lookAt(e){return OP.lookAt(e),OP.updateMatrix(),this.applyMatrix4(OP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Rm).negate(),this.translate(Rm.x,Rm.y,Rm.z),this}setFromPoints(e){const i=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new wt(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new jd);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ie(-1/0,-1/0,-1/0),new ie(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,r=i.length;n<r;n++){const s=i[n];So.setFromBufferAttribute(s),this.morphTargetsRelative?(br.addVectors(this.boundingBox.min,So.min),this.boundingBox.expandByPoint(br),br.addVectors(this.boundingBox.max,So.max),this.boundingBox.expandByPoint(br)):(this.boundingBox.expandByPoint(So.min),this.boundingBox.expandByPoint(So.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Wd);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ie,1/0);return}if(e){const n=this.boundingSphere.center;if(So.setFromBufferAttribute(e),i)for(let s=0,o=i.length;s<o;s++){const a=i[s];Cy.setFromBufferAttribute(a),this.morphTargetsRelative?(br.addVectors(So.min,Cy.min),So.expandByPoint(br),br.addVectors(So.max,Cy.max),So.expandByPoint(br)):(So.expandByPoint(Cy.min),So.expandByPoint(Cy.max))}So.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)br.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(br));if(i)for(let s=0,o=i.length;s<o;s++){const a=i[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)br.fromBufferAttribute(a,c),l&&(Rm.fromBufferAttribute(e,c),br.add(Rm)),r=Math.max(r,n.distanceToSquared(br))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=i.position.array,s=i.normal.array,o=i.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ai(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new ie,h[P]=new ie;const u=new ie,d=new ie,f=new ie,p=new Ve,m=new Ve,g=new Ve,v=new ie,y=new ie;function x(P,I,k){u.fromArray(r,P*3),d.fromArray(r,I*3),f.fromArray(r,k*3),p.fromArray(o,P*2),m.fromArray(o,I*2),g.fromArray(o,k*2),d.sub(u),f.sub(u),m.sub(p),g.sub(p);const R=1/(m.x*g.y-g.x*m.y);isFinite(R)&&(v.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar(R),y.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(R),c[P].add(v),c[I].add(v),c[k].add(v),h[P].add(y),h[I].add(y),h[k].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:n.length}]);for(let P=0,I=b.length;P<I;++P){const k=b[P],R=k.start,F=k.count;for(let V=R,Q=R+F;V<Q;V+=3)x(n[V+0],n[V+1],n[V+2])}const S=new ie,A=new ie,E=new ie,M=new ie;function T(P){E.fromArray(s,P*3),M.copy(E);const I=c[P];S.copy(I),S.sub(E.multiplyScalar(E.dot(I))).normalize(),A.crossVectors(M,I);const R=A.dot(h[P])<0?-1:1;l[P*4]=S.x,l[P*4+1]=S.y,l[P*4+2]=S.z,l[P*4+3]=R}for(let P=0,I=b.length;P<I;++P){const k=b[P],R=k.start,F=k.count;for(let V=R,Q=R+F;V<Q;V+=3)T(n[V+0]),T(n[V+1]),T(n[V+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ai(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new ie,s=new ie,o=new ie,a=new ie,l=new ie,c=new ie,h=new ie,u=new ie;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(i,p),s.fromBufferAttribute(i,m),o.fromBufferAttribute(i,g),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),a.add(h),l.add(h),c.add(h),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=i.count;d<f;d+=3)r.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),n.setXYZ(d+0,h.x,h.y,h.z),n.setXYZ(d+1,h.x,h.y,h.z),n.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)br.fromBufferAttribute(e,i),br.normalize(),e.setXYZ(i,br.x,br.y,br.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){a.isInterleavedBufferAttribute?f=l[m]*a.data.stride+a.offset:f=l[m]*h;for(let v=0;v<h;v++)d[p++]=c[f++]}return new Ai(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new $t,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,n);i.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){const d=c[h],f=e(d,n);l.push(f)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];i.addGroup(c.start,c.count,c.materialIndex)}return i}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(i))}const s=e.morphAttributes;for(const c in s){const h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(i));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const h5=new Nt,Om=new z_,FP=new Wd,Ey=new ie,Ty=new ie,Py=new ie,NP=new ie,Qb=new ie,Jb=new Ve,Kb=new Ve,Zb=new Ve,kP=new ie,$b=new ie;class cr extends vi{constructor(e=new $t,i=new Bo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,i){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;i.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Qb.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],u=s[l];h!==0&&(NP.fromBufferAttribute(u,e),o?Qb.addScaledVector(NP,h):Qb.addScaledVector(NP.sub(i),h))}i.add(Qb)}return this.isSkinnedMesh&&this.boneTransform(e,i),i}raycast(e,i){const n=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),FP.copy(n.boundingSphere),FP.applyMatrix4(s),e.ray.intersectsSphere(FP)===!1)||(h5.copy(s).invert(),Om.copy(e.ray).applyMatrix4(h5),n.boundingBox!==null&&Om.intersectsBox(n.boundingBox)===!1))return;let o;const a=n.index,l=n.attributes.position,c=n.attributes.uv,h=n.attributes.uv2,u=n.groups,d=n.drawRange;if(a!==null)if(Array.isArray(r))for(let f=0,p=u.length;f<p;f++){const m=u[f],g=r[m.materialIndex],v=Math.max(m.start,d.start),y=Math.min(a.count,Math.min(m.start+m.count,d.start+d.count));for(let x=v,b=y;x<b;x+=3){const S=a.getX(x),A=a.getX(x+1),E=a.getX(x+2);o=eS(this,g,e,Om,c,h,S,A,E),o&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=m.materialIndex,i.push(o))}}else{const f=Math.max(0,d.start),p=Math.min(a.count,d.start+d.count);for(let m=f,g=p;m<g;m+=3){const v=a.getX(m),y=a.getX(m+1),x=a.getX(m+2);o=eS(this,r,e,Om,c,h,v,y,x),o&&(o.faceIndex=Math.floor(m/3),i.push(o))}}else if(l!==void 0)if(Array.isArray(r))for(let f=0,p=u.length;f<p;f++){const m=u[f],g=r[m.materialIndex],v=Math.max(m.start,d.start),y=Math.min(l.count,Math.min(m.start+m.count,d.start+d.count));for(let x=v,b=y;x<b;x+=3){const S=x,A=x+1,E=x+2;o=eS(this,g,e,Om,c,h,S,A,E),o&&(o.faceIndex=Math.floor(x/3),o.face.materialIndex=m.materialIndex,i.push(o))}}else{const f=Math.max(0,d.start),p=Math.min(l.count,d.start+d.count);for(let m=f,g=p;m<g;m+=3){const v=m,y=m+1,x=m+2;o=eS(this,r,e,Om,c,h,v,y,x),o&&(o.faceIndex=Math.floor(m/3),i.push(o))}}}}function Mle(t,e,i,n,r,s,o,a){let l;if(e.side===so?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Ec,a),l===null)return null;$b.copy(a),$b.applyMatrix4(t.matrixWorld);const c=i.ray.origin.distanceTo($b);return c<i.near||c>i.far?null:{distance:c,point:$b.clone(),object:t}}function eS(t,e,i,n,r,s,o,a,l){t.getVertexPosition(o,Ey),t.getVertexPosition(a,Ty),t.getVertexPosition(l,Py);const c=Mle(t,e,i,n,Ey,Ty,Py,kP);if(c){r&&(Jb.fromBufferAttribute(r,o),Kb.fromBufferAttribute(r,a),Zb.fromBufferAttribute(r,l),c.uv=Ca.getUV(kP,Ey,Ty,Py,Jb,Kb,Zb,new Ve)),s&&(Jb.fromBufferAttribute(s,o),Kb.fromBufferAttribute(s,a),Zb.fromBufferAttribute(s,l),c.uv2=Ca.getUV(kP,Ey,Ty,Py,Jb,Kb,Zb,new Ve));const h={a:o,b:a,c:l,normal:new ie,materialIndex:0};Ca.getNormal(Ey,Ty,Py,h.normal),c.face=h}return c}class Xd extends $t{constructor(e=1,i=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],u=[];let d=0,f=0;p("z","y","x",-1,-1,n,i,e,o,s,0),p("z","y","x",1,-1,n,i,-e,o,s,1),p("x","z","y",1,1,e,n,i,r,o,2),p("x","z","y",1,-1,e,n,-i,r,o,3),p("x","y","z",1,-1,e,i,n,r,s,4),p("x","y","z",-1,-1,e,i,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new wt(c,3)),this.setAttribute("normal",new wt(h,3)),this.setAttribute("uv",new wt(u,2));function p(m,g,v,y,x,b,S,A,E,M,T){const P=b/E,I=S/M,k=b/2,R=S/2,F=A/2,V=E+1,Q=M+1;let X=0,z=0;const Y=new ie;for(let j=0;j<Q;j++){const J=j*I-R;for(let H=0;H<V;H++){const Z=H*P-k;Y[m]=Z*y,Y[g]=J*x,Y[v]=F,c.push(Y.x,Y.y,Y.z),Y[m]=0,Y[g]=0,Y[v]=A>0?1:-1,h.push(Y.x,Y.y,Y.z),u.push(H/E),u.push(1-j/M),X+=1}}for(let j=0;j<M;j++)for(let J=0;J<E;J++){const H=d+J+V*j,Z=d+J+V*(j+1),K=d+(J+1)+V*(j+1),ne=d+(J+1)+V*j;l.push(H,Z,ne),l.push(Z,K,ne),z+=6}a.addGroup(f,z,T),f+=z,d+=X}}static fromJSON(e){return new Xd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Xv(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function bs(t){const e={};for(let i=0;i<t.length;i++){const n=Xv(t[i]);for(const r in n)e[r]=n[r]}return e}function Cle(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function oQ(t){return t.getRenderTarget()===null&&t.outputEncoding===Yi?hl:Wv}const aQ={clone:Xv,merge:bs};var Ele=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Tle=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Pl extends Zn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Ele,this.fragmentShader=Tle,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xv(e.uniforms),this.uniformsGroups=Cle(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?i.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[r]={type:"m4",value:o.toArray()}:i.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class G_ extends vi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Nt,this.projectionMatrix=new Nt,this.projectionMatrixInverse=new Nt}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class sn extends G_{constructor(e=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=q1*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(xp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return q1*2*Math.atan(Math.tan(xp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,n,r,s,o){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(xp*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,i-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,i,i-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Fm=-90,Nm=1;class JF extends vi{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new sn(Fm,Nm,e,i);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new sn(Fm,Nm,e,i);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new sn(Fm,Nm,e,i);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new sn(Fm,Nm,e,i);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new sn(Fm,Nm,e,i);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new sn(Fm,Nm,e,i);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,i){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,h=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=Al,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(i,r),e.setRenderTarget(n,1),e.render(i,s),e.setRenderTarget(n,2),e.render(i,o),e.setRenderTarget(n,3),e.render(i,a),e.setRenderTarget(n,4),e.render(i,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(i,c),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class V_ extends on{constructor(e,i,n,r,s,o,a,l,c,h){e=e!==void 0?e:[],i=i!==void 0?i:Ed,super(e,i,n,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class KF extends Tl{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new V_(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:bi}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Xd(5,5,5),s=new Pl({name:"CubemapFromEquirect",uniforms:Xv(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:so,blending:Ou});s.uniforms.tEquirect.value=i;const o=new cr(r,s),a=i.minFilter;return i.minFilter===Tc&&(i.minFilter=bi),new JF(1,10,this).update(e,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,i,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(i,n,r);e.setRenderTarget(s)}}const zP=new ie,Ple=new ie,Dle=new Ps;class kh{constructor(e=new ie(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,r){return this.normal.set(e,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const r=zP.subVectors(n,i).cross(Ple.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,i){const n=e.delta(zP),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:i.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||Dle.getNormalMatrix(e),r=this.coplanarPoint(zP).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const km=new Wd,tS=new ie;class qE{constructor(e=new kh,i=new kh,n=new kh,r=new kh,s=new kh,o=new kh){this.planes=[e,i,n,r,s,o]}set(e,i,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(i),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const i=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],f=n[9],p=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15];return i[0].setComponents(a-r,u-l,m-d,x-g).normalize(),i[1].setComponents(a+r,u+l,m+d,x+g).normalize(),i[2].setComponents(a+s,u+c,m+f,x+v).normalize(),i[3].setComponents(a-s,u-c,m-f,x-v).normalize(),i[4].setComponents(a-o,u-h,m-p,x-y).normalize(),i[5].setComponents(a+o,u+h,m+p,x+y).normalize(),this}intersectsObject(e){const i=e.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),km.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(km)}intersectsSprite(e){return km.center.set(0,0,0),km.radius=.7071067811865476,km.applyMatrix4(e.matrixWorld),this.intersectsSphere(km)}intersectsSphere(e){const i=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(tS.x=r.normal.x>0?e.max.x:e.min.x,tS.y=r.normal.y>0?e.max.y:e.min.y,tS.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(tS)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function lQ(){let t=null,e=!1,i=null,n=null;function r(s,o){i(s,o),n=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function Ile(t,e){const i=e.isWebGL2,n=new WeakMap;function r(c,h){const u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){const d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(i?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h&&(t.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){const d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}class $p extends $t{constructor(e=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:r};const s=e/2,o=i/2,a=Math.floor(n),l=Math.floor(r),c=a+1,h=l+1,u=e/a,d=i/l,f=[],p=[],m=[],g=[];for(let v=0;v<h;v++){const y=v*d-o;for(let x=0;x<c;x++){const b=x*u-s;p.push(b,-y,0),m.push(0,0,1),g.push(x/a),g.push(1-v/l)}}for(let v=0;v<l;v++)for(let y=0;y<a;y++){const x=y+c*v,b=y+c*(v+1),S=y+1+c*(v+1),A=y+1+c*v;f.push(x,b,A),f.push(b,S,A)}this.setIndex(f),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(m,3)),this.setAttribute("uv",new wt(g,2))}static fromJSON(e){return new $p(e.width,e.height,e.widthSegments,e.heightSegments)}}var Lle=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Ble=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Rle=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Ole=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Fle=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Nle=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,kle="vec3 transformed = vec3( position );",zle=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Ule=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Gle=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Vle=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Hle=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,jle=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Wle=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Xle=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,qle=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Yle=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Qle=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Jle=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Kle=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Zle=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$le=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,ece=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,tce=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,ice=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,nce=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,rce="gl_FragColor = linearToOutputTexel( gl_FragColor );",sce=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,oce=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ace=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,lce=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,cce=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,uce=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,hce=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,dce=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fce=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,pce=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,mce=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,gce=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,vce=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,yce=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,xce=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,_ce=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,wce=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,bce=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Sce=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Ace=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Mce=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Cce=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Ece=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Tce=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Pce=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Dce=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Ice=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Lce=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Bce=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Rce=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Oce=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Fce=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Nce=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,kce=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zce=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Uce=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Gce=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Vce=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Hce=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,jce=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Wce=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Xce=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,qce=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Yce=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Qce=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Jce=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Kce=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Zce=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,$ce=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,eue=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,tue=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,iue=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,nue=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,rue=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,sue=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,oue=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,aue=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,lue=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,cue=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,uue=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,hue=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,due=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,fue=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,pue=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,mue=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,gue=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,vue=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,yue=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,xue=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,_ue=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,wue=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,bue=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Sue=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Aue=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Mue=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Cue=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Eue=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Tue=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Pue=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Due=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Iue=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Lue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Bue=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Rue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Oue=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Fue=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Nue=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,kue=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,zue=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Uue=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Gue=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Vue=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Hue=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jue=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Wue=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Xue=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,que=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yue=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Que=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jue=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Kue=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Zue=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$ue=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ehe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,the=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ihe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nhe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rhe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,she=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ohe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ahe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,lhe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,che=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ni={alphamap_fragment:Lle,alphamap_pars_fragment:Ble,alphatest_fragment:Rle,alphatest_pars_fragment:Ole,aomap_fragment:Fle,aomap_pars_fragment:Nle,begin_vertex:kle,beginnormal_vertex:zle,bsdfs:Ule,iridescence_fragment:Gle,bumpmap_pars_fragment:Vle,clipping_planes_fragment:Hle,clipping_planes_pars_fragment:jle,clipping_planes_pars_vertex:Wle,clipping_planes_vertex:Xle,color_fragment:qle,color_pars_fragment:Yle,color_pars_vertex:Qle,color_vertex:Jle,common:Kle,cube_uv_reflection_fragment:Zle,defaultnormal_vertex:$le,displacementmap_pars_vertex:ece,displacementmap_vertex:tce,emissivemap_fragment:ice,emissivemap_pars_fragment:nce,encodings_fragment:rce,encodings_pars_fragment:sce,envmap_fragment:oce,envmap_common_pars_fragment:ace,envmap_pars_fragment:lce,envmap_pars_vertex:cce,envmap_physical_pars_fragment:wce,envmap_vertex:uce,fog_vertex:hce,fog_pars_vertex:dce,fog_fragment:fce,fog_pars_fragment:pce,gradientmap_pars_fragment:mce,lightmap_fragment:gce,lightmap_pars_fragment:vce,lights_lambert_fragment:yce,lights_lambert_pars_fragment:xce,lights_pars_begin:_ce,lights_toon_fragment:bce,lights_toon_pars_fragment:Sce,lights_phong_fragment:Ace,lights_phong_pars_fragment:Mce,lights_physical_fragment:Cce,lights_physical_pars_fragment:Ece,lights_fragment_begin:Tce,lights_fragment_maps:Pce,lights_fragment_end:Dce,logdepthbuf_fragment:Ice,logdepthbuf_pars_fragment:Lce,logdepthbuf_pars_vertex:Bce,logdepthbuf_vertex:Rce,map_fragment:Oce,map_pars_fragment:Fce,map_particle_fragment:Nce,map_particle_pars_fragment:kce,metalnessmap_fragment:zce,metalnessmap_pars_fragment:Uce,morphcolor_vertex:Gce,morphnormal_vertex:Vce,morphtarget_pars_vertex:Hce,morphtarget_vertex:jce,normal_fragment_begin:Wce,normal_fragment_maps:Xce,normal_pars_fragment:qce,normal_pars_vertex:Yce,normal_vertex:Qce,normalmap_pars_fragment:Jce,clearcoat_normal_fragment_begin:Kce,clearcoat_normal_fragment_maps:Zce,clearcoat_pars_fragment:$ce,iridescence_pars_fragment:eue,output_fragment:tue,packing:iue,premultiplied_alpha_fragment:nue,project_vertex:rue,dithering_fragment:sue,dithering_pars_fragment:oue,roughnessmap_fragment:aue,roughnessmap_pars_fragment:lue,shadowmap_pars_fragment:cue,shadowmap_pars_vertex:uue,shadowmap_vertex:hue,shadowmask_pars_fragment:due,skinbase_vertex:fue,skinning_pars_vertex:pue,skinning_vertex:mue,skinnormal_vertex:gue,specularmap_fragment:vue,specularmap_pars_fragment:yue,tonemapping_fragment:xue,tonemapping_pars_fragment:_ue,transmission_fragment:wue,transmission_pars_fragment:bue,uv_pars_fragment:Sue,uv_pars_vertex:Aue,uv_vertex:Mue,uv2_pars_fragment:Cue,uv2_pars_vertex:Eue,uv2_vertex:Tue,worldpos_vertex:Pue,background_vert:Due,background_frag:Iue,backgroundCube_vert:Lue,backgroundCube_frag:Bue,cube_vert:Rue,cube_frag:Oue,depth_vert:Fue,depth_frag:Nue,distanceRGBA_vert:kue,distanceRGBA_frag:zue,equirect_vert:Uue,equirect_frag:Gue,linedashed_vert:Vue,linedashed_frag:Hue,meshbasic_vert:jue,meshbasic_frag:Wue,meshlambert_vert:Xue,meshlambert_frag:que,meshmatcap_vert:Yue,meshmatcap_frag:Que,meshnormal_vert:Jue,meshnormal_frag:Kue,meshphong_vert:Zue,meshphong_frag:$ue,meshphysical_vert:ehe,meshphysical_frag:the,meshtoon_vert:ihe,meshtoon_frag:nhe,points_vert:rhe,points_frag:she,shadow_vert:ohe,shadow_frag:ahe,sprite_vert:lhe,sprite_frag:che},st={common:{diffuse:{value:new ct(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ps},uv2Transform:{value:new Ps},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ve(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ct(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ct(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ps}},sprite:{diffuse:{value:new ct(16777215)},opacity:{value:1},center:{value:new Ve(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ps}}},fl={basic:{uniforms:bs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.fog]),vertexShader:ni.meshbasic_vert,fragmentShader:ni.meshbasic_frag},lambert:{uniforms:bs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new ct(0)}}]),vertexShader:ni.meshlambert_vert,fragmentShader:ni.meshlambert_frag},phong:{uniforms:bs([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new ct(0)},specular:{value:new ct(1118481)},shininess:{value:30}}]),vertexShader:ni.meshphong_vert,fragmentShader:ni.meshphong_frag},standard:{uniforms:bs([st.common,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.roughnessmap,st.metalnessmap,st.fog,st.lights,{emissive:{value:new ct(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag},toon:{uniforms:bs([st.common,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.gradientmap,st.fog,st.lights,{emissive:{value:new ct(0)}}]),vertexShader:ni.meshtoon_vert,fragmentShader:ni.meshtoon_frag},matcap:{uniforms:bs([st.common,st.bumpmap,st.normalmap,st.displacementmap,st.fog,{matcap:{value:null}}]),vertexShader:ni.meshmatcap_vert,fragmentShader:ni.meshmatcap_frag},points:{uniforms:bs([st.points,st.fog]),vertexShader:ni.points_vert,fragmentShader:ni.points_frag},dashed:{uniforms:bs([st.common,st.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ni.linedashed_vert,fragmentShader:ni.linedashed_frag},depth:{uniforms:bs([st.common,st.displacementmap]),vertexShader:ni.depth_vert,fragmentShader:ni.depth_frag},normal:{uniforms:bs([st.common,st.bumpmap,st.normalmap,st.displacementmap,{opacity:{value:1}}]),vertexShader:ni.meshnormal_vert,fragmentShader:ni.meshnormal_frag},sprite:{uniforms:bs([st.sprite,st.fog]),vertexShader:ni.sprite_vert,fragmentShader:ni.sprite_frag},background:{uniforms:{uvTransform:{value:new Ps},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ni.background_vert,fragmentShader:ni.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ni.backgroundCube_vert,fragmentShader:ni.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ni.cube_vert,fragmentShader:ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ni.equirect_vert,fragmentShader:ni.equirect_frag},distanceRGBA:{uniforms:bs([st.common,st.displacementmap,{referencePosition:{value:new ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ni.distanceRGBA_vert,fragmentShader:ni.distanceRGBA_frag},shadow:{uniforms:bs([st.lights,st.fog,{color:{value:new ct(0)},opacity:{value:1}}]),vertexShader:ni.shadow_vert,fragmentShader:ni.shadow_frag}};fl.physical={uniforms:bs([fl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ve(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ct(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ve},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ct(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ct(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag};const iS={r:0,b:0,g:0};function uhe(t,e,i,n,r,s,o){const a=new ct(0);let l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,v){let y=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?i:e).get(x));const b=t.xr,S=b.getSession&&b.getSession();S&&S.environmentBlendMode==="additive"&&(x=null),x===null?m(a,l):x&&x.isColor&&(m(x,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),x&&(x.isCubeTexture||x.mapping===A0)?(h===void 0&&(h=new cr(new Xd(1,1,1),new Pl({name:"BackgroundCubeMaterial",uniforms:Xv(fl.backgroundCube.uniforms),vertexShader:fl.backgroundCube.vertexShader,fragmentShader:fl.backgroundCube.fragmentShader,side:so,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,E,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=x,h.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=x.encoding!==Yi,(u!==x||d!==x.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new cr(new $p(2,2),new Pl({name:"BackgroundMaterial",uniforms:Xv(fl.background.uniforms),vertexShader:fl.background.vertexShader,fragmentShader:fl.background.fragmentShader,side:Ec,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==Yi,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(u!==x||d!==x.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(iS,oQ(t)),n.buffers.color.setClear(iS.r,iS.g,iS.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(g,v=1){a.set(g),l=v,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(a,l)},render:p}}function hhe(t,e,i,n){const r=t.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=g(null);let c=l,h=!1;function u(F,V,Q,X,z){let Y=!1;if(o){const j=m(X,Q,V);c!==j&&(c=j,f(c.object)),Y=v(F,X,Q,z),Y&&y(F,X,Q,z)}else{const j=V.wireframe===!0;(c.geometry!==X.id||c.program!==Q.id||c.wireframe!==j)&&(c.geometry=X.id,c.program=Q.id,c.wireframe=j,Y=!0)}z!==null&&i.update(z,34963),(Y||h)&&(h=!1,M(F,V,Q,X),z!==null&&t.bindBuffer(34963,i.get(z).buffer))}function d(){return n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(F){return n.isWebGL2?t.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return n.isWebGL2?t.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function m(F,V,Q){const X=Q.wireframe===!0;let z=a[F.id];z===void 0&&(z={},a[F.id]=z);let Y=z[V.id];Y===void 0&&(Y={},z[V.id]=Y);let j=Y[X];return j===void 0&&(j=g(d()),Y[X]=j),j}function g(F){const V=[],Q=[],X=[];for(let z=0;z<r;z++)V[z]=0,Q[z]=0,X[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:Q,attributeDivisors:X,object:F,attributes:{},index:null}}function v(F,V,Q,X){const z=c.attributes,Y=V.attributes;let j=0;const J=Q.getAttributes();for(const H in J)if(J[H].location>=0){const K=z[H];let ne=Y[H];if(ne===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(ne=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(ne=F.instanceColor)),K===void 0||K.attribute!==ne||ne&&K.data!==ne.data)return!0;j++}return c.attributesNum!==j||c.index!==X}function y(F,V,Q,X){const z={},Y=V.attributes;let j=0;const J=Q.getAttributes();for(const H in J)if(J[H].location>=0){let K=Y[H];K===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(K=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(K=F.instanceColor));const ne={};ne.attribute=K,K&&K.data&&(ne.data=K.data),z[H]=ne,j++}c.attributes=z,c.attributesNum=j,c.index=X}function x(){const F=c.newAttributes;for(let V=0,Q=F.length;V<Q;V++)F[V]=0}function b(F){S(F,0)}function S(F,V){const Q=c.newAttributes,X=c.enabledAttributes,z=c.attributeDivisors;Q[F]=1,X[F]===0&&(t.enableVertexAttribArray(F),X[F]=1),z[F]!==V&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,V),z[F]=V)}function A(){const F=c.newAttributes,V=c.enabledAttributes;for(let Q=0,X=V.length;Q<X;Q++)V[Q]!==F[Q]&&(t.disableVertexAttribArray(Q),V[Q]=0)}function E(F,V,Q,X,z,Y){n.isWebGL2===!0&&(Q===5124||Q===5125)?t.vertexAttribIPointer(F,V,Q,z,Y):t.vertexAttribPointer(F,V,Q,X,z,Y)}function M(F,V,Q,X){if(n.isWebGL2===!1&&(F.isInstancedMesh||X.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();const z=X.attributes,Y=Q.getAttributes(),j=V.defaultAttributeValues;for(const J in Y){const H=Y[J];if(H.location>=0){let Z=z[J];if(Z===void 0&&(J==="instanceMatrix"&&F.instanceMatrix&&(Z=F.instanceMatrix),J==="instanceColor"&&F.instanceColor&&(Z=F.instanceColor)),Z!==void 0){const K=Z.normalized,ne=Z.itemSize,W=i.get(Z);if(W===void 0)continue;const ve=W.buffer,de=W.type,pe=W.bytesPerElement;if(Z.isInterleavedBufferAttribute){const ce=Z.data,ye=ce.stride,ae=Z.offset;if(ce.isInstancedInterleavedBuffer){for(let le=0;le<H.locationSize;le++)S(H.location+le,ce.meshPerAttribute);F.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=ce.meshPerAttribute*ce.count)}else for(let le=0;le<H.locationSize;le++)b(H.location+le);t.bindBuffer(34962,ve);for(let le=0;le<H.locationSize;le++)E(H.location+le,ne/H.locationSize,de,K,ye*pe,(ae+ne/H.locationSize*le)*pe)}else{if(Z.isInstancedBufferAttribute){for(let ce=0;ce<H.locationSize;ce++)S(H.location+ce,Z.meshPerAttribute);F.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let ce=0;ce<H.locationSize;ce++)b(H.location+ce);t.bindBuffer(34962,ve);for(let ce=0;ce<H.locationSize;ce++)E(H.location+ce,ne/H.locationSize,de,K,ne*pe,ne/H.locationSize*ce*pe)}}else if(j!==void 0){const K=j[J];if(K!==void 0)switch(K.length){case 2:t.vertexAttrib2fv(H.location,K);break;case 3:t.vertexAttrib3fv(H.location,K);break;case 4:t.vertexAttrib4fv(H.location,K);break;default:t.vertexAttrib1fv(H.location,K)}}}}A()}function T(){k();for(const F in a){const V=a[F];for(const Q in V){const X=V[Q];for(const z in X)p(X[z].object),delete X[z];delete V[Q]}delete a[F]}}function P(F){if(a[F.id]===void 0)return;const V=a[F.id];for(const Q in V){const X=V[Q];for(const z in X)p(X[z].object),delete X[z];delete V[Q]}delete a[F.id]}function I(F){for(const V in a){const Q=a[V];if(Q[F.id]===void 0)continue;const X=Q[F.id];for(const z in X)p(X[z].object),delete X[z];delete Q[F.id]}}function k(){R(),h=!0,c!==l&&(c=l,f(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:k,resetDefaultState:R,dispose:T,releaseStatesOfGeometry:P,releaseStatesOfProgram:I,initAttributes:x,enableAttribute:b,disableUnusedAttributes:A}}function dhe(t,e,i,n){const r=n.isWebGL2;let s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function fhe(t,e,i){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext;let a=i.precision!==void 0?i.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),m=t.getParameter(34921),g=t.getParameter(36347),v=t.getParameter(36348),y=t.getParameter(36349),x=d>0,b=o||e.has("OES_texture_float"),S=x&&b,A=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:A}}function phe(t){const e=this;let i=null,n=0,r=!1,s=!1;const o=new kh,a=new Ps,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){const p=u.clippingPlanes,m=u.clipIntersection,g=u.clipShadows,v=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{const y=s?0:n,x=y*4;let b=v.clippingState||null;l.value=b,b=h(p,d,x,f);for(let S=0;S!==x;++S)b[S]=i[S];v.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(u,d,f,p){const m=u!==null?u.length:0;let g=null;if(m!==0){if(g=l.value,p!==!0||g===null){const v=f+m*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let x=0,b=f;x!==m;++x,b+=4)o.copy(u[x]).applyMatrix4(y,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function mhe(t){let e=new WeakMap;function i(o,a){return a===V1?o.mapping=Ed:a===H1&&(o.mapping=Td),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===V1||a===H1)if(e.has(o)){const l=e.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new KF(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Ra extends G_{constructor(e=-1,i=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+i,l=r-i;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const jg=4,d5=[.125,.215,.35,.446,.526,.582],Wf=20,UP=new Ra,f5=new ct;let GP=null;const Ff=(1+Math.sqrt(5))/2,zm=1/Ff,p5=[new ie(1,1,1),new ie(-1,1,1),new ie(1,1,-1),new ie(-1,1,-1),new ie(0,Ff,zm),new ie(0,Ff,-zm),new ie(zm,0,Ff),new ie(-zm,0,Ff),new ie(Ff,zm,0),new ie(-Ff,zm,0)];class iB{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,n=.1,r=100){GP=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=v5(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=g5(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(GP),e.scissorTest=!1,nS(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Ed||e.mapping===Td?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),GP=this._renderer.getRenderTarget();const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:bi,minFilter:bi,generateMipmaps:!1,type:Hv,format:Ys,encoding:Dd,depthBuffer:!1},r=m5(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=m5(e,i,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ghe(s)),this._blurMaterial=vhe(s,e,i)}return r}_compileMaterial(e){const i=new cr(this._lodPlanes[0],e);this._renderer.compile(i,UP)}_sceneToCubeUV(e,i,n,r){const a=new sn(90,1,i,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,d=h.toneMapping;h.getClearColor(f5),h.toneMapping=Al,h.autoClear=!1;const f=new Bo({name:"PMREM.Background",side:so,depthWrite:!1,depthTest:!1}),p=new cr(new Xd,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(f5),m=!0);for(let v=0;v<6;v++){const y=v%3;y===0?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):y===1?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const x=this._cubeSize;nS(r,y*x,v>2?x:0,x,x),h.setRenderTarget(r),m&&h.render(p,a),h.render(e,a)}p.geometry.dispose(),p.material.dispose(),h.toneMapping=d,h.autoClear=u,e.background=g}_textureToCubeUV(e,i){const n=this._renderer,r=e.mapping===Ed||e.mapping===Td;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=v5()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=g5());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new cr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;nS(i,0,0,3*l,2*l),n.setRenderTarget(i),n.render(o,UP)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=p5[(r-1)%p5.length];this._blur(e,r-1,r,s,o)}i.autoClear=n}_blur(e,i,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,i,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,i,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new cr(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Wf-1),m=s/p,g=isFinite(s)?1+Math.floor(h*m):Wf;g>Wf&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Wf}`);const v=[];let y=0;for(let E=0;E<Wf;++E){const M=E/m,T=Math.exp(-M*M/2);v.push(T),E===0?y+=T:E<g&&(y+=2*T)}for(let E=0;E<v.length;E++)v[E]=v[E]/y;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=v,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:x}=this;d.dTheta.value=p,d.mipInt.value=x-n;const b=this._sizeLods[r],S=3*b*(r>x-jg?r-x+jg:0),A=4*(this._cubeSize-b);nS(i,S,A,3*b,2*b),l.setRenderTarget(i),l.render(u,UP)}}function ghe(t){const e=[],i=[],n=[];let r=t;const s=t-jg+1+d5.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);i.push(a);let l=1/a;o>t-jg?l=d5[o-t+jg-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,m=3,g=2,v=1,y=new Float32Array(m*p*f),x=new Float32Array(g*p*f),b=new Float32Array(v*p*f);for(let A=0;A<f;A++){const E=A%3*2/3-1,M=A>2?0:-1,T=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];y.set(T,m*p*A),x.set(d,g*p*A);const P=[A,A,A,A,A,A];b.set(P,v*p*A)}const S=new $t;S.setAttribute("position",new Ai(y,m)),S.setAttribute("uv",new Ai(x,g)),S.setAttribute("faceIndex",new Ai(b,v)),e.push(S),r>jg&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function m5(t,e,i){const n=new Tl(t,e,i);return n.texture.mapping=A0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function nS(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function vhe(t,e,i){const n=new Float32Array(Wf),r=new ie(0,1,0);return new Pl({name:"SphericalGaussianBlur",defines:{n:Wf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:ZF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function g5(){return new Pl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ZF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function v5(){return new Pl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ZF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ou,depthTest:!1,depthWrite:!1})}function ZF(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function yhe(t){let e=new WeakMap,i=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===V1||l===H1,h=l===Ed||l===Td;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return i===null&&(i=new iB(t)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new iB(t));const d=c?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function xhe(t){const e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function _he(t,e,i,n){const r={},s=new WeakMap;function o(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){const d=u.attributes;for(const p in d)e.update(d[p],34962);const f=u.morphAttributes;for(const p in f){const m=f[p];for(let g=0,v=m.length;g<v;g++)e.update(m[g],34962)}}function c(u){const d=[],f=u.index,p=u.attributes.position;let m=0;if(f!==null){const y=f.array;m=f.version;for(let x=0,b=y.length;x<b;x+=3){const S=y[x+0],A=y[x+1],E=y[x+2];d.push(S,A,A,E,E,S)}}else{const y=p.array;m=p.version;for(let x=0,b=y.length/3-1;x<b;x+=3){const S=x+0,A=x+1,E=x+2;d.push(S,A,A,E,E,S)}}const g=new(rQ(d)?QF:YF)(d,1);g.version=m;const v=s.get(u);v&&e.remove(v),s.set(u,g)}function h(u){const d=s.get(u);if(d){const f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function whe(t,e,i,n){const r=n.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let m,g;if(r)m=t,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function bhe(t){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function She(t,e){return t[0]-e[0]}function Ahe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Mhe(t,e,i){const n={},r=new Float32Array(8),s=new WeakMap,o=new Ci,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){const f=c.morphTargetInfluences;if(e.isWebGL2===!0){const m=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,g=m!==void 0?m.length:0;let v=s.get(h);if(v===void 0||v.count!==g){let Q=function(){F.dispose(),s.delete(h),h.removeEventListener("dispose",Q)};var p=Q;v!==void 0&&v.texture.dispose();const b=h.morphAttributes.position!==void 0,S=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,E=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],T=h.morphAttributes.color||[];let P=0;b===!0&&(P=1),S===!0&&(P=2),A===!0&&(P=3);let I=h.attributes.position.count*P,k=1;I>e.maxTextureSize&&(k=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const R=new Float32Array(I*k*4*g),F=new XE(R,I,k,g);F.type=Eu,F.needsUpdate=!0;const V=P*4;for(let X=0;X<g;X++){const z=E[X],Y=M[X],j=T[X],J=I*k*4*X;for(let H=0;H<z.count;H++){const Z=H*V;b===!0&&(o.fromBufferAttribute(z,H),R[J+Z+0]=o.x,R[J+Z+1]=o.y,R[J+Z+2]=o.z,R[J+Z+3]=0),S===!0&&(o.fromBufferAttribute(Y,H),R[J+Z+4]=o.x,R[J+Z+5]=o.y,R[J+Z+6]=o.z,R[J+Z+7]=0),A===!0&&(o.fromBufferAttribute(j,H),R[J+Z+8]=o.x,R[J+Z+9]=o.y,R[J+Z+10]=o.z,R[J+Z+11]=j.itemSize===4?o.w:1)}}v={count:g,texture:F,size:new Ve(I,k)},s.set(h,v),h.addEventListener("dispose",Q)}let y=0;for(let b=0;b<f.length;b++)y+=f[b];const x=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",x),d.getUniforms().setValue(t,"morphTargetInfluences",f),d.getUniforms().setValue(t,"morphTargetsTexture",v.texture,i),d.getUniforms().setValue(t,"morphTargetsTextureSize",v.size)}else{const m=f===void 0?0:f.length;let g=n[h.id];if(g===void 0||g.length!==m){g=[];for(let S=0;S<m;S++)g[S]=[S,0];n[h.id]=g}for(let S=0;S<m;S++){const A=g[S];A[0]=S,A[1]=f[S]}g.sort(Ahe);for(let S=0;S<8;S++)S<m&&g[S][1]?(a[S][0]=g[S][0],a[S][1]=g[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(She);const v=h.morphAttributes.position,y=h.morphAttributes.normal;let x=0;for(let S=0;S<8;S++){const A=a[S],E=A[0],M=A[1];E!==Number.MAX_SAFE_INTEGER&&M?(v&&h.getAttribute("morphTarget"+S)!==v[E]&&h.setAttribute("morphTarget"+S,v[E]),y&&h.getAttribute("morphNormal"+S)!==y[E]&&h.setAttribute("morphNormal"+S,y[E]),r[S]=M,x+=M):(v&&h.hasAttribute("morphTarget"+S)===!0&&h.deleteAttribute("morphTarget"+S),y&&h.hasAttribute("morphNormal"+S)===!0&&h.deleteAttribute("morphNormal"+S),r[S]=0)}const b=h.morphTargetsRelative?1:1-x;d.getUniforms().setValue(t,"morphTargetBaseInfluence",b),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function Che(t,e,i,n){let r=new WeakMap;function s(l){const c=n.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}const cQ=new on,uQ=new XE,hQ=new qF,dQ=new V_,y5=[],x5=[],_5=new Float32Array(16),w5=new Float32Array(9),b5=new Float32Array(4);function M0(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let s=y5[r];if(s===void 0&&(s=new Float32Array(r),y5[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function dr(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function fr(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function YE(t,e){let i=x5[e];i===void 0&&(i=new Int32Array(e),x5[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Ehe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function The(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(dr(i,e))return;t.uniform2fv(this.addr,e),fr(i,e)}}function Phe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(dr(i,e))return;t.uniform3fv(this.addr,e),fr(i,e)}}function Dhe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(dr(i,e))return;t.uniform4fv(this.addr,e),fr(i,e)}}function Ihe(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(dr(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),fr(i,e)}else{if(dr(i,n))return;b5.set(n),t.uniformMatrix2fv(this.addr,!1,b5),fr(i,n)}}function Lhe(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(dr(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),fr(i,e)}else{if(dr(i,n))return;w5.set(n),t.uniformMatrix3fv(this.addr,!1,w5),fr(i,n)}}function Bhe(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(dr(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),fr(i,e)}else{if(dr(i,n))return;_5.set(n),t.uniformMatrix4fv(this.addr,!1,_5),fr(i,n)}}function Rhe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Ohe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(dr(i,e))return;t.uniform2iv(this.addr,e),fr(i,e)}}function Fhe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(dr(i,e))return;t.uniform3iv(this.addr,e),fr(i,e)}}function Nhe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(dr(i,e))return;t.uniform4iv(this.addr,e),fr(i,e)}}function khe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function zhe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(dr(i,e))return;t.uniform2uiv(this.addr,e),fr(i,e)}}function Uhe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(dr(i,e))return;t.uniform3uiv(this.addr,e),fr(i,e)}}function Ghe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(dr(i,e))return;t.uniform4uiv(this.addr,e),fr(i,e)}}function Vhe(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||cQ,r)}function Hhe(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||hQ,r)}function jhe(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||dQ,r)}function Whe(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||uQ,r)}function Xhe(t){switch(t){case 5126:return Ehe;case 35664:return The;case 35665:return Phe;case 35666:return Dhe;case 35674:return Ihe;case 35675:return Lhe;case 35676:return Bhe;case 5124:case 35670:return Rhe;case 35667:case 35671:return Ohe;case 35668:case 35672:return Fhe;case 35669:case 35673:return Nhe;case 5125:return khe;case 36294:return zhe;case 36295:return Uhe;case 36296:return Ghe;case 35678:case 36198:case 36298:case 36306:case 35682:return Vhe;case 35679:case 36299:case 36307:return Hhe;case 35680:case 36300:case 36308:case 36293:return jhe;case 36289:case 36303:case 36311:case 36292:return Whe}}function qhe(t,e){t.uniform1fv(this.addr,e)}function Yhe(t,e){const i=M0(e,this.size,2);t.uniform2fv(this.addr,i)}function Qhe(t,e){const i=M0(e,this.size,3);t.uniform3fv(this.addr,i)}function Jhe(t,e){const i=M0(e,this.size,4);t.uniform4fv(this.addr,i)}function Khe(t,e){const i=M0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function Zhe(t,e){const i=M0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function $he(t,e){const i=M0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function ede(t,e){t.uniform1iv(this.addr,e)}function tde(t,e){t.uniform2iv(this.addr,e)}function ide(t,e){t.uniform3iv(this.addr,e)}function nde(t,e){t.uniform4iv(this.addr,e)}function rde(t,e){t.uniform1uiv(this.addr,e)}function sde(t,e){t.uniform2uiv(this.addr,e)}function ode(t,e){t.uniform3uiv(this.addr,e)}function ade(t,e){t.uniform4uiv(this.addr,e)}function lde(t,e,i){const n=this.cache,r=e.length,s=YE(i,r);dr(n,s)||(t.uniform1iv(this.addr,s),fr(n,s));for(let o=0;o!==r;++o)i.setTexture2D(e[o]||cQ,s[o])}function cde(t,e,i){const n=this.cache,r=e.length,s=YE(i,r);dr(n,s)||(t.uniform1iv(this.addr,s),fr(n,s));for(let o=0;o!==r;++o)i.setTexture3D(e[o]||hQ,s[o])}function ude(t,e,i){const n=this.cache,r=e.length,s=YE(i,r);dr(n,s)||(t.uniform1iv(this.addr,s),fr(n,s));for(let o=0;o!==r;++o)i.setTextureCube(e[o]||dQ,s[o])}function hde(t,e,i){const n=this.cache,r=e.length,s=YE(i,r);dr(n,s)||(t.uniform1iv(this.addr,s),fr(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(e[o]||uQ,s[o])}function dde(t){switch(t){case 5126:return qhe;case 35664:return Yhe;case 35665:return Qhe;case 35666:return Jhe;case 35674:return Khe;case 35675:return Zhe;case 35676:return $he;case 5124:case 35670:return ede;case 35667:case 35671:return tde;case 35668:case 35672:return ide;case 35669:case 35673:return nde;case 5125:return rde;case 36294:return sde;case 36295:return ode;case 36296:return ade;case 35678:case 36198:case 36298:case 36306:case 35682:return lde;case 35679:case 36299:case 36307:return cde;case 35680:case 36300:case 36308:case 36293:return ude;case 36289:case 36303:case 36311:case 36292:return hde}}class fde{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.setValue=Xhe(i.type)}}class pde{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.size=i.size,this.setValue=dde(i.type)}}class mde{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,i[a.id],n)}}}const VP=/(\w+)(\])?(\[|\.)?/g;function S5(t,e){t.seq.push(e),t.map[e.id]=e}function gde(t,e,i){const n=t.name,r=n.length;for(VP.lastIndex=0;;){const s=VP.exec(n),o=VP.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){S5(i,c===void 0?new fde(a,t,e):new pde(a,t,e));break}else{let u=i.map[a];u===void 0&&(u=new mde(a),S5(i,u)),i=u}}}class vM{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(i,r),o=e.getUniformLocation(i,s.name);gde(s,o,this)}}setValue(e,i,n,r){const s=this.map[i];s!==void 0&&s.setValue(e,n,r)}setOptional(e,i,n){const r=i[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,i,n,r){for(let s=0,o=i.length;s!==o;++s){const a=i[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,i){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in i&&n.push(o)}return n}}function A5(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}let vde=0;function yde(t,e){const i=t.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function xde(t){switch(t){case Dd:return["Linear","( value )"];case Yi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function M5(t,e,i){const n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+yde(t.getShaderSource(e),o)}else return r}function _de(t,e){const i=xde(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function wde(t,e){let i;switch(e){case PY:i="Linear";break;case DY:i="Reinhard";break;case IY:i="OptimizedCineon";break;case GF:i="ACESFilmic";break;case LY:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function bde(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Cx).join(`
`)}function Sde(t){const e=[];for(const i in t){const n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function Ade(t,e){const i={},n=t.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function Cx(t){return t!==""}function C5(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function E5(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Mde=/^[ \t]*#include +<([\w\d./]+)>/gm;function nB(t){return t.replace(Mde,Cde)}function Cde(t,e){const i=ni[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return nB(i)}const Ede=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function T5(t){return t.replace(Ede,Tde)}function Tde(t,e,i,n){let r="";for(let s=parseInt(e);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function P5(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Pde(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===VE?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Qx?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===tp&&(e="SHADOWMAP_TYPE_VSM"),e}function Dde(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ed:case Td:e="ENVMAP_TYPE_CUBE";break;case A0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ide(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Td:e="ENVMAP_MODE_REFRACTION";break}return e}function Lde(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case k_:e="ENVMAP_BLENDING_MULTIPLY";break;case EY:e="ENVMAP_BLENDING_MIX";break;case TY:e="ENVMAP_BLENDING_ADD";break}return e}function Bde(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Rde(t,e,i,n){const r=t.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=Pde(i),c=Dde(i),h=Ide(i),u=Lde(i),d=Bde(i),f=i.isWebGL2?"":bde(i),p=Sde(s),m=r.createProgram();let g,v,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(g=[p].filter(Cx).join(`
`),g.length>0&&(g+=`
`),v=[f,p].filter(Cx).join(`
`),v.length>0&&(v+=`
`)):(g=[P5(i),"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Cx).join(`
`),v=[f,P5(i),"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Al?"#define TONE_MAPPING":"",i.toneMapping!==Al?ni.tonemapping_pars_fragment:"",i.toneMapping!==Al?wde("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",ni.encodings_pars_fragment,_de("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Cx).join(`
`)),o=nB(o),o=C5(o,i),o=E5(o,i),a=nB(a),a=C5(a,i),a=E5(a,i),o=T5(o),a=T5(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",i.glslVersion===eB?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===eB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const x=y+g+o,b=y+v+a,S=A5(r,35633,x),A=A5(r,35632,b);if(r.attachShader(m,S),r.attachShader(m,A),i.index0AttributeName!==void 0?r.bindAttribLocation(m,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const T=r.getProgramInfoLog(m).trim(),P=r.getShaderInfoLog(S).trim(),I=r.getShaderInfoLog(A).trim();let k=!0,R=!0;if(r.getProgramParameter(m,35714)===!1){k=!1;const F=M5(r,S,"vertex"),V=M5(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+`

Program Info Log: `+T+`
`+F+`
`+V)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(P===""||I==="")&&(R=!1);R&&(this.diagnostics={runnable:k,programLog:T,vertexShader:{log:P,prefix:g},fragmentShader:{log:I,prefix:v}})}r.deleteShader(S),r.deleteShader(A);let E;this.getUniforms=function(){return E===void 0&&(E=new vM(r,m)),E};let M;return this.getAttributes=function(){return M===void 0&&(M=Ade(r,m)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=i.shaderName,this.id=vde++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=A,this}let Ode=0;class Fde{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(i),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new Nde(e),i.set(e,n)),n}}class Nde{constructor(e){this.id=Ode++,this.code=e,this.usedTimes=0}}function kde(t,e,i,n,r,s,o){const a=new wp,l=new Fde,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(M,T,P,I,k){const R=I.fog,F=k.geometry,V=M.isMeshStandardMaterial?I.environment:null,Q=(M.isMeshStandardMaterial?i:e).get(M.envMap||V),X=Q&&Q.mapping===A0?Q.image.height:null,z=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));const Y=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,j=Y!==void 0?Y.length:0;let J=0;F.morphAttributes.position!==void 0&&(J=1),F.morphAttributes.normal!==void 0&&(J=2),F.morphAttributes.color!==void 0&&(J=3);let H,Z,K,ne;if(z){const ye=fl[z];H=ye.vertexShader,Z=ye.fragmentShader}else H=M.vertexShader,Z=M.fragmentShader,l.update(M),K=l.getVertexShaderID(M),ne=l.getFragmentShaderID(M);const W=t.getRenderTarget(),ve=M.alphaTest>0,de=M.clearcoat>0,pe=M.iridescence>0;return{isWebGL2:h,shaderID:z,shaderName:M.type,vertexShader:H,fragmentShader:Z,defines:M.defines,customVertexShaderID:K,customFragmentShaderID:ne,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:d,outputEncoding:W===null?t.outputEncoding:W.isXRRenderTarget===!0?W.texture.encoding:Dd,map:!!M.map,matcap:!!M.matcap,envMap:!!Q,envMapMode:Q&&Q.mapping,envMapCubeUVHeight:X,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===eQ,tangentSpaceNormalMap:M.normalMapType===Hd,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===Yi,clearcoat:de,clearcoatMap:de&&!!M.clearcoatMap,clearcoatRoughnessMap:de&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:de&&!!M.clearcoatNormalMap,iridescence:pe,iridescenceMap:pe&&!!M.iridescenceMap,iridescenceThicknessMap:pe&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===gp,alphaMap:!!M.alphaMap,alphaTest:ve,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!F.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!R,useFog:M.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:u,skinning:k.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:j,morphTextureStride:J,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:Al,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===ml,flipSided:M.side===so,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){const T=[];if(M.shaderID?T.push(M.shaderID):(T.push(M.customVertexShaderID),T.push(M.customFragmentShaderID)),M.defines!==void 0)for(const P in M.defines)T.push(P),T.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(v(T,M),y(T,M),T.push(t.outputEncoding)),T.push(M.customProgramCacheKey),T.join()}function v(M,T){M.push(T.precision),M.push(T.outputEncoding),M.push(T.envMapMode),M.push(T.envMapCubeUVHeight),M.push(T.combine),M.push(T.vertexUvs),M.push(T.fogExp2),M.push(T.sizeAttenuation),M.push(T.morphTargetsCount),M.push(T.morphAttributeCount),M.push(T.numDirLights),M.push(T.numPointLights),M.push(T.numSpotLights),M.push(T.numSpotLightMaps),M.push(T.numHemiLights),M.push(T.numRectAreaLights),M.push(T.numDirLightShadows),M.push(T.numPointLightShadows),M.push(T.numSpotLightShadows),M.push(T.numSpotLightShadowsWithMaps),M.push(T.shadowMapType),M.push(T.toneMapping),M.push(T.numClippingPlanes),M.push(T.numClipIntersection),M.push(T.depthPacking)}function y(M,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.map&&a.enable(4),T.matcap&&a.enable(5),T.envMap&&a.enable(6),T.lightMap&&a.enable(7),T.aoMap&&a.enable(8),T.emissiveMap&&a.enable(9),T.bumpMap&&a.enable(10),T.normalMap&&a.enable(11),T.objectSpaceNormalMap&&a.enable(12),T.tangentSpaceNormalMap&&a.enable(13),T.clearcoat&&a.enable(14),T.clearcoatMap&&a.enable(15),T.clearcoatRoughnessMap&&a.enable(16),T.clearcoatNormalMap&&a.enable(17),T.iridescence&&a.enable(18),T.iridescenceMap&&a.enable(19),T.iridescenceThicknessMap&&a.enable(20),T.displacementMap&&a.enable(21),T.specularMap&&a.enable(22),T.roughnessMap&&a.enable(23),T.metalnessMap&&a.enable(24),T.gradientMap&&a.enable(25),T.alphaMap&&a.enable(26),T.alphaTest&&a.enable(27),T.vertexColors&&a.enable(28),T.vertexAlphas&&a.enable(29),T.vertexUvs&&a.enable(30),T.vertexTangents&&a.enable(31),T.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.physicallyCorrectLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.specularIntensityMap&&a.enable(15),T.specularColorMap&&a.enable(16),T.transmission&&a.enable(17),T.transmissionMap&&a.enable(18),T.thicknessMap&&a.enable(19),T.sheen&&a.enable(20),T.sheenColorMap&&a.enable(21),T.sheenRoughnessMap&&a.enable(22),T.decodeVideoTexture&&a.enable(23),T.opaque&&a.enable(24),M.push(a.mask)}function x(M){const T=p[M.type];let P;if(T){const I=fl[T];P=aQ.clone(I.uniforms)}else P=M.uniforms;return P}function b(M,T){let P;for(let I=0,k=c.length;I<k;I++){const R=c[I];if(R.cacheKey===T){P=R,++P.usedTimes;break}}return P===void 0&&(P=new Rde(t,T,M,s),c.push(P)),P}function S(M){if(--M.usedTimes===0){const T=c.indexOf(M);c[T]=c[c.length-1],c.pop(),M.destroy()}}function A(M){l.remove(M)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:b,releaseProgram:S,releaseShaderCache:A,programs:c,dispose:E}}function zde(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function n(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function Ude(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function D5(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function I5(){const t=[];let e=0;const i=[],n=[],r=[];function s(){e=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,m,g){let v=t[e];return v===void 0?(v={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:m,group:g},t[e]=v):(v.id=u.id,v.object=u,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=u.renderOrder,v.z=m,v.group=g),e++,v}function a(u,d,f,p,m,g){const v=o(u,d,f,p,m,g);f.transmission>0?n.push(v):f.transparent===!0?r.push(v):i.push(v)}function l(u,d,f,p,m,g){const v=o(u,d,f,p,m,g);f.transmission>0?n.unshift(v):f.transparent===!0?r.unshift(v):i.unshift(v)}function c(u,d){i.length>1&&i.sort(u||Ude),n.length>1&&n.sort(d||D5),r.length>1&&r.sort(d||D5)}function h(){for(let u=e,d=t.length;u<d;u++){const f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function Gde(){let t=new WeakMap;function e(n,r){const s=t.get(n);let o;return s===void 0?(o=new I5,t.set(n,[o])):r>=s.length?(o=new I5,s.push(o)):o=s[r],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function Vde(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new ie,color:new ct};break;case"SpotLight":i={position:new ie,direction:new ie,color:new ct,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ie,color:new ct,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ie,skyColor:new ct,groundColor:new ct};break;case"RectAreaLight":i={color:new ct,position:new ie,halfWidth:new ie,halfHeight:new ie};break}return t[e.id]=i,i}}}function Hde(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}let jde=0;function Wde(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Xde(t,e){const i=new Vde,n=Hde(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new ie);const s=new ie,o=new Nt,a=new Nt;function l(h,u){let d=0,f=0,p=0;for(let I=0;I<9;I++)r.probe[I].set(0,0,0);let m=0,g=0,v=0,y=0,x=0,b=0,S=0,A=0,E=0,M=0;h.sort(Wde);const T=u!==!0?Math.PI:1;for(let I=0,k=h.length;I<k;I++){const R=h[I],F=R.color,V=R.intensity,Q=R.distance,X=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)d+=F.r*V*T,f+=F.g*V*T,p+=F.b*V*T;else if(R.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(R.sh.coefficients[z],V);else if(R.isDirectionalLight){const z=i.get(R);if(z.color.copy(R.color).multiplyScalar(R.intensity*T),R.castShadow){const Y=R.shadow,j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,r.directionalShadow[m]=j,r.directionalShadowMap[m]=X,r.directionalShadowMatrix[m]=R.shadow.matrix,b++}r.directional[m]=z,m++}else if(R.isSpotLight){const z=i.get(R);z.position.setFromMatrixPosition(R.matrixWorld),z.color.copy(F).multiplyScalar(V*T),z.distance=Q,z.coneCos=Math.cos(R.angle),z.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),z.decay=R.decay,r.spot[v]=z;const Y=R.shadow;if(R.map&&(r.spotLightMap[E]=R.map,E++,Y.updateMatrices(R),R.castShadow&&M++),r.spotLightMatrix[v]=Y.matrix,R.castShadow){const j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,r.spotShadow[v]=j,r.spotShadowMap[v]=X,A++}v++}else if(R.isRectAreaLight){const z=i.get(R);z.color.copy(F).multiplyScalar(V),z.halfWidth.set(R.width*.5,0,0),z.halfHeight.set(0,R.height*.5,0),r.rectArea[y]=z,y++}else if(R.isPointLight){const z=i.get(R);if(z.color.copy(R.color).multiplyScalar(R.intensity*T),z.distance=R.distance,z.decay=R.decay,R.castShadow){const Y=R.shadow,j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,j.shadowCameraNear=Y.camera.near,j.shadowCameraFar=Y.camera.far,r.pointShadow[g]=j,r.pointShadowMap[g]=X,r.pointShadowMatrix[g]=R.shadow.matrix,S++}r.point[g]=z,g++}else if(R.isHemisphereLight){const z=i.get(R);z.skyColor.copy(R.color).multiplyScalar(V*T),z.groundColor.copy(R.groundColor).multiplyScalar(V*T),r.hemi[x]=z,x++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=st.LTC_FLOAT_1,r.rectAreaLTC2=st.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=st.LTC_HALF_1,r.rectAreaLTC2=st.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==m||P.pointLength!==g||P.spotLength!==v||P.rectAreaLength!==y||P.hemiLength!==x||P.numDirectionalShadows!==b||P.numPointShadows!==S||P.numSpotShadows!==A||P.numSpotMaps!==E)&&(r.directional.length=m,r.spot.length=v,r.rectArea.length=y,r.point.length=g,r.hemi.length=x,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=S,r.pointShadowMap.length=S,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=S,r.spotLightMatrix.length=A+E-M,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=M,P.directionalLength=m,P.pointLength=g,P.spotLength=v,P.rectAreaLength=y,P.hemiLength=x,P.numDirectionalShadows=b,P.numPointShadows=S,P.numSpotShadows=A,P.numSpotMaps=E,r.version=jde++)}function c(h,u){let d=0,f=0,p=0,m=0,g=0;const v=u.matrixWorldInverse;for(let y=0,x=h.length;y<x;y++){const b=h[y];if(b.isDirectionalLight){const S=r.directional[d];S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),d++}else if(b.isSpotLight){const S=r.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),p++}else if(b.isRectAreaLight){const S=r.rectArea[m];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const S=r.point[f];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){const S=r.hemi[g];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:r}}function L5(t,e){const i=new Xde(t,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(u){n.push(u)}function a(u){r.push(u)}function l(u){i.setup(n,u)}function c(u){i.setupView(n,u)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function qde(t,e){let i=new WeakMap;function n(s,o=0){const a=i.get(s);let l;return a===void 0?(l=new L5(t,e),i.set(s,[l])):o>=a.length?(l=new L5(t,e),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}class $F extends Zn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ZY,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class eN extends Zn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new ie,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Yde=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Qde=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Jde(t,e,i){let n=new qE;const r=new Ve,s=new Ve,o=new Ci,a=new $F({depthPacking:$Y}),l=new eN,c={},h=i.maxTextureSize,u={[Ec]:so,[so]:Ec,[ml]:ml},d=new Pl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ve},radius:{value:4}},vertexShader:Yde,fragmentShader:Qde}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new $t;p.setAttribute("position",new Ai(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new cr(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=VE,this.render=function(b,S,A){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;const E=t.getRenderTarget(),M=t.getActiveCubeFace(),T=t.getActiveMipmapLevel(),P=t.state;P.setBlending(Ou),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let I=0,k=b.length;I<k;I++){const R=b[I],F=R.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",R,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);const V=F.getFrameExtents();if(r.multiply(V),s.copy(F.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/V.x),r.x=s.x*V.x,F.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/V.y),r.y=s.y*V.y,F.mapSize.y=s.y)),F.map===null){const X=this.type!==tp?{minFilter:Sn,magFilter:Sn}:{};F.map=new Tl(r.x,r.y,X),F.map.texture.name=R.name+".shadowMap",F.camera.updateProjectionMatrix()}t.setRenderTarget(F.map),t.clear();const Q=F.getViewportCount();for(let X=0;X<Q;X++){const z=F.getViewport(X);o.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),P.viewport(o),F.updateMatrices(R,X),n=F.getFrustum(),x(S,A,F.camera,R,this.type)}F.isPointLightShadow!==!0&&this.type===tp&&v(F,A),F.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(E,M,T)};function v(b,S){const A=e.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Tl(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(S,null,A,d,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(S,null,A,f,m,null)}function y(b,S,A,E,M,T){let P=null;const I=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(I!==void 0)P=I;else if(P=A.isPointLight===!0?l:a,t.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const k=P.uuid,R=S.uuid;let F=c[k];F===void 0&&(F={},c[k]=F);let V=F[R];V===void 0&&(V=P.clone(),F[R]=V),P=V}return P.visible=S.visible,P.wireframe=S.wireframe,T===tp?P.side=S.shadowSide!==null?S.shadowSide:S.side:P.side=S.shadowSide!==null?S.shadowSide:u[S.side],P.alphaMap=S.alphaMap,P.alphaTest=S.alphaTest,P.map=S.map,P.clipShadows=S.clipShadows,P.clippingPlanes=S.clippingPlanes,P.clipIntersection=S.clipIntersection,P.displacementMap=S.displacementMap,P.displacementScale=S.displacementScale,P.displacementBias=S.displacementBias,P.wireframeLinewidth=S.wireframeLinewidth,P.linewidth=S.linewidth,A.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(A.matrixWorld),P.nearDistance=E,P.farDistance=M),P}function x(b,S,A,E,M){if(b.visible===!1)return;if(b.layers.test(S.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&M===tp)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);const I=e.update(b),k=b.material;if(Array.isArray(k)){const R=I.groups;for(let F=0,V=R.length;F<V;F++){const Q=R[F],X=k[Q.materialIndex];if(X&&X.visible){const z=y(b,X,E,A.near,A.far,M);t.renderBufferDirect(A,null,I,z,b,Q)}}}else if(k.visible){const R=y(b,k,E,A.near,A.far,M);t.renderBufferDirect(A,null,I,R,b,null)}}const P=b.children;for(let I=0,k=P.length;I<k;I++)x(P[I],S,A,E,M)}}function Kde(t,e,i){const n=i.isWebGL2;function r(){let q=!1;const oe=new Ci;let xe=null;const Fe=new Ci(0,0,0,0);return{setMask:function(Xe){xe!==Xe&&!q&&(t.colorMask(Xe,Xe,Xe,Xe),xe=Xe)},setLocked:function(Xe){q=Xe},setClear:function(Xe,pt,ti,ui,vr){vr===!0&&(Xe*=ui,pt*=ui,ti*=ui),oe.set(Xe,pt,ti,ui),Fe.equals(oe)===!1&&(t.clearColor(Xe,pt,ti,ui),Fe.copy(oe))},reset:function(){q=!1,xe=null,Fe.set(-1,0,0,0)}}}function s(){let q=!1,oe=null,xe=null,Fe=null;return{setTest:function(Xe){Xe?ve(2929):de(2929)},setMask:function(Xe){oe!==Xe&&!q&&(t.depthMask(Xe),oe=Xe)},setFunc:function(Xe){if(xe!==Xe){switch(Xe){case _Y:t.depthFunc(512);break;case wY:t.depthFunc(519);break;case bY:t.depthFunc(513);break;case sC:t.depthFunc(515);break;case SY:t.depthFunc(514);break;case AY:t.depthFunc(518);break;case MY:t.depthFunc(516);break;case CY:t.depthFunc(517);break;default:t.depthFunc(515)}xe=Xe}},setLocked:function(Xe){q=Xe},setClear:function(Xe){Fe!==Xe&&(t.clearDepth(Xe),Fe=Xe)},reset:function(){q=!1,oe=null,xe=null,Fe=null}}}function o(){let q=!1,oe=null,xe=null,Fe=null,Xe=null,pt=null,ti=null,ui=null,vr=null;return{setTest:function(Pt){q||(Pt?ve(2960):de(2960))},setMask:function(Pt){oe!==Pt&&!q&&(t.stencilMask(Pt),oe=Pt)},setFunc:function(Pt,gn,ki){(xe!==Pt||Fe!==gn||Xe!==ki)&&(t.stencilFunc(Pt,gn,ki),xe=Pt,Fe=gn,Xe=ki)},setOp:function(Pt,gn,ki){(pt!==Pt||ti!==gn||ui!==ki)&&(t.stencilOp(Pt,gn,ki),pt=Pt,ti=gn,ui=ki)},setLocked:function(Pt){q=Pt},setClear:function(Pt){vr!==Pt&&(t.clearStencil(Pt),vr=Pt)},reset:function(){q=!1,oe=null,xe=null,Fe=null,Xe=null,pt=null,ti=null,ui=null,vr=null}}}const a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap;let d={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,I=null,k=null,R=null,F=null;const V=t.getParameter(35661);let Q=!1,X=0;const z=t.getParameter(7938);z.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(z)[1]),Q=X>=1):z.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),Q=X>=2);let Y=null,j={};const J=t.getParameter(3088),H=t.getParameter(2978),Z=new Ci().fromArray(J),K=new Ci().fromArray(H);function ne(q,oe,xe){const Fe=new Uint8Array(4),Xe=t.createTexture();t.bindTexture(q,Xe),t.texParameteri(q,10241,9728),t.texParameteri(q,10240,9728);for(let pt=0;pt<xe;pt++)t.texImage2D(oe+pt,0,6408,1,1,0,6408,5121,Fe);return Xe}const W={};W[3553]=ne(3553,3553,1),W[34067]=ne(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ve(2929),l.setFunc(sC),Be(!1),Ue(ML),ve(2884),Ee(Ou);function ve(q){d[q]!==!0&&(t.enable(q),d[q]=!0)}function de(q){d[q]!==!1&&(t.disable(q),d[q]=!1)}function pe(q,oe){return f[q]!==oe?(t.bindFramebuffer(q,oe),f[q]=oe,n&&(q===36009&&(f[36160]=oe),q===36160&&(f[36009]=oe)),!0):!1}function ce(q,oe){let xe=m,Fe=!1;if(q)if(xe=p.get(oe),xe===void 0&&(xe=[],p.set(oe,xe)),q.isWebGLMultipleRenderTargets){const Xe=q.texture;if(xe.length!==Xe.length||xe[0]!==36064){for(let pt=0,ti=Xe.length;pt<ti;pt++)xe[pt]=36064+pt;xe.length=Xe.length,Fe=!0}}else xe[0]!==36064&&(xe[0]=36064,Fe=!0);else xe[0]!==1029&&(xe[0]=1029,Fe=!0);Fe&&(i.isWebGL2?t.drawBuffers(xe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(xe))}function ye(q){return g!==q?(t.useProgram(q),g=q,!0):!1}const ae={[jf]:32774,[cY]:32778,[uY]:32779};if(n)ae[PL]=32775,ae[DL]=32776;else{const q=e.get("EXT_blend_minmax");q!==null&&(ae[PL]=q.MIN_EXT,ae[DL]=q.MAX_EXT)}const le={[hY]:0,[dY]:1,[fY]:768,[zF]:770,[xY]:776,[vY]:774,[mY]:772,[pY]:769,[UF]:771,[yY]:775,[gY]:773};function Ee(q,oe,xe,Fe,Xe,pt,ti,ui){if(q===Ou){v===!0&&(de(3042),v=!1);return}if(v===!1&&(ve(3042),v=!0),q!==lY){if(q!==y||ui!==T){if((x!==jf||A!==jf)&&(t.blendEquation(32774),x=jf,A=jf),ui)switch(q){case gp:t.blendFuncSeparate(1,771,1,771);break;case CL:t.blendFunc(1,1);break;case EL:t.blendFuncSeparate(0,769,0,1);break;case TL:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case gp:t.blendFuncSeparate(770,771,1,771);break;case CL:t.blendFunc(770,1);break;case EL:t.blendFuncSeparate(0,769,0,1);break;case TL:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}b=null,S=null,E=null,M=null,y=q,T=ui}return}Xe=Xe||oe,pt=pt||xe,ti=ti||Fe,(oe!==x||Xe!==A)&&(t.blendEquationSeparate(ae[oe],ae[Xe]),x=oe,A=Xe),(xe!==b||Fe!==S||pt!==E||ti!==M)&&(t.blendFuncSeparate(le[xe],le[Fe],le[pt],le[ti]),b=xe,S=Fe,E=pt,M=ti),y=q,T=!1}function Te(q,oe){q.side===ml?de(2884):ve(2884);let xe=q.side===so;oe&&(xe=!xe),Be(xe),q.blending===gp&&q.transparent===!1?Ee(Ou):Ee(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);const Fe=q.stencilWrite;c.setTest(Fe),Fe&&(c.setMask(q.stencilWriteMask),c.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),c.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),Pe(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?ve(32926):de(32926)}function Be(q){P!==q&&(q?t.frontFace(2304):t.frontFace(2305),P=q)}function Ue(q){q!==sY?(ve(2884),q!==I&&(q===ML?t.cullFace(1029):q===oY?t.cullFace(1028):t.cullFace(1032))):de(2884),I=q}function Ie(q){q!==k&&(Q&&t.lineWidth(q),k=q)}function Pe(q,oe,xe){q?(ve(32823),(R!==oe||F!==xe)&&(t.polygonOffset(oe,xe),R=oe,F=xe)):de(32823)}function Je(q){q?ve(3089):de(3089)}function Ke(q){q===void 0&&(q=33984+V-1),Y!==q&&(t.activeTexture(q),Y=q)}function U(q,oe,xe){xe===void 0&&(Y===null?xe=33984+V-1:xe=Y);let Fe=j[xe];Fe===void 0&&(Fe={type:void 0,texture:void 0},j[xe]=Fe),(Fe.type!==q||Fe.texture!==oe)&&(Y!==xe&&(t.activeTexture(xe),Y=xe),t.bindTexture(q,oe||W[q]),Fe.type=q,Fe.texture=oe)}function L(){const q=j[Y];q!==void 0&&q.type!==void 0&&(t.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function _e(){try{t.compressedTexImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function we(){try{t.texSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Me(){try{t.texSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function We(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Le(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ue(){try{t.texStorage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ge(){try{t.texStorage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function re(){try{t.texImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function be(){try{t.texImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Re(q){Z.equals(q)===!1&&(t.scissor(q.x,q.y,q.z,q.w),Z.copy(q))}function Ne(q){K.equals(q)===!1&&(t.viewport(q.x,q.y,q.z,q.w),K.copy(q))}function tt(q,oe){let xe=u.get(oe);xe===void 0&&(xe=new WeakMap,u.set(oe,xe));let Fe=xe.get(q);Fe===void 0&&(Fe=t.getUniformBlockIndex(oe,q.name),xe.set(q,Fe))}function xt(q,oe){const Fe=u.get(oe).get(q);h.get(oe)!==Fe&&(t.uniformBlockBinding(oe,Fe,q.__bindingPointIndex),h.set(oe,Fe))}function kt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),n===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},Y=null,j={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,I=null,k=null,R=null,F=null,Z.set(0,0,t.canvas.width,t.canvas.height),K.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:ve,disable:de,bindFramebuffer:pe,drawBuffers:ce,useProgram:ye,setBlending:Ee,setMaterial:Te,setFlipSided:Be,setCullFace:Ue,setLineWidth:Ie,setPolygonOffset:Pe,setScissorTest:Je,activeTexture:Ke,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:_e,texImage2D:re,texImage3D:be,updateUBOMapping:tt,uniformBlockBinding:xt,texStorage2D:ue,texStorage3D:Ge,texSubImage2D:we,texSubImage3D:Me,compressedTexSubImage2D:We,compressedTexSubImage3D:Le,scissor:Re,viewport:Ne,reset:kt}}function Zde(t,e,i,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return v?new OffscreenCanvas(U,L):Y1("canvas")}function x(U,L,te,_e){let we=1;if((U.width>_e||U.height>_e)&&(we=_e/Math.max(U.width,U.height)),we<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){const Me=L?lC:Math.floor,We=Me(we*U.width),Le=Me(we*U.height);m===void 0&&(m=y(We,Le));const ue=te?y(We,Le):m;return ue.width=We,ue.height=Le,ue.getContext("2d").drawImage(U,0,0,We,Le),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+We+"x"+Le+")."),ue}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function b(U){return tB(U.width)&&tB(U.height)}function S(U){return a?!1:U.wrapS!==Hr||U.wrapT!==Hr||U.minFilter!==Sn&&U.minFilter!==bi}function A(U,L){return U.generateMipmaps&&L&&U.minFilter!==Sn&&U.minFilter!==bi}function E(U){t.generateMipmap(U)}function M(U,L,te,_e,we=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Me=L;return L===6403&&(te===5126&&(Me=33326),te===5131&&(Me=33325),te===5121&&(Me=33321)),L===33319&&(te===5126&&(Me=33328),te===5131&&(Me=33327),te===5121&&(Me=33323)),L===6408&&(te===5126&&(Me=34836),te===5131&&(Me=34842),te===5121&&(Me=_e===Yi&&we===!1?35907:32856),te===32819&&(Me=32854),te===32820&&(Me=32855)),(Me===33325||Me===33326||Me===33327||Me===33328||Me===34842||Me===34836)&&e.get("EXT_color_buffer_float"),Me}function T(U,L,te){return A(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==Sn&&U.minFilter!==bi?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===Sn||U===j1||U===fv?9728:9729}function I(U){const L=U.target;L.removeEventListener("dispose",I),R(L),L.isVideoTexture&&p.delete(L)}function k(U){const L=U.target;L.removeEventListener("dispose",k),V(L)}function R(U){const L=n.get(U);if(L.__webglInit===void 0)return;const te=U.source,_e=g.get(te);if(_e){const we=_e[L.__cacheKey];we.usedTimes--,we.usedTimes===0&&F(U),Object.keys(_e).length===0&&g.delete(te)}n.remove(U)}function F(U){const L=n.get(U);t.deleteTexture(L.__webglTexture);const te=U.source,_e=g.get(te);delete _e[L.__cacheKey],o.memory.textures--}function V(U){const L=U.texture,te=n.get(U),_e=n.get(L);if(_e.__webglTexture!==void 0&&(t.deleteTexture(_e.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let we=0;we<6;we++)t.deleteFramebuffer(te.__webglFramebuffer[we]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[we]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let we=0;we<te.__webglColorRenderbuffer.length;we++)te.__webglColorRenderbuffer[we]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[we]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let we=0,Me=L.length;we<Me;we++){const We=n.get(L[we]);We.__webglTexture&&(t.deleteTexture(We.__webglTexture),o.memory.textures--),n.remove(L[we])}n.remove(L),n.remove(U)}let Q=0;function X(){Q=0}function z(){const U=Q;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Q+=1,U}function Y(U){const L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.encoding),L.join()}function j(U,L){const te=n.get(U);if(U.isVideoTexture&&Je(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){const _e=U.image;if(_e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(te,U,L);return}}i.bindTexture(3553,te.__webglTexture,33984+L)}function J(U,L){const te=n.get(U);if(U.version>0&&te.__version!==U.version){de(te,U,L);return}i.bindTexture(35866,te.__webglTexture,33984+L)}function H(U,L){const te=n.get(U);if(U.version>0&&te.__version!==U.version){de(te,U,L);return}i.bindTexture(32879,te.__webglTexture,33984+L)}function Z(U,L){const te=n.get(U);if(U.version>0&&te.__version!==U.version){pe(te,U,L);return}i.bindTexture(34067,te.__webglTexture,33984+L)}const K={[Pd]:10497,[Hr]:33071,[Vv]:33648},ne={[Sn]:9728,[j1]:9984,[fv]:9986,[bi]:9729,[jE]:9985,[Tc]:9987};function W(U,L,te){if(te?(t.texParameteri(U,10242,K[L.wrapS]),t.texParameteri(U,10243,K[L.wrapT]),(U===32879||U===35866)&&t.texParameteri(U,32882,K[L.wrapR]),t.texParameteri(U,10240,ne[L.magFilter]),t.texParameteri(U,10241,ne[L.minFilter])):(t.texParameteri(U,10242,33071),t.texParameteri(U,10243,33071),(U===32879||U===35866)&&t.texParameteri(U,32882,33071),(L.wrapS!==Hr||L.wrapT!==Hr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,10240,P(L.magFilter)),t.texParameteri(U,10241,P(L.minFilter)),L.minFilter!==Sn&&L.minFilter!==bi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const _e=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===Sn||L.minFilter!==fv&&L.minFilter!==Tc||L.type===Eu&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===Hv&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||n.get(L).__currentAnisotropy)&&(t.texParameterf(U,_e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),n.get(L).__currentAnisotropy=L.anisotropy)}}function ve(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",I));const _e=L.source;let we=g.get(_e);we===void 0&&(we={},g.set(_e,we));const Me=Y(L);if(Me!==U.__cacheKey){we[Me]===void 0&&(we[Me]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),we[Me].usedTimes++;const We=we[U.__cacheKey];We!==void 0&&(we[U.__cacheKey].usedTimes--,We.usedTimes===0&&F(L)),U.__cacheKey=Me,U.__webglTexture=we[Me].texture}return te}function de(U,L,te){let _e=3553;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(_e=35866),L.isData3DTexture&&(_e=32879);const we=ve(U,L),Me=L.source;i.bindTexture(_e,U.__webglTexture,33984+te);const We=n.get(Me);if(Me.version!==We.__version||we===!0){i.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);const Le=S(L)&&b(L.image)===!1;let ue=x(L.image,Le,!1,h);ue=Ke(L,ue);const Ge=b(ue)||a,re=s.convert(L.format,L.encoding);let be=s.convert(L.type),Re=M(L.internalFormat,re,be,L.encoding,L.isVideoTexture);W(_e,L,Ge);let Ne;const tt=L.mipmaps,xt=a&&L.isVideoTexture!==!0,kt=We.__version===void 0||we===!0,q=T(L,ue,Ge);if(L.isDepthTexture)Re=6402,a?L.type===Eu?Re=36012:L.type===Qh?Re=33190:L.type===vp?Re=35056:Re=33189:L.type===Eu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===md&&Re===6402&&L.type!==VF&&L.type!==Qh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=Qh,be=s.convert(L.type)),L.format===zp&&Re===6402&&(Re=34041,L.type!==vp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=vp,be=s.convert(L.type))),kt&&(xt?i.texStorage2D(3553,1,Re,ue.width,ue.height):i.texImage2D(3553,0,Re,ue.width,ue.height,0,re,be,null));else if(L.isDataTexture)if(tt.length>0&&Ge){xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,be,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,re,be,Ne.data);L.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,q,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ue.width,ue.height,re,be,ue.data)):i.texImage2D(3553,0,Re,ue.width,ue.height,0,re,be,ue.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){xt&&kt&&i.texStorage3D(35866,q,Re,tt[0].width,tt[0].height,ue.depth);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],L.format!==Ys?re!==null?xt?i.compressedTexSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,re,Ne.data,0,0):i.compressedTexImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,Ne.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,re,be,Ne.data):i.texImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,re,be,Ne.data)}else{xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],L.format!==Ys?re!==null?xt?i.compressedTexSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,Ne.data):i.compressedTexImage2D(3553,oe,Re,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,be,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,re,be,Ne.data)}else if(L.isDataArrayTexture)xt?(kt&&i.texStorage3D(35866,q,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(35866,0,0,0,0,ue.width,ue.height,ue.depth,re,be,ue.data)):i.texImage3D(35866,0,Re,ue.width,ue.height,ue.depth,0,re,be,ue.data);else if(L.isData3DTexture)xt?(kt&&i.texStorage3D(32879,q,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(32879,0,0,0,0,ue.width,ue.height,ue.depth,re,be,ue.data)):i.texImage3D(32879,0,Re,ue.width,ue.height,ue.depth,0,re,be,ue.data);else if(L.isFramebufferTexture){if(kt)if(xt)i.texStorage2D(3553,q,Re,ue.width,ue.height);else{let oe=ue.width,xe=ue.height;for(let Fe=0;Fe<q;Fe++)i.texImage2D(3553,Fe,Re,oe,xe,0,re,be,null),oe>>=1,xe>>=1}}else if(tt.length>0&&Ge){xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],xt?i.texSubImage2D(3553,oe,0,0,re,be,Ne):i.texImage2D(3553,oe,Re,re,be,Ne);L.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,q,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,re,be,ue)):i.texImage2D(3553,0,Re,re,be,ue);A(L,Ge)&&E(_e),We.__version=Me.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function pe(U,L,te){if(L.image.length!==6)return;const _e=ve(U,L),we=L.source;i.bindTexture(34067,U.__webglTexture,33984+te);const Me=n.get(we);if(we.version!==Me.__version||_e===!0){i.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);const We=L.isCompressedTexture||L.image[0].isCompressedTexture,Le=L.image[0]&&L.image[0].isDataTexture,ue=[];for(let oe=0;oe<6;oe++)!We&&!Le?ue[oe]=x(L.image[oe],!1,!0,c):ue[oe]=Le?L.image[oe].image:L.image[oe],ue[oe]=Ke(L,ue[oe]);const Ge=ue[0],re=b(Ge)||a,be=s.convert(L.format,L.encoding),Re=s.convert(L.type),Ne=M(L.internalFormat,be,Re,L.encoding),tt=a&&L.isVideoTexture!==!0,xt=Me.__version===void 0||_e===!0;let kt=T(L,Ge,re);W(34067,L,re);let q;if(We){tt&&xt&&i.texStorage2D(34067,kt,Ne,Ge.width,Ge.height);for(let oe=0;oe<6;oe++){q=ue[oe].mipmaps;for(let xe=0;xe<q.length;xe++){const Fe=q[xe];L.format!==Ys?be!==null?tt?i.compressedTexSubImage2D(34069+oe,xe,0,0,Fe.width,Fe.height,be,Fe.data):i.compressedTexImage2D(34069+oe,xe,Ne,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tt?i.texSubImage2D(34069+oe,xe,0,0,Fe.width,Fe.height,be,Re,Fe.data):i.texImage2D(34069+oe,xe,Ne,Fe.width,Fe.height,0,be,Re,Fe.data)}}}else{q=L.mipmaps,tt&&xt&&(q.length>0&&kt++,i.texStorage2D(34067,kt,Ne,ue[0].width,ue[0].height));for(let oe=0;oe<6;oe++)if(Le){tt?i.texSubImage2D(34069+oe,0,0,0,ue[oe].width,ue[oe].height,be,Re,ue[oe].data):i.texImage2D(34069+oe,0,Ne,ue[oe].width,ue[oe].height,0,be,Re,ue[oe].data);for(let xe=0;xe<q.length;xe++){const Xe=q[xe].image[oe].image;tt?i.texSubImage2D(34069+oe,xe+1,0,0,Xe.width,Xe.height,be,Re,Xe.data):i.texImage2D(34069+oe,xe+1,Ne,Xe.width,Xe.height,0,be,Re,Xe.data)}}else{tt?i.texSubImage2D(34069+oe,0,0,0,be,Re,ue[oe]):i.texImage2D(34069+oe,0,Ne,be,Re,ue[oe]);for(let xe=0;xe<q.length;xe++){const Fe=q[xe];tt?i.texSubImage2D(34069+oe,xe+1,0,0,be,Re,Fe.image[oe]):i.texImage2D(34069+oe,xe+1,Ne,be,Re,Fe.image[oe])}}}A(L,re)&&E(34067),Me.__version=we.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ce(U,L,te,_e,we){const Me=s.convert(te.format,te.encoding),We=s.convert(te.type),Le=M(te.internalFormat,Me,We,te.encoding);n.get(L).__hasExternalTextures||(we===32879||we===35866?i.texImage3D(we,0,Le,L.width,L.height,L.depth,0,Me,We,null):i.texImage2D(we,0,Le,L.width,L.height,0,Me,We,null)),i.bindFramebuffer(36160,U),Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,_e,we,n.get(te).__webglTexture,0,Ie(L)):(we===3553||we>=34069&&we<=34074)&&t.framebufferTexture2D(36160,_e,we,n.get(te).__webglTexture,0),i.bindFramebuffer(36160,null)}function ye(U,L,te){if(t.bindRenderbuffer(36161,U),L.depthBuffer&&!L.stencilBuffer){let _e=33189;if(te||Pe(L)){const we=L.depthTexture;we&&we.isDepthTexture&&(we.type===Eu?_e=36012:we.type===Qh&&(_e=33190));const Me=Ie(L);Pe(L)?d.renderbufferStorageMultisampleEXT(36161,Me,_e,L.width,L.height):t.renderbufferStorageMultisample(36161,Me,_e,L.width,L.height)}else t.renderbufferStorage(36161,_e,L.width,L.height);t.framebufferRenderbuffer(36160,36096,36161,U)}else if(L.depthBuffer&&L.stencilBuffer){const _e=Ie(L);te&&Pe(L)===!1?t.renderbufferStorageMultisample(36161,_e,35056,L.width,L.height):Pe(L)?d.renderbufferStorageMultisampleEXT(36161,_e,35056,L.width,L.height):t.renderbufferStorage(36161,34041,L.width,L.height),t.framebufferRenderbuffer(36160,33306,36161,U)}else{const _e=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let we=0;we<_e.length;we++){const Me=_e[we],We=s.convert(Me.format,Me.encoding),Le=s.convert(Me.type),ue=M(Me.internalFormat,We,Le,Me.encoding),Ge=Ie(L);te&&Pe(L)===!1?t.renderbufferStorageMultisample(36161,Ge,ue,L.width,L.height):Pe(L)?d.renderbufferStorageMultisampleEXT(36161,Ge,ue,L.width,L.height):t.renderbufferStorage(36161,ue,L.width,L.height)}}t.bindRenderbuffer(36161,null)}function ae(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),j(L.depthTexture,0);const _e=n.get(L.depthTexture).__webglTexture,we=Ie(L);if(L.depthTexture.format===md)Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,_e,0,we):t.framebufferTexture2D(36160,36096,3553,_e,0);else if(L.depthTexture.format===zp)Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,_e,0,we):t.framebufferTexture2D(36160,33306,3553,_e,0);else throw new Error("Unknown depthTexture format")}function le(U){const L=n.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ae(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let _e=0;_e<6;_e++)i.bindFramebuffer(36160,L.__webglFramebuffer[_e]),L.__webglDepthbuffer[_e]=t.createRenderbuffer(),ye(L.__webglDepthbuffer[_e],U,!1)}else i.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),ye(L.__webglDepthbuffer,U,!1);i.bindFramebuffer(36160,null)}function Ee(U,L,te){const _e=n.get(U);L!==void 0&&ce(_e.__webglFramebuffer,U,U.texture,36064,3553),te!==void 0&&le(U)}function Te(U){const L=U.texture,te=n.get(U),_e=n.get(L);U.addEventListener("dispose",k),U.isWebGLMultipleRenderTargets!==!0&&(_e.__webglTexture===void 0&&(_e.__webglTexture=t.createTexture()),_e.__version=L.version,o.memory.textures++);const we=U.isWebGLCubeRenderTarget===!0,Me=U.isWebGLMultipleRenderTargets===!0,We=b(U)||a;if(we){te.__webglFramebuffer=[];for(let Le=0;Le<6;Le++)te.__webglFramebuffer[Le]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Me)if(r.drawBuffers){const Le=U.texture;for(let ue=0,Ge=Le.length;ue<Ge;ue++){const re=n.get(Le[ue]);re.__webglTexture===void 0&&(re.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Pe(U)===!1){const Le=Me?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,te.__webglMultisampledFramebuffer);for(let ue=0;ue<Le.length;ue++){const Ge=Le[ue];te.__webglColorRenderbuffer[ue]=t.createRenderbuffer(),t.bindRenderbuffer(36161,te.__webglColorRenderbuffer[ue]);const re=s.convert(Ge.format,Ge.encoding),be=s.convert(Ge.type),Re=M(Ge.internalFormat,re,be,Ge.encoding,U.isXRRenderTarget===!0),Ne=Ie(U);t.renderbufferStorageMultisample(36161,Ne,Re,U.width,U.height),t.framebufferRenderbuffer(36160,36064+ue,36161,te.__webglColorRenderbuffer[ue])}t.bindRenderbuffer(36161,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),ye(te.__webglDepthRenderbuffer,U,!0)),i.bindFramebuffer(36160,null)}}if(we){i.bindTexture(34067,_e.__webglTexture),W(34067,L,We);for(let Le=0;Le<6;Le++)ce(te.__webglFramebuffer[Le],U,L,36064,34069+Le);A(L,We)&&E(34067),i.unbindTexture()}else if(Me){const Le=U.texture;for(let ue=0,Ge=Le.length;ue<Ge;ue++){const re=Le[ue],be=n.get(re);i.bindTexture(3553,be.__webglTexture),W(3553,re,We),ce(te.__webglFramebuffer,U,re,36064+ue,3553),A(re,We)&&E(3553)}i.unbindTexture()}else{let Le=3553;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Le=U.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(Le,_e.__webglTexture),W(Le,L,We),ce(te.__webglFramebuffer,U,L,36064,Le),A(L,We)&&E(Le),i.unbindTexture()}U.depthBuffer&&le(U)}function Be(U){const L=b(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let _e=0,we=te.length;_e<we;_e++){const Me=te[_e];if(A(Me,L)){const We=U.isWebGLCubeRenderTarget?34067:3553,Le=n.get(Me).__webglTexture;i.bindTexture(We,Le),E(We),i.unbindTexture()}}}function Ue(U){if(a&&U.samples>0&&Pe(U)===!1){const L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,_e=U.height;let we=16384;const Me=[],We=U.stencilBuffer?33306:36096,Le=n.get(U),ue=U.isWebGLMultipleRenderTargets===!0;if(ue)for(let Ge=0;Ge<L.length;Ge++)i.bindFramebuffer(36160,Le.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ge,36161,null),i.bindFramebuffer(36160,Le.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ge,3553,null,0);i.bindFramebuffer(36008,Le.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,Le.__webglFramebuffer);for(let Ge=0;Ge<L.length;Ge++){Me.push(36064+Ge),U.depthBuffer&&Me.push(We);const re=Le.__ignoreDepthValues!==void 0?Le.__ignoreDepthValues:!1;if(re===!1&&(U.depthBuffer&&(we|=256),U.stencilBuffer&&(we|=1024)),ue&&t.framebufferRenderbuffer(36008,36064,36161,Le.__webglColorRenderbuffer[Ge]),re===!0&&(t.invalidateFramebuffer(36008,[We]),t.invalidateFramebuffer(36009,[We])),ue){const be=n.get(L[Ge]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,be,0)}t.blitFramebuffer(0,0,te,_e,0,0,te,_e,we,9728),f&&t.invalidateFramebuffer(36008,Me)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ue)for(let Ge=0;Ge<L.length;Ge++){i.bindFramebuffer(36160,Le.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ge,36161,Le.__webglColorRenderbuffer[Ge]);const re=n.get(L[Ge]).__webglTexture;i.bindFramebuffer(36160,Le.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ge,3553,re,0)}i.bindFramebuffer(36009,Le.__webglMultisampledFramebuffer)}}function Ie(U){return Math.min(u,U.samples)}function Pe(U){const L=n.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Je(U){const L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ke(U,L){const te=U.encoding,_e=U.format,we=U.type;return U.isCompressedTexture===!0||U.isVideoTexture===!0||U.format===aC||te!==Dd&&(te===Yi?a===!1?e.has("EXT_sRGB")===!0&&_e===Ys?(U.format=aC,U.minFilter=bi,U.generateMipmaps=!1):L=XF.sRGBToLinear(L):(_e!==Ys||we!==Xu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",te)),L}this.allocateTextureUnit=z,this.resetTextureUnits=X,this.setTexture2D=j,this.setTexture2DArray=J,this.setTexture3D=H,this.setTextureCube=Z,this.rebindTextures=Ee,this.setupRenderTarget=Te,this.updateRenderTargetMipmap=Be,this.updateMultisampleRenderTarget=Ue,this.setupDepthRenderbuffer=le,this.setupFrameBufferTexture=ce,this.useMultisampledRTT=Pe}function fQ(t,e,i){const n=i.isWebGL2;function r(s,o=null){let a;if(s===Xu)return 5121;if(s===FY)return 32819;if(s===NY)return 32820;if(s===BY)return 5120;if(s===RY)return 5122;if(s===VF)return 5123;if(s===OY)return 5124;if(s===Qh)return 5125;if(s===Eu)return 5126;if(s===Hv)return n?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===kY)return 6406;if(s===Ys)return 6408;if(s===zY)return 6409;if(s===UY)return 6410;if(s===md)return 6402;if(s===zp)return 34041;if(s===aC)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===GY)return 6403;if(s===VY)return 36244;if(s===HY)return 33319;if(s===jY)return 33320;if(s===WY)return 36249;if(s===cM||s===uM||s===hM||s===dM)if(o===Yi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===cM)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===uM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===hM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===dM)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===cM)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===uM)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===hM)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===dM)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===IL||s===LL||s===BL||s===RL)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===IL)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===LL)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===BL)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===RL)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===XY)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===OL||s===FL)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===OL)return o===Yi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===FL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===NL||s===kL||s===zL||s===UL||s===GL||s===VL||s===HL||s===jL||s===WL||s===XL||s===qL||s===YL||s===QL||s===JL)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===NL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===kL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===zL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===UL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===GL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===VL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===HL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===jL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===WL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===XL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===qL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===YL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===QL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===JL)return o===Yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===fM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===fM)return o===Yi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===qY||s===KL||s===ZL||s===$L)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===fM)return a.COMPRESSED_RED_RGTC1_EXT;if(s===KL)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===ZL)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===$L)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===vp?n?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class pQ extends sn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Pu extends vi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $de={type:"move"};class HP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Pu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Pu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ie,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ie),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Pu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ie,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ie),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const m of e.hand.values()){const g=i.getJointPose(m,n),v=this._getHandJoint(c,m);g!==null&&(v.matrix.fromArray(g.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=g.radius),v.visible=g!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=h.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=i.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=i.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent($de)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new Pu;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}class mQ extends on{constructor(e,i,n,r,s,o,a,l,c,h){if(h=h!==void 0?h:md,h!==md&&h!==zp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===md&&(n=Qh),n===void 0&&h===zp&&(n=vp),super(null,r,s,o,a,l,h,n,c),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=a!==void 0?a:Sn,this.minFilter=l!==void 0?l:Sn,this.flipY=!1,this.generateMipmaps=!1}}class efe extends Oc{constructor(e,i){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,u=null,d=null,f=null,p=null;const m=i.getContextAttributes();let g=null,v=null;const y=[],x=[],b=new Set,S=new Map,A=new sn;A.layers.enable(1),A.viewport=new Ci;const E=new sn;E.layers.enable(2),E.viewport=new Ci;const M=[A,E],T=new pQ;T.layers.enable(1),T.layers.enable(2);let P=null,I=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let Z=y[H];return Z===void 0&&(Z=new HP,y[H]=Z),Z.getTargetRaySpace()},this.getControllerGrip=function(H){let Z=y[H];return Z===void 0&&(Z=new HP,y[H]=Z),Z.getGripSpace()},this.getHand=function(H){let Z=y[H];return Z===void 0&&(Z=new HP,y[H]=Z),Z.getHandSpace()};function k(H){const Z=x.indexOf(H.inputSource);if(Z===-1)return;const K=y[Z];K!==void 0&&K.dispatchEvent({type:H.type,data:H.inputSource})}function R(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",F);for(let H=0;H<y.length;H++){const Z=x[H];Z!==null&&(x[H]=null,y[H].disconnect(Z))}P=null,I=null,e.setRenderTarget(g),f=null,d=null,u=null,r=null,v=null,J.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){s=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){a=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(H){c=H},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(H){if(r=H,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",R),r.addEventListener("inputsourceschange",F),m.xrCompatible!==!0&&await i.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Z={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,i,Z),r.updateRenderState({baseLayer:f}),v=new Tl(f.framebufferWidth,f.framebufferHeight,{format:Ys,type:Xu,encoding:e.outputEncoding,stencilBuffer:m.stencil})}else{let Z=null,K=null,ne=null;m.depth&&(ne=m.stencil?35056:33190,Z=m.stencil?zp:md,K=m.stencil?vp:Qh);const W={colorFormat:32856,depthFormat:ne,scaleFactor:s};u=new XRWebGLBinding(r,i),d=u.createProjectionLayer(W),r.updateRenderState({layers:[d]}),v=new Tl(d.textureWidth,d.textureHeight,{format:Ys,type:Xu,depthTexture:new mQ(d.textureWidth,d.textureHeight,K,void 0,void 0,void 0,void 0,void 0,void 0,Z),stencilBuffer:m.stencil,encoding:e.outputEncoding,samples:m.antialias?4:0});const ve=e.properties.get(v);ve.__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),J.setContext(r),J.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function F(H){for(let Z=0;Z<H.removed.length;Z++){const K=H.removed[Z],ne=x.indexOf(K);ne>=0&&(x[ne]=null,y[ne].disconnect(K))}for(let Z=0;Z<H.added.length;Z++){const K=H.added[Z];let ne=x.indexOf(K);if(ne===-1){for(let ve=0;ve<y.length;ve++)if(ve>=x.length){x.push(K),ne=ve;break}else if(x[ve]===null){x[ve]=K,ne=ve;break}if(ne===-1)break}const W=y[ne];W&&W.connect(K)}}const V=new ie,Q=new ie;function X(H,Z,K){V.setFromMatrixPosition(Z.matrixWorld),Q.setFromMatrixPosition(K.matrixWorld);const ne=V.distanceTo(Q),W=Z.projectionMatrix.elements,ve=K.projectionMatrix.elements,de=W[14]/(W[10]-1),pe=W[14]/(W[10]+1),ce=(W[9]+1)/W[5],ye=(W[9]-1)/W[5],ae=(W[8]-1)/W[0],le=(ve[8]+1)/ve[0],Ee=de*ae,Te=de*le,Be=ne/(-ae+le),Ue=Be*-ae;Z.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(Ue),H.translateZ(Be),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();const Ie=de+Be,Pe=pe+Be,Je=Ee-Ue,Ke=Te+(ne-Ue),U=ce*pe/Pe*Ie,L=ye*pe/Pe*Ie;H.projectionMatrix.makePerspective(Je,Ke,U,L,Ie,Pe)}function z(H,Z){Z===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(Z.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(r===null)return;T.near=E.near=A.near=H.near,T.far=E.far=A.far=H.far,(P!==T.near||I!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),P=T.near,I=T.far);const Z=H.parent,K=T.cameras;z(T,Z);for(let W=0;W<K.length;W++)z(K[W],Z);T.matrixWorld.decompose(T.position,T.quaternion,T.scale),H.matrix.copy(T.matrix),H.matrix.decompose(H.position,H.quaternion,H.scale);const ne=H.children;for(let W=0,ve=ne.length;W<ve;W++)ne[W].updateMatrixWorld(!0);K.length===2?X(T,A,E):T.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return T},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(H){l=H,d!==null&&(d.fixedFoveation=H),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=H)},this.getPlanes=function(){return b};let Y=null;function j(H,Z){if(h=Z.getViewerPose(c||o),p=Z,h!==null){const K=h.views;f!==null&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let ne=!1;K.length!==T.cameras.length&&(T.cameras.length=0,ne=!0);for(let W=0;W<K.length;W++){const ve=K[W];let de=null;if(f!==null)de=f.getViewport(ve);else{const ce=u.getViewSubImage(d,ve);de=ce.viewport,W===0&&(e.setRenderTargetTextures(v,ce.colorTexture,d.ignoreDepthValues?void 0:ce.depthStencilTexture),e.setRenderTarget(v))}let pe=M[W];pe===void 0&&(pe=new sn,pe.layers.enable(W),pe.viewport=new Ci,M[W]=pe),pe.matrix.fromArray(ve.transform.matrix),pe.projectionMatrix.fromArray(ve.projectionMatrix),pe.viewport.set(de.x,de.y,de.width,de.height),W===0&&T.matrix.copy(pe.matrix),ne===!0&&T.cameras.push(pe)}}for(let K=0;K<y.length;K++){const ne=x[K],W=y[K];ne!==null&&W!==void 0&&W.update(ne,Z,c||o)}if(Y&&Y(H,Z),Z.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:Z.detectedPlanes});let K=null;for(const ne of b)Z.detectedPlanes.has(ne)||(K===null&&(K=[]),K.push(ne));if(K!==null)for(const ne of K)b.delete(ne),S.delete(ne),n.dispatchEvent({type:"planeremoved",data:ne});for(const ne of Z.detectedPlanes)if(!b.has(ne))b.add(ne),S.set(ne,Z.lastChangedTime),n.dispatchEvent({type:"planeadded",data:ne});else{const W=S.get(ne);ne.lastChangedTime>W&&(S.set(ne,ne.lastChangedTime),n.dispatchEvent({type:"planechanged",data:ne}))}}p=null}const J=new lQ;J.setAnimationLoop(j),this.setAnimationLoop=function(H){Y=H},this.dispose=function(){}}}function tfe(t,e){function i(m,g){g.color.getRGB(m.fogColor.value,oQ(t)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function n(m,g,v,y,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),h(m,g)):g.isMeshPhongMaterial?(r(m,g),c(m,g)):g.isMeshStandardMaterial?(r(m,g),u(m,g),g.isMeshPhysicalMaterial&&d(m,g,x)):g.isMeshMatcapMaterial?(r(m,g),f(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),p(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&o(m,g)):g.isPointsMaterial?a(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===so&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===so&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const b=t.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function a(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function h(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function u(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===so&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function ife(t,e,i,n){let r={},s={},o=[];const a=i.isWebGL2?t.getParameter(35375):0;function l(y,x){const b=x.program;n.uniformBlockBinding(y,b)}function c(y,x){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",g));const S=x.program;n.updateUBOMapping(y,S);const A=e.render.frame;s[y.id]!==A&&(d(y),s[y.id]=A)}function h(y){const x=u();y.__bindingPointIndex=x;const b=t.createBuffer(),S=y.__size,A=y.usage;return t.bindBuffer(35345,b),t.bufferData(35345,S,A),t.bindBuffer(35345,null),t.bindBufferBase(35345,x,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){const x=r[y.id],b=y.uniforms,S=y.__cache;t.bindBuffer(35345,x);for(let A=0,E=b.length;A<E;A++){const M=b[A];if(f(M,A,S)===!0){const T=M.__offset,P=Array.isArray(M.value)?M.value:[M.value];let I=0;for(let k=0;k<P.length;k++){const R=P[k],F=m(R);typeof R=="number"?(M.__data[0]=R,t.bufferSubData(35345,T+I,M.__data)):R.isMatrix3?(M.__data[0]=R.elements[0],M.__data[1]=R.elements[1],M.__data[2]=R.elements[2],M.__data[3]=R.elements[0],M.__data[4]=R.elements[3],M.__data[5]=R.elements[4],M.__data[6]=R.elements[5],M.__data[7]=R.elements[0],M.__data[8]=R.elements[6],M.__data[9]=R.elements[7],M.__data[10]=R.elements[8],M.__data[11]=R.elements[0]):(R.toArray(M.__data,I),I+=F.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,T,M.__data)}}t.bindBuffer(35345,null)}function f(y,x,b){const S=y.value;if(b[x]===void 0){if(typeof S=="number")b[x]=S;else{const A=Array.isArray(S)?S:[S],E=[];for(let M=0;M<A.length;M++)E.push(A[M].clone());b[x]=E}return!0}else if(typeof S=="number"){if(b[x]!==S)return b[x]=S,!0}else{const A=Array.isArray(b[x])?b[x]:[b[x]],E=Array.isArray(S)?S:[S];for(let M=0;M<A.length;M++){const T=A[M];if(T.equals(E[M])===!1)return T.copy(E[M]),!0}}return!1}function p(y){const x=y.uniforms;let b=0;const S=16;let A=0;for(let E=0,M=x.length;E<M;E++){const T=x[E],P={boundary:0,storage:0},I=Array.isArray(T.value)?T.value:[T.value];for(let k=0,R=I.length;k<R;k++){const F=I[k],V=m(F);P.boundary+=V.boundary,P.storage+=V.storage}if(T.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=b,E>0){A=b%S;const k=S-A;A!==0&&k-P.boundary<0&&(b+=S-A,T.__offset=b)}b+=P.storage}return A=b%S,A>0&&(b+=S-A),y.__size=b,y.__cache={},this}function m(y){const x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function g(y){const x=y.target;x.removeEventListener("dispose",g);const b=o.indexOf(x.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function v(){for(const y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}function nfe(){const t=Y1("canvas");return t.style.display="block",t}function QE(t={}){this.isWebGLRenderer=!0;const e=t.canvas!==void 0?t.canvas:nfe(),i=t.context!==void 0?t.context:null,n=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",c=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1;let h;i!==null?h=i.getContextAttributes().alpha:h=t.alpha!==void 0?t.alpha:!1;let u=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Dd,this.physicallyCorrectLights=!1,this.toneMapping=Al,this.toneMappingExposure=1;const m=this;let g=!1,v=0,y=0,x=null,b=-1,S=null;const A=new Ci,E=new Ci;let M=null,T=e.width,P=e.height,I=1,k=null,R=null;const F=new Ci(0,0,T,P),V=new Ci(0,0,T,P);let Q=!1;const X=new qE;let z=!1,Y=!1,j=null;const J=new Nt,H=new Ve,Z=new ie,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ne(){return x===null?I:1}let W=i;function ve(N,ee){for(let he=0;he<N.length;he++){const $=N[he],fe=e.getContext($,ee);if(fe!==null)return fe}return null}try{const N={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${N_}`),e.addEventListener("webglcontextlost",Re,!1),e.addEventListener("webglcontextrestored",Ne,!1),e.addEventListener("webglcontextcreationerror",tt,!1),W===null){const ee=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&ee.shift(),W=ve(ee,N),W===null)throw ve(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}W.getShaderPrecisionFormat===void 0&&(W.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let de,pe,ce,ye,ae,le,Ee,Te,Be,Ue,Ie,Pe,Je,Ke,U,L,te,_e,we,Me,We,Le,ue,Ge;function re(){de=new xhe(W),pe=new fhe(W,de,t),de.init(pe),Le=new fQ(W,de,pe),ce=new Kde(W,de,pe),ye=new bhe,ae=new zde,le=new Zde(W,de,ce,ae,pe,Le,ye),Ee=new mhe(m),Te=new yhe(m),Be=new Ile(W,pe),ue=new hhe(W,de,Be,pe),Ue=new _he(W,Be,ye,ue),Ie=new Che(W,Ue,Be,ye),we=new Mhe(W,pe,le),L=new phe(ae),Pe=new kde(m,Ee,Te,de,pe,ue,L),Je=new tfe(m,ae),Ke=new Gde,U=new qde(de,pe),_e=new uhe(m,Ee,Te,ce,Ie,h,o),te=new Jde(m,Ie,pe),Ge=new ife(W,ye,pe,ce),Me=new dhe(W,de,ye,pe),We=new whe(W,de,ye,pe),ye.programs=Pe.programs,m.capabilities=pe,m.extensions=de,m.properties=ae,m.renderLists=Ke,m.shadowMap=te,m.state=ce,m.info=ye}re();const be=new efe(m,W);this.xr=be,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){const N=de.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){const N=de.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(N){N!==void 0&&(I=N,this.setSize(T,P,!1))},this.getSize=function(N){return N.set(T,P)},this.setSize=function(N,ee,he){if(be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}T=N,P=ee,e.width=Math.floor(N*I),e.height=Math.floor(ee*I),he!==!1&&(e.style.width=N+"px",e.style.height=ee+"px"),this.setViewport(0,0,N,ee)},this.getDrawingBufferSize=function(N){return N.set(T*I,P*I).floor()},this.setDrawingBufferSize=function(N,ee,he){T=N,P=ee,I=he,e.width=Math.floor(N*he),e.height=Math.floor(ee*he),this.setViewport(0,0,N,ee)},this.getCurrentViewport=function(N){return N.copy(A)},this.getViewport=function(N){return N.copy(F)},this.setViewport=function(N,ee,he,$){N.isVector4?F.set(N.x,N.y,N.z,N.w):F.set(N,ee,he,$),ce.viewport(A.copy(F).multiplyScalar(I).floor())},this.getScissor=function(N){return N.copy(V)},this.setScissor=function(N,ee,he,$){N.isVector4?V.set(N.x,N.y,N.z,N.w):V.set(N,ee,he,$),ce.scissor(E.copy(V).multiplyScalar(I).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(N){ce.setScissorTest(Q=N)},this.setOpaqueSort=function(N){k=N},this.setTransparentSort=function(N){R=N},this.getClearColor=function(N){return N.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor.apply(_e,arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha.apply(_e,arguments)},this.clear=function(N=!0,ee=!0,he=!0){let $=0;N&&($|=16384),ee&&($|=256),he&&($|=1024),W.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Re,!1),e.removeEventListener("webglcontextrestored",Ne,!1),e.removeEventListener("webglcontextcreationerror",tt,!1),Ke.dispose(),U.dispose(),ae.dispose(),Ee.dispose(),Te.dispose(),Ie.dispose(),ue.dispose(),Ge.dispose(),Pe.dispose(),be.dispose(),be.removeEventListener("sessionstart",Fe),be.removeEventListener("sessionend",Xe),j&&(j.dispose(),j=null),pt.stop()};function Re(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const N=ye.autoReset,ee=te.enabled,he=te.autoUpdate,$=te.needsUpdate,fe=te.type;re(),ye.autoReset=N,te.enabled=ee,te.autoUpdate=he,te.needsUpdate=$,te.type=fe}function tt(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function xt(N){const ee=N.target;ee.removeEventListener("dispose",xt),kt(ee)}function kt(N){q(N),ae.remove(N)}function q(N){const ee=ae.get(N).programs;ee!==void 0&&(ee.forEach(function(he){Pe.releaseProgram(he)}),N.isShaderMaterial&&Pe.releaseShaderCache(N))}this.renderBufferDirect=function(N,ee,he,$,fe,je){ee===null&&(ee=K);const $e=fe.isMesh&&fe.matrixWorld.determinant()<0,rt=Q0(N,ee,he,$,fe);ce.setMaterial($,$e);let ot=he.index,_t=1;$.wireframe===!0&&(ot=Ue.getWireframeAttribute(he),_t=2);const mt=he.drawRange,dt=he.attributes.position;let si=mt.start*_t,Ti=(mt.start+mt.count)*_t;je!==null&&(si=Math.max(si,je.start*_t),Ti=Math.min(Ti,(je.start+je.count)*_t)),ot!==null?(si=Math.max(si,0),Ti=Math.min(Ti,ot.count)):dt!=null&&(si=Math.max(si,0),Ti=Math.min(Ti,dt.count));const Pn=Ti-si;if(Pn<0||Pn===1/0)return;ue.setup(fe,$,rt,he,ot);let Or,Ut=Me;if(ot!==null&&(Or=Be.get(ot),Ut=We,Ut.setIndex(Or)),fe.isMesh)$.wireframe===!0?(ce.setLineWidth($.wireframeLinewidth*ne()),Ut.setMode(1)):Ut.setMode(4);else if(fe.isLine){let at=$.linewidth;at===void 0&&(at=1),ce.setLineWidth(at*ne()),fe.isLineSegments?Ut.setMode(1):fe.isLineLoop?Ut.setMode(2):Ut.setMode(3)}else fe.isPoints?Ut.setMode(0):fe.isSprite&&Ut.setMode(4);if(fe.isInstancedMesh)Ut.renderInstances(si,Pn,fe.count);else if(he.isInstancedBufferGeometry){const at=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,Xa=Math.min(he.instanceCount,at);Ut.renderInstances(si,Pn,Xa)}else Ut.render(si,Pn)},this.compile=function(N,ee){function he($,fe,je){$.transparent===!0&&$.side===ml&&$.forceSinglePass===!1?($.side=so,$.needsUpdate=!0,ki($,fe,je),$.side=Ec,$.needsUpdate=!0,ki($,fe,je),$.side=ml):ki($,fe,je)}d=U.get(N),d.init(),p.push(d),N.traverseVisible(function($){$.isLight&&$.layers.test(ee.layers)&&(d.pushLight($),$.castShadow&&d.pushShadow($))}),d.setupLights(m.physicallyCorrectLights),N.traverse(function($){const fe=$.material;if(fe)if(Array.isArray(fe))for(let je=0;je<fe.length;je++){const $e=fe[je];he($e,N,$)}else he(fe,N,$)}),p.pop(),d=null};let oe=null;function xe(N){oe&&oe(N)}function Fe(){pt.stop()}function Xe(){pt.start()}const pt=new lQ;pt.setAnimationLoop(xe),typeof self<"u"&&pt.setContext(self),this.setAnimationLoop=function(N){oe=N,be.setAnimationLoop(N),N===null?pt.stop():pt.start()},be.addEventListener("sessionstart",Fe),be.addEventListener("sessionend",Xe),this.render=function(N,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),ee.parent===null&&ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),be.enabled===!0&&be.isPresenting===!0&&(be.cameraAutoUpdate===!0&&be.updateCamera(ee),ee=be.getCamera()),N.isScene===!0&&N.onBeforeRender(m,N,ee,x),d=U.get(N,p.length),d.init(),p.push(d),J.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),X.setFromProjectionMatrix(J),Y=this.localClippingEnabled,z=L.init(this.clippingPlanes,Y),u=Ke.get(N,f.length),u.init(),f.push(u),ti(N,ee,0,m.sortObjects),u.finish(),m.sortObjects===!0&&u.sort(k,R),z===!0&&L.beginShadows();const he=d.state.shadowsArray;if(te.render(he,N,ee),z===!0&&L.endShadows(),this.info.autoReset===!0&&this.info.reset(),_e.render(u,N),d.setupLights(m.physicallyCorrectLights),ee.isArrayCamera){const $=ee.cameras;for(let fe=0,je=$.length;fe<je;fe++){const $e=$[fe];ui(u,N,$e,$e.viewport)}}else ui(u,N,ee);x!==null&&(le.updateMultisampleRenderTarget(x),le.updateRenderTargetMipmap(x)),N.isScene===!0&&N.onAfterRender(m,N,ee),ue.resetDefaultState(),b=-1,S=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function ti(N,ee,he,$){if(N.visible===!1)return;if(N.layers.test(ee.layers)){if(N.isGroup)he=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(ee);else if(N.isLight)d.pushLight(N),N.castShadow&&d.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||X.intersectsSprite(N)){$&&Z.setFromMatrixPosition(N.matrixWorld).applyMatrix4(J);const $e=Ie.update(N),rt=N.material;rt.visible&&u.push(N,$e,rt,he,Z.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(N.isSkinnedMesh&&N.skeleton.frame!==ye.render.frame&&(N.skeleton.update(),N.skeleton.frame=ye.render.frame),!N.frustumCulled||X.intersectsObject(N))){$&&Z.setFromMatrixPosition(N.matrixWorld).applyMatrix4(J);const $e=Ie.update(N),rt=N.material;if(Array.isArray(rt)){const ot=$e.groups;for(let _t=0,mt=ot.length;_t<mt;_t++){const dt=ot[_t],si=rt[dt.materialIndex];si&&si.visible&&u.push(N,$e,si,he,Z.z,dt)}}else rt.visible&&u.push(N,$e,rt,he,Z.z,null)}}const je=N.children;for(let $e=0,rt=je.length;$e<rt;$e++)ti(je[$e],ee,he,$)}function ui(N,ee,he,$){const fe=N.opaque,je=N.transmissive,$e=N.transparent;d.setupLightsView(he),z===!0&&L.setGlobalState(m.clippingPlanes,he),je.length>0&&vr(fe,ee,he),$&&ce.viewport(A.copy($)),fe.length>0&&Pt(fe,ee,he),je.length>0&&Pt(je,ee,he),$e.length>0&&Pt($e,ee,he),ce.buffers.depth.setTest(!0),ce.buffers.depth.setMask(!0),ce.buffers.color.setMask(!0),ce.setPolygonOffset(!1)}function vr(N,ee,he){const $=pe.isWebGL2;j===null&&(j=new Tl(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?Hv:Xu,minFilter:Tc,samples:$&&s===!0?4:0})),m.getDrawingBufferSize(H),$?j.setSize(H.x,H.y):j.setSize(lC(H.x),lC(H.y));const fe=m.getRenderTarget();m.setRenderTarget(j),m.clear();const je=m.toneMapping;m.toneMapping=Al,Pt(N,ee,he),m.toneMapping=je,le.updateMultisampleRenderTarget(j),le.updateRenderTargetMipmap(j),m.setRenderTarget(fe)}function Pt(N,ee,he){const $=ee.isScene===!0?ee.overrideMaterial:null;for(let fe=0,je=N.length;fe<je;fe++){const $e=N[fe],rt=$e.object,ot=$e.geometry,_t=$===null?$e.material:$,mt=$e.group;rt.layers.test(he.layers)&&gn(rt,ee,he,ot,_t,mt)}}function gn(N,ee,he,$,fe,je){N.onBeforeRender(m,ee,he,$,fe,je),N.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),fe.onBeforeRender(m,ee,he,$,N,je),fe.transparent===!0&&fe.side===ml&&fe.forceSinglePass===!1?(fe.side=so,fe.needsUpdate=!0,m.renderBufferDirect(he,ee,$,fe,N,je),fe.side=Ec,fe.needsUpdate=!0,m.renderBufferDirect(he,ee,$,fe,N,je),fe.side=ml):m.renderBufferDirect(he,ee,$,fe,N,je),N.onAfterRender(m,ee,he,$,fe,je)}function ki(N,ee,he){ee.isScene!==!0&&(ee=K);const $=ae.get(N),fe=d.state.lights,je=d.state.shadowsArray,$e=fe.state.version,rt=Pe.getParameters(N,fe.state,je,ee,he),ot=Pe.getProgramCacheKey(rt);let _t=$.programs;$.environment=N.isMeshStandardMaterial?ee.environment:null,$.fog=ee.fog,$.envMap=(N.isMeshStandardMaterial?Te:Ee).get(N.envMap||$.environment),_t===void 0&&(N.addEventListener("dispose",xt),_t=new Map,$.programs=_t);let mt=_t.get(ot);if(mt!==void 0){if($.currentProgram===mt&&$.lightsStateVersion===$e)return $d(N,rt),mt}else rt.uniforms=Pe.getUniforms(N),N.onBuild(he,rt,m),N.onBeforeCompile(rt,m),mt=Pe.acquireProgram(rt,ot),_t.set(ot,mt),$.uniforms=rt.uniforms;const dt=$.uniforms;(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(dt.clippingPlanes=L.uniform),$d(N,rt),$.needsLights=ef(N),$.lightsStateVersion=$e,$.needsLights&&(dt.ambientLightColor.value=fe.state.ambient,dt.lightProbe.value=fe.state.probe,dt.directionalLights.value=fe.state.directional,dt.directionalLightShadows.value=fe.state.directionalShadow,dt.spotLights.value=fe.state.spot,dt.spotLightShadows.value=fe.state.spotShadow,dt.rectAreaLights.value=fe.state.rectArea,dt.ltc_1.value=fe.state.rectAreaLTC1,dt.ltc_2.value=fe.state.rectAreaLTC2,dt.pointLights.value=fe.state.point,dt.pointLightShadows.value=fe.state.pointShadow,dt.hemisphereLights.value=fe.state.hemi,dt.directionalShadowMap.value=fe.state.directionalShadowMap,dt.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,dt.spotShadowMap.value=fe.state.spotShadowMap,dt.spotLightMatrix.value=fe.state.spotLightMatrix,dt.spotLightMap.value=fe.state.spotLightMap,dt.pointShadowMap.value=fe.state.pointShadowMap,dt.pointShadowMatrix.value=fe.state.pointShadowMatrix);const si=mt.getUniforms(),Ti=vM.seqWithValue(si.seq,dt);return $.currentProgram=mt,$.uniformsList=Ti,mt}function $d(N,ee){const he=ae.get(N);he.outputEncoding=ee.outputEncoding,he.instancing=ee.instancing,he.skinning=ee.skinning,he.morphTargets=ee.morphTargets,he.morphNormals=ee.morphNormals,he.morphColors=ee.morphColors,he.morphTargetsCount=ee.morphTargetsCount,he.numClippingPlanes=ee.numClippingPlanes,he.numIntersection=ee.numClipIntersection,he.vertexAlphas=ee.vertexAlphas,he.vertexTangents=ee.vertexTangents,he.toneMapping=ee.toneMapping}function Q0(N,ee,he,$,fe){ee.isScene!==!0&&(ee=K),le.resetTextureUnits();const je=ee.fog,$e=$.isMeshStandardMaterial?ee.environment:null,rt=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:Dd,ot=($.isMeshStandardMaterial?Te:Ee).get($.envMap||$e),_t=$.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,mt=!!$.normalMap&&!!he.attributes.tangent,dt=!!he.morphAttributes.position,si=!!he.morphAttributes.normal,Ti=!!he.morphAttributes.color,Pn=$.toneMapped?m.toneMapping:Al,Or=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Ut=Or!==void 0?Or.length:0,at=ae.get($),Xa=d.state.lights;if(z===!0&&(Y===!0||N!==S)){const Wt=N===S&&$.id===b;L.setState($,N,Wt)}let Xi=!1;$.version===at.__version?(at.needsLights&&at.lightsStateVersion!==Xa.state.version||at.outputEncoding!==rt||fe.isInstancedMesh&&at.instancing===!1||!fe.isInstancedMesh&&at.instancing===!0||fe.isSkinnedMesh&&at.skinning===!1||!fe.isSkinnedMesh&&at.skinning===!0||at.envMap!==ot||$.fog===!0&&at.fog!==je||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==L.numPlanes||at.numIntersection!==L.numIntersection)||at.vertexAlphas!==_t||at.vertexTangents!==mt||at.morphTargets!==dt||at.morphNormals!==si||at.morphColors!==Ti||at.toneMapping!==Pn||pe.isWebGL2===!0&&at.morphTargetsCount!==Ut)&&(Xi=!0):(Xi=!0,at.__version=$.version);let Fr=at.currentProgram;Xi===!0&&(Fr=ki($,ee,fe));let Uc=!1,yr=!1,Yr=!1;const bt=Fr.getUniforms(),Kt=at.uniforms;if(ce.useProgram(Fr.program)&&(Uc=!0,yr=!0,Yr=!0),$.id!==b&&(b=$.id,yr=!0),Uc||S!==N){if(bt.setValue(W,"projectionMatrix",N.projectionMatrix),pe.logarithmicDepthBuffer&&bt.setValue(W,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),S!==N&&(S=N,yr=!0,Yr=!0),$.isShaderMaterial||$.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshStandardMaterial||$.envMap){const Wt=bt.map.cameraPosition;Wt!==void 0&&Wt.setValue(W,Z.setFromMatrixPosition(N.matrixWorld))}($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&bt.setValue(W,"isOrthographic",N.isOrthographicCamera===!0),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial||$.isShadowMaterial||fe.isSkinnedMesh)&&bt.setValue(W,"viewMatrix",N.matrixWorldInverse)}if(fe.isSkinnedMesh){bt.setOptional(W,fe,"bindMatrix"),bt.setOptional(W,fe,"bindMatrixInverse");const Wt=fe.skeleton;Wt&&(pe.floatVertexTextures?(Wt.boneTexture===null&&Wt.computeBoneTexture(),bt.setValue(W,"boneTexture",Wt.boneTexture,le),bt.setValue(W,"boneTextureSize",Wt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Qr=he.morphAttributes;if((Qr.position!==void 0||Qr.normal!==void 0||Qr.color!==void 0&&pe.isWebGL2===!0)&&we.update(fe,he,$,Fr),(yr||at.receiveShadow!==fe.receiveShadow)&&(at.receiveShadow=fe.receiveShadow,bt.setValue(W,"receiveShadow",fe.receiveShadow)),$.isMeshGouraudMaterial&&$.envMap!==null&&(Kt.envMap.value=ot,Kt.flipEnvMap.value=ot.isCubeTexture&&ot.isRenderTargetTexture===!1?-1:1),yr&&(bt.setValue(W,"toneMappingExposure",m.toneMappingExposure),at.needsLights&&dm(Kt,Yr),je&&$.fog===!0&&Je.refreshFogUniforms(Kt,je),Je.refreshMaterialUniforms(Kt,$,I,P,j),vM.upload(W,at.uniformsList,Kt,le)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(vM.upload(W,at.uniformsList,Kt,le),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&bt.setValue(W,"center",fe.center),bt.setValue(W,"modelViewMatrix",fe.modelViewMatrix),bt.setValue(W,"normalMatrix",fe.normalMatrix),bt.setValue(W,"modelMatrix",fe.matrixWorld),$.isShaderMaterial||$.isRawShaderMaterial){const Wt=$.uniformsGroups;for(let vn=0,qa=Wt.length;vn<qa;vn++)if(pe.isWebGL2){const Ko=Wt[vn];Ge.update(Ko,Fr),Ge.bind(Ko,Fr)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Fr}function dm(N,ee){N.ambientLightColor.needsUpdate=ee,N.lightProbe.needsUpdate=ee,N.directionalLights.needsUpdate=ee,N.directionalLightShadows.needsUpdate=ee,N.pointLights.needsUpdate=ee,N.pointLightShadows.needsUpdate=ee,N.spotLights.needsUpdate=ee,N.spotLightShadows.needsUpdate=ee,N.rectAreaLights.needsUpdate=ee,N.hemisphereLights.needsUpdate=ee}function ef(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(N,ee,he){ae.get(N.texture).__webglTexture=ee,ae.get(N.depthTexture).__webglTexture=he;const $=ae.get(N);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=he===void 0,$.__autoAllocateDepthBuffer||de.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,ee){const he=ae.get(N);he.__webglFramebuffer=ee,he.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(N,ee=0,he=0){x=N,v=ee,y=he;let $=!0,fe=null,je=!1,$e=!1;if(N){const ot=ae.get(N);ot.__useDefaultFramebuffer!==void 0?(ce.bindFramebuffer(36160,null),$=!1):ot.__webglFramebuffer===void 0?le.setupRenderTarget(N):ot.__hasExternalTextures&&le.rebindTextures(N,ae.get(N.texture).__webglTexture,ae.get(N.depthTexture).__webglTexture);const _t=N.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&($e=!0);const mt=ae.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(fe=mt[ee],je=!0):pe.isWebGL2&&N.samples>0&&le.useMultisampledRTT(N)===!1?fe=ae.get(N).__webglMultisampledFramebuffer:fe=mt,A.copy(N.viewport),E.copy(N.scissor),M=N.scissorTest}else A.copy(F).multiplyScalar(I).floor(),E.copy(V).multiplyScalar(I).floor(),M=Q;if(ce.bindFramebuffer(36160,fe)&&pe.drawBuffers&&$&&ce.drawBuffers(N,fe),ce.viewport(A),ce.scissor(E),ce.setScissorTest(M),je){const ot=ae.get(N.texture);W.framebufferTexture2D(36160,36064,34069+ee,ot.__webglTexture,he)}else if($e){const ot=ae.get(N.texture),_t=ee||0;W.framebufferTextureLayer(36160,36064,ot.__webglTexture,he||0,_t)}b=-1},this.readRenderTargetPixels=function(N,ee,he,$,fe,je,$e){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let rt=ae.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&$e!==void 0&&(rt=rt[$e]),rt){ce.bindFramebuffer(36160,rt);try{const ot=N.texture,_t=ot.format,mt=ot.type;if(_t!==Ys&&Le.convert(_t)!==W.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const dt=mt===Hv&&(de.has("EXT_color_buffer_half_float")||pe.isWebGL2&&de.has("EXT_color_buffer_float"));if(mt!==Xu&&Le.convert(mt)!==W.getParameter(35738)&&!(mt===Eu&&(pe.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float")))&&!dt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=N.width-$&&he>=0&&he<=N.height-fe&&W.readPixels(ee,he,$,fe,Le.convert(_t),Le.convert(mt),je)}finally{const ot=x!==null?ae.get(x).__webglFramebuffer:null;ce.bindFramebuffer(36160,ot)}}},this.copyFramebufferToTexture=function(N,ee,he=0){const $=Math.pow(2,-he),fe=Math.floor(ee.image.width*$),je=Math.floor(ee.image.height*$);le.setTexture2D(ee,0),W.copyTexSubImage2D(3553,he,0,0,N.x,N.y,fe,je),ce.unbindTexture()},this.copyTextureToTexture=function(N,ee,he,$=0){const fe=ee.image.width,je=ee.image.height,$e=Le.convert(he.format),rt=Le.convert(he.type);le.setTexture2D(he,0),W.pixelStorei(37440,he.flipY),W.pixelStorei(37441,he.premultiplyAlpha),W.pixelStorei(3317,he.unpackAlignment),ee.isDataTexture?W.texSubImage2D(3553,$,N.x,N.y,fe,je,$e,rt,ee.image.data):ee.isCompressedTexture?W.compressedTexSubImage2D(3553,$,N.x,N.y,ee.mipmaps[0].width,ee.mipmaps[0].height,$e,ee.mipmaps[0].data):W.texSubImage2D(3553,$,N.x,N.y,$e,rt,ee.image),$===0&&he.generateMipmaps&&W.generateMipmap(3553),ce.unbindTexture()},this.copyTextureToTexture3D=function(N,ee,he,$,fe=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const je=N.max.x-N.min.x+1,$e=N.max.y-N.min.y+1,rt=N.max.z-N.min.z+1,ot=Le.convert($.format),_t=Le.convert($.type);let mt;if($.isData3DTexture)le.setTexture3D($,0),mt=32879;else if($.isDataArrayTexture)le.setTexture2DArray($,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(37440,$.flipY),W.pixelStorei(37441,$.premultiplyAlpha),W.pixelStorei(3317,$.unpackAlignment);const dt=W.getParameter(3314),si=W.getParameter(32878),Ti=W.getParameter(3316),Pn=W.getParameter(3315),Or=W.getParameter(32877),Ut=he.isCompressedTexture?he.mipmaps[0]:he.image;W.pixelStorei(3314,Ut.width),W.pixelStorei(32878,Ut.height),W.pixelStorei(3316,N.min.x),W.pixelStorei(3315,N.min.y),W.pixelStorei(32877,N.min.z),he.isDataTexture||he.isData3DTexture?W.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,_t,Ut.data):he.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),W.compressedTexSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,Ut.data)):W.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,_t,Ut),W.pixelStorei(3314,dt),W.pixelStorei(32878,si),W.pixelStorei(3316,Ti),W.pixelStorei(3315,Pn),W.pixelStorei(32877,Or),fe===0&&$.generateMipmaps&&W.generateMipmap(mt),ce.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?le.setTextureCube(N,0):N.isData3DTexture?le.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?le.setTexture2DArray(N,0):le.setTexture2D(N,0),ce.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,ce.reset(),ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class gQ extends QE{}gQ.prototype.isWebGL1Renderer=!0;class JE{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new ct(e),this.density=i}clone(){return new JE(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class KE{constructor(e,i=1,n=1e3){this.isFog=!0,this.name="",this.color=new ct(e),this.near=i,this.far=n}clone(){return new KE(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Q1 extends vi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class H_{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=X1,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Go()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,n){e*=this.stride,n*=i.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=i.array[n+r];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(i,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const vs=new ie;class Id{constructor(e,i,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,n=this.data.count;i<n;i++)vs.fromBufferAttribute(this,i),vs.applyMatrix4(e),this.setXYZ(i,vs.x,vs.y,vs.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)vs.fromBufferAttribute(this,i),vs.applyNormalMatrix(e),this.setXYZ(i,vs.x,vs.y,vs.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)vs.fromBufferAttribute(this,i),vs.transformDirection(e),this.setXYZ(i,vs.x,vs.y,vs.z);return this}setX(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=Tu(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=Tu(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=Tu(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=Tu(i,this.array)),i}setXY(e,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this}setXYZ(e,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array),r=Gi(r,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,i,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),n=Gi(n,this.array),r=Gi(r,this.array),s=Gi(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return new Ai(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Id(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class tN extends Zn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ct(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Um;const Dy=new ie,Gm=new ie,Vm=new ie,Hm=new Ve,Iy=new Ve,vQ=new Nt,rS=new ie,Ly=new ie,sS=new ie,B5=new Ve,jP=new Ve,R5=new Ve;class yQ extends vi{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Um===void 0){Um=new $t;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new H_(i,5);Um.setIndex([0,1,2,0,2,3]),Um.setAttribute("position",new Id(n,3,0,!1)),Um.setAttribute("uv",new Id(n,2,3,!1))}this.geometry=Um,this.material=e!==void 0?e:new tN,this.center=new Ve(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Gm.setFromMatrixScale(this.matrixWorld),vQ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Gm.multiplyScalar(-Vm.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const o=this.center;oS(rS.set(-.5,-.5,0),Vm,o,Gm,r,s),oS(Ly.set(.5,-.5,0),Vm,o,Gm,r,s),oS(sS.set(.5,.5,0),Vm,o,Gm,r,s),B5.set(0,0),jP.set(1,0),R5.set(1,1);let a=e.ray.intersectTriangle(rS,Ly,sS,!1,Dy);if(a===null&&(oS(Ly.set(-.5,.5,0),Vm,o,Gm,r,s),jP.set(0,1),a=e.ray.intersectTriangle(rS,sS,Ly,!1,Dy),a===null))return;const l=e.ray.origin.distanceTo(Dy);l<e.near||l>e.far||i.push({distance:l,point:Dy.clone(),uv:Ca.getUV(Dy,rS,Ly,sS,B5,jP,R5,new Ve),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function oS(t,e,i,n,r,s){Hm.subVectors(t,i).addScalar(.5).multiply(n),r!==void 0?(Iy.x=s*Hm.x-r*Hm.y,Iy.y=r*Hm.x+s*Hm.y):Iy.copy(Hm),t.copy(e),t.x+=Iy.x,t.y+=Iy.y,t.applyMatrix4(vQ)}const aS=new ie,O5=new ie;class xQ extends vi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let n=0,r=i.length;n<r;n++){const s=i[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,n=0){i=Math.abs(i);const r=this.levels;let s;for(s=0;s<r.length&&!(i<r[s].distance);s++);return r.splice(s,0,{distance:i,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let n,r;for(n=1,r=i.length;n<r;n++){let s=i[n].distance;if(i[n].object.visible&&(s-=s*i[n].hysteresis),e<s)break}return i[n-1].object}return null}raycast(e,i){if(this.levels.length>0){aS.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(aS);this.getObjectForDistance(r).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){aS.setFromMatrixPosition(e.matrixWorld),O5.setFromMatrixPosition(this.matrixWorld);const n=aS.distanceTo(O5)/e.zoom;i[0].object.visible=!0;let r,s;for(r=1,s=i.length;r<s;r++){let o=i[r].distance;if(i[r].object.visible&&(o-=o*i[r].hysteresis),n>=o)i[r-1].object.visible=!1,i[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)i[r].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const o=n[r];i.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return i}}const F5=new ie,N5=new Ci,k5=new Ci,rfe=new ie,z5=new Nt;class iN extends cr{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Nt,this.bindMatrixInverse=new Nt}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ci,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){e.fromBufferAttribute(i,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,i){const n=this.skeleton,r=this.geometry;N5.fromBufferAttribute(r.attributes.skinIndex,e),k5.fromBufferAttribute(r.attributes.skinWeight,e),F5.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let s=0;s<4;s++){const o=k5.getComponent(s);if(o!==0){const a=N5.getComponent(s);z5.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),i.addScaledVector(rfe.copy(F5).applyMatrix4(z5),o)}}return i.applyMatrix4(this.bindMatrixInverse)}}class ZE extends vi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class pv extends on{constructor(e=null,i=1,n=1,r,s,o,a,l,c=Sn,h=Sn,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isDataTexture=!0,this.image={data:e,width:i,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const U5=new Nt,sfe=new Nt;class j_{constructor(e=[],i=[]){this.uuid=Go(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Nt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const n=new Nt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,i=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:sfe;U5.multiplyMatrices(a,i[s]),U5.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new j_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=iQ(e),e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const n=new pv(i,e,e,Ys,Eu);return n.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let i=0,n=this.bones.length;i<n;i++){const r=this.bones[i];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=i[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new ZE),this.bones.push(o),this.boneInverses.push(new Nt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,n=this.boneInverses;for(let r=0,s=i.length;r<s;r++){const o=i[r];e.bones.push(o.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class qv extends Ai{constructor(e,i,n,r=1){super(e,i,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const G5=new Nt,V5=new Nt,lS=[],ofe=new Nt,By=new cr;class nN extends cr{constructor(e,i,n){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new qv(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,ofe)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const n=this.matrixWorld,r=this.count;if(By.geometry=this.geometry,By.material=this.material,By.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,G5),V5.multiplyMatrices(n,G5),By.matrixWorld=V5,By.raycast(e,lS);for(let o=0,a=lS.length;o<a;o++){const l=lS[o];l.instanceId=s,l.object=this,i.push(l)}lS.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new qv(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ps extends Zn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ct(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const H5=new ie,j5=new ie,W5=new Nt,WP=new z_,cS=new Wd;class qu extends vi{constructor(e=new $t,i=new ps){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[0];for(let r=1,s=i.count;r<s;r++)H5.fromBufferAttribute(i,r-1),j5.fromBufferAttribute(i,r),n[r]=n[r-1],n[r]+=H5.distanceTo(j5);e.setAttribute("lineDistance",new wt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cS.copy(n.boundingSphere),cS.applyMatrix4(r),cS.radius+=s,e.ray.intersectsSphere(cS)===!1)return;W5.copy(r).invert(),WP.copy(e.ray).applyMatrix4(W5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new ie,h=new ie,u=new ie,d=new ie,f=this.isLineSegments?2:1,p=n.index,g=n.attributes.position;if(p!==null){const v=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let x=v,b=y-1;x<b;x+=f){const S=p.getX(x),A=p.getX(x+1);if(c.fromBufferAttribute(g,S),h.fromBufferAttribute(g,A),WP.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||i.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count);for(let x=v,b=y-1;x<b;x+=f){if(c.fromBufferAttribute(g,x),h.fromBufferAttribute(g,x+1),WP.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(d);A<e.near||A>e.far||i.push({distance:A,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const X5=new ie,q5=new ie;class Bl extends qu{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,n=[];for(let r=0,s=i.count;r<s;r+=2)X5.fromBufferAttribute(i,r),q5.fromBufferAttribute(i,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+X5.distanceTo(q5);e.setAttribute("lineDistance",new wt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class rN extends qu{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class W_ extends Zn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ct(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Y5=new Nt,rB=new z_,uS=new Wd,hS=new ie;let sN=class extends vi{constructor(e=new $t,i=new W_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=e.material,this.geometry=e.geometry,this}raycast(e,i){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),uS.copy(n.boundingSphere),uS.applyMatrix4(r),uS.radius+=s,e.ray.intersectsSphere(uS)===!1)return;Y5.copy(r).invert(),rB.copy(e.ray).applyMatrix4(Y5);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,u=n.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,m=f;p<m;p++){const g=c.getX(p);hS.fromBufferAttribute(u,g),Q5(hS,g,l,r,e,i,this)}}else{const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,m=f;p<m;p++)hS.fromBufferAttribute(u,p),Q5(hS,p,l,r,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function Q5(t,e,i,n,r,s,o){const a=rB.distanceSqToPoint(t);if(a<i){const l=new ie;rB.closestPointToPoint(t,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class Ex extends on{constructor(e,i,n,r,s,o,a,l,c){super(e,i,n,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:bi,this.magFilter=s!==void 0?s:bi,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class afe extends on{constructor(e,i,n){super({width:e,height:i}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=Sn,this.minFilter=Sn,this.generateMipmaps=!1,this.needsUpdate=!0}}class oN extends on{constructor(e,i,n,r,s,o,a,l,c,h,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isCompressedTexture=!0,this.image={width:i,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class lfe extends oN{constructor(e,i,n,r,s,o){super(e,i,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Hr}}class cfe extends on{constructor(e,i,n,r,s,o,a,l,c){super(e,i,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Rl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const n=this.getUtoTmapping(e);return this.getPoint(n,i)}getPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return i}getSpacedPoints(e=5){const i=[];for(let n=0;n<=e;n++)i.push(this.getPointAt(n/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,r=this.getPoint(0),s=0;i.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),i.push(s),r=n;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const n=this.getLengths();let r=0;const s=n.length;let o;i?o=i:o=e*n[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=n[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===o)return r/(s-1);const h=n[r],d=n[r+1]-h,f=(o-h)/d;return(r+f)/(s-1)}getTangent(e,i){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=i||(o.isVector2?new Ve:new ie);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,i){const n=this.getUtoTmapping(e);return this.getTangent(n,i)}computeFrenetFrames(e,i){const n=new ie,r=[],s=[],o=[],a=new ie,l=new Nt;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new ie)}s[0]=new ie,o[0]=new ie;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),d<=c&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(Nn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(i===!0){let f=Math.acos(Nn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class $E extends Rl{constructor(e=0,i=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,i){const n=i||new Ve,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*h-f*u+this.aX,c=d*u+f*h+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class _Q extends $E{constructor(e,i,n,r,s,o){super(e,i,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function aN(){let t=0,e=0,i=0,n=0;function r(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return t+e*s+i*o+n*a}}}const dS=new ie,XP=new aN,qP=new aN,YP=new aN;class wQ extends Rl{constructor(e=[],i=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=n,this.tension=r}getPoint(e,i=new ie){const n=i,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(dS.subVectors(r[0],r[1]).add(r[0]),c=dS);const u=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(dS.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=dS),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(u),f),m=Math.pow(u.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(h),f);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),XP.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,p,m,g),qP.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,p,m,g),YP.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,p,m,g)}else this.curveType==="catmullrom"&&(XP.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),qP.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),YP.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return n.set(XP.calc(l),qP.calc(l),YP.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new ie().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function J5(t,e,i,n,r){const s=(n-e)*.5,o=(r-i)*.5,a=t*t,l=t*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*t+i}function ufe(t,e){const i=1-t;return i*i*e}function hfe(t,e){return 2*(1-t)*t*e}function dfe(t,e){return t*t*e}function Kx(t,e,i,n){return ufe(t,e)+hfe(t,i)+dfe(t,n)}function ffe(t,e){const i=1-t;return i*i*i*e}function pfe(t,e){const i=1-t;return 3*i*i*t*e}function mfe(t,e){return 3*(1-t)*t*t*e}function gfe(t,e){return t*t*t*e}function Zx(t,e,i,n,r){return ffe(t,e)+pfe(t,i)+mfe(t,n)+gfe(t,r)}class lN extends Rl{constructor(e=new Ve,i=new Ve,n=new Ve,r=new Ve){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new Ve){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Zx(e,r.x,s.x,o.x,a.x),Zx(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class bQ extends Rl{constructor(e=new ie,i=new ie,n=new ie,r=new ie){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new ie){const n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Zx(e,r.x,s.x,o.x,a.x),Zx(e,r.y,s.y,o.y,a.y),Zx(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eT extends Rl{constructor(e=new Ve,i=new Ve){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new Ve){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i){const n=i||new Ve;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class SQ extends Rl{constructor(e=new ie,i=new ie){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new ie){const n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class cN extends Rl{constructor(e=new Ve,i=new Ve,n=new Ve){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new Ve){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(Kx(e,r.x,s.x,o.x),Kx(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uN extends Rl{constructor(e=new ie,i=new ie,n=new ie){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=n}getPoint(e,i=new ie){const n=i,r=this.v0,s=this.v1,o=this.v2;return n.set(Kx(e,r.x,s.x,o.x),Kx(e,r.y,s.y,o.y),Kx(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hN extends Rl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new Ve){const n=i,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return n.set(J5(a,l.x,c.x,h.x,u.x),J5(a,l.y,c.y,h.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,n=this.points.length;i<n;i++){const r=this.points[i];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,n=e.points.length;i<n;i++){const r=e.points[i];this.points.push(new Ve().fromArray(r))}return this}}var dN=Object.freeze({__proto__:null,ArcCurve:_Q,CatmullRomCurve3:wQ,CubicBezierCurve:lN,CubicBezierCurve3:bQ,EllipseCurve:$E,LineCurve:eT,LineCurve3:SQ,QuadraticBezierCurve:cN,QuadraticBezierCurve3:uN,SplineCurve:hN});class AQ extends Rl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);e.equals(i)||this.curves.push(new eT(i,e))}getPoint(e,i){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const o=r[s]-n,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,i)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let n=0,r=this.curves.length;n<r;n++)i+=this.curves[n].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let n=0;n<=e;n++)i.push(this.getPoint(n/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];n&&n.equals(h)||(i.push(h),n=h)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const r=this.curves[i];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,n=e.curves.length;i<n;i++){const r=e.curves[i];this.curves.push(new dN[r.type]().fromJSON(r))}return this}}class J1 extends AQ{constructor(e){super(),this.type="Path",this.currentPoint=new Ve,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,n=e.length;i<n;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const n=new eT(this.currentPoint.clone(),new Ve(e,i));return this.curves.push(n),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,n,r){const s=new cN(this.currentPoint.clone(),new Ve(e,i),new Ve(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,i,n,r,s,o){const a=new lN(this.currentPoint.clone(),new Ve(e,i),new Ve(n,r),new Ve(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),n=new hN(i);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,n,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,i+l,n,r,s,o),this}absarc(e,i,n,r,s,o){return this.absellipse(e,i,n,n,r,s,o),this}ellipse(e,i,n,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,i+h,n,r,s,o,a,l),this}absellipse(e,i,n,r,s,o,a,l){const c=new $E(e,i,n,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class C0 extends $t{constructor(e=[new Ve(0,-.5),new Ve(.5,0),new Ve(0,.5)],i=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:n,phiLength:r},i=Math.floor(i),r=Nn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],h=1/i,u=new ie,d=new Ve,f=new ie,p=new ie,m=new ie;let g=0,v=0;for(let y=0;y<=e.length-1;y++)switch(y){case 0:g=e[y+1].x-e[y].x,v=e[y+1].y-e[y].y,f.x=v*1,f.y=-g,f.z=v*0,m.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[y+1].x-e[y].x,v=e[y+1].y-e[y].y,f.x=v*1,f.y=-g,f.z=v*0,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),l.push(f.x,f.y,f.z),m.copy(p)}for(let y=0;y<=i;y++){const x=n+y*h*r,b=Math.sin(x),S=Math.cos(x);for(let A=0;A<=e.length-1;A++){u.x=e[A].x*b,u.y=e[A].y,u.z=e[A].x*S,o.push(u.x,u.y,u.z),d.x=y/i,d.y=A/(e.length-1),a.push(d.x,d.y);const E=l[3*A+0]*b,M=l[3*A+1],T=l[3*A+0]*S;c.push(E,M,T)}}for(let y=0;y<i;y++)for(let x=0;x<e.length-1;x++){const b=x+y*e.length,S=b,A=b+e.length,E=b+e.length+1,M=b+1;s.push(S,A,M),s.push(E,M,A)}this.setIndex(s),this.setAttribute("position",new wt(o,3)),this.setAttribute("uv",new wt(a,2)),this.setAttribute("normal",new wt(c,3))}static fromJSON(e){return new C0(e.points,e.segments,e.phiStart,e.phiLength)}}class X_ extends C0{constructor(e=1,i=1,n=4,r=8){const s=new J1;s.absarc(0,-i/2,e,Math.PI*1.5,0),s.absarc(0,i/2,e,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:i,capSegments:n,radialSegments:r}}static fromJSON(e){return new X_(e.radius,e.length,e.capSegments,e.radialSegments)}}class q_ extends $t{constructor(e=1,i=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:n,thetaLength:r},i=Math.max(3,i);const s=[],o=[],a=[],l=[],c=new ie,h=new Ve;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=i;u++,d+=3){const f=n+u/i*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[d]/e+1)/2,h.y=(o[d+1]/e+1)/2,l.push(h.x,h.y)}for(let u=1;u<=i;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new wt(o,3)),this.setAttribute("normal",new wt(a,3)),this.setAttribute("uv",new wt(l,2))}static fromJSON(e){return new q_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class em extends $t{constructor(e=1,i=1,n=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],u=[],d=[],f=[];let p=0;const m=[],g=n/2;let v=0;y(),o===!1&&(e>0&&x(!0),i>0&&x(!1)),this.setIndex(h),this.setAttribute("position",new wt(u,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(f,2));function y(){const b=new ie,S=new ie;let A=0;const E=(i-e)/n;for(let M=0;M<=s;M++){const T=[],P=M/s,I=P*(i-e)+e;for(let k=0;k<=r;k++){const R=k/r,F=R*l+a,V=Math.sin(F),Q=Math.cos(F);S.x=I*V,S.y=-P*n+g,S.z=I*Q,u.push(S.x,S.y,S.z),b.set(V,E,Q).normalize(),d.push(b.x,b.y,b.z),f.push(R,1-P),T.push(p++)}m.push(T)}for(let M=0;M<r;M++)for(let T=0;T<s;T++){const P=m[T][M],I=m[T+1][M],k=m[T+1][M+1],R=m[T][M+1];h.push(P,I,R),h.push(I,k,R),A+=6}c.addGroup(v,A,0),v+=A}function x(b){const S=p,A=new Ve,E=new ie;let M=0;const T=b===!0?e:i,P=b===!0?1:-1;for(let k=1;k<=r;k++)u.push(0,g*P,0),d.push(0,P,0),f.push(.5,.5),p++;const I=p;for(let k=0;k<=r;k++){const F=k/r*l+a,V=Math.cos(F),Q=Math.sin(F);E.x=T*Q,E.y=g*P,E.z=T*V,u.push(E.x,E.y,E.z),d.push(0,P,0),A.x=V*.5+.5,A.y=Q*.5*P+.5,f.push(A.x,A.y),p++}for(let k=0;k<r;k++){const R=S+k,F=I+k;b===!0?h.push(F,F+1,R):h.push(F+1,F,R),M+=3}c.addGroup(v,M,b===!0?1:2),v+=M}}static fromJSON(e){return new em(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Y_ extends em{constructor(e=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,i,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Y_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class eh extends $t{constructor(e=[],i=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:n,detail:r};const s=[],o=[];a(r),c(n),h(),this.setAttribute("position",new wt(s,3)),this.setAttribute("normal",new wt(s.slice(),3)),this.setAttribute("uv",new wt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(y){const x=new ie,b=new ie,S=new ie;for(let A=0;A<i.length;A+=3)f(i[A+0],x),f(i[A+1],b),f(i[A+2],S),l(x,b,S,y)}function l(y,x,b,S){const A=S+1,E=[];for(let M=0;M<=A;M++){E[M]=[];const T=y.clone().lerp(b,M/A),P=x.clone().lerp(b,M/A),I=A-M;for(let k=0;k<=I;k++)k===0&&M===A?E[M][k]=T:E[M][k]=T.clone().lerp(P,k/I)}for(let M=0;M<A;M++)for(let T=0;T<2*(A-M)-1;T++){const P=Math.floor(T/2);T%2===0?(d(E[M][P+1]),d(E[M+1][P]),d(E[M][P])):(d(E[M][P+1]),d(E[M+1][P+1]),d(E[M+1][P]))}}function c(y){const x=new ie;for(let b=0;b<s.length;b+=3)x.x=s[b+0],x.y=s[b+1],x.z=s[b+2],x.normalize().multiplyScalar(y),s[b+0]=x.x,s[b+1]=x.y,s[b+2]=x.z}function h(){const y=new ie;for(let x=0;x<s.length;x+=3){y.x=s[x+0],y.y=s[x+1],y.z=s[x+2];const b=g(y)/2/Math.PI+.5,S=v(y)/Math.PI+.5;o.push(b,1-S)}p(),u()}function u(){for(let y=0;y<o.length;y+=6){const x=o[y+0],b=o[y+2],S=o[y+4],A=Math.max(x,b,S),E=Math.min(x,b,S);A>.9&&E<.1&&(x<.2&&(o[y+0]+=1),b<.2&&(o[y+2]+=1),S<.2&&(o[y+4]+=1))}}function d(y){s.push(y.x,y.y,y.z)}function f(y,x){const b=y*3;x.x=e[b+0],x.y=e[b+1],x.z=e[b+2]}function p(){const y=new ie,x=new ie,b=new ie,S=new ie,A=new Ve,E=new Ve,M=new Ve;for(let T=0,P=0;T<s.length;T+=9,P+=6){y.set(s[T+0],s[T+1],s[T+2]),x.set(s[T+3],s[T+4],s[T+5]),b.set(s[T+6],s[T+7],s[T+8]),A.set(o[P+0],o[P+1]),E.set(o[P+2],o[P+3]),M.set(o[P+4],o[P+5]),S.copy(y).add(x).add(b).divideScalar(3);const I=g(S);m(A,P+0,y,I),m(E,P+2,x,I),m(M,P+4,b,I)}}function m(y,x,b,S){S<0&&y.x===1&&(o[x]=y.x-1),b.x===0&&b.z===0&&(o[x]=S/2/Math.PI+.5)}function g(y){return Math.atan2(y.z,-y.x)}function v(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}static fromJSON(e){return new eh(e.vertices,e.indices,e.radius,e.details)}}class Q_ extends eh{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Q_(e.radius,e.detail)}}const fS=new ie,pS=new ie,QP=new ie,mS=new Ca;class MQ extends $t{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const r=Math.pow(10,4),s=Math.cos(xp*i),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:g,c:v}=mS;if(m.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),v.fromBufferAttribute(a,c[2]),mS.getNormal(QP),u[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,u[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let y=0;y<3;y++){const x=(y+1)%3,b=u[y],S=u[x],A=mS[h[y]],E=mS[h[x]],M=`${b}_${S}`,T=`${S}_${b}`;T in d&&d[T]?(QP.dot(d[T].normal)<=s&&(f.push(A.x,A.y,A.z),f.push(E.x,E.y,E.z)),d[T]=null):M in d||(d[M]={index0:c[y],index1:c[x],normal:QP.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:g}=d[p];fS.fromBufferAttribute(a,m),pS.fromBufferAttribute(a,g),f.push(fS.x,fS.y,fS.z),f.push(pS.x,pS.y,pS.z)}this.setAttribute("position",new wt(f,3))}}}class bp extends J1{constructor(e){super(e),this.uuid=Go(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let n=0,r=this.holes.length;n<r;n++)i[n]=this.holes[n].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const r=this.holes[i];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,n=e.holes.length;i<n;i++){const r=e.holes[i];this.holes.push(new J1().fromJSON(r))}return this}}const vfe={triangulate:function(t,e,i=2){const n=e&&e.length,r=n?e[0]*i:t.length;let s=CQ(t,0,r,i,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=bfe(t,e,s,i)),t.length>80*i){a=c=t[0],l=h=t[1];for(let p=i;p<r;p+=i)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return K1(s,o,i,a,l,f,0),o}};function CQ(t,e,i,n,r){let s,o;if(r===Bfe(t,e,i,n)>0)for(s=e;s<i;s+=n)o=K5(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=K5(s,t[s],t[s+1],o);return o&&tT(o,o.next)&&($1(o),o=o.next),o}function Gp(t,e){if(!t)return t;e||(e=t);let i=t,n;do if(n=!1,!i.steiner&&(tT(i,i.next)||un(i.prev,i,i.next)===0)){if($1(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function K1(t,e,i,n,r,s,o){if(!t)return;!o&&s&&Efe(t,n,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?xfe(t,n,r,s):yfe(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(c.i/i|0),$1(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=_fe(Gp(t),e,i),K1(t,e,i,n,r,s,2)):o===2&&wfe(t,e,i,n,r,s):K1(Gp(t),e,i,n,r,s,1);break}}}function yfe(t){const e=t.prev,i=t,n=t.next;if(un(e,i,n)>=0)return!1;const r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=n.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Wg(r,a,s,l,o,c,p.x,p.y)&&un(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function xfe(t,e,i,n){const r=t.prev,s=t,o=t.next;if(un(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,m=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,v=sB(f,p,e,i,n),y=sB(m,g,e,i,n);let x=t.prevZ,b=t.nextZ;for(;x&&x.z>=v&&b&&b.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&Wg(a,h,l,u,c,d,x.x,x.y)&&un(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&Wg(a,h,l,u,c,d,b.x,b.y)&&un(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&Wg(a,h,l,u,c,d,x.x,x.y)&&un(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&Wg(a,h,l,u,c,d,b.x,b.y)&&un(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function _fe(t,e,i){let n=t;do{const r=n.prev,s=n.next.next;!tT(r,s)&&EQ(r,n,n.next,s)&&Z1(r,s)&&Z1(s,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(s.i/i|0),$1(n),$1(n.next),n=t=s),n=n.next}while(n!==t);return Gp(n)}function wfe(t,e,i,n,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Dfe(o,a)){let l=TQ(o,a);o=Gp(o,o.next),l=Gp(l,l.next),K1(o,e,i,n,r,s,0),K1(l,e,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function bfe(t,e,i,n){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,c=CQ(t,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(Pfe(c));for(r.sort(Sfe),s=0;s<r.length;s++)i=Afe(r[s],i);return i}function Sfe(t,e){return t.x-e.x}function Afe(t,e){const i=Mfe(t,e);if(!i)return e;const n=TQ(i,t);return Gp(n,n.next),Gp(i,i.next)}function Mfe(t,e){let i=e,n=-1/0,r;const s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&Wg(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),Z1(i,t)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&Cfe(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function Cfe(t,e){return un(t.prev,t,e.prev)<0&&un(e.next,t,t.next)<0}function Efe(t,e,i,n){let r=t;do r.z===0&&(r.z=sB(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Tfe(r)}function Tfe(t){let e,i,n,r,s,o,a,l,c=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return t}function sB(t,e,i,n,r){return t=(t-i)*r|0,e=(e-n)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Pfe(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function Wg(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function Dfe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Ife(t,e)&&(Z1(t,e)&&Z1(e,t)&&Lfe(t,e)&&(un(t.prev,t,e.prev)||un(t,e.prev,e))||tT(t,e)&&un(t.prev,t,t.next)>0&&un(e.prev,e,e.next)>0)}function un(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function tT(t,e){return t.x===e.x&&t.y===e.y}function EQ(t,e,i,n){const r=vS(un(t,e,i)),s=vS(un(t,e,n)),o=vS(un(i,n,t)),a=vS(un(i,n,e));return!!(r!==s&&o!==a||r===0&&gS(t,i,e)||s===0&&gS(t,n,e)||o===0&&gS(i,t,n)||a===0&&gS(i,e,n))}function gS(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function vS(t){return t>0?1:t<0?-1:0}function Ife(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&EQ(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function Z1(t,e){return un(t.prev,t,t.next)<0?un(t,e,t.next)>=0&&un(t,t.prev,e)>=0:un(t,e,t.prev)<0||un(t,t.next,e)<0}function Lfe(t,e){let i=t,n=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function TQ(t,e){const i=new oB(t.i,t.x,t.y),n=new oB(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function K5(t,e,i,n){const r=new oB(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function oB(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bfe(t,e,i,n){let r=0;for(let s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class wc{static area(e){const i=e.length;let n=0;for(let r=i-1,s=0;s<i;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return wc.area(e)<0}static triangulateShape(e,i){const n=[],r=[],s=[];Z5(e),$5(n,e);let o=e.length;i.forEach(Z5);for(let l=0;l<i.length;l++)r.push(o),o+=i[l].length,$5(n,i[l]);const a=vfe.triangulate(n,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Z5(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function $5(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class J_ extends $t{constructor(e=new bp([new Ve(.5,.5),new Ve(-.5,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new wt(r,3)),this.setAttribute("uv",new wt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=i.curveSegments!==void 0?i.curveSegments:12,h=i.steps!==void 0?i.steps:1,u=i.depth!==void 0?i.depth:1;let d=i.bevelEnabled!==void 0?i.bevelEnabled:!0,f=i.bevelThickness!==void 0?i.bevelThickness:.2,p=i.bevelSize!==void 0?i.bevelSize:f-.1,m=i.bevelOffset!==void 0?i.bevelOffset:0,g=i.bevelSegments!==void 0?i.bevelSegments:3;const v=i.extrudePath,y=i.UVGenerator!==void 0?i.UVGenerator:Rfe;let x,b=!1,S,A,E,M;v&&(x=v.getSpacedPoints(h),b=!0,d=!1,S=v.computeFrenetFrames(h,!1),A=new ie,E=new ie,M=new ie),d||(g=0,f=0,p=0,m=0);const T=a.extractPoints(c);let P=T.shape;const I=T.holes;if(!wc.isClockWise(P)){P=P.reverse();for(let ae=0,le=I.length;ae<le;ae++){const Ee=I[ae];wc.isClockWise(Ee)&&(I[ae]=Ee.reverse())}}const R=wc.triangulateShape(P,I),F=P;for(let ae=0,le=I.length;ae<le;ae++){const Ee=I[ae];P=P.concat(Ee)}function V(ae,le,Ee){return le||console.error("THREE.ExtrudeGeometry: vec does not exist"),le.clone().multiplyScalar(Ee).add(ae)}const Q=P.length,X=R.length;function z(ae,le,Ee){let Te,Be,Ue;const Ie=ae.x-le.x,Pe=ae.y-le.y,Je=Ee.x-ae.x,Ke=Ee.y-ae.y,U=Ie*Ie+Pe*Pe,L=Ie*Ke-Pe*Je;if(Math.abs(L)>Number.EPSILON){const te=Math.sqrt(U),_e=Math.sqrt(Je*Je+Ke*Ke),we=le.x-Pe/te,Me=le.y+Ie/te,We=Ee.x-Ke/_e,Le=Ee.y+Je/_e,ue=((We-we)*Ke-(Le-Me)*Je)/(Ie*Ke-Pe*Je);Te=we+Ie*ue-ae.x,Be=Me+Pe*ue-ae.y;const Ge=Te*Te+Be*Be;if(Ge<=2)return new Ve(Te,Be);Ue=Math.sqrt(Ge/2)}else{let te=!1;Ie>Number.EPSILON?Je>Number.EPSILON&&(te=!0):Ie<-Number.EPSILON?Je<-Number.EPSILON&&(te=!0):Math.sign(Pe)===Math.sign(Ke)&&(te=!0),te?(Te=-Pe,Be=Ie,Ue=Math.sqrt(U)):(Te=Ie,Be=Pe,Ue=Math.sqrt(U/2))}return new Ve(Te/Ue,Be/Ue)}const Y=[];for(let ae=0,le=F.length,Ee=le-1,Te=ae+1;ae<le;ae++,Ee++,Te++)Ee===le&&(Ee=0),Te===le&&(Te=0),Y[ae]=z(F[ae],F[Ee],F[Te]);const j=[];let J,H=Y.concat();for(let ae=0,le=I.length;ae<le;ae++){const Ee=I[ae];J=[];for(let Te=0,Be=Ee.length,Ue=Be-1,Ie=Te+1;Te<Be;Te++,Ue++,Ie++)Ue===Be&&(Ue=0),Ie===Be&&(Ie=0),J[Te]=z(Ee[Te],Ee[Ue],Ee[Ie]);j.push(J),H=H.concat(J)}for(let ae=0;ae<g;ae++){const le=ae/g,Ee=f*Math.cos(le*Math.PI/2),Te=p*Math.sin(le*Math.PI/2)+m;for(let Be=0,Ue=F.length;Be<Ue;Be++){const Ie=V(F[Be],Y[Be],Te);ve(Ie.x,Ie.y,-Ee)}for(let Be=0,Ue=I.length;Be<Ue;Be++){const Ie=I[Be];J=j[Be];for(let Pe=0,Je=Ie.length;Pe<Je;Pe++){const Ke=V(Ie[Pe],J[Pe],Te);ve(Ke.x,Ke.y,-Ee)}}}const Z=p+m;for(let ae=0;ae<Q;ae++){const le=d?V(P[ae],H[ae],Z):P[ae];b?(E.copy(S.normals[0]).multiplyScalar(le.x),A.copy(S.binormals[0]).multiplyScalar(le.y),M.copy(x[0]).add(E).add(A),ve(M.x,M.y,M.z)):ve(le.x,le.y,0)}for(let ae=1;ae<=h;ae++)for(let le=0;le<Q;le++){const Ee=d?V(P[le],H[le],Z):P[le];b?(E.copy(S.normals[ae]).multiplyScalar(Ee.x),A.copy(S.binormals[ae]).multiplyScalar(Ee.y),M.copy(x[ae]).add(E).add(A),ve(M.x,M.y,M.z)):ve(Ee.x,Ee.y,u/h*ae)}for(let ae=g-1;ae>=0;ae--){const le=ae/g,Ee=f*Math.cos(le*Math.PI/2),Te=p*Math.sin(le*Math.PI/2)+m;for(let Be=0,Ue=F.length;Be<Ue;Be++){const Ie=V(F[Be],Y[Be],Te);ve(Ie.x,Ie.y,u+Ee)}for(let Be=0,Ue=I.length;Be<Ue;Be++){const Ie=I[Be];J=j[Be];for(let Pe=0,Je=Ie.length;Pe<Je;Pe++){const Ke=V(Ie[Pe],J[Pe],Te);b?ve(Ke.x,Ke.y+x[h-1].y,x[h-1].x+Ee):ve(Ke.x,Ke.y,u+Ee)}}}K(),ne();function K(){const ae=r.length/3;if(d){let le=0,Ee=Q*le;for(let Te=0;Te<X;Te++){const Be=R[Te];de(Be[2]+Ee,Be[1]+Ee,Be[0]+Ee)}le=h+g*2,Ee=Q*le;for(let Te=0;Te<X;Te++){const Be=R[Te];de(Be[0]+Ee,Be[1]+Ee,Be[2]+Ee)}}else{for(let le=0;le<X;le++){const Ee=R[le];de(Ee[2],Ee[1],Ee[0])}for(let le=0;le<X;le++){const Ee=R[le];de(Ee[0]+Q*h,Ee[1]+Q*h,Ee[2]+Q*h)}}n.addGroup(ae,r.length/3-ae,0)}function ne(){const ae=r.length/3;let le=0;W(F,le),le+=F.length;for(let Ee=0,Te=I.length;Ee<Te;Ee++){const Be=I[Ee];W(Be,le),le+=Be.length}n.addGroup(ae,r.length/3-ae,1)}function W(ae,le){let Ee=ae.length;for(;--Ee>=0;){const Te=Ee;let Be=Ee-1;Be<0&&(Be=ae.length-1);for(let Ue=0,Ie=h+g*2;Ue<Ie;Ue++){const Pe=Q*Ue,Je=Q*(Ue+1),Ke=le+Te+Pe,U=le+Be+Pe,L=le+Be+Je,te=le+Te+Je;pe(Ke,U,L,te)}}}function ve(ae,le,Ee){l.push(ae),l.push(le),l.push(Ee)}function de(ae,le,Ee){ce(ae),ce(le),ce(Ee);const Te=r.length/3,Be=y.generateTopUV(n,r,Te-3,Te-2,Te-1);ye(Be[0]),ye(Be[1]),ye(Be[2])}function pe(ae,le,Ee,Te){ce(ae),ce(le),ce(Te),ce(le),ce(Ee),ce(Te);const Be=r.length/3,Ue=y.generateSideWallUV(n,r,Be-6,Be-3,Be-2,Be-1);ye(Ue[0]),ye(Ue[1]),ye(Ue[3]),ye(Ue[1]),ye(Ue[2]),ye(Ue[3])}function ce(ae){r.push(l[ae*3+0]),r.push(l[ae*3+1]),r.push(l[ae*3+2])}function ye(ae){s.push(ae.x),s.push(ae.y)}}}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,n=this.parameters.options;return Ofe(i,n,e)}static fromJSON(e,i){const n=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=i[e.shapes[s]];n.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new dN[r.type]().fromJSON(r)),new J_(n,e.options)}}const Rfe={generateTopUV:function(t,e,i,n,r){const s=e[i*3],o=e[i*3+1],a=e[n*3],l=e[n*3+1],c=e[r*3],h=e[r*3+1];return[new Ve(s,o),new Ve(a,l),new Ve(c,h)]},generateSideWallUV:function(t,e,i,n,r,s){const o=e[i*3],a=e[i*3+1],l=e[i*3+2],c=e[n*3],h=e[n*3+1],u=e[n*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],m=e[s*3],g=e[s*3+1],v=e[s*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Ve(o,1-l),new Ve(c,1-u),new Ve(d,1-p),new Ve(m,1-v)]:[new Ve(a,1-l),new Ve(h,1-u),new Ve(f,1-p),new Ve(g,1-v)]}};function Ofe(t,e,i){if(i.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const s=t[n];i.shapes.push(s.uuid)}else i.shapes.push(t.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class K_ extends eh{constructor(e=1,i=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new K_(e.radius,e.detail)}}class E0 extends eh{constructor(e=1,i=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new E0(e.radius,e.detail)}}class Z_ extends $t{constructor(e=.5,i=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);const a=[],l=[],c=[],h=[];let u=e;const d=(i-e)/r,f=new ie,p=new Ve;for(let m=0;m<=r;m++){for(let g=0;g<=n;g++){const v=s+g/n*o;f.x=u*Math.cos(v),f.y=u*Math.sin(v),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/i+1)/2,p.y=(f.y/i+1)/2,h.push(p.x,p.y)}u+=d}for(let m=0;m<r;m++){const g=m*(n+1);for(let v=0;v<n;v++){const y=v+g,x=y,b=y+n+1,S=y+n+2,A=y+1;a.push(x,b,A),a.push(b,S,A)}}this.setIndex(a),this.setAttribute("position",new wt(l,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(h,2))}static fromJSON(e){return new Z_(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class $_ extends $t{constructor(e=new bp([new Ve(0,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const n=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new wt(r,3)),this.setAttribute("normal",new wt(s,3)),this.setAttribute("uv",new wt(o,2));function c(h){const u=r.length/3,d=h.extractPoints(i);let f=d.shape;const p=d.holes;wc.isClockWise(f)===!1&&(f=f.reverse());for(let g=0,v=p.length;g<v;g++){const y=p[g];wc.isClockWise(y)===!0&&(p[g]=y.reverse())}const m=wc.triangulateShape(f,p);for(let g=0,v=p.length;g<v;g++){const y=p[g];f=f.concat(y)}for(let g=0,v=f.length;g<v;g++){const y=f[g];r.push(y.x,y.y,0),s.push(0,0,1),o.push(y.x,y.y)}for(let g=0,v=m.length;g<v;g++){const y=m[g],x=y[0]+u,b=y[1]+u,S=y[2]+u;n.push(x,b,S),l+=3}}}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return Ffe(i,e)}static fromJSON(e,i){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=i[e.shapes[r]];n.push(o)}return new $_(n,e.curveSegments)}}function Ffe(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){const r=t[i];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class T0 extends $t{constructor(e=1,i=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const h=[],u=new ie,d=new ie,f=[],p=[],m=[],g=[];for(let v=0;v<=n;v++){const y=[],x=v/n;let b=0;v==0&&o==0?b=.5/i:v==n&&l==Math.PI&&(b=-.5/i);for(let S=0;S<=i;S++){const A=S/i;u.x=-e*Math.cos(r+A*s)*Math.sin(o+x*a),u.y=e*Math.cos(o+x*a),u.z=e*Math.sin(r+A*s)*Math.sin(o+x*a),p.push(u.x,u.y,u.z),d.copy(u).normalize(),m.push(d.x,d.y,d.z),g.push(A+b,1-x),y.push(c++)}h.push(y)}for(let v=0;v<n;v++)for(let y=0;y<i;y++){const x=h[v][y+1],b=h[v][y],S=h[v+1][y],A=h[v+1][y+1];(v!==0||o>0)&&f.push(x,b,A),(v!==n-1||l<Math.PI)&&f.push(b,S,A)}this.setIndex(f),this.setAttribute("position",new wt(p,3)),this.setAttribute("normal",new wt(m,3)),this.setAttribute("uv",new wt(g,2))}static fromJSON(e){return new T0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class ew extends eh{constructor(e=1,i=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new ew(e.radius,e.detail)}}class tw extends $t{constructor(e=1,i=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new ie,u=new ie,d=new ie;for(let f=0;f<=n;f++)for(let p=0;p<=r;p++){const m=p/r*s,g=f/n*Math.PI*2;u.x=(e+i*Math.cos(g))*Math.cos(m),u.y=(e+i*Math.cos(g))*Math.sin(m),u.z=i*Math.sin(g),a.push(u.x,u.y,u.z),h.x=e*Math.cos(m),h.y=e*Math.sin(m),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let p=1;p<=r;p++){const m=(r+1)*f+p-1,g=(r+1)*(f-1)+p-1,v=(r+1)*(f-1)+p,y=(r+1)*f+p;o.push(m,g,y),o.push(g,v,y)}this.setIndex(o),this.setAttribute("position",new wt(a,3)),this.setAttribute("normal",new wt(l,3)),this.setAttribute("uv",new wt(c,2))}static fromJSON(e){return new tw(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class iw extends $t{constructor(e=1,i=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);const a=[],l=[],c=[],h=[],u=new ie,d=new ie,f=new ie,p=new ie,m=new ie,g=new ie,v=new ie;for(let x=0;x<=n;++x){const b=x/n*s*Math.PI*2;y(b,s,o,e,f),y(b+.01,s,o,e,p),g.subVectors(p,f),v.addVectors(p,f),m.crossVectors(g,v),v.crossVectors(m,g),m.normalize(),v.normalize();for(let S=0;S<=r;++S){const A=S/r*Math.PI*2,E=-i*Math.cos(A),M=i*Math.sin(A);u.x=f.x+(E*v.x+M*m.x),u.y=f.y+(E*v.y+M*m.y),u.z=f.z+(E*v.z+M*m.z),l.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),h.push(x/n),h.push(S/r)}}for(let x=1;x<=n;x++)for(let b=1;b<=r;b++){const S=(r+1)*(x-1)+(b-1),A=(r+1)*x+(b-1),E=(r+1)*x+b,M=(r+1)*(x-1)+b;a.push(S,A,M),a.push(A,E,M)}this.setIndex(a),this.setAttribute("position",new wt(l,3)),this.setAttribute("normal",new wt(c,3)),this.setAttribute("uv",new wt(h,2));function y(x,b,S,A,E){const M=Math.cos(x),T=Math.sin(x),P=S/b*x,I=Math.cos(P);E.x=A*(2+I)*.5*M,E.y=A*(2+I)*T*.5,E.z=A*Math.sin(P)*.5}}static fromJSON(e){return new iw(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class nw extends $t{constructor(e=new uN(new ie(-1,-1,0),new ie(-1,1,0),new ie(1,1,0)),i=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:n,radialSegments:r,closed:s};const o=e.computeFrenetFrames(i,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ie,l=new ie,c=new Ve;let h=new ie;const u=[],d=[],f=[],p=[];m(),this.setIndex(p),this.setAttribute("position",new wt(u,3)),this.setAttribute("normal",new wt(d,3)),this.setAttribute("uv",new wt(f,2));function m(){for(let x=0;x<i;x++)g(x);g(s===!1?i:0),y(),v()}function g(x){h=e.getPointAt(x/i,h);const b=o.normals[x],S=o.binormals[x];for(let A=0;A<=r;A++){const E=A/r*Math.PI*2,M=Math.sin(E),T=-Math.cos(E);l.x=T*b.x+M*S.x,l.y=T*b.y+M*S.y,l.z=T*b.z+M*S.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=h.x+n*l.x,a.y=h.y+n*l.y,a.z=h.z+n*l.z,u.push(a.x,a.y,a.z)}}function v(){for(let x=1;x<=i;x++)for(let b=1;b<=r;b++){const S=(r+1)*(x-1)+(b-1),A=(r+1)*x+(b-1),E=(r+1)*x+b,M=(r+1)*(x-1)+b;p.push(S,A,M),p.push(A,E,M)}}function y(){for(let x=0;x<=i;x++)for(let b=0;b<=r;b++)c.x=x/i,c.y=b/r,f.push(c.x,c.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new nw(new dN[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class PQ extends $t{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],n=new Set,r=new ie,s=new ie;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.start,f=u.count;for(let p=d,m=d+f;p<m;p+=3)for(let g=0;g<3;g++){const v=a.getX(p+g),y=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,v),s.fromBufferAttribute(o,y),eV(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,u=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,u),eV(r,s,n)===!0&&(i.push(r.x,r.y,r.z),i.push(s.x,s.y,s.z))}}this.setAttribute("position",new wt(i,3))}}}function eV(t,e,i){const n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return i.has(n)===!0||i.has(r)===!0?!1:(i.add(n),i.add(r),!0)}var tV=Object.freeze({__proto__:null,BoxGeometry:Xd,CapsuleGeometry:X_,CircleGeometry:q_,ConeGeometry:Y_,CylinderGeometry:em,DodecahedronGeometry:Q_,EdgesGeometry:MQ,ExtrudeGeometry:J_,IcosahedronGeometry:K_,LatheGeometry:C0,OctahedronGeometry:E0,PlaneGeometry:$p,PolyhedronGeometry:eh,RingGeometry:Z_,ShapeGeometry:$_,SphereGeometry:T0,TetrahedronGeometry:ew,TorusGeometry:tw,TorusKnotGeometry:iw,TubeGeometry:nw,WireframeGeometry:PQ});class DQ extends Zn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ct(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class IQ extends Pl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class rw extends Zn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ct(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Fc extends rw{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ve(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Nn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ct(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ct(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ct(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class LQ extends Zn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ct(16777215),this.specular=new ct(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class BQ extends Zn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ct(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class RQ extends Zn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class OQ extends Zn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ct(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ct(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class FQ extends Zn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ct(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Hd,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NQ extends ps{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function xa(t,e,i){return fN(t)?new t.constructor(t.subarray(e,i!==void 0?i:t.length)):t.slice(e,i)}function sp(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function fN(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kQ(t){function e(r,s){return t[r]-t[s]}const i=t.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(e),n}function aB(t,e,i){const n=t.length,r=new t.constructor(n);for(let s=0,o=0;o!==n;++s){const a=i[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function pN(t,e,i,n){let r=1,s=t[0];for(;s!==void 0&&s[n]===void 0;)s=t[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),i.push(o)),s=t[r++];while(s!==void 0)}function Nfe(t,e,i,n,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],h=c.getValueSize(),u=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<i||p>=n)){u.push(c.times[f]);for(let m=0;m<h;++m)d.push(c.values[f*h+m])}}u.length!==0&&(c.times=sp(u,c.times.constructor),c.values=sp(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function kfe(t,e=0,i=t,n=30){n<=0&&(n=30);const r=i.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=i.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(c===void 0)continue;let h=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let m;if(s<=a.times[0]){const v=h,y=u-h;m=xa(a.values,v,y)}else if(s>=a.times[p]){const v=p*u+h,y=v+u-h;m=xa(a.values,v,y)}else{const v=a.createInterpolant(),y=h,x=u-h;v.evaluate(s),m=xa(v.resultBuffer,y,x)}l==="quaternion"&&new Ir().fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let v=0;v<g;++v){const y=v*f+d;if(l==="quaternion")Ir.multiplyQuaternionsFlat(c.values,y,m,0,c.values,y);else{const x=f-d*2;for(let b=0;b<x;++b)c.values[y+b]-=m[b]}}}return t.blendMode=HF,t}var zfe=Object.freeze({__proto__:null,arraySlice:xa,convertArray:sp,flattenJSON:pN,getKeyframeOrder:kQ,isTypedArray:fN,makeClipAdditive:kfe,sortedArray:aB,subclip:Nfe});class P0{constructor(e,i,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new i.constructor(n),this.sampleValues=i,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let n=this._cachedIndex,r=i[n],s=i[n-1];e:{t:{let o;i:{n:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break n;return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=i[++n],e<r)break t}o=i.length;break i}if(!(e>=s)){const a=i[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=i[--n-1],e>=s)break t}o=n,n=0;break i}break e}for(;n<o;){const a=n+o>>>1;e<i[a]?o=a:n=a+1}if(r=i[n],s=i[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=i.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)i[o]=n[s+o];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class zQ extends P0{constructor(e,i,n,r){super(e,i,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ip,endingEnd:ip}}intervalChanged_(e,i,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case np:s=e,a=2*i-n;break;case W1:s=r.length-2,a=i+r[s]-r[s+1];break;default:s=e,a=n}if(l===void 0)switch(this.getSettings_().endingEnd){case np:o=e,l=2*n-i;break;case W1:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=i}const c=(n-i)*.5,h=this.valueSize;this._weightPrev=c/(i-a),this._weightNext=c/(l-n),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-i)/(r-i),m=p*p,g=m*p,v=-d*g+2*d*m-d*p,y=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,x=(-1-f)*g+(1.5+f)*m+.5*p,b=f*g-f*m;for(let S=0;S!==a;++S)s[S]=v*o[h+S]+y*o[c+S]+x*o[l+S]+b*o[u+S];return s}}class mN extends P0{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(n-i)/(r-i),u=1-h;for(let d=0;d!==a;++d)s[d]=o[c+d]*u+o[l+d]*h;return s}}class UQ extends P0{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ol{constructor(e,i,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sp(i,this.TimeBufferType),this.values=sp(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let n;if(i.toJSON!==this.toJSON)n=i.toJSON(e);else{n={name:e.name,times:sp(e.times,Array),values:sp(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new UQ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new mN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new zQ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case jv:i=this.InterpolantFactoryMethodDiscrete;break;case Up:i=this.InterpolantFactoryMethodLinear;break;case pM:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jv;case this.InterpolantFactoryMethodLinear:return Up;case this.InterpolantFactoryMethodSmooth:return pM}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let n=0,r=i.length;n!==r;++n)i[n]*=e}return this}trim(e,i){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>i;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=xa(n,s,o),this.values=xa(this.values,s*a,o*a)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&fN(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=xa(this.times),i=xa(this.values),n=this.getValueSize(),r=this.getInterpolation()===pM,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(r)l=!0;else{const u=a*n,d=u-n,f=u+n;for(let p=0;p!==n;++p){const m=i[u+p];if(m!==i[d+p]||m!==i[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*n,d=o*n;for(let f=0;f!==n;++f)i[d+f]=i[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)i[l+c]=i[a+c];++o}return o!==e.length?(this.times=xa(e,0,o),this.values=xa(i,0,o*n)):(this.times=e,this.values=i),this}clone(){const e=xa(this.times,0),i=xa(this.values,0),n=this.constructor,r=new n(this.name,e,i);return r.createInterpolant=this.createInterpolant,r}}Ol.prototype.TimeBufferType=Float32Array;Ol.prototype.ValueBufferType=Float32Array;Ol.prototype.DefaultInterpolation=Up;class tm extends Ol{}tm.prototype.ValueTypeName="bool";tm.prototype.ValueBufferType=Array;tm.prototype.DefaultInterpolation=jv;tm.prototype.InterpolantFactoryMethodLinear=void 0;tm.prototype.InterpolantFactoryMethodSmooth=void 0;class gN extends Ol{}gN.prototype.ValueTypeName="color";class Yv extends Ol{}Yv.prototype.ValueTypeName="number";class GQ extends P0{constructor(e,i,n,r){super(e,i,n,r)}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-i)/(r-i);let c=e*a;for(let h=c+a;c!==h;c+=4)Ir.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Ld extends Ol{InterpolantFactoryMethodLinear(e){return new GQ(this.times,this.values,this.getValueSize(),e)}}Ld.prototype.ValueTypeName="quaternion";Ld.prototype.DefaultInterpolation=Up;Ld.prototype.InterpolantFactoryMethodSmooth=void 0;class im extends Ol{}im.prototype.ValueTypeName="string";im.prototype.ValueBufferType=Array;im.prototype.DefaultInterpolation=jv;im.prototype.InterpolantFactoryMethodLinear=void 0;im.prototype.InterpolantFactoryMethodSmooth=void 0;class Qv extends Ol{}Qv.prototype.ValueTypeName="vector";class Jv{constructor(e,i=-1,n,r=WE){this.name=e,this.tracks=n,this.duration=i,this.blendMode=r,this.uuid=Go(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)i.push(Gfe(n[o]).scale(r));const s=new this(e.name,e.duration,i,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const i=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)i.push(Ol.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,i,n,r){const s=i.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=kQ(l);l=aB(l,1,h),c=aB(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Yv(".morphTargetInfluences["+i[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,i){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===i)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,i,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const u=h[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],i,n));return o}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(u,d,f,p,m){if(f.length!==0){const g=[],v=[];pN(f,g,v,p),g.length!==0&&m.push(new u(d,g,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const g=[],v=[];for(let y=0;y!==d[p].morphTargets.length;++y){const x=d[p];g.push(x.time),v.push(x.morphTarget===m?1:0)}r.push(new Yv(".morphTargetInfluence["+m+"]",g,v))}l=f.length*o}else{const f=".bones["+i[u].name+"]";n(Qv,f+".position",d,"pos",r),n(Ld,f+".quaternion",d,"rot",r),n(Qv,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let i=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];i=Math.max(i,s.times[s.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ufe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Yv;case"vector":case"vector2":case"vector3":case"vector4":return Qv;case"color":return gN;case"quaternion":return Ld;case"bool":case"boolean":return tm;case"string":return im}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Gfe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Ufe(t.type);if(t.times===void 0){const i=[],n=[];pN(t.keys,i,n,"value"),t.times=i,t.values=n}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Vp={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class vN{constructor(e,i,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(h))return p}return null}}}const Xg=new vN;class ks{constructor(e){this.manager=e!==void 0?e:Xg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(r,s){n.load(e,r,i,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Zc={};class Vfe extends Error{constructor(e,i){super(e),this.response=i}}class jo extends ks{constructor(e){super(e)}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Vp.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(s),this.manager.itemEnd(e)},0),s;if(Zc[e]!==void 0){Zc[e].push({onLoad:i,onProgress:n,onError:r});return}Zc[e]=[],Zc[e].push({onLoad:i,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=Zc[e],u=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let m=0;const g=new ReadableStream({start(v){y();function y(){u.read().then(({done:x,value:b})=>{if(x)v.close();else{m+=b.byteLength;const S=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let A=0,E=h.length;A<E;A++){const M=h[A];M.onProgress&&M.onProgress(S)}v.enqueue(b),y()}})}}});return new Response(g)}else throw new Vfe(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),d=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Vp.add(e,c);const h=Zc[e];delete Zc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const h=Zc[e];if(h===void 0)throw this.manager.itemError(e),c;delete Zc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Hfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new jo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i=[];for(let n=0;n<e.length;n++){const r=Jv.parse(e[n]);i.push(r)}return i}}class jfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=[],a=new oN,l=new jo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function h(u){l.load(e[u],function(d){const f=s.parse(d,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=bi),a.image=o,a.format=f.format,a.needsUpdate=!0,i&&i(a))},n,r)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)h(u);else l.load(e,function(u){const d=s.parse(u,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+m]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=bi),a.format=d.format,a.needsUpdate=!0,i&&i(a)},n,r);return a}}class e_ extends ks{constructor(e){super(e)}load(e,i,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Vp.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a=Y1("img");function l(){h(),Vp.add(e,this),i&&i(this),s.manager.itemEnd(e)}function c(u){h(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Wfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=new V_,o=new e_(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,i&&i(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Xfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new pv,a=new jo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Hr,o.wrapT=c.wrapT!==void 0?c.wrapT:Hr,o.magFilter=c.magFilter!==void 0?c.magFilter:bi,o.minFilter=c.minFilter!==void 0?c.minFilter:bi,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Tc),c.mipmapCount===1&&(o.minFilter=bi),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,i&&i(o,c))},n,r),o}}class yN extends ks{constructor(e){super(e)}load(e,i,n,r){const s=new on,o=new e_(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,i!==void 0&&i(s)},n,r),s}}class qd extends vi{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ct(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class VQ extends qd{constructor(e,i,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(vi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ct(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const JP=new Nt,iV=new ie,nV=new ie;class xN{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ve(512,512),this.map=null,this.mapPass=null,this.matrix=new Nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new qE,this._frameExtents=new Ve(1,1),this._viewportCount=1,this._viewports=[new Ci(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;iV.setFromMatrixPosition(e.matrixWorld),i.position.copy(iV),nV.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(nV),i.updateMatrixWorld(),JP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(JP),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(JP)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class qfe extends xN{constructor(){super(new sn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,n=q1*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||i.far;(n!==i.fov||r!==i.aspect||s!==i.far)&&(i.fov=n,i.aspect=r,i.far=s,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class _N extends qd{constructor(e,i,n=0,r=Math.PI/3,s=0,o=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(vi.DEFAULT_UP),this.updateMatrix(),this.target=new vi,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new qfe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const rV=new Nt,Ry=new ie,KP=new ie;class Yfe extends xN{constructor(){super(new sn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ve(4,2),this._viewportCount=6,this._viewports=[new Ci(2,1,1,1),new Ci(0,1,1,1),new Ci(3,1,1,1),new Ci(1,1,1,1),new Ci(3,0,1,1),new Ci(1,0,1,1)],this._cubeDirections=[new ie(1,0,0),new ie(-1,0,0),new ie(0,0,1),new ie(0,0,-1),new ie(0,1,0),new ie(0,-1,0)],this._cubeUps=[new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,1,0),new ie(0,0,1),new ie(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Ry.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ry),KP.copy(n.position),KP.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(KP),n.updateMatrixWorld(),r.makeTranslation(-Ry.x,-Ry.y,-Ry.z),rV.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(rV)}}class wN extends qd{constructor(e,i,n=0,r=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Yfe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Qfe extends xN{constructor(){super(new Ra(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class bN extends qd{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(vi.DEFAULT_UP),this.updateMatrix(),this.target=new vi,this.shadow=new Qfe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class HQ extends qd{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class jQ extends qd{constructor(e,i,n=10,r=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class WQ{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ie)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.282095),i.addScaledVector(o[1],.488603*r),i.addScaledVector(o[2],.488603*s),i.addScaledVector(o[3],.488603*n),i.addScaledVector(o[4],1.092548*(n*r)),i.addScaledVector(o[5],1.092548*(r*s)),i.addScaledVector(o[6],.315392*(3*s*s-1)),i.addScaledVector(o[7],1.092548*(n*s)),i.addScaledVector(o[8],.546274*(n*n-r*r)),i}getIrradianceAt(e,i){const n=e.x,r=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.886227),i.addScaledVector(o[1],2*.511664*r),i.addScaledVector(o[2],2*.511664*s),i.addScaledVector(o[3],2*.511664*n),i.addScaledVector(o[4],2*.429043*n*r),i.addScaledVector(o[5],2*.429043*r*s),i.addScaledVector(o[6],.743125*s*s-.247708),i.addScaledVector(o[7],2*.429043*n*s),i.addScaledVector(o[8],.429043*(n*n-r*r)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,i+r*3);return this}toArray(e=[],i=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,i+r*3);return e}static getBasisAt(e,i){const n=e.x,r=e.y,s=e.z;i[0]=.282095,i[1]=.488603*r,i[2]=.488603*s,i[3]=.488603*n,i[4]=1.092548*n*r,i[5]=1.092548*r*s,i[6]=.315392*(3*s*s-1),i[7]=1.092548*n*s,i[8]=.546274*(n*n-r*r)}}class iT extends qd{constructor(e=new WQ,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class nT extends ks{constructor(e){super(e),this.textures={}}load(e,i,n,r){const s=this,o=new jo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i=this.textures;function n(s){return i[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),i[s]}const r=nT.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new ct().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new ct().setHex(o.value);break;case"v2":r.uniforms[s].value=new Ve().fromArray(o.value);break;case"v3":r.uniforms[s].value=new ie().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Ci().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Ps().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Nt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ve().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ve().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:DQ,SpriteMaterial:tN,RawShaderMaterial:IQ,ShaderMaterial:Pl,PointsMaterial:W_,MeshPhysicalMaterial:Fc,MeshStandardMaterial:rw,MeshPhongMaterial:LQ,MeshToonMaterial:BQ,MeshNormalMaterial:RQ,MeshLambertMaterial:OQ,MeshDepthMaterial:$F,MeshDistanceMaterial:eN,MeshBasicMaterial:Bo,MeshMatcapMaterial:FQ,LineDashedMaterial:NQ,LineBasicMaterial:ps,Material:Zn};return new i[e]}}class bc{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let n=0,r=e.length;n<r;n++)i+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class XQ extends $t{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class qQ extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new jo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}parse(e){const i={},n={};function r(f,p){if(i[p]!==void 0)return i[p];const g=f.interleavedBuffers[p],v=s(f,g.buffer),y=Hg(g.type,v),x=new H_(y,g.stride);return x.uuid=g.uuid,i[p]=x,x}function s(f,p){if(n[p]!==void 0)return n[p];const g=f.arrayBuffers[p],v=new Uint32Array(g).buffer;return n[p]=v,v}const o=e.isInstancedBufferGeometry?new XQ:new $t,a=e.data.index;if(a!==void 0){const f=Hg(a.type,a.array);o.setIndex(new Ai(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let m;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);m=new Id(g,p.itemSize,p.offset,p.normalized)}else{const g=Hg(p.type,p.array),v=p.isInstancedBufferAttribute?qv:Ai;m=new v(g,p.itemSize,p.normalized)}p.name!==void 0&&(m.name=p.name),p.usage!==void 0&&m.setUsage(p.usage),p.updateRange!==void 0&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(f,m)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],m=[];for(let g=0,v=p.length;g<v;g++){const y=p[g];let x;if(y.isInterleavedBufferAttribute){const b=r(e.data,y.data);x=new Id(b,y.itemSize,y.offset,y.normalized)}else{const b=Hg(y.type,y.array);x=new Ai(b,y.itemSize,y.normalized)}y.name!==void 0&&(x.name=y.name),m.push(x)}o.morphAttributes[f]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let f=0,p=u.length;f!==p;++f){const m=u[f];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new ie;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new Wd(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Jfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=this.path===""?bc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new jo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,i)},n,r)}async loadAsync(e,i){const n=this,r=this.path===""?bc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new jo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,i),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,i){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){i!==void 0&&i(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,n),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),i!==void 0){let u=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&i(c)}return c}async parseAsync(e){const i=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,i),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const i={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new bp().fromJSON(e[n]);i[s.uuid]=s}return i}parseSkeletons(e,i){const n={},r={};if(i.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new j_().fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,i){const n={};if(e!==void 0){const r=new qQ;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in tV?a=tV[l.type].fromJSON(l,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),a.isBufferGeometry===!0&&l.userData!==void 0&&(a.userData=l.userData),n[l.uuid]=a}}return n}parseMaterials(e,i){const n={},r={};if(e!==void 0){const s=new nT;s.setTextures(i);for(let o=0,a=e.length;o<a;o++){const l=e[o];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const i={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=Jv.parse(r);i[s.uuid]=s}return i}parseImages(e,i){const n=this,r={};let s;function o(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return o(h)}else return l.data?{data:Hg(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new vN(i);s=new e_(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const u=e[c],d=u.url;if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const g=d[p],v=a(g);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new pv(v.data,v.width,v.height)))}r[u.uuid]=new rp(f)}else{const f=a(u.url);r[u.uuid]=new rp(f)}}}return r}async parseImagesAsync(e){const i=this,n={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:i.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Hg(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new e_(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u],p=await s(f);p!==null&&(p instanceof HTMLImageElement?h.push(p):h.push(new pv(p.data,p.width,p.height)))}n[l.uuid]=new rp(h)}else{const h=await s(l.url);n[l.uuid]=new rp(h)}}}return n}parseTextures(e,i){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),i[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=i[a.image],c=l.data;let h;Array.isArray(c)?(h=new V_,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new pv:h=new on,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=n(a.mapping,Kfe)),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=n(a.wrap[0],sV),h.wrapT=n(a.wrap[1],sV)),a.format!==void 0&&(h.format=a.format),a.type!==void 0&&(h.type=a.type),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=n(a.minFilter,oV)),a.magFilter!==void 0&&(h.magFilter=n(a.magFilter,oV)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(h.userData=a.userData),r[a.uuid]=h}return r}parseObject(e,i,n,r,s){let o;function a(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),i[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,m=d.length;p<m;p++){const g=d[p];n[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(n[g])}return f}return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),n[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let h,u;switch(e.type){case"Scene":o=new Q1,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new ct(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new KE(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new JE(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new sn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ra(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new HQ(e.color,e.intensity);break;case"DirectionalLight":o=new bN(e.color,e.intensity);break;case"PointLight":o=new wN(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new jQ(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new _N(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new VQ(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new iT().fromJSON(e);break;case"SkinnedMesh":h=a(e.geometry),u=l(e.material),o=new iN(h,u),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=a(e.geometry),u=l(e.material),o=new cr(h,u);break;case"InstancedMesh":h=a(e.geometry),u=l(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new nN(h,u,d),o.instanceMatrix=new qv(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new qv(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new xQ;break;case"Line":o=new qu(a(e.geometry),l(e.material));break;case"LineLoop":o=new rN(a(e.geometry),l(e.material));break;case"LineSegments":o=new Bl(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new sN(a(e.geometry),l(e.material));break;case"Sprite":o=new yQ(l(e.material));break;case"Group":o=new Pu;break;case"Bone":o=new ZE;break;default:o=new vi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],i,n,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],m=o.getObjectByProperty("uuid",p.object);m!==void 0&&o.addLevel(m,p.distance,p.hysteresis)}}return o}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=i[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}}const Kfe={UVMapping:HE,CubeReflectionMapping:Ed,CubeRefractionMapping:Td,EquirectangularReflectionMapping:V1,EquirectangularRefractionMapping:H1,CubeUVReflectionMapping:A0},sV={RepeatWrapping:Pd,ClampToEdgeWrapping:Hr,MirroredRepeatWrapping:Vv},oV={NearestFilter:Sn,NearestMipmapNearestFilter:j1,NearestMipmapLinearFilter:fv,LinearFilter:bi,LinearMipmapNearestFilter:jE,LinearMipmapLinearFilter:Tc};class YQ extends ks{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Vp.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Vp.add(e,l),i&&i(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let yS,SN=class{static getContext(){return yS===void 0&&(yS=new(window.AudioContext||window.webkitAudioContext)),yS}static setContext(e){yS=e}};class Zfe extends ks{constructor(e){super(e)}load(e,i,n,r){const s=this,o=new jo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);SN.getContext().decodeAudioData(l,function(h){i(h)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}}class $fe extends iT{constructor(e,i,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=new ct().set(e),s=new ct().set(i),o=new ie(r.r,r.g,r.b),a=new ie(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class epe extends iT{constructor(e,i=1){super(void 0,i),this.isAmbientLightProbe=!0;const n=new ct().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const aV=new Nt,lV=new Nt,pf=new Nt;class tpe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new sn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new sn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,pf.copy(e.projectionMatrix);const r=i.eyeSep/2,s=r*i.near/i.focus,o=i.near*Math.tan(xp*i.fov*.5)/i.zoom;let a,l;lV.elements[12]=-r,aV.elements[12]=r,a=-o*i.aspect+s,l=o*i.aspect+s,pf.elements[0]=2*i.near/(l-a),pf.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(pf),a=-o*i.aspect-s,l=o*i.aspect-s,pf.elements[0]=2*i.near/(l-a),pf.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(pf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lV),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(aV)}}class AN{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=cV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=cV();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function cV(){return(typeof performance>"u"?Date:performance).now()}const mf=new ie,uV=new Ir,ipe=new ie,gf=new ie;class npe extends vi{constructor(){super(),this.type="AudioListener",this.context=SN.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new AN}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(mf,uV,ipe),gf.set(0,0,-1).applyQuaternion(uV),i.positionX){const r=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(mf.x,r),i.positionY.linearRampToValueAtTime(mf.y,r),i.positionZ.linearRampToValueAtTime(mf.z,r),i.forwardX.linearRampToValueAtTime(gf.x,r),i.forwardY.linearRampToValueAtTime(gf.y,r),i.forwardZ.linearRampToValueAtTime(gf.z,r),i.upX.linearRampToValueAtTime(n.x,r),i.upY.linearRampToValueAtTime(n.y,r),i.upZ.linearRampToValueAtTime(n.z,r)}else i.setPosition(mf.x,mf.y,mf.z),i.setOrientation(gf.x,gf.y,gf.z,n.x,n.y,n.z)}}let QQ=class extends vi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const vf=new ie,hV=new Ir,rpe=new ie,yf=new ie;class spe extends QQ{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(vf,hV,rpe),yf.set(0,0,1).applyQuaternion(hV);const i=this.panner;if(i.positionX){const n=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(vf.x,n),i.positionY.linearRampToValueAtTime(vf.y,n),i.positionZ.linearRampToValueAtTime(vf.z,n),i.orientationX.linearRampToValueAtTime(yf.x,n),i.orientationY.linearRampToValueAtTime(yf.y,n),i.orientationZ.linearRampToValueAtTime(yf.z,n)}else i.setPosition(vf.x,vf.y,vf.z),i.setOrientation(yf.x,yf.y,yf.z)}}class ope{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let n=0;n<i.length;n++)e+=i[n];return e/i.length}}class JQ{constructor(e,i,n){this.binding=e,this.valueSize=n;let r,s,o;switch(i){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const n=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=i}else{o+=i;const a=i/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const i=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,n=this.buffer,r=e*i+i,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=i*this._origIndex;this._mixBufferRegion(n,r,l,1-s,i)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*i,1,i);for(let l=i,c=i+i;l!==c;++l)if(n[l]!==n[l+i]){a.setValue(n,r);break}}saveOriginalState(){const e=this.binding,i=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(i,r);for(let s=n,o=r;s!==o;++s)i[s]=i[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let n=e;n<i;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[e+n]}_select(e,i,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[i+o]=e[n+o]}_slerp(e,i,n,r){Ir.slerpFlat(e,i,e,i,e,n,r)}_slerpAdditive(e,i,n,r,s){const o=this._workIndex*s;Ir.multiplyQuaternionsFlat(e,o,e,i,e,n),Ir.slerpFlat(e,i,e,i,e,o,r)}_lerp(e,i,n,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=i+a;e[l]=e[l]*o+e[n+a]*r}}_lerpAdditive(e,i,n,r,s){for(let o=0;o!==s;++o){const a=i+o;e[a]=e[a]+e[n+o]*r}}}const MN="\\[\\]\\.:\\/",ape=new RegExp("["+MN+"]","g"),CN="[^"+MN+"]",lpe="[^"+MN.replace("\\.","")+"]",cpe=/((?:WC+[\/:])*)/.source.replace("WC",CN),upe=/(WCOD+)?/.source.replace("WCOD",lpe),hpe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",CN),dpe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",CN),fpe=new RegExp("^"+cpe+upe+hpe+dpe+"$"),ppe=["material","materials","bones","map"];class mpe{constructor(e,i,n){const r=n||gi.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,r)}getValue(e,i){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,i)}setValue(e,i){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=e.length;i!==n;++i)e[i].unbind()}}class gi{constructor(e,i,n){this.path=i,this.parsedPath=n||gi.parseTrackName(i),this.node=gi.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,n){return e&&e.isAnimationObjectGroup?new gi.Composite(e,i,n):new gi(e,i,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(ape,"")}static parseTrackName(e){const i=fpe.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);ppe.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(i);if(n!==void 0)return n}if(e.children){const n=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===i||a.uuid===i)return a;const l=n(a.children);if(l)return l}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[i++]=n[r]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,n=i.objectName,r=i.propertyName;let s=i.propertyIndex;if(e||(e=gi.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let c=i.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}gi.Composite=mpe;gi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};gi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};gi.prototype.GetterByBindingType=[gi.prototype._getValue_direct,gi.prototype._getValue_array,gi.prototype._getValue_arrayElement,gi.prototype._getValue_toArray];gi.prototype.SetterByBindingTypeAndVersioning=[[gi.prototype._setValue_direct,gi.prototype._setValue_direct_setNeedsUpdate,gi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_array,gi.prototype._setValue_array_setNeedsUpdate,gi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_arrayElement,gi.prototype._setValue_arrayElement_setNeedsUpdate,gi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[gi.prototype._setValue_fromArray,gi.prototype._setValue_fromArray_setNeedsUpdate,gi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class gpe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Go(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const d=arguments[h],f=d.uuid;let p=i[f];if(p===void 0){p=l++,i[f]=p,e.push(d);for(let m=0,g=o;m!==g;++m)s[m].push(new gi(d,n[m],r[m]))}else if(p<c){a=e[p];const m=--c,g=e[m];i[g.uuid]=p,e[p]=g,i[f]=m,e[m]=d;for(let v=0,y=o;v!==y;++v){const x=s[v],b=x[m];let S=x[p];x[p]=b,S===void 0&&(S=new gi(d,n[v],r[v])),x[m]=S}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=i[c];if(h!==void 0&&h>=s){const u=s++,d=e[u];i[d.uuid]=h,e[h]=d,i[c]=u,e[u]=l;for(let f=0,p=r;f!==p;++f){const m=n[f],g=m[u],v=m[h];m[h]=g,m[u]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,i=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,u=i[h];if(u!==void 0)if(delete i[h],u<s){const d=--s,f=e[d],p=--o,m=e[p];i[f.uuid]=u,e[u]=f,i[m.uuid]=d,e[d]=m,e.pop();for(let g=0,v=r;g!==v;++g){const y=n[g],x=y[d],b=y[p];y[u]=x,y[d]=b,y.pop()}}else{const d=--o,f=e[d];d>0&&(i[f.uuid]=u),e[u]=f,e.pop();for(let p=0,m=r;p!==m;++p){const g=n[p];g[u]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,i){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,u=new Array(c);r=s.length,n[e]=r,o.push(e),a.push(i),s.push(u);for(let d=h,f=l.length;d!==f;++d){const p=l[d];u[d]=new gi(p,e,i)}return u}unsubscribe_(e){const i=this._bindingsIndicesByPath,n=i[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];i[c]=n,o[n]=l,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}}class vpe{constructor(e,i,n=null,r=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=n,this.blendMode=r;const s=i.tracks,o=s.length,a=new Array(o),l={endingStart:ip,endingEnd:ip};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=QY,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,n){if(e.fadeOut(i),this.fadeIn(i),n){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,i),this.warp(a,1,i)}return this}crossFadeTo(e,i,n){return e.crossFadeFrom(this,i,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,n){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/o,c[1]=i/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?i=0:(this._startTime=null,i=n*l)}i*=this._updateTimeScale(e);const o=this._updateTime(i),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case HF:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case WE:default:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];i*=r,e>n.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const o=n===JY;if(e===0)return s===-1?r:o&&(s&1)===1?i-r:r;if(n===YY){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=i)r=i;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=i||r<0){const a=Math.floor(r/i);r-=i*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?i:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return i-r}return r}_setEndings(e,i,n){const r=this._interpolantSettings;n?(r.endingStart=np,r.endingEnd=np):(e?r.endingStart=this.zeroSlopeAtStart?np:ip:r.endingStart=W1,i?r.endingEnd=this.zeroSlopeAtEnd?np:ip:r.endingEnd=W1)}_scheduleFading(e,i,n){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=i,a[1]=s+e,l[1]=n,this}}const ype=new Float32Array(1);class xpe extends Oc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let u=0;u!==s;++u){const d=r[u],f=d.name;let p=h[f];if(p!==void 0)++p.referenceCount,o[u]=p;else{if(p=o[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const m=i&&i._propertyBindings[u].binding.parsedPath;p=new JQ(gi.create(n,f,m),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,n){const r=this._actions,s=this._actionsByClip;let o=s[i];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[i]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const i=this._actions,n=i[i.length-1],r=e._cacheIndex;n._cacheIndex=r,i[r]=n,i.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const u=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let n=0,r=i.length;n!==r;++n){const s=i[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const i=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_takeBackAction(e){const i=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_addInactiveBinding(e,i,n){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[i];o===void 0&&(o={},r[i]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const i=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],l=i[i.length-1],c=e._cacheIndex;l._cacheIndex=c,i[c]=l,i.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const i=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_takeBackBinding(e){const i=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=i[r];e._cacheIndex=r,i[r]=e,s._cacheIndex=n,i[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=e[i];return n===void 0&&(n=new mN(new Float32Array(2),new Float32Array(2),1,ype),n.__cacheIndex=i,e[i]=n),n}_takeBackControlInterpolant(e){const i=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=i[r];e.__cacheIndex=r,i[r]=e,s.__cacheIndex=n,i[n]=s}clipAction(e,i,n){const r=i||this._root,s=r.uuid;let o=typeof e=="string"?Jv.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(n===void 0&&(o!==null?n=o.blendMode:n=WE),l!==void 0){const u=l.actionByRoot[s];if(u!==void 0&&u.blendMode===n)return u;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new vpe(this,o,i,n);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(e,i){const n=i||this._root,r=n.uuid,s=typeof e=="string"?Jv.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const i=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==n;++c)i[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,u=i[i.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,i[h]=u,i.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const i=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,l=a[i];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[i];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,i){const n=this.existingAction(e,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class EN{constructor(e){this.value=e}clone(){return new EN(this.value.clone===void 0?this.value:this.value.clone())}}let _pe=0;class wpe extends Oc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_pe++}),this.name="",this.usage=X1,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let n=0,r=i.length;n<r;n++)this.uniforms.push(i[n].clone());return this}clone(){return new this.constructor().copy(this)}}class bpe extends H_{constructor(e,i,n=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class Spe{constructor(e,i,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class KQ{constructor(e,i,n=0,r=1/0){this.ray=new z_(e,i),this.near=n,this.far=r,this.camera=null,this.layers=new wp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,n=[]){return lB(e,this,n,i),n.sort(dV),n}intersectObjects(e,i=!0,n=[]){for(let r=0,s=e.length;r<s;r++)lB(e[r],this,n,i);return n.sort(dV),n}}function dV(t,e){return t.distance-e.distance}function lB(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),n===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)lB(r[s],e,i,!0)}}class cB{constructor(e=1,i=0,n=0){return this.radius=e,this.phi=i,this.theta=n,this}set(e,i,n){return this.radius=e,this.phi=i,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Nn(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Ape{constructor(e=1,i=0,n=0){return this.radius=e,this.theta=i,this.y=n,this}set(e,i,n){return this.radius=e,this.theta=i,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=i,this}clone(){return new this.constructor().copy(this)}}const fV=new Ve;class Mpe{constructor(e=new Ve(1/0,1/0),i=new Ve(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=fV.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return fV.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const pV=new ie,xS=new ie;class Cpe{constructor(e=new ie,i=new ie){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){pV.subVectors(e,this.start),xS.subVectors(this.end,this.start);const n=xS.dot(xS);let s=xS.dot(pV)/n;return i&&(s=Nn(s,0,1)),s}closestPointToPoint(e,i,n){const r=this.closestPointToPointParameter(e,i);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const mV=new ie;class Epe extends vi{constructor(e,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const n=new $t,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}n.setAttribute("position",new wt(r,3));const s=new ps({fog:!1,toneMapped:!1});this.cone=new Bl(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),mV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(mV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const vh=new ie,_S=new Nt,ZP=new Nt;class Tpe extends Bl{constructor(e){const i=ZQ(e),n=new $t,r=[],s=[],o=new ct(0,0,1),a=new ct(0,1,0);for(let c=0;c<i.length;c++){const h=i[c];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new wt(r,3)),n.setAttribute("color",new wt(s,3));const l=new ps({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,n=this.geometry,r=n.getAttribute("position");ZP.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<i.length;s++){const a=i[s];a.parent&&a.parent.isBone&&(_S.multiplyMatrices(ZP,a.matrixWorld),vh.setFromMatrixPosition(_S),r.setXYZ(o,vh.x,vh.y,vh.z),_S.multiplyMatrices(ZP,a.parent.matrixWorld),vh.setFromMatrixPosition(_S),r.setXYZ(o+1,vh.x,vh.y,vh.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function ZQ(t){const e=[];t.isBone===!0&&e.push(t);for(let i=0;i<t.children.length;i++)e.push.apply(e,ZQ(t.children[i]));return e}class Ppe extends cr{constructor(e,i,n){const r=new T0(i,4,2),s=new Bo({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Dpe=new ie,gV=new ct,vV=new ct;class Ipe extends vi{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new E0(i);r.rotateY(Math.PI*.5),this.material=new Bo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Ai(o,3)),this.add(new cr(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");gV.copy(this.light.color),vV.copy(this.light.groundColor);for(let n=0,r=i.count;n<r;n++){const s=n<r/2?gV:vV;i.setXYZ(n,s.r,s.g,s.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Dpe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Lpe extends Bl{constructor(e=10,i=10,n=4473924,r=8947848){n=new ct(n),r=new ct(r);const s=i/2,o=e/i,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=i;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=d===s?n:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}const h=new $t;h.setAttribute("position",new wt(l,3)),h.setAttribute("color",new wt(c,3));const u=new ps({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Bpe extends Bl{constructor(e=10,i=16,n=8,r=64,s=4473924,o=8947848){s=new ct(s),o=new ct(o);const a=[],l=[];if(i>1)for(let u=0;u<i;u++){const d=u/i*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const m=u&1?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let u=0;u<n;u++){const d=u&1?s:o,f=e-e/n*u;for(let p=0;p<r;p++){let m=p/r*(Math.PI*2),g=Math.sin(m)*f,v=Math.cos(m)*f;a.push(g,0,v),l.push(d.r,d.g,d.b),m=(p+1)/r*(Math.PI*2),g=Math.sin(m)*f,v=Math.cos(m)*f,a.push(g,0,v),l.push(d.r,d.g,d.b)}}const c=new $t;c.setAttribute("position",new wt(a,3)),c.setAttribute("color",new wt(l,3));const h=new ps({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const yV=new ie,wS=new ie,xV=new ie;class Rpe extends vi{constructor(e,i,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",i===void 0&&(i=1);let r=new $t;r.setAttribute("position",new wt([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const s=new ps({fog:!1,toneMapped:!1});this.lightPlane=new qu(r,s),this.add(this.lightPlane),r=new $t,r.setAttribute("position",new wt([0,0,0,0,0,1],3)),this.targetLine=new qu(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),yV.setFromMatrixPosition(this.light.matrixWorld),wS.setFromMatrixPosition(this.light.target.matrixWorld),xV.subVectors(wS,yV),this.lightPlane.lookAt(wS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wS),this.targetLine.scale.z=xV.length()}}const bS=new ie,xn=new G_;class Ope extends Bl{constructor(e){const i=new $t,n=new ps({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,m){l(p),l(m)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}i.setAttribute("position",new wt(r,3)),i.setAttribute("color",new wt(s,3)),super(i,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new ct(16755200),h=new ct(16711680),u=new ct(43775),d=new ct(16777215),f=new ct(3355443);this.setColors(c,h,u,d,f)}setColors(e,i,n,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,i.r,i.g,i.b),a.setXYZ(25,i.r,i.g,i.b),a.setXYZ(26,i.r,i.g,i.b),a.setXYZ(27,i.r,i.g,i.b),a.setXYZ(28,i.r,i.g,i.b),a.setXYZ(29,i.r,i.g,i.b),a.setXYZ(30,i.r,i.g,i.b),a.setXYZ(31,i.r,i.g,i.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,n=1,r=1;xn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),In("c",i,e,xn,0,0,-1),In("t",i,e,xn,0,0,1),In("n1",i,e,xn,-n,-r,-1),In("n2",i,e,xn,n,-r,-1),In("n3",i,e,xn,-n,r,-1),In("n4",i,e,xn,n,r,-1),In("f1",i,e,xn,-n,-r,1),In("f2",i,e,xn,n,-r,1),In("f3",i,e,xn,-n,r,1),In("f4",i,e,xn,n,r,1),In("u1",i,e,xn,n*.7,r*1.1,-1),In("u2",i,e,xn,-n*.7,r*1.1,-1),In("u3",i,e,xn,0,r*2,-1),In("cf1",i,e,xn,-n,0,1),In("cf2",i,e,xn,n,0,1),In("cf3",i,e,xn,0,-r,1),In("cf4",i,e,xn,0,r,1),In("cn1",i,e,xn,-n,0,-1),In("cn2",i,e,xn,n,0,-1),In("cn3",i,e,xn,0,-r,-1),In("cn4",i,e,xn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function In(t,e,i,n,r,s,o){bS.set(r,s,o).unproject(n);const a=e[t];if(a!==void 0){const l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],bS.x,bS.y,bS.z)}}const SS=new jd;class Fpe extends Bl{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new $t;s.setIndex(new Ai(n,1)),s.setAttribute("position",new Ai(r,3)),super(s,new ps({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&SS.setFromObject(this.object),SS.isEmpty())return;const i=SS.min,n=SS.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=i.x,s[4]=n.y,s[5]=n.z,s[6]=i.x,s[7]=i.y,s[8]=n.z,s[9]=n.x,s[10]=i.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=i.z,s[15]=i.x,s[16]=n.y,s[17]=i.z,s[18]=i.x,s[19]=i.y,s[20]=i.z,s[21]=n.x,s[22]=i.y,s[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Npe extends Bl{constructor(e,i=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new $t;s.setIndex(new Ai(n,1)),s.setAttribute("position",new wt(r,3)),super(s,new ps({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class kpe extends qu{constructor(e,i=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new $t;o.setAttribute("position",new wt(s,3)),o.computeBoundingSphere(),super(o,new ps({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new $t;l.setAttribute("position",new wt(a,3)),l.computeBoundingSphere(),this.add(new cr(l,new Bo({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _V=new ie;let AS,$P;class zpe extends vi{constructor(e=new ie(0,0,1),i=new ie(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",AS===void 0&&(AS=new $t,AS.setAttribute("position",new wt([0,0,0,0,1,0],3)),$P=new em(0,.5,1,5,1),$P.translate(0,-.5,0)),this.position.copy(i),this.line=new qu(AS,new ps({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new cr($P,new Bo({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{_V.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(_V,i)}}setLength(e,i=e*.2,n=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(n,i,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Upe extends Bl{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new $t;r.setAttribute("position",new wt(i,3)),r.setAttribute("color",new wt(n,3));const s=new ps({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,i,n){const r=new ct,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(i),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Gpe{constructor(){this.type="ShapePath",this.color=new ct,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new J1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,n,r){return this.currentPath.quadraticCurveTo(e,i,n,r),this}bezierCurveTo(e,i,n,r,s,o){return this.currentPath.bezierCurveTo(e,i,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(v){const y=[];for(let x=0,b=v.length;x<b;x++){const S=v[x],A=new bp;A.curves=S.curves,y.push(A)}return y}function n(v,y){const x=y.length;let b=!1;for(let S=x-1,A=0;A<x;S=A++){let E=y[S],M=y[A],T=M.x-E.x,P=M.y-E.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(E=y[A],T=-T,M=y[S],P=-P),v.y<E.y||v.y>M.y)continue;if(v.y===E.y){if(v.x===E.x)return!0}else{const I=P*(v.x-E.x)-T*(v.y-E.y);if(I===0)return!0;if(I<0)continue;b=!b}}else{if(v.y!==E.y)continue;if(M.x<=v.x&&v.x<=E.x||E.x<=v.x&&v.x<=M.x)return!0}}return b}const r=wc.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new bp,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=e?!h:h;const u=[],d=[];let f=[],p=0,m;d[p]=void 0,f[p]=[];for(let v=0,y=s.length;v<y;v++)a=s[v],m=a.getPoints(),o=r(m),o=e?!o:o,o?(!h&&d[p]&&p++,d[p]={s:new bp,p:m},d[p].s.curves=a.curves,h&&p++,f[p]=[]):f[p].push({h:a,p:m[0]});if(!d[0])return i(s);if(d.length>1){let v=!1,y=0;for(let x=0,b=d.length;x<b;x++)u[x]=[];for(let x=0,b=d.length;x<b;x++){const S=f[x];for(let A=0;A<S.length;A++){const E=S[A];let M=!0;for(let T=0;T<d.length;T++)n(E.p,d[T].p)&&(x!==T&&y++,M?(M=!1,u[T].push(E)):v=!0);M&&u[x].push(E)}}y>0&&v===!1&&(f=u)}let g;for(let v=0,y=d.length;v<y;v++){l=d[v].s,c.push(l),g=f[v];for(let x=0,b=g.length;x<b;x++)l.holes.push(g[x].h)}return c}}const Su=Vpe();function Vpe(){const t=new ArrayBuffer(4),e=new Float32Array(t),i=new Uint32Array(t),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:i,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Hpe(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Nn(t,-65504,65504),Su.floatView[0]=t;const e=Su.uint32View[0],i=e>>23&511;return Su.baseTable[i]+((e&8388607)>>Su.shiftTable[i])}function jpe(t){const e=t>>10;return Su.uint32View[0]=Su.mantissaTable[Su.offsetTable[e]+(t&1023)]+Su.exponentTable[e],Su.floatView[0]}var Wpe=Object.freeze({__proto__:null,fromHalfFloat:jpe,toHalfFloat:Hpe});class Xpe extends Xd{constructor(e,i,n,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,i,n,r,s,o)}}class qpe extends X_{constructor(e,i,n,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,i,n,r)}}class Ype extends q_{constructor(e,i,n,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,i,n,r)}}class Qpe extends Y_{constructor(e,i,n,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,i,n,r,s,o,a)}}class Jpe extends em{constructor(e,i,n,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,i,n,r,s,o,a,l)}}class Kpe extends Q_{constructor(e,i){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,i)}}class Zpe extends J_{constructor(e,i){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,i)}}class $pe extends K_{constructor(e,i){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,i)}}class eme extends C0{constructor(e,i,n,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,i,n,r)}}class tme extends E0{constructor(e,i){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,i)}}class ime extends $p{constructor(e,i,n,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,i,n,r)}}class nme extends eh{constructor(e,i,n,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,i,n,r)}}class rme extends Z_{constructor(e,i,n,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,i,n,r,s,o)}}class sme extends $_{constructor(e,i){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,i)}}class ome extends T0{constructor(e,i,n,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,i,n,r,s,o,a)}}class ame extends ew{constructor(e,i){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,i)}}class lme extends tw{constructor(e,i,n,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,i,n,r,s)}}class cme extends iw{constructor(e,i,n,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,i,n,r,s,o)}}class ume extends nw{constructor(e,i,n,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,i,n,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:N_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=N_);const hme=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:GF,AddEquation:jf,AddOperation:TY,AdditiveAnimationBlendMode:HF,AdditiveBlending:CL,AlphaFormat:kY,AlwaysDepth:wY,AlwaysStencilFunc:tQ,AmbientLight:HQ,AmbientLightProbe:epe,AnimationClip:Jv,AnimationLoader:Hfe,AnimationMixer:xpe,AnimationObjectGroup:gpe,AnimationUtils:zfe,ArcCurve:_Q,ArrayCamera:pQ,ArrowHelper:zpe,Audio:QQ,AudioAnalyser:ope,AudioContext:SN,AudioListener:npe,AudioLoader:Zfe,AxesHelper:Upe,BackSide:so,BasicDepthPacking:ZY,BasicShadowMap:aY,Bone:ZE,BooleanKeyframeTrack:tm,Box2:Mpe,Box3:jd,Box3Helper:Npe,BoxBufferGeometry:Xpe,BoxGeometry:Xd,BoxHelper:Fpe,BufferAttribute:Ai,BufferGeometry:$t,BufferGeometryLoader:qQ,ByteType:BY,Cache:Vp,Camera:G_,CameraHelper:Ope,CanvasTexture:cfe,CapsuleBufferGeometry:qpe,CapsuleGeometry:X_,CatmullRomCurve3:wQ,CineonToneMapping:IY,CircleBufferGeometry:Ype,CircleGeometry:q_,ClampToEdgeWrapping:Hr,Clock:AN,Color:ct,ColorKeyframeTrack:gN,ColorManagement:rs,CompressedArrayTexture:lfe,CompressedTexture:oN,CompressedTextureLoader:jfe,ConeBufferGeometry:Qpe,ConeGeometry:Y_,CubeCamera:JF,CubeReflectionMapping:Ed,CubeRefractionMapping:Td,CubeTexture:V_,CubeTextureLoader:Wfe,CubeUVReflectionMapping:A0,CubicBezierCurve:lN,CubicBezierCurve3:bQ,CubicInterpolant:zQ,CullFaceBack:ML,CullFaceFront:oY,CullFaceFrontBack:gae,CullFaceNone:sY,Curve:Rl,CurvePath:AQ,CustomBlending:lY,CustomToneMapping:LY,CylinderBufferGeometry:Jpe,CylinderGeometry:em,Cylindrical:Ape,Data3DTexture:qF,DataArrayTexture:XE,DataTexture:pv,DataTextureLoader:Xfe,DataUtils:Wpe,DecrementStencilOp:Cae,DecrementWrapStencilOp:Tae,DefaultLoadingManager:Xg,DepthFormat:md,DepthStencilFormat:zp,DepthTexture:mQ,DirectionalLight:bN,DirectionalLightHelper:Rpe,DiscreteInterpolant:UQ,DodecahedronBufferGeometry:Kpe,DodecahedronGeometry:Q_,DoubleSide:ml,DstAlphaFactor:mY,DstColorFactor:vY,DynamicCopyUsage:Vae,DynamicDrawUsage:yp,DynamicReadUsage:zae,EdgesGeometry:MQ,EllipseCurve:$E,EqualDepth:SY,EqualStencilFunc:Lae,EquirectangularReflectionMapping:V1,EquirectangularRefractionMapping:H1,Euler:U_,EventDispatcher:Oc,ExtrudeBufferGeometry:Zpe,ExtrudeGeometry:J_,FileLoader:jo,Float16BufferAttribute:ble,Float32BufferAttribute:wt,Float64BufferAttribute:Sle,FloatType:Eu,Fog:KE,FogExp2:JE,FramebufferTexture:afe,FrontSide:Ec,Frustum:qE,GLBufferAttribute:Spe,GLSL1:jae,GLSL3:eB,GreaterDepth:MY,GreaterEqualDepth:AY,GreaterEqualStencilFunc:Fae,GreaterStencilFunc:Rae,GridHelper:Lpe,Group:Pu,HalfFloatType:Hv,HemisphereLight:VQ,HemisphereLightHelper:Ipe,HemisphereLightProbe:$fe,IcosahedronBufferGeometry:$pe,IcosahedronGeometry:K_,ImageBitmapLoader:YQ,ImageLoader:e_,ImageUtils:XF,IncrementStencilOp:Mae,IncrementWrapStencilOp:Eae,InstancedBufferAttribute:qv,InstancedBufferGeometry:XQ,InstancedInterleavedBuffer:bpe,InstancedMesh:nN,Int16BufferAttribute:_le,Int32BufferAttribute:wle,Int8BufferAttribute:vle,IntType:OY,InterleavedBuffer:H_,InterleavedBufferAttribute:Id,Interpolant:P0,InterpolateDiscrete:jv,InterpolateLinear:Up,InterpolateSmooth:pM,InvertStencilOp:Pae,KeepStencilOp:mM,KeyframeTrack:Ol,LOD:xQ,LatheBufferGeometry:eme,LatheGeometry:C0,Layers:wp,LessDepth:bY,LessEqualDepth:sC,LessEqualStencilFunc:Bae,LessStencilFunc:Iae,Light:qd,LightProbe:iT,Line:qu,Line3:Cpe,LineBasicMaterial:ps,LineCurve:eT,LineCurve3:SQ,LineDashedMaterial:NQ,LineLoop:rN,LineSegments:Bl,LinearEncoding:Dd,LinearFilter:bi,LinearInterpolant:mN,LinearMipMapLinearFilter:wae,LinearMipMapNearestFilter:_ae,LinearMipmapLinearFilter:Tc,LinearMipmapNearestFilter:jE,LinearSRGBColorSpace:Wv,LinearToneMapping:PY,Loader:ks,LoaderUtils:bc,LoadingManager:vN,LoopOnce:YY,LoopPingPong:JY,LoopRepeat:QY,LuminanceAlphaFormat:UY,LuminanceFormat:zY,MOUSE:Rf,Material:Zn,MaterialLoader:nT,MathUtils:nQ,Matrix3:Ps,Matrix4:Nt,MaxEquation:DL,Mesh:cr,MeshBasicMaterial:Bo,MeshDepthMaterial:$F,MeshDistanceMaterial:eN,MeshLambertMaterial:OQ,MeshMatcapMaterial:FQ,MeshNormalMaterial:RQ,MeshPhongMaterial:LQ,MeshPhysicalMaterial:Fc,MeshStandardMaterial:rw,MeshToonMaterial:BQ,MinEquation:PL,MirroredRepeatWrapping:Vv,MixOperation:EY,MultiplyBlending:TL,MultiplyOperation:k_,NearestFilter:Sn,NearestMipMapLinearFilter:xae,NearestMipMapNearestFilter:yae,NearestMipmapLinearFilter:fv,NearestMipmapNearestFilter:j1,NeverDepth:_Y,NeverStencilFunc:Dae,NoBlending:Ou,NoColorSpace:bae,NoToneMapping:Al,NormalAnimationBlendMode:WE,NormalBlending:gp,NotEqualDepth:CY,NotEqualStencilFunc:Oae,NumberKeyframeTrack:Yv,Object3D:vi,ObjectLoader:Jfe,ObjectSpaceNormalMap:eQ,OctahedronBufferGeometry:tme,OctahedronGeometry:E0,OneFactor:dY,OneMinusDstAlphaFactor:gY,OneMinusDstColorFactor:yY,OneMinusSrcAlphaFactor:UF,OneMinusSrcColorFactor:pY,OrthographicCamera:Ra,PCFShadowMap:VE,PCFSoftShadowMap:Qx,PMREMGenerator:iB,Path:J1,PerspectiveCamera:sn,Plane:kh,PlaneBufferGeometry:ime,PlaneGeometry:$p,PlaneHelper:kpe,PointLight:wN,PointLightHelper:Ppe,Points:sN,PointsMaterial:W_,PolarGridHelper:Bpe,PolyhedronBufferGeometry:nme,PolyhedronGeometry:eh,PositionalAudio:spe,PropertyBinding:gi,PropertyMixer:JQ,QuadraticBezierCurve:cN,QuadraticBezierCurve3:uN,Quaternion:Ir,QuaternionKeyframeTrack:Ld,QuaternionLinearInterpolant:GQ,RED_GREEN_RGTC2_Format:ZL,RED_RGTC1_Format:qY,REVISION:N_,RGBADepthPacking:$Y,RGBAFormat:Ys,RGBAIntegerFormat:WY,RGBA_ASTC_10x10_Format:YL,RGBA_ASTC_10x5_Format:WL,RGBA_ASTC_10x6_Format:XL,RGBA_ASTC_10x8_Format:qL,RGBA_ASTC_12x10_Format:QL,RGBA_ASTC_12x12_Format:JL,RGBA_ASTC_4x4_Format:NL,RGBA_ASTC_5x4_Format:kL,RGBA_ASTC_5x5_Format:zL,RGBA_ASTC_6x5_Format:UL,RGBA_ASTC_6x6_Format:GL,RGBA_ASTC_8x5_Format:VL,RGBA_ASTC_8x6_Format:HL,RGBA_ASTC_8x8_Format:jL,RGBA_BPTC_Format:fM,RGBA_ETC2_EAC_Format:FL,RGBA_PVRTC_2BPPV1_Format:RL,RGBA_PVRTC_4BPPV1_Format:BL,RGBA_S3TC_DXT1_Format:uM,RGBA_S3TC_DXT3_Format:hM,RGBA_S3TC_DXT5_Format:dM,RGB_ETC1_Format:XY,RGB_ETC2_Format:OL,RGB_PVRTC_2BPPV1_Format:LL,RGB_PVRTC_4BPPV1_Format:IL,RGB_S3TC_DXT1_Format:cM,RGFormat:HY,RGIntegerFormat:jY,RawShaderMaterial:IQ,Ray:z_,Raycaster:KQ,RectAreaLight:jQ,RedFormat:GY,RedIntegerFormat:VY,ReinhardToneMapping:DY,RepeatWrapping:Pd,ReplaceStencilOp:Aae,ReverseSubtractEquation:uY,RingBufferGeometry:rme,RingGeometry:Z_,SIGNED_RED_GREEN_RGTC2_Format:$L,SIGNED_RED_RGTC1_Format:KL,SRGBColorSpace:hl,Scene:Q1,ShaderChunk:ni,ShaderLib:fl,ShaderMaterial:Pl,ShadowMaterial:DQ,Shape:bp,ShapeBufferGeometry:sme,ShapeGeometry:$_,ShapePath:Gpe,ShapeUtils:wc,ShortType:RY,Skeleton:j_,SkeletonHelper:Tpe,SkinnedMesh:iN,Source:rp,Sphere:Wd,SphereBufferGeometry:ome,SphereGeometry:T0,Spherical:cB,SphericalHarmonics3:WQ,SplineCurve:hN,SpotLight:_N,SpotLightHelper:Epe,Sprite:yQ,SpriteMaterial:tN,SrcAlphaFactor:zF,SrcAlphaSaturateFactor:xY,SrcColorFactor:fY,StaticCopyUsage:Gae,StaticDrawUsage:X1,StaticReadUsage:kae,StereoCamera:tpe,StreamCopyUsage:Hae,StreamDrawUsage:Nae,StreamReadUsage:Uae,StringKeyframeTrack:im,SubtractEquation:cY,SubtractiveBlending:EL,TOUCH:Of,TangentSpaceNormalMap:Hd,TetrahedronBufferGeometry:ame,TetrahedronGeometry:ew,Texture:on,TextureLoader:yN,TorusBufferGeometry:lme,TorusGeometry:tw,TorusKnotBufferGeometry:cme,TorusKnotGeometry:iw,Triangle:Ca,TriangleFanDrawMode:oC,TriangleStripDrawMode:jF,TrianglesDrawMode:KY,TubeBufferGeometry:ume,TubeGeometry:nw,TwoPassDoubleSide:vae,UVMapping:HE,Uint16BufferAttribute:YF,Uint32BufferAttribute:QF,Uint8BufferAttribute:yle,Uint8ClampedBufferAttribute:xle,Uniform:EN,UniformsGroup:wpe,UniformsLib:st,UniformsUtils:aQ,UnsignedByteType:Xu,UnsignedInt248Type:vp,UnsignedIntType:Qh,UnsignedShort4444Type:FY,UnsignedShort5551Type:NY,UnsignedShortType:VF,VSMShadowMap:tp,Vector2:Ve,Vector3:ie,Vector4:Ci,VectorKeyframeTrack:Qv,VideoTexture:Ex,WebGL1Renderer:gQ,WebGL3DRenderTarget:ale,WebGLArrayRenderTarget:ole,WebGLCubeRenderTarget:KF,WebGLMultipleRenderTargets:lle,WebGLRenderTarget:Tl,WebGLRenderer:QE,WebGLUtils:fQ,WireframeGeometry:PQ,WrapAroundEnding:W1,ZeroCurvatureEnding:ip,ZeroFactor:hY,ZeroSlopeEnding:np,ZeroStencilOp:Sae,_SRGBAFormat:aC,sRGBEncoding:Yi},Symbol.toStringTag,{value:"Module"}));var $Q={exports:{}},nm={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */nm.ConcurrentRoot=1;nm.ContinuousEventPriority=4;nm.DefaultEventPriority=16;nm.DiscreteEventPriority=1;nm.IdleEventPriority=536870912;nm.LegacyRoot=0;$Q.exports=nm;var qg=$Q.exports;function dme(t){let e;const i=new Set,n=(c,h)=>{const u=typeof c=="function"?c(e):c;if(u!==e){const d=e;e=h?u:Object.assign({},e,u),i.forEach(f=>f(e,d))}},r=()=>e,s=(c,h=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=h(e);function f(){const p=h(e);if(!u(d,p)){const m=d;c(d=p,m)}}return i.add(f),()=>i.delete(f)},l={setState:n,getState:r,subscribe:(c,h,u)=>h||u?s(c,h,u):(i.add(c),()=>i.delete(c)),destroy:()=>i.clear()};return e=t(n,r,l),l}const fme=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),wV=fme?me.useEffect:me.useLayoutEffect;function eJ(t){const e=typeof t=="function"?dme(t):t,i=(n=e.getState,r=Object.is)=>{const[,s]=me.useReducer(g=>g+1,0),o=e.getState(),a=me.useRef(o),l=me.useRef(n),c=me.useRef(r),h=me.useRef(!1),u=me.useRef();u.current===void 0&&(u.current=n(o));let d,f=!1;(a.current!==o||l.current!==n||c.current!==r||h.current)&&(d=n(o),f=!r(u.current,d)),wV(()=>{f&&(u.current=d),a.current=o,l.current=n,c.current=r,h.current=!1});const p=me.useRef(o);wV(()=>{const g=()=>{try{const y=e.getState(),x=l.current(y);c.current(u.current,x)||(a.current=y,u.current=x,s())}catch{h.current=!0,s()}},v=e.subscribe(g);return e.getState()!==p.current&&g(),v},[]);const m=f?d:u.current;return me.useDebugValue(m),m};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[i,e];return{next(){const r=n.length<=0;return{value:n.shift(),done:r}}}},i}var tJ={exports:{}},iJ={exports:{}},nJ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,Y){var j=z.length;z.push(Y);e:for(;0<j;){var J=j-1>>>1,H=z[J];if(0<r(H,Y))z[J]=Y,z[j]=H,j=J;else break e}}function i(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var Y=z[0],j=z.pop();if(j!==Y){z[0]=j;e:for(var J=0,H=z.length,Z=H>>>1;J<Z;){var K=2*(J+1)-1,ne=z[K],W=K+1,ve=z[W];if(0>r(ne,j))W<H&&0>r(ve,ne)?(z[J]=ve,z[W]=j,J=W):(z[J]=ne,z[K]=j,J=K);else if(W<H&&0>r(ve,j))z[J]=ve,z[W]=j,J=W;else break e}}return Y}function r(z,Y){var j=z.sortIndex-Y.sortIndex;return j!==0?j:z.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(z){for(var Y=i(c);Y!==null;){if(Y.callback===null)n(c);else if(Y.startTime<=z)n(c),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=i(c)}}function b(z){if(m=!1,x(z),!p)if(i(l)!==null)p=!0,Q(S);else{var Y=i(c);Y!==null&&X(b,Y.startTime-z)}}function S(z,Y){p=!1,m&&(m=!1,v(M),M=-1),f=!0;var j=d;try{for(x(Y),u=i(l);u!==null&&(!(u.expirationTime>Y)||z&&!I());){var J=u.callback;if(typeof J=="function"){u.callback=null,d=u.priorityLevel;var H=J(u.expirationTime<=Y);Y=t.unstable_now(),typeof H=="function"?u.callback=H:u===i(l)&&n(l),x(Y)}else n(l);u=i(l)}if(u!==null)var Z=!0;else{var K=i(c);K!==null&&X(b,K.startTime-Y),Z=!1}return Z}finally{u=null,d=j,f=!1}}var A=!1,E=null,M=-1,T=5,P=-1;function I(){return!(t.unstable_now()-P<T)}function k(){if(E!==null){var z=t.unstable_now();P=z;var Y=!0;try{Y=E(!0,z)}finally{Y?R():(A=!1,E=null)}}else A=!1}var R;if(typeof y=="function")R=function(){y(k)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,V=F.port2;F.port1.onmessage=k,R=function(){V.postMessage(null)}}else R=function(){g(k,0)};function Q(z){E=z,A||(A=!0,R())}function X(z,Y){M=g(function(){z(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(z){switch(d){case 1:case 2:case 3:var Y=3;break;default:Y=d}var j=d;d=Y;try{return z()}finally{d=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,Y){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var j=d;d=z;try{return Y()}finally{d=j}},t.unstable_scheduleCallback=function(z,Y,j){var J=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?J+j:J):j=J,z){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=j+H,z={id:h++,callback:Y,priorityLevel:z,startTime:j,expirationTime:H,sortIndex:-1},j>J?(z.sortIndex=j,e(c,z),i(l)===null&&z===i(c)&&(m?(v(M),M=-1):m=!0,X(b,j-J))):(z.sortIndex=H,e(l,z),p||f||(p=!0,Q(S))),z},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(z){var Y=d;return function(){var j=d;d=Y;try{return z.apply(this,arguments)}finally{d=j}}}})(nJ);iJ.exports=nJ;var uB=iJ.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pme=function(e){var i={},n=me,r=uB,s=Object.assign;function o(_){for(var w="https://reactjs.org/docs/error-decoder.html?invariant="+_,C=1;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+_+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),S=Symbol.iterator;function A(_){return _===null||typeof _!="object"?null:(_=S&&_[S]||_["@@iterator"],typeof _=="function"?_:null)}function E(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case v:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case p:return(_.displayName||"Context")+".Consumer";case f:return(_._context.displayName||"Context")+".Provider";case m:var w=_.render;return _=_.displayName,_||(_=w.displayName||w.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case y:return w=_.displayName||null,w!==null?w:E(_.type)||"Memo";case x:w=_._payload,_=_._init;try{return E(_(w))}catch{}}return null}function M(_){var w=_.type;switch(_.tag){case 24:return"Cache";case 9:return(w.displayName||"Context")+".Consumer";case 10:return(w._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=w.render,_=_.displayName||_.name||"",w.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return w;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(w);case 8:return w===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w}return null}function T(_){var w=_,C=_;if(_.alternate)for(;w.return;)w=w.return;else{_=w;do w=_,w.flags&4098&&(C=w.return),_=w.return;while(_)}return w.tag===3?C:null}function P(_){if(T(_)!==_)throw Error(o(188))}function I(_){var w=_.alternate;if(!w){if(w=T(_),w===null)throw Error(o(188));return w!==_?null:_}for(var C=_,D=w;;){var B=C.return;if(B===null)break;var G=B.alternate;if(G===null){if(D=B.return,D!==null){C=D;continue}break}if(B.child===G.child){for(G=B.child;G;){if(G===C)return P(B),_;if(G===D)return P(B),w;G=G.sibling}throw Error(o(188))}if(C.return!==D.return)C=B,D=G;else{for(var se=!1,Se=B.child;Se;){if(Se===C){se=!0,C=B,D=G;break}if(Se===D){se=!0,D=B,C=G;break}Se=Se.sibling}if(!se){for(Se=G.child;Se;){if(Se===C){se=!0,C=G,D=B;break}if(Se===D){se=!0,D=G,C=B;break}Se=Se.sibling}if(!se)throw Error(o(189))}}if(C.alternate!==D)throw Error(o(190))}if(C.tag!==3)throw Error(o(188));return C.stateNode.current===C?_:w}function k(_){return _=I(_),_!==null?R(_):null}function R(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var w=R(_);if(w!==null)return w;_=_.sibling}return null}function F(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){if(_.tag!==4){var w=F(_);if(w!==null)return w}_=_.sibling}return null}var V=Array.isArray,Q=e.getPublicInstance,X=e.getRootHostContext,z=e.getChildHostContext,Y=e.prepareForCommit,j=e.resetAfterCommit,J=e.createInstance,H=e.appendInitialChild,Z=e.finalizeInitialChildren,K=e.prepareUpdate,ne=e.shouldSetTextContent,W=e.createTextInstance,ve=e.scheduleTimeout,de=e.cancelTimeout,pe=e.noTimeout,ce=e.isPrimaryRenderer,ye=e.supportsMutation,ae=e.supportsPersistence,le=e.supportsHydration,Ee=e.getInstanceFromNode,Te=e.preparePortalMount,Be=e.getCurrentEventPriority,Ue=e.detachDeletedInstance,Ie=e.supportsMicrotasks,Pe=e.scheduleMicrotask,Je=e.supportsTestSelectors,Ke=e.findFiberRoot,U=e.getBoundingRect,L=e.getTextContent,te=e.isHiddenSubtree,_e=e.matchAccessibilityRole,we=e.setFocusIfFocusable,Me=e.setupIntersectionObserver,We=e.appendChild,Le=e.appendChildToContainer,ue=e.commitTextUpdate,Ge=e.commitMount,re=e.commitUpdate,be=e.insertBefore,Re=e.insertInContainerBefore,Ne=e.removeChild,tt=e.removeChildFromContainer,xt=e.resetTextContent,kt=e.hideInstance,q=e.hideTextInstance,oe=e.unhideInstance,xe=e.unhideTextInstance,Fe=e.clearContainer,Xe=e.cloneInstance,pt=e.createContainerChildSet,ti=e.appendChildToContainerChildSet,ui=e.finalizeContainerChildren,vr=e.replaceContainerChildren,Pt=e.cloneHiddenInstance,gn=e.cloneHiddenTextInstance,ki=e.canHydrateInstance,$d=e.canHydrateTextInstance,Q0=e.canHydrateSuspenseInstance,dm=e.isSuspenseInstancePending,ef=e.isSuspenseInstanceFallback,N=e.registerSuspenseInstanceRetry,ee=e.getNextHydratableSibling,he=e.getFirstHydratableChild,$=e.getFirstHydratableChildWithinContainer,fe=e.getFirstHydratableChildWithinSuspenseInstance,je=e.hydrateInstance,$e=e.hydrateTextInstance,rt=e.hydrateSuspenseInstance,ot=e.getNextHydratableInstanceAfterSuspenseInstance,_t=e.commitHydratedContainer,mt=e.commitHydratedSuspenseInstance,dt=e.clearSuspenseBoundary,si=e.clearSuspenseBoundaryFromContainer,Ti=e.shouldDeleteUnhydratedTailInstances,Pn=e.didNotMatchHydratedContainerTextInstance,Or=e.didNotMatchHydratedTextInstance,Ut;function at(_){if(Ut===void 0)try{throw Error()}catch(C){var w=C.stack.trim().match(/\n( *(at )?)/);Ut=w&&w[1]||""}return`
`+Ut+_}var Xa=!1;function Xi(_,w){if(!_||Xa)return"";Xa=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(w)if(w=function(){throw Error()},Object.defineProperty(w.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(w,[])}catch(et){var D=et}Reflect.construct(_,[],w)}else{try{w.call()}catch(et){D=et}_.call(w.prototype)}else{try{throw Error()}catch(et){D=et}_()}}catch(et){if(et&&D&&typeof et.stack=="string"){for(var B=et.stack.split(`
`),G=D.stack.split(`
`),se=B.length-1,Se=G.length-1;1<=se&&0<=Se&&B[se]!==G[Se];)Se--;for(;1<=se&&0<=Se;se--,Se--)if(B[se]!==G[Se]){if(se!==1||Se!==1)do if(se--,Se--,0>Se||B[se]!==G[Se]){var ze=`
`+B[se].replace(" at new "," at ");return _.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",_.displayName)),ze}while(1<=se&&0<=Se);break}}}finally{Xa=!1,Error.prepareStackTrace=C}return(_=_?_.displayName||_.name:"")?at(_):""}var Fr=Object.prototype.hasOwnProperty,Uc=[],yr=-1;function Yr(_){return{current:_}}function bt(_){0>yr||(_.current=Uc[yr],Uc[yr]=null,yr--)}function Kt(_,w){yr++,Uc[yr]=_.current,_.current=w}var Qr={},Wt=Yr(Qr),vn=Yr(!1),qa=Qr;function Ko(_,w){var C=_.type.contextTypes;if(!C)return Qr;var D=_.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===w)return D.__reactInternalMemoizedMaskedChildContext;var B={},G;for(G in C)B[G]=w[G];return D&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=w,_.__reactInternalMemoizedMaskedChildContext=B),B}function Us(_){return _=_.childContextTypes,_!=null}function Pw(){bt(vn),bt(Wt)}function sU(_,w,C){if(Wt.current!==Qr)throw Error(o(168));Kt(Wt,w),Kt(vn,C)}function oU(_,w,C){var D=_.stateNode;if(w=w.childContextTypes,typeof D.getChildContext!="function")return C;D=D.getChildContext();for(var B in D)if(!(B in w))throw Error(o(108,M(_)||"Unknown",B));return s({},C,D)}function Dw(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Qr,qa=Wt.current,Kt(Wt,_),Kt(vn,vn.current),!0}function aU(_,w,C){var D=_.stateNode;if(!D)throw Error(o(169));C?(_=oU(_,w,qa),D.__reactInternalMemoizedMergedChildContext=_,bt(vn),bt(Wt),Kt(Wt,_)):bt(vn),Kt(vn,C)}var Ya=Math.clz32?Math.clz32:Cne,Ane=Math.log,Mne=Math.LN2;function Cne(_){return _>>>=0,_===0?32:31-(Ane(_)/Mne|0)|0}var Iw=64,Lw=4194304;function J0(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function Bw(_,w){var C=_.pendingLanes;if(C===0)return 0;var D=0,B=_.suspendedLanes,G=_.pingedLanes,se=C&268435455;if(se!==0){var Se=se&~B;Se!==0?D=J0(Se):(G&=se,G!==0&&(D=J0(G)))}else se=C&~B,se!==0?D=J0(se):G!==0&&(D=J0(G));if(D===0)return 0;if(w!==0&&w!==D&&!(w&B)&&(B=D&-D,G=w&-w,B>=G||B===16&&(G&4194240)!==0))return w;if(D&4&&(D|=C&16),w=_.entangledLanes,w!==0)for(_=_.entanglements,w&=D;0<w;)C=31-Ya(w),B=1<<C,D|=_[C],w&=~B;return D}function Ene(_,w){switch(_){case 1:case 2:case 4:return w+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tne(_,w){for(var C=_.suspendedLanes,D=_.pingedLanes,B=_.expirationTimes,G=_.pendingLanes;0<G;){var se=31-Ya(G),Se=1<<se,ze=B[se];ze===-1?(!(Se&C)||Se&D)&&(B[se]=Ene(Se,w)):ze<=w&&(_.expiredLanes|=Se),G&=~Se}}function HT(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function jT(_){for(var w=[],C=0;31>C;C++)w.push(_);return w}function K0(_,w,C){_.pendingLanes|=w,w!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,w=31-Ya(w),_[w]=C}function Pne(_,w){var C=_.pendingLanes&~w;_.pendingLanes=w,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=w,_.mutableReadLanes&=w,_.entangledLanes&=w,w=_.entanglements;var D=_.eventTimes;for(_=_.expirationTimes;0<C;){var B=31-Ya(C),G=1<<B;w[B]=0,D[B]=-1,_[B]=-1,C&=~G}}function WT(_,w){var C=_.entangledLanes|=w;for(_=_.entanglements;C;){var D=31-Ya(C),B=1<<D;B&w|_[D]&w&&(_[D]|=w),C&=~B}}var xi=0;function lU(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var XT=r.unstable_scheduleCallback,cU=r.unstable_cancelCallback,Dne=r.unstable_shouldYield,Ine=r.unstable_requestPaint,xr=r.unstable_now,qT=r.unstable_ImmediatePriority,Lne=r.unstable_UserBlockingPriority,YT=r.unstable_NormalPriority,Bne=r.unstable_IdlePriority,Rw=null,kl=null;function Rne(_){if(kl&&typeof kl.onCommitFiberRoot=="function")try{kl.onCommitFiberRoot(Rw,_,void 0,(_.current.flags&128)===128)}catch{}}function One(_,w){return _===w&&(_!==0||1/_===1/w)||_!==_&&w!==w}var zl=typeof Object.is=="function"?Object.is:One,Gc=null,Ow=!1,QT=!1;function uU(_){Gc===null?Gc=[_]:Gc.push(_)}function Fne(_){Ow=!0,uU(_)}function Ul(){if(!QT&&Gc!==null){QT=!0;var _=0,w=xi;try{var C=Gc;for(xi=1;_<C.length;_++){var D=C[_];do D=D(!0);while(D!==null)}Gc=null,Ow=!1}catch(B){throw Gc!==null&&(Gc=Gc.slice(_+1)),XT(qT,Ul),B}finally{xi=w,QT=!1}}return null}var Nne=a.ReactCurrentBatchConfig;function Fw(_,w){if(zl(_,w))return!0;if(typeof _!="object"||_===null||typeof w!="object"||w===null)return!1;var C=Object.keys(_),D=Object.keys(w);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var B=C[D];if(!Fr.call(w,B)||!zl(_[B],w[B]))return!1}return!0}function kne(_){switch(_.tag){case 5:return at(_.type);case 16:return at("Lazy");case 13:return at("Suspense");case 19:return at("SuspenseList");case 0:case 2:case 15:return _=Xi(_.type,!1),_;case 11:return _=Xi(_.type.render,!1),_;case 1:return _=Xi(_.type,!0),_;default:return""}}function Qa(_,w){if(_&&_.defaultProps){w=s({},w),_=_.defaultProps;for(var C in _)w[C]===void 0&&(w[C]=_[C]);return w}return w}var Nw=Yr(null),kw=null,fm=null,JT=null;function KT(){JT=fm=kw=null}function hU(_,w,C){ce?(Kt(Nw,w._currentValue),w._currentValue=C):(Kt(Nw,w._currentValue2),w._currentValue2=C)}function ZT(_){var w=Nw.current;bt(Nw),ce?_._currentValue=w:_._currentValue2=w}function $T(_,w,C){for(;_!==null;){var D=_.alternate;if((_.childLanes&w)!==w?(_.childLanes|=w,D!==null&&(D.childLanes|=w)):D!==null&&(D.childLanes&w)!==w&&(D.childLanes|=w),_===C)break;_=_.return}}function pm(_,w){kw=_,JT=fm=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&w&&(_o=!0),_.firstContext=null)}function Zo(_){var w=ce?_._currentValue:_._currentValue2;if(JT!==_)if(_={context:_,memoizedValue:w,next:null},fm===null){if(kw===null)throw Error(o(308));fm=_,kw.dependencies={lanes:0,firstContext:_}}else fm=fm.next=_;return w}var Gl=null,rh=!1;function e2(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dU(_,w){_=_.updateQueue,w.updateQueue===_&&(w.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function Vc(_,w){return{eventTime:_,lane:w,tag:0,payload:null,callback:null,next:null}}function sh(_,w){var C=_.updateQueue;C!==null&&(C=C.shared,Vn!==null&&_.mode&1&&!(oi&2)?(_=C.interleaved,_===null?(w.next=w,Gl===null?Gl=[C]:Gl.push(C)):(w.next=_.next,_.next=w),C.interleaved=w):(_=C.pending,_===null?w.next=w:(w.next=_.next,_.next=w),C.pending=w))}function zw(_,w,C){if(w=w.updateQueue,w!==null&&(w=w.shared,(C&4194240)!==0)){var D=w.lanes;D&=_.pendingLanes,C|=D,w.lanes=C,WT(_,C)}}function fU(_,w){var C=_.updateQueue,D=_.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var B=null,G=null;if(C=C.firstBaseUpdate,C!==null){do{var se={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};G===null?B=G=se:G=G.next=se,C=C.next}while(C!==null);G===null?B=G=w:G=G.next=w}else B=G=w;C={baseState:D.baseState,firstBaseUpdate:B,lastBaseUpdate:G,shared:D.shared,effects:D.effects},_.updateQueue=C;return}_=C.lastBaseUpdate,_===null?C.firstBaseUpdate=w:_.next=w,C.lastBaseUpdate=w}function Uw(_,w,C,D){var B=_.updateQueue;rh=!1;var G=B.firstBaseUpdate,se=B.lastBaseUpdate,Se=B.shared.pending;if(Se!==null){B.shared.pending=null;var ze=Se,et=ze.next;ze.next=null,se===null?G=et:se.next=et,se=ze;var yt=_.alternate;yt!==null&&(yt=yt.updateQueue,Se=yt.lastBaseUpdate,Se!==se&&(Se===null?yt.firstBaseUpdate=et:Se.next=et,yt.lastBaseUpdate=ze))}if(G!==null){var Yt=B.baseState;se=0,yt=et=ze=null,Se=G;do{var Dt=Se.lane,zi=Se.eventTime;if((D&Dt)===Dt){yt!==null&&(yt=yt.next={eventTime:zi,lane:0,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null});e:{var At=_,$r=Se;switch(Dt=w,zi=C,$r.tag){case 1:if(At=$r.payload,typeof At=="function"){Yt=At.call(zi,Yt,Dt);break e}Yt=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=$r.payload,Dt=typeof At=="function"?At.call(zi,Yt,Dt):At,Dt==null)break e;Yt=s({},Yt,Dt);break e;case 2:rh=!0}}Se.callback!==null&&Se.lane!==0&&(_.flags|=64,Dt=B.effects,Dt===null?B.effects=[Se]:Dt.push(Se))}else zi={eventTime:zi,lane:Dt,tag:Se.tag,payload:Se.payload,callback:Se.callback,next:null},yt===null?(et=yt=zi,ze=Yt):yt=yt.next=zi,se|=Dt;if(Se=Se.next,Se===null){if(Se=B.shared.pending,Se===null)break;Dt=Se,Se=Dt.next,Dt.next=null,B.lastBaseUpdate=Dt,B.shared.pending=null}}while(1);if(yt===null&&(ze=Yt),B.baseState=ze,B.firstBaseUpdate=et,B.lastBaseUpdate=yt,w=B.shared.interleaved,w!==null){B=w;do se|=B.lane,B=B.next;while(B!==w)}else G===null&&(B.shared.lanes=0);Sm|=se,_.lanes=se,_.memoizedState=Yt}}function pU(_,w,C){if(_=w.effects,w.effects=null,_!==null)for(w=0;w<_.length;w++){var D=_[w],B=D.callback;if(B!==null){if(D.callback=null,D=C,typeof B!="function")throw Error(o(191,B));B.call(D)}}}var mU=new n.Component().refs;function t2(_,w,C,D){w=_.memoizedState,C=C(D,w),C=C==null?w:s({},w,C),_.memoizedState=C,_.lanes===0&&(_.updateQueue.baseState=C)}var Gw={isMounted:function(_){return(_=_._reactInternals)?T(_)===_:!1},enqueueSetState:function(_,w,C){_=_._reactInternals;var D=gs(),B=lh(_),G=Vc(D,B);G.payload=w,C!=null&&(G.callback=C),sh(_,G),w=na(_,B,D),w!==null&&zw(w,_,B)},enqueueReplaceState:function(_,w,C){_=_._reactInternals;var D=gs(),B=lh(_),G=Vc(D,B);G.tag=1,G.payload=w,C!=null&&(G.callback=C),sh(_,G),w=na(_,B,D),w!==null&&zw(w,_,B)},enqueueForceUpdate:function(_,w){_=_._reactInternals;var C=gs(),D=lh(_),B=Vc(C,D);B.tag=2,w!=null&&(B.callback=w),sh(_,B),w=na(_,D,C),w!==null&&zw(w,_,D)}};function gU(_,w,C,D,B,G,se){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(D,G,se):w.prototype&&w.prototype.isPureReactComponent?!Fw(C,D)||!Fw(B,G):!0}function vU(_,w,C){var D=!1,B=Qr,G=w.contextType;return typeof G=="object"&&G!==null?G=Zo(G):(B=Us(w)?qa:Wt.current,D=w.contextTypes,G=(D=D!=null)?Ko(_,B):Qr),w=new w(C,G),_.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Gw,_.stateNode=w,w._reactInternals=_,D&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=B,_.__reactInternalMemoizedMaskedChildContext=G),w}function yU(_,w,C,D){_=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(C,D),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(C,D),w.state!==_&&Gw.enqueueReplaceState(w,w.state,null)}function i2(_,w,C,D){var B=_.stateNode;B.props=C,B.state=_.memoizedState,B.refs=mU,e2(_);var G=w.contextType;typeof G=="object"&&G!==null?B.context=Zo(G):(G=Us(w)?qa:Wt.current,B.context=Ko(_,G)),B.state=_.memoizedState,G=w.getDerivedStateFromProps,typeof G=="function"&&(t2(_,w,G,C),B.state=_.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(w=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),w!==B.state&&Gw.enqueueReplaceState(B,B.state,null),Uw(_,C,B,D),B.state=_.memoizedState),typeof B.componentDidMount=="function"&&(_.flags|=4194308)}var mm=[],gm=0,Vw=null,Hw=0,$o=[],ea=0,tf=null,Hc=1,jc="";function nf(_,w){mm[gm++]=Hw,mm[gm++]=Vw,Vw=_,Hw=w}function xU(_,w,C){$o[ea++]=Hc,$o[ea++]=jc,$o[ea++]=tf,tf=_;var D=Hc;_=jc;var B=32-Ya(D)-1;D&=~(1<<B),C+=1;var G=32-Ya(w)+B;if(30<G){var se=B-B%5;G=(D&(1<<se)-1).toString(32),D>>=se,B-=se,Hc=1<<32-Ya(w)+B|C<<B|D,jc=G+_}else Hc=1<<G|C<<B|D,jc=_}function n2(_){_.return!==null&&(nf(_,1),xU(_,1,0))}function r2(_){for(;_===Vw;)Vw=mm[--gm],mm[gm]=null,Hw=mm[--gm],mm[gm]=null;for(;_===tf;)tf=$o[--ea],$o[ea]=null,jc=$o[--ea],$o[ea]=null,Hc=$o[--ea],$o[ea]=null}var yo=null,xo=null,tn=!1,Z0=!1,Ja=null;function _U(_,w){var C=ra(5,null,null,0);C.elementType="DELETED",C.stateNode=w,C.return=_,w=_.deletions,w===null?(_.deletions=[C],_.flags|=16):w.push(C)}function wU(_,w){switch(_.tag){case 5:return w=ki(w,_.type,_.pendingProps),w!==null?(_.stateNode=w,yo=_,xo=he(w),!0):!1;case 6:return w=$d(w,_.pendingProps),w!==null?(_.stateNode=w,yo=_,xo=null,!0):!1;case 13:if(w=Q0(w),w!==null){var C=tf!==null?{id:Hc,overflow:jc}:null;return _.memoizedState={dehydrated:w,treeContext:C,retryLane:1073741824},C=ra(18,null,null,0),C.stateNode=w,C.return=_,_.child=C,yo=_,xo=null,!0}return!1;default:return!1}}function s2(_){return(_.mode&1)!==0&&(_.flags&128)===0}function o2(_){if(tn){var w=xo;if(w){var C=w;if(!wU(_,w)){if(s2(_))throw Error(o(418));w=ee(C);var D=yo;w&&wU(_,w)?_U(D,C):(_.flags=_.flags&-4097|2,tn=!1,yo=_)}}else{if(s2(_))throw Error(o(418));_.flags=_.flags&-4097|2,tn=!1,yo=_}}}function bU(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;yo=_}function $0(_){if(!le||_!==yo)return!1;if(!tn)return bU(_),tn=!0,!1;if(_.tag!==3&&(_.tag!==5||Ti(_.type)&&!ne(_.type,_.memoizedProps))){var w=xo;if(w){if(s2(_)){for(_=xo;_;)_=ee(_);throw Error(o(418))}for(;w;)_U(_,w),w=ee(w)}}if(bU(_),_.tag===13){if(!le)throw Error(o(316));if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));xo=ot(_)}else xo=yo?ee(_.stateNode):null;return!0}function vm(){le&&(xo=yo=null,Z0=tn=!1)}function a2(_){Ja===null?Ja=[_]:Ja.push(_)}function ey(_,w,C){if(_=C.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(o(309));var D=C.stateNode}if(!D)throw Error(o(147,_));var B=D,G=""+_;return w!==null&&w.ref!==null&&typeof w.ref=="function"&&w.ref._stringRef===G?w.ref:(w=function(se){var Se=B.refs;Se===mU&&(Se=B.refs={}),se===null?delete Se[G]:Se[G]=se},w._stringRef=G,w)}if(typeof _!="string")throw Error(o(284));if(!C._owner)throw Error(o(290,_))}return _}function jw(_,w){throw _=Object.prototype.toString.call(w),Error(o(31,_==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":_))}function SU(_){var w=_._init;return w(_._payload)}function AU(_){function w(De,Ae){if(_){var ke=De.deletions;ke===null?(De.deletions=[Ae],De.flags|=16):ke.push(Ae)}}function C(De,Ae){if(!_)return null;for(;Ae!==null;)w(De,Ae),Ae=Ae.sibling;return null}function D(De,Ae){for(De=new Map;Ae!==null;)Ae.key!==null?De.set(Ae.key,Ae):De.set(Ae.index,Ae),Ae=Ae.sibling;return De}function B(De,Ae){return De=uh(De,Ae),De.index=0,De.sibling=null,De}function G(De,Ae,ke){return De.index=ke,_?(ke=De.alternate,ke!==null?(ke=ke.index,ke<Ae?(De.flags|=2,Ae):ke):(De.flags|=2,Ae)):(De.flags|=1048576,Ae)}function se(De){return _&&De.alternate===null&&(De.flags|=2),De}function Se(De,Ae,ke,ut){return Ae===null||Ae.tag!==6?(Ae=j2(ke,De.mode,ut),Ae.return=De,Ae):(Ae=B(Ae,ke),Ae.return=De,Ae)}function ze(De,Ae,ke,ut){var St=ke.type;return St===h?yt(De,Ae,ke.props.children,ut,ke.key):Ae!==null&&(Ae.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===x&&SU(St)===Ae.type)?(ut=B(Ae,ke.props),ut.ref=ey(De,Ae,ke),ut.return=De,ut):(ut=wb(ke.type,ke.key,ke.props,null,De.mode,ut),ut.ref=ey(De,Ae,ke),ut.return=De,ut)}function et(De,Ae,ke,ut){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==ke.containerInfo||Ae.stateNode.implementation!==ke.implementation?(Ae=W2(ke,De.mode,ut),Ae.return=De,Ae):(Ae=B(Ae,ke.children||[]),Ae.return=De,Ae)}function yt(De,Ae,ke,ut,St){return Ae===null||Ae.tag!==7?(Ae=uf(ke,De.mode,ut,St),Ae.return=De,Ae):(Ae=B(Ae,ke),Ae.return=De,Ae)}function Yt(De,Ae,ke){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return Ae=j2(""+Ae,De.mode,ke),Ae.return=De,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case l:return ke=wb(Ae.type,Ae.key,Ae.props,null,De.mode,ke),ke.ref=ey(De,null,Ae),ke.return=De,ke;case c:return Ae=W2(Ae,De.mode,ke),Ae.return=De,Ae;case x:var ut=Ae._init;return Yt(De,ut(Ae._payload),ke)}if(V(Ae)||A(Ae))return Ae=uf(Ae,De.mode,ke,null),Ae.return=De,Ae;jw(De,Ae)}return null}function Dt(De,Ae,ke,ut){var St=Ae!==null?Ae.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return St!==null?null:Se(De,Ae,""+ke,ut);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case l:return ke.key===St?ze(De,Ae,ke,ut):null;case c:return ke.key===St?et(De,Ae,ke,ut):null;case x:return St=ke._init,Dt(De,Ae,St(ke._payload),ut)}if(V(ke)||A(ke))return St!==null?null:yt(De,Ae,ke,ut,null);jw(De,ke)}return null}function zi(De,Ae,ke,ut,St){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return De=De.get(ke)||null,Se(Ae,De,""+ut,St);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case l:return De=De.get(ut.key===null?ke:ut.key)||null,ze(Ae,De,ut,St);case c:return De=De.get(ut.key===null?ke:ut.key)||null,et(Ae,De,ut,St);case x:var ii=ut._init;return zi(De,Ae,ke,ii(ut._payload),St)}if(V(ut)||A(ut))return De=De.get(ke)||null,yt(Ae,De,ut,St,null);jw(Ae,ut)}return null}function At(De,Ae,ke,ut){for(var St=null,ii=null,Qt=Ae,_i=Ae=0,wr=null;Qt!==null&&_i<ke.length;_i++){Qt.index>_i?(wr=Qt,Qt=null):wr=Qt.sibling;var wi=Dt(De,Qt,ke[_i],ut);if(wi===null){Qt===null&&(Qt=wr);break}_&&Qt&&wi.alternate===null&&w(De,Qt),Ae=G(wi,Ae,_i),ii===null?St=wi:ii.sibling=wi,ii=wi,Qt=wr}if(_i===ke.length)return C(De,Qt),tn&&nf(De,_i),St;if(Qt===null){for(;_i<ke.length;_i++)Qt=Yt(De,ke[_i],ut),Qt!==null&&(Ae=G(Qt,Ae,_i),ii===null?St=Qt:ii.sibling=Qt,ii=Qt);return tn&&nf(De,_i),St}for(Qt=D(De,Qt);_i<ke.length;_i++)wr=zi(Qt,De,_i,ke[_i],ut),wr!==null&&(_&&wr.alternate!==null&&Qt.delete(wr.key===null?_i:wr.key),Ae=G(wr,Ae,_i),ii===null?St=wr:ii.sibling=wr,ii=wr);return _&&Qt.forEach(function(hh){return w(De,hh)}),tn&&nf(De,_i),St}function $r(De,Ae,ke,ut){var St=A(ke);if(typeof St!="function")throw Error(o(150));if(ke=St.call(ke),ke==null)throw Error(o(151));for(var ii=St=null,Qt=Ae,_i=Ae=0,wr=null,wi=ke.next();Qt!==null&&!wi.done;_i++,wi=ke.next()){Qt.index>_i?(wr=Qt,Qt=null):wr=Qt.sibling;var hh=Dt(De,Qt,wi.value,ut);if(hh===null){Qt===null&&(Qt=wr);break}_&&Qt&&hh.alternate===null&&w(De,Qt),Ae=G(hh,Ae,_i),ii===null?St=hh:ii.sibling=hh,ii=hh,Qt=wr}if(wi.done)return C(De,Qt),tn&&nf(De,_i),St;if(Qt===null){for(;!wi.done;_i++,wi=ke.next())wi=Yt(De,wi.value,ut),wi!==null&&(Ae=G(wi,Ae,_i),ii===null?St=wi:ii.sibling=wi,ii=wi);return tn&&nf(De,_i),St}for(Qt=D(De,Qt);!wi.done;_i++,wi=ke.next())wi=zi(Qt,De,_i,wi.value,ut),wi!==null&&(_&&wi.alternate!==null&&Qt.delete(wi.key===null?_i:wi.key),Ae=G(wi,Ae,_i),ii===null?St=wi:ii.sibling=wi,ii=wi);return _&&Qt.forEach(function(pre){return w(De,pre)}),tn&&nf(De,_i),St}function sa(De,Ae,ke,ut){if(typeof ke=="object"&&ke!==null&&ke.type===h&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case l:e:{for(var St=ke.key,ii=Ae;ii!==null;){if(ii.key===St){if(St=ke.type,St===h){if(ii.tag===7){C(De,ii.sibling),Ae=B(ii,ke.props.children),Ae.return=De,De=Ae;break e}}else if(ii.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===x&&SU(St)===ii.type){C(De,ii.sibling),Ae=B(ii,ke.props),Ae.ref=ey(De,ii,ke),Ae.return=De,De=Ae;break e}C(De,ii);break}else w(De,ii);ii=ii.sibling}ke.type===h?(Ae=uf(ke.props.children,De.mode,ut,ke.key),Ae.return=De,De=Ae):(ut=wb(ke.type,ke.key,ke.props,null,De.mode,ut),ut.ref=ey(De,Ae,ke),ut.return=De,De=ut)}return se(De);case c:e:{for(ii=ke.key;Ae!==null;){if(Ae.key===ii)if(Ae.tag===4&&Ae.stateNode.containerInfo===ke.containerInfo&&Ae.stateNode.implementation===ke.implementation){C(De,Ae.sibling),Ae=B(Ae,ke.children||[]),Ae.return=De,De=Ae;break e}else{C(De,Ae);break}else w(De,Ae);Ae=Ae.sibling}Ae=W2(ke,De.mode,ut),Ae.return=De,De=Ae}return se(De);case x:return ii=ke._init,sa(De,Ae,ii(ke._payload),ut)}if(V(ke))return At(De,Ae,ke,ut);if(A(ke))return $r(De,Ae,ke,ut);jw(De,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,Ae!==null&&Ae.tag===6?(C(De,Ae.sibling),Ae=B(Ae,ke),Ae.return=De,De=Ae):(C(De,Ae),Ae=j2(ke,De.mode,ut),Ae.return=De,De=Ae),se(De)):C(De,Ae)}return sa}var ym=AU(!0),MU=AU(!1),ty={},ta=Yr(ty),iy=Yr(ty),xm=Yr(ty);function Vl(_){if(_===ty)throw Error(o(174));return _}function l2(_,w){Kt(xm,w),Kt(iy,_),Kt(ta,ty),_=X(w),bt(ta),Kt(ta,_)}function _m(){bt(ta),bt(iy),bt(xm)}function CU(_){var w=Vl(xm.current),C=Vl(ta.current);w=z(C,_.type,w),C!==w&&(Kt(iy,_),Kt(ta,w))}function c2(_){iy.current===_&&(bt(ta),bt(iy))}var an=Yr(0);function Ww(_){for(var w=_;w!==null;){if(w.tag===13){var C=w.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||dm(C)||ef(C)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if(w.flags&128)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===_)break;for(;w.sibling===null;){if(w.return===null||w.return===_)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}var u2=[];function h2(){for(var _=0;_<u2.length;_++){var w=u2[_];ce?w._workInProgressVersionPrimary=null:w._workInProgressVersionSecondary=null}u2.length=0}var Xw=a.ReactCurrentDispatcher,ia=a.ReactCurrentBatchConfig,wm=0,yn=null,Jr=null,_r=null,qw=!1,ny=!1,ry=0,zne=0;function Kr(){throw Error(o(321))}function d2(_,w){if(w===null)return!1;for(var C=0;C<w.length&&C<_.length;C++)if(!zl(_[C],w[C]))return!1;return!0}function f2(_,w,C,D,B,G){if(wm=G,yn=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,Xw.current=_===null||_.memoizedState===null?Hne:jne,_=C(D,B),ny){G=0;do{if(ny=!1,ry=0,25<=G)throw Error(o(301));G+=1,_r=Jr=null,w.updateQueue=null,Xw.current=Wne,_=C(D,B)}while(ny)}if(Xw.current=Zw,w=Jr!==null&&Jr.next!==null,wm=0,_r=Jr=yn=null,qw=!1,w)throw Error(o(300));return _}function p2(){var _=ry!==0;return ry=0,_}function Wc(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _r===null?yn.memoizedState=_r=_:_r=_r.next=_,_r}function Hl(){if(Jr===null){var _=yn.alternate;_=_!==null?_.memoizedState:null}else _=Jr.next;var w=_r===null?yn.memoizedState:_r.next;if(w!==null)_r=w,Jr=_;else{if(_===null)throw Error(o(310));Jr=_,_={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},_r===null?yn.memoizedState=_r=_:_r=_r.next=_}return _r}function rf(_,w){return typeof w=="function"?w(_):w}function Yw(_){var w=Hl(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=_;var D=Jr,B=D.baseQueue,G=C.pending;if(G!==null){if(B!==null){var se=B.next;B.next=G.next,G.next=se}D.baseQueue=B=G,C.pending=null}if(B!==null){G=B.next,D=D.baseState;var Se=se=null,ze=null,et=G;do{var yt=et.lane;if((wm&yt)===yt)ze!==null&&(ze=ze.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),D=et.hasEagerState?et.eagerState:_(D,et.action);else{var Yt={lane:yt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};ze===null?(Se=ze=Yt,se=D):ze=ze.next=Yt,yn.lanes|=yt,Sm|=yt}et=et.next}while(et!==null&&et!==G);ze===null?se=D:ze.next=Se,zl(D,w.memoizedState)||(_o=!0),w.memoizedState=D,w.baseState=se,w.baseQueue=ze,C.lastRenderedState=D}if(_=C.interleaved,_!==null){B=_;do G=B.lane,yn.lanes|=G,Sm|=G,B=B.next;while(B!==_)}else B===null&&(C.lanes=0);return[w.memoizedState,C.dispatch]}function Qw(_){var w=Hl(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=_;var D=C.dispatch,B=C.pending,G=w.memoizedState;if(B!==null){C.pending=null;var se=B=B.next;do G=_(G,se.action),se=se.next;while(se!==B);zl(G,w.memoizedState)||(_o=!0),w.memoizedState=G,w.baseQueue===null&&(w.baseState=G),C.lastRenderedState=G}return[G,D]}function EU(){}function TU(_,w){var C=yn,D=Hl(),B=w(),G=!zl(D.memoizedState,B);if(G&&(D.memoizedState=B,_o=!0),D=D.queue,oy(IU.bind(null,C,D,_),[_]),D.getSnapshot!==w||G||_r!==null&&_r.memoizedState.tag&1){if(C.flags|=2048,sy(9,DU.bind(null,C,D,B,w),void 0,null),Vn===null)throw Error(o(349));wm&30||PU(C,w,B)}return B}function PU(_,w,C){_.flags|=16384,_={getSnapshot:w,value:C},w=yn.updateQueue,w===null?(w={lastEffect:null,stores:null},yn.updateQueue=w,w.stores=[_]):(C=w.stores,C===null?w.stores=[_]:C.push(_))}function DU(_,w,C,D){w.value=C,w.getSnapshot=D,LU(w)&&na(_,1,-1)}function IU(_,w,C){return C(function(){LU(w)&&na(_,1,-1)})}function LU(_){var w=_.getSnapshot;_=_.value;try{var C=w();return!zl(_,C)}catch{return!0}}function m2(_){var w=Wc();return typeof _=="function"&&(_=_()),w.memoizedState=w.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rf,lastRenderedState:_},w.queue=_,_=_.dispatch=Vne.bind(null,yn,_),[w.memoizedState,_]}function sy(_,w,C,D){return _={tag:_,create:w,destroy:C,deps:D,next:null},w=yn.updateQueue,w===null?(w={lastEffect:null,stores:null},yn.updateQueue=w,w.lastEffect=_.next=_):(C=w.lastEffect,C===null?w.lastEffect=_.next=_:(D=C.next,C.next=_,_.next=D,w.lastEffect=_)),_}function BU(){return Hl().memoizedState}function Jw(_,w,C,D){var B=Wc();yn.flags|=_,B.memoizedState=sy(1|w,C,void 0,D===void 0?null:D)}function Kw(_,w,C,D){var B=Hl();D=D===void 0?null:D;var G=void 0;if(Jr!==null){var se=Jr.memoizedState;if(G=se.destroy,D!==null&&d2(D,se.deps)){B.memoizedState=sy(w,C,G,D);return}}yn.flags|=_,B.memoizedState=sy(1|w,C,G,D)}function g2(_,w){return Jw(8390656,8,_,w)}function oy(_,w){return Kw(2048,8,_,w)}function RU(_,w){return Kw(4,2,_,w)}function OU(_,w){return Kw(4,4,_,w)}function FU(_,w){if(typeof w=="function")return _=_(),w(_),function(){w(null)};if(w!=null)return _=_(),w.current=_,function(){w.current=null}}function NU(_,w,C){return C=C!=null?C.concat([_]):null,Kw(4,4,FU.bind(null,w,_),C)}function v2(){}function kU(_,w){var C=Hl();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&d2(w,D[1])?D[0]:(C.memoizedState=[_,w],_)}function zU(_,w){var C=Hl();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&d2(w,D[1])?D[0]:(_=_(),C.memoizedState=[_,w],_)}function Une(_,w){var C=xi;xi=C!==0&&4>C?C:4,_(!0);var D=ia.transition;ia.transition={};try{_(!1),w()}finally{xi=C,ia.transition=D}}function UU(){return Hl().memoizedState}function Gne(_,w,C){var D=lh(_);C={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null},GU(_)?VU(w,C):(HU(_,w,C),C=gs(),_=na(_,D,C),_!==null&&jU(_,w,D))}function Vne(_,w,C){var D=lh(_),B={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null};if(GU(_))VU(w,B);else{HU(_,w,B);var G=_.alternate;if(_.lanes===0&&(G===null||G.lanes===0)&&(G=w.lastRenderedReducer,G!==null))try{var se=w.lastRenderedState,Se=G(se,C);if(B.hasEagerState=!0,B.eagerState=Se,zl(Se,se))return}catch{}finally{}C=gs(),_=na(_,D,C),_!==null&&jU(_,w,D)}}function GU(_){var w=_.alternate;return _===yn||w!==null&&w===yn}function VU(_,w){ny=qw=!0;var C=_.pending;C===null?w.next=w:(w.next=C.next,C.next=w),_.pending=w}function HU(_,w,C){Vn!==null&&_.mode&1&&!(oi&2)?(_=w.interleaved,_===null?(C.next=C,Gl===null?Gl=[w]:Gl.push(w)):(C.next=_.next,_.next=C),w.interleaved=C):(_=w.pending,_===null?C.next=C:(C.next=_.next,_.next=C),w.pending=C)}function jU(_,w,C){if(C&4194240){var D=w.lanes;D&=_.pendingLanes,C|=D,w.lanes=C,WT(_,C)}}var Zw={readContext:Zo,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useInsertionEffect:Kr,useLayoutEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useMutableSource:Kr,useSyncExternalStore:Kr,useId:Kr,unstable_isNewReconciler:!1},Hne={readContext:Zo,useCallback:function(_,w){return Wc().memoizedState=[_,w===void 0?null:w],_},useContext:Zo,useEffect:g2,useImperativeHandle:function(_,w,C){return C=C!=null?C.concat([_]):null,Jw(4194308,4,FU.bind(null,w,_),C)},useLayoutEffect:function(_,w){return Jw(4194308,4,_,w)},useInsertionEffect:function(_,w){return Jw(4,2,_,w)},useMemo:function(_,w){var C=Wc();return w=w===void 0?null:w,_=_(),C.memoizedState=[_,w],_},useReducer:function(_,w,C){var D=Wc();return w=C!==void 0?C(w):w,D.memoizedState=D.baseState=w,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:w},D.queue=_,_=_.dispatch=Gne.bind(null,yn,_),[D.memoizedState,_]},useRef:function(_){var w=Wc();return _={current:_},w.memoizedState=_},useState:m2,useDebugValue:v2,useDeferredValue:function(_){var w=m2(_),C=w[0],D=w[1];return g2(function(){var B=ia.transition;ia.transition={};try{D(_)}finally{ia.transition=B}},[_]),C},useTransition:function(){var _=m2(!1),w=_[0];return _=Une.bind(null,_[1]),Wc().memoizedState=_,[w,_]},useMutableSource:function(){},useSyncExternalStore:function(_,w,C){var D=yn,B=Wc();if(tn){if(C===void 0)throw Error(o(407));C=C()}else{if(C=w(),Vn===null)throw Error(o(349));wm&30||PU(D,w,C)}B.memoizedState=C;var G={value:C,getSnapshot:w};return B.queue=G,g2(IU.bind(null,D,G,_),[_]),D.flags|=2048,sy(9,DU.bind(null,D,G,C,w),void 0,null),C},useId:function(){var _=Wc(),w=Vn.identifierPrefix;if(tn){var C=jc,D=Hc;C=(D&~(1<<32-Ya(D)-1)).toString(32)+C,w=":"+w+"R"+C,C=ry++,0<C&&(w+="H"+C.toString(32)),w+=":"}else C=zne++,w=":"+w+"r"+C.toString(32)+":";return _.memoizedState=w},unstable_isNewReconciler:!1},jne={readContext:Zo,useCallback:kU,useContext:Zo,useEffect:oy,useImperativeHandle:NU,useInsertionEffect:RU,useLayoutEffect:OU,useMemo:zU,useReducer:Yw,useRef:BU,useState:function(){return Yw(rf)},useDebugValue:v2,useDeferredValue:function(_){var w=Yw(rf),C=w[0],D=w[1];return oy(function(){var B=ia.transition;ia.transition={};try{D(_)}finally{ia.transition=B}},[_]),C},useTransition:function(){var _=Yw(rf)[0],w=Hl().memoizedState;return[_,w]},useMutableSource:EU,useSyncExternalStore:TU,useId:UU,unstable_isNewReconciler:!1},Wne={readContext:Zo,useCallback:kU,useContext:Zo,useEffect:oy,useImperativeHandle:NU,useInsertionEffect:RU,useLayoutEffect:OU,useMemo:zU,useReducer:Qw,useRef:BU,useState:function(){return Qw(rf)},useDebugValue:v2,useDeferredValue:function(_){var w=Qw(rf),C=w[0],D=w[1];return oy(function(){var B=ia.transition;ia.transition={};try{D(_)}finally{ia.transition=B}},[_]),C},useTransition:function(){var _=Qw(rf)[0],w=Hl().memoizedState;return[_,w]},useMutableSource:EU,useSyncExternalStore:TU,useId:UU,unstable_isNewReconciler:!1};function y2(_,w){try{var C="",D=w;do C+=kne(D),D=D.return;while(D);var B=C}catch(G){B=`
Error generating stack: `+G.message+`
`+G.stack}return{value:_,source:w,stack:B}}function x2(_,w){try{console.error(w.value)}catch(C){setTimeout(function(){throw C})}}var Xne=typeof WeakMap=="function"?WeakMap:Map;function WU(_,w,C){C=Vc(-1,C),C.tag=3,C.payload={element:null};var D=w.value;return C.callback=function(){pb||(pb=!0,N2=D),x2(_,w)},C}function XU(_,w,C){C=Vc(-1,C),C.tag=3;var D=_.type.getDerivedStateFromError;if(typeof D=="function"){var B=w.value;C.payload=function(){return D(B)},C.callback=function(){x2(_,w)}}var G=_.stateNode;return G!==null&&typeof G.componentDidCatch=="function"&&(C.callback=function(){x2(_,w),typeof D!="function"&&(oh===null?oh=new Set([this]):oh.add(this));var se=w.stack;this.componentDidCatch(w.value,{componentStack:se!==null?se:""})}),C}function qU(_,w,C){var D=_.pingCache;if(D===null){D=_.pingCache=new Xne;var B=new Set;D.set(w,B)}else B=D.get(w),B===void 0&&(B=new Set,D.set(w,B));B.has(C)||(B.add(C),_=ore.bind(null,_,w,C),w.then(_,_))}function YU(_){do{var w;if((w=_.tag===13)&&(w=_.memoizedState,w=w!==null?w.dehydrated!==null:!0),w)return _;_=_.return}while(_!==null);return null}function QU(_,w,C,D,B){return _.mode&1?(_.flags|=65536,_.lanes=B,_):(_===w?_.flags|=65536:(_.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(w=Vc(-1,1),w.tag=2,sh(C,w))),C.lanes|=1),_)}function jl(_){_.flags|=4}function JU(_,w){if(_!==null&&_.child===w.child)return!0;if(w.flags&16)return!1;for(_=w.child;_!==null;){if(_.flags&12854||_.subtreeFlags&12854)return!1;_=_.sibling}return!0}var ay,ly,$w,eb;if(ye)ay=function(_,w){for(var C=w.child;C!==null;){if(C.tag===5||C.tag===6)H(_,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===w)break;for(;C.sibling===null;){if(C.return===null||C.return===w)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},ly=function(){},$w=function(_,w,C,D,B){if(_=_.memoizedProps,_!==D){var G=w.stateNode,se=Vl(ta.current);C=K(G,C,_,D,B,se),(w.updateQueue=C)&&jl(w)}},eb=function(_,w,C,D){C!==D&&jl(w)};else if(ae){ay=function(_,w,C,D){for(var B=w.child;B!==null;){if(B.tag===5){var G=B.stateNode;C&&D&&(G=Pt(G,B.type,B.memoizedProps,B)),H(_,G)}else if(B.tag===6)G=B.stateNode,C&&D&&(G=gn(G,B.memoizedProps,B)),H(_,G);else if(B.tag!==4){if(B.tag===22&&B.memoizedState!==null)G=B.child,G!==null&&(G.return=B),ay(_,B,!0,!0);else if(B.child!==null){B.child.return=B,B=B.child;continue}}if(B===w)break;for(;B.sibling===null;){if(B.return===null||B.return===w)return;B=B.return}B.sibling.return=B.return,B=B.sibling}};var KU=function(_,w,C,D){for(var B=w.child;B!==null;){if(B.tag===5){var G=B.stateNode;C&&D&&(G=Pt(G,B.type,B.memoizedProps,B)),ti(_,G)}else if(B.tag===6)G=B.stateNode,C&&D&&(G=gn(G,B.memoizedProps,B)),ti(_,G);else if(B.tag!==4){if(B.tag===22&&B.memoizedState!==null)G=B.child,G!==null&&(G.return=B),KU(_,B,!0,!0);else if(B.child!==null){B.child.return=B,B=B.child;continue}}if(B===w)break;for(;B.sibling===null;){if(B.return===null||B.return===w)return;B=B.return}B.sibling.return=B.return,B=B.sibling}};ly=function(_,w){var C=w.stateNode;if(!JU(_,w)){_=C.containerInfo;var D=pt(_);KU(D,w,!1,!1),C.pendingChildren=D,jl(w),ui(_,D)}},$w=function(_,w,C,D,B){var G=_.stateNode,se=_.memoizedProps;if((_=JU(_,w))&&se===D)w.stateNode=G;else{var Se=w.stateNode,ze=Vl(ta.current),et=null;se!==D&&(et=K(Se,C,se,D,B,ze)),_&&et===null?w.stateNode=G:(G=Xe(G,et,C,se,D,w,_,Se),Z(G,C,D,B,ze)&&jl(w),w.stateNode=G,_?jl(w):ay(G,w,!1,!1))}},eb=function(_,w,C,D){C!==D?(_=Vl(xm.current),C=Vl(ta.current),w.stateNode=W(D,_,C,w),jl(w)):w.stateNode=_.stateNode}}else ly=function(){},$w=function(){},eb=function(){};function cy(_,w){if(!tn)switch(_.tailMode){case"hidden":w=_.tail;for(var C=null;w!==null;)w.alternate!==null&&(C=w),w=w.sibling;C===null?_.tail=null:C.sibling=null;break;case"collapsed":C=_.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?w||_.tail===null?_.tail=null:_.tail.sibling=null:D.sibling=null}}function Zr(_){var w=_.alternate!==null&&_.alternate.child===_.child,C=0,D=0;if(w)for(var B=_.child;B!==null;)C|=B.lanes|B.childLanes,D|=B.subtreeFlags&14680064,D|=B.flags&14680064,B.return=_,B=B.sibling;else for(B=_.child;B!==null;)C|=B.lanes|B.childLanes,D|=B.subtreeFlags,D|=B.flags,B.return=_,B=B.sibling;return _.subtreeFlags|=D,_.childLanes=C,w}function qne(_,w,C){var D=w.pendingProps;switch(r2(w),w.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zr(w),null;case 1:return Us(w.type)&&Pw(),Zr(w),null;case 3:return D=w.stateNode,_m(),bt(vn),bt(Wt),h2(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(_===null||_.child===null)&&($0(w)?jl(w):_===null||_.memoizedState.isDehydrated&&!(w.flags&256)||(w.flags|=1024,Ja!==null&&(U2(Ja),Ja=null))),ly(_,w),Zr(w),null;case 5:c2(w),C=Vl(xm.current);var B=w.type;if(_!==null&&w.stateNode!=null)$w(_,w,B,D,C),_.ref!==w.ref&&(w.flags|=512,w.flags|=2097152);else{if(!D){if(w.stateNode===null)throw Error(o(166));return Zr(w),null}if(_=Vl(ta.current),$0(w)){if(!le)throw Error(o(175));_=je(w.stateNode,w.type,w.memoizedProps,C,_,w,!Z0),w.updateQueue=_,_!==null&&jl(w)}else{var G=J(B,D,C,_,w);ay(G,w,!1,!1),w.stateNode=G,Z(G,B,D,C,_)&&jl(w)}w.ref!==null&&(w.flags|=512,w.flags|=2097152)}return Zr(w),null;case 6:if(_&&w.stateNode!=null)eb(_,w,_.memoizedProps,D);else{if(typeof D!="string"&&w.stateNode===null)throw Error(o(166));if(_=Vl(xm.current),C=Vl(ta.current),$0(w)){if(!le)throw Error(o(176));if(_=w.stateNode,D=w.memoizedProps,(C=$e(_,D,w,!Z0))&&(B=yo,B!==null))switch(G=(B.mode&1)!==0,B.tag){case 3:Pn(B.stateNode.containerInfo,_,D,G);break;case 5:Or(B.type,B.memoizedProps,B.stateNode,_,D,G)}C&&jl(w)}else w.stateNode=W(D,_,C,w)}return Zr(w),null;case 13:if(bt(an),D=w.memoizedState,tn&&xo!==null&&w.mode&1&&!(w.flags&128)){for(_=xo;_;)_=ee(_);return vm(),w.flags|=98560,w}if(D!==null&&D.dehydrated!==null){if(D=$0(w),_===null){if(!D)throw Error(o(318));if(!le)throw Error(o(344));if(_=w.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));rt(_,w)}else vm(),!(w.flags&128)&&(w.memoizedState=null),w.flags|=4;return Zr(w),null}return Ja!==null&&(U2(Ja),Ja=null),w.flags&128?(w.lanes=C,w):(D=D!==null,C=!1,_===null?$0(w):C=_.memoizedState!==null,D&&!C&&(w.child.flags|=8192,w.mode&1&&(_===null||an.current&1?er===0&&(er=3):V2())),w.updateQueue!==null&&(w.flags|=4),Zr(w),null);case 4:return _m(),ly(_,w),_===null&&Te(w.stateNode.containerInfo),Zr(w),null;case 10:return ZT(w.type._context),Zr(w),null;case 17:return Us(w.type)&&Pw(),Zr(w),null;case 19:if(bt(an),B=w.memoizedState,B===null)return Zr(w),null;if(D=(w.flags&128)!==0,G=B.rendering,G===null)if(D)cy(B,!1);else{if(er!==0||_!==null&&_.flags&128)for(_=w.child;_!==null;){if(G=Ww(_),G!==null){for(w.flags|=128,cy(B,!1),_=G.updateQueue,_!==null&&(w.updateQueue=_,w.flags|=4),w.subtreeFlags=0,_=C,D=w.child;D!==null;)C=D,B=_,C.flags&=14680066,G=C.alternate,G===null?(C.childLanes=0,C.lanes=B,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=G.childLanes,C.lanes=G.lanes,C.child=G.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=G.memoizedProps,C.memoizedState=G.memoizedState,C.updateQueue=G.updateQueue,C.type=G.type,B=G.dependencies,C.dependencies=B===null?null:{lanes:B.lanes,firstContext:B.firstContext}),D=D.sibling;return Kt(an,an.current&1|2),w.child}_=_.sibling}B.tail!==null&&xr()>F2&&(w.flags|=128,D=!0,cy(B,!1),w.lanes=4194304)}else{if(!D)if(_=Ww(G),_!==null){if(w.flags|=128,D=!0,_=_.updateQueue,_!==null&&(w.updateQueue=_,w.flags|=4),cy(B,!0),B.tail===null&&B.tailMode==="hidden"&&!G.alternate&&!tn)return Zr(w),null}else 2*xr()-B.renderingStartTime>F2&&C!==1073741824&&(w.flags|=128,D=!0,cy(B,!1),w.lanes=4194304);B.isBackwards?(G.sibling=w.child,w.child=G):(_=B.last,_!==null?_.sibling=G:w.child=G,B.last=G)}return B.tail!==null?(w=B.tail,B.rendering=w,B.tail=w.sibling,B.renderingStartTime=xr(),w.sibling=null,_=an.current,Kt(an,D?_&1|2:_&1),w):(Zr(w),null);case 22:case 23:return G2(),D=w.memoizedState!==null,_!==null&&_.memoizedState!==null!==D&&(w.flags|=8192),D&&w.mode&1?wo&1073741824&&(Zr(w),ye&&w.subtreeFlags&6&&(w.flags|=8192)):Zr(w),null;case 24:return null;case 25:return null}throw Error(o(156,w.tag))}var Yne=a.ReactCurrentOwner,_o=!1;function ms(_,w,C,D){w.child=_===null?MU(w,null,C,D):ym(w,_.child,C,D)}function ZU(_,w,C,D,B){C=C.render;var G=w.ref;return pm(w,B),D=f2(_,w,C,D,G,B),C=p2(),_!==null&&!_o?(w.updateQueue=_.updateQueue,w.flags&=-2053,_.lanes&=~B,Xc(_,w,B)):(tn&&C&&n2(w),w.flags|=1,ms(_,w,D,B),w.child)}function $U(_,w,C,D,B){if(_===null){var G=C.type;return typeof G=="function"&&!H2(G)&&G.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(w.tag=15,w.type=G,e4(_,w,G,D,B)):(_=wb(C.type,null,D,w,w.mode,B),_.ref=w.ref,_.return=w,w.child=_)}if(G=_.child,!(_.lanes&B)){var se=G.memoizedProps;if(C=C.compare,C=C!==null?C:Fw,C(se,D)&&_.ref===w.ref)return Xc(_,w,B)}return w.flags|=1,_=uh(G,D),_.ref=w.ref,_.return=w,w.child=_}function e4(_,w,C,D,B){if(_!==null&&Fw(_.memoizedProps,D)&&_.ref===w.ref)if(_o=!1,(_.lanes&B)!==0)_.flags&131072&&(_o=!0);else return w.lanes=_.lanes,Xc(_,w,B);return _2(_,w,C,D,B)}function t4(_,w,C){var D=w.pendingProps,B=D.children,G=_!==null?_.memoizedState:null;if(D.mode==="hidden")if(!(w.mode&1))w.memoizedState={baseLanes:0,cachePool:null},Kt(bm,wo),wo|=C;else if(C&1073741824)w.memoizedState={baseLanes:0,cachePool:null},D=G!==null?G.baseLanes:C,Kt(bm,wo),wo|=D;else return _=G!==null?G.baseLanes|C:C,w.lanes=w.childLanes=1073741824,w.memoizedState={baseLanes:_,cachePool:null},w.updateQueue=null,Kt(bm,wo),wo|=_,null;else G!==null?(D=G.baseLanes|C,w.memoizedState=null):D=C,Kt(bm,wo),wo|=D;return ms(_,w,B,C),w.child}function i4(_,w){var C=w.ref;(_===null&&C!==null||_!==null&&_.ref!==C)&&(w.flags|=512,w.flags|=2097152)}function _2(_,w,C,D,B){var G=Us(C)?qa:Wt.current;return G=Ko(w,G),pm(w,B),C=f2(_,w,C,D,G,B),D=p2(),_!==null&&!_o?(w.updateQueue=_.updateQueue,w.flags&=-2053,_.lanes&=~B,Xc(_,w,B)):(tn&&D&&n2(w),w.flags|=1,ms(_,w,C,B),w.child)}function n4(_,w,C,D,B){if(Us(C)){var G=!0;Dw(w)}else G=!1;if(pm(w,B),w.stateNode===null)_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),vU(w,C,D),i2(w,C,D,B),D=!0;else if(_===null){var se=w.stateNode,Se=w.memoizedProps;se.props=Se;var ze=se.context,et=C.contextType;typeof et=="object"&&et!==null?et=Zo(et):(et=Us(C)?qa:Wt.current,et=Ko(w,et));var yt=C.getDerivedStateFromProps,Yt=typeof yt=="function"||typeof se.getSnapshotBeforeUpdate=="function";Yt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Se!==D||ze!==et)&&yU(w,se,D,et),rh=!1;var Dt=w.memoizedState;se.state=Dt,Uw(w,D,se,B),ze=w.memoizedState,Se!==D||Dt!==ze||vn.current||rh?(typeof yt=="function"&&(t2(w,C,yt,D),ze=w.memoizedState),(Se=rh||gU(w,C,Se,D,Dt,ze,et))?(Yt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(w.flags|=4194308)):(typeof se.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=D,w.memoizedState=ze),se.props=D,se.state=ze,se.context=et,D=Se):(typeof se.componentDidMount=="function"&&(w.flags|=4194308),D=!1)}else{se=w.stateNode,dU(_,w),Se=w.memoizedProps,et=w.type===w.elementType?Se:Qa(w.type,Se),se.props=et,Yt=w.pendingProps,Dt=se.context,ze=C.contextType,typeof ze=="object"&&ze!==null?ze=Zo(ze):(ze=Us(C)?qa:Wt.current,ze=Ko(w,ze));var zi=C.getDerivedStateFromProps;(yt=typeof zi=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Se!==Yt||Dt!==ze)&&yU(w,se,D,ze),rh=!1,Dt=w.memoizedState,se.state=Dt,Uw(w,D,se,B);var At=w.memoizedState;Se!==Yt||Dt!==At||vn.current||rh?(typeof zi=="function"&&(t2(w,C,zi,D),At=w.memoizedState),(et=rh||gU(w,C,et,D,Dt,At,ze)||!1)?(yt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(D,At,ze),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(D,At,ze)),typeof se.componentDidUpdate=="function"&&(w.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof se.componentDidUpdate!="function"||Se===_.memoizedProps&&Dt===_.memoizedState||(w.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Se===_.memoizedProps&&Dt===_.memoizedState||(w.flags|=1024),w.memoizedProps=D,w.memoizedState=At),se.props=D,se.state=At,se.context=ze,D=et):(typeof se.componentDidUpdate!="function"||Se===_.memoizedProps&&Dt===_.memoizedState||(w.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Se===_.memoizedProps&&Dt===_.memoizedState||(w.flags|=1024),D=!1)}return w2(_,w,C,D,G,B)}function w2(_,w,C,D,B,G){i4(_,w);var se=(w.flags&128)!==0;if(!D&&!se)return B&&aU(w,C,!1),Xc(_,w,G);D=w.stateNode,Yne.current=w;var Se=se&&typeof C.getDerivedStateFromError!="function"?null:D.render();return w.flags|=1,_!==null&&se?(w.child=ym(w,_.child,null,G),w.child=ym(w,null,Se,G)):ms(_,w,Se,G),w.memoizedState=D.state,B&&aU(w,C,!0),w.child}function r4(_){var w=_.stateNode;w.pendingContext?sU(_,w.pendingContext,w.pendingContext!==w.context):w.context&&sU(_,w.context,!1),l2(_,w.containerInfo)}function s4(_,w,C,D,B){return vm(),a2(B),w.flags|=256,ms(_,w,C,D),w.child}var tb={dehydrated:null,treeContext:null,retryLane:0};function ib(_){return{baseLanes:_,cachePool:null}}function o4(_,w,C){var D=w.pendingProps,B=an.current,G=!1,se=(w.flags&128)!==0,Se;if((Se=se)||(Se=_!==null&&_.memoizedState===null?!1:(B&2)!==0),Se?(G=!0,w.flags&=-129):(_===null||_.memoizedState!==null)&&(B|=1),Kt(an,B&1),_===null)return o2(w),_=w.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(w.mode&1?ef(_)?w.lanes=8:w.lanes=1073741824:w.lanes=1,null):(B=D.children,_=D.fallback,G?(D=w.mode,G=w.child,B={mode:"hidden",children:B},!(D&1)&&G!==null?(G.childLanes=0,G.pendingProps=B):G=bb(B,D,0,null),_=uf(_,D,C,null),G.return=w,_.return=w,G.sibling=_,w.child=G,w.child.memoizedState=ib(C),w.memoizedState=tb,_):b2(w,B));if(B=_.memoizedState,B!==null){if(Se=B.dehydrated,Se!==null){if(se)return w.flags&256?(w.flags&=-257,nb(_,w,C,Error(o(422)))):w.memoizedState!==null?(w.child=_.child,w.flags|=128,null):(G=D.fallback,B=w.mode,D=bb({mode:"visible",children:D.children},B,0,null),G=uf(G,B,C,null),G.flags|=2,D.return=w,G.return=w,D.sibling=G,w.child=D,w.mode&1&&ym(w,_.child,null,C),w.child.memoizedState=ib(C),w.memoizedState=tb,G);if(!(w.mode&1))w=nb(_,w,C,null);else if(ef(Se))w=nb(_,w,C,Error(o(419)));else if(D=(C&_.childLanes)!==0,_o||D){if(D=Vn,D!==null){switch(C&-C){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}D=G&(D.suspendedLanes|C)?0:G,D!==0&&D!==B.retryLane&&(B.retryLane=D,na(_,D,-1))}V2(),w=nb(_,w,C,Error(o(421)))}else dm(Se)?(w.flags|=128,w.child=_.child,w=are.bind(null,_),N(Se,w),w=null):(C=B.treeContext,le&&(xo=fe(Se),yo=w,tn=!0,Ja=null,Z0=!1,C!==null&&($o[ea++]=Hc,$o[ea++]=jc,$o[ea++]=tf,Hc=C.id,jc=C.overflow,tf=w)),w=b2(w,w.pendingProps.children),w.flags|=4096);return w}return G?(D=l4(_,w,D.children,D.fallback,C),G=w.child,B=_.child.memoizedState,G.memoizedState=B===null?ib(C):{baseLanes:B.baseLanes|C,cachePool:null},G.childLanes=_.childLanes&~C,w.memoizedState=tb,D):(C=a4(_,w,D.children,C),w.memoizedState=null,C)}return G?(D=l4(_,w,D.children,D.fallback,C),G=w.child,B=_.child.memoizedState,G.memoizedState=B===null?ib(C):{baseLanes:B.baseLanes|C,cachePool:null},G.childLanes=_.childLanes&~C,w.memoizedState=tb,D):(C=a4(_,w,D.children,C),w.memoizedState=null,C)}function b2(_,w){return w=bb({mode:"visible",children:w},_.mode,0,null),w.return=_,_.child=w}function a4(_,w,C,D){var B=_.child;return _=B.sibling,C=uh(B,{mode:"visible",children:C}),!(w.mode&1)&&(C.lanes=D),C.return=w,C.sibling=null,_!==null&&(D=w.deletions,D===null?(w.deletions=[_],w.flags|=16):D.push(_)),w.child=C}function l4(_,w,C,D,B){var G=w.mode;_=_.child;var se=_.sibling,Se={mode:"hidden",children:C};return!(G&1)&&w.child!==_?(C=w.child,C.childLanes=0,C.pendingProps=Se,w.deletions=null):(C=uh(_,Se),C.subtreeFlags=_.subtreeFlags&14680064),se!==null?D=uh(se,D):(D=uf(D,G,B,null),D.flags|=2),D.return=w,C.return=w,C.sibling=D,w.child=C,D}function nb(_,w,C,D){return D!==null&&a2(D),ym(w,_.child,null,C),_=b2(w,w.pendingProps.children),_.flags|=2,w.memoizedState=null,_}function c4(_,w,C){_.lanes|=w;var D=_.alternate;D!==null&&(D.lanes|=w),$T(_.return,w,C)}function S2(_,w,C,D,B){var G=_.memoizedState;G===null?_.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:B}:(G.isBackwards=w,G.rendering=null,G.renderingStartTime=0,G.last=D,G.tail=C,G.tailMode=B)}function u4(_,w,C){var D=w.pendingProps,B=D.revealOrder,G=D.tail;if(ms(_,w,D.children,C),D=an.current,D&2)D=D&1|2,w.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=w.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&c4(_,C,w);else if(_.tag===19)c4(_,C,w);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===w)break e;for(;_.sibling===null;){if(_.return===null||_.return===w)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}D&=1}if(Kt(an,D),!(w.mode&1))w.memoizedState=null;else switch(B){case"forwards":for(C=w.child,B=null;C!==null;)_=C.alternate,_!==null&&Ww(_)===null&&(B=C),C=C.sibling;C=B,C===null?(B=w.child,w.child=null):(B=C.sibling,C.sibling=null),S2(w,!1,B,C,G);break;case"backwards":for(C=null,B=w.child,w.child=null;B!==null;){if(_=B.alternate,_!==null&&Ww(_)===null){w.child=B;break}_=B.sibling,B.sibling=C,C=B,B=_}S2(w,!0,C,null,G);break;case"together":S2(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function Xc(_,w,C){if(_!==null&&(w.dependencies=_.dependencies),Sm|=w.lanes,!(C&w.childLanes))return null;if(_!==null&&w.child!==_.child)throw Error(o(153));if(w.child!==null){for(_=w.child,C=uh(_,_.pendingProps),w.child=C,C.return=w;_.sibling!==null;)_=_.sibling,C=C.sibling=uh(_,_.pendingProps),C.return=w;C.sibling=null}return w.child}function Qne(_,w,C){switch(w.tag){case 3:r4(w),vm();break;case 5:CU(w);break;case 1:Us(w.type)&&Dw(w);break;case 4:l2(w,w.stateNode.containerInfo);break;case 10:hU(w,w.type._context,w.memoizedProps.value);break;case 13:var D=w.memoizedState;if(D!==null)return D.dehydrated!==null?(Kt(an,an.current&1),w.flags|=128,null):C&w.child.childLanes?o4(_,w,C):(Kt(an,an.current&1),_=Xc(_,w,C),_!==null?_.sibling:null);Kt(an,an.current&1);break;case 19:if(D=(C&w.childLanes)!==0,_.flags&128){if(D)return u4(_,w,C);w.flags|=128}var B=w.memoizedState;if(B!==null&&(B.rendering=null,B.tail=null,B.lastEffect=null),Kt(an,an.current),D)break;return null;case 22:case 23:return w.lanes=0,t4(_,w,C)}return Xc(_,w,C)}function Jne(_,w){switch(r2(w),w.tag){case 1:return Us(w.type)&&Pw(),_=w.flags,_&65536?(w.flags=_&-65537|128,w):null;case 3:return _m(),bt(vn),bt(Wt),h2(),_=w.flags,_&65536&&!(_&128)?(w.flags=_&-65537|128,w):null;case 5:return c2(w),null;case 13:if(bt(an),_=w.memoizedState,_!==null&&_.dehydrated!==null){if(w.alternate===null)throw Error(o(340));vm()}return _=w.flags,_&65536?(w.flags=_&-65537|128,w):null;case 19:return bt(an),null;case 4:return _m(),null;case 10:return ZT(w.type._context),null;case 22:case 23:return G2(),null;case 24:return null;default:return null}}var rb=!1,sf=!1,Kne=typeof WeakSet=="function"?WeakSet:Set,lt=null;function sb(_,w){var C=_.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(D){Hs(_,w,D)}else C.current=null}function A2(_,w,C){try{C()}catch(D){Hs(_,w,D)}}var h4=!1;function Zne(_,w){for(Y(_.containerInfo),lt=w;lt!==null;)if(_=lt,w=_.child,(_.subtreeFlags&1028)!==0&&w!==null)w.return=_,lt=w;else for(;lt!==null;){_=lt;try{var C=_.alternate;if(_.flags&1024)switch(_.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var D=C.memoizedProps,B=C.memoizedState,G=_.stateNode,se=G.getSnapshotBeforeUpdate(_.elementType===_.type?D:Qa(_.type,D),B);G.__reactInternalSnapshotBeforeUpdate=se}break;case 3:ye&&Fe(_.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Se){Hs(_,_.return,Se)}if(w=_.sibling,w!==null){w.return=_.return,lt=w;break}lt=_.return}return C=h4,h4=!1,C}function of(_,w,C){var D=w.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var B=D=D.next;do{if((B.tag&_)===_){var G=B.destroy;B.destroy=void 0,G!==void 0&&A2(w,C,G)}B=B.next}while(B!==D)}}function uy(_,w){if(w=w.updateQueue,w=w!==null?w.lastEffect:null,w!==null){var C=w=w.next;do{if((C.tag&_)===_){var D=C.create;C.destroy=D()}C=C.next}while(C!==w)}}function M2(_){var w=_.ref;if(w!==null){var C=_.stateNode;switch(_.tag){case 5:_=Q(C);break;default:_=C}typeof w=="function"?w(_):w.current=_}}function d4(_,w,C){if(kl&&typeof kl.onCommitFiberUnmount=="function")try{kl.onCommitFiberUnmount(Rw,w)}catch{}switch(w.tag){case 0:case 11:case 14:case 15:if(_=w.updateQueue,_!==null&&(_=_.lastEffect,_!==null)){var D=_=_.next;do{var B=D,G=B.destroy;B=B.tag,G!==void 0&&(B&2||B&4)&&A2(w,C,G),D=D.next}while(D!==_)}break;case 1:if(sb(w,C),_=w.stateNode,typeof _.componentWillUnmount=="function")try{_.props=w.memoizedProps,_.state=w.memoizedState,_.componentWillUnmount()}catch(se){Hs(w,C,se)}break;case 5:sb(w,C);break;case 4:ye?y4(_,w,C):ae&&ae&&(w=w.stateNode.containerInfo,C=pt(w),vr(w,C))}}function f4(_,w,C){for(var D=w;;)if(d4(_,D,C),D.child===null||ye&&D.tag===4){if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return}D.sibling.return=D.return,D=D.sibling}else D.child.return=D,D=D.child}function p4(_){var w=_.alternate;w!==null&&(_.alternate=null,p4(w)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(w=_.stateNode,w!==null&&Ue(w)),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function m4(_){return _.tag===5||_.tag===3||_.tag===4}function g4(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||m4(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function v4(_){if(ye){e:{for(var w=_.return;w!==null;){if(m4(w))break e;w=w.return}throw Error(o(160))}var C=w;switch(C.tag){case 5:w=C.stateNode,C.flags&32&&(xt(w),C.flags&=-33),C=g4(_),E2(_,C,w);break;case 3:case 4:w=C.stateNode.containerInfo,C=g4(_),C2(_,C,w);break;default:throw Error(o(161))}}}function C2(_,w,C){var D=_.tag;if(D===5||D===6)_=_.stateNode,w?Re(C,_,w):Le(C,_);else if(D!==4&&(_=_.child,_!==null))for(C2(_,w,C),_=_.sibling;_!==null;)C2(_,w,C),_=_.sibling}function E2(_,w,C){var D=_.tag;if(D===5||D===6)_=_.stateNode,w?be(C,_,w):We(C,_);else if(D!==4&&(_=_.child,_!==null))for(E2(_,w,C),_=_.sibling;_!==null;)E2(_,w,C),_=_.sibling}function y4(_,w,C){for(var D=w,B=!1,G,se;;){if(!B){B=D.return;e:for(;;){if(B===null)throw Error(o(160));switch(G=B.stateNode,B.tag){case 5:se=!1;break e;case 3:G=G.containerInfo,se=!0;break e;case 4:G=G.containerInfo,se=!0;break e}B=B.return}B=!0}if(D.tag===5||D.tag===6)f4(_,D,C),se?tt(G,D.stateNode):Ne(G,D.stateNode);else if(D.tag===18)se?si(G,D.stateNode):dt(G,D.stateNode);else if(D.tag===4){if(D.child!==null){G=D.stateNode.containerInfo,se=!0,D.child.return=D,D=D.child;continue}}else if(d4(_,D,C),D.child!==null){D.child.return=D,D=D.child;continue}if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return,D.tag===4&&(B=!1)}D.sibling.return=D.return,D=D.sibling}}function T2(_,w){if(ye){switch(w.tag){case 0:case 11:case 14:case 15:of(3,w,w.return),uy(3,w),of(5,w,w.return);return;case 1:return;case 5:var C=w.stateNode;if(C!=null){var D=w.memoizedProps;_=_!==null?_.memoizedProps:D;var B=w.type,G=w.updateQueue;w.updateQueue=null,G!==null&&re(C,G,B,_,D,w)}return;case 6:if(w.stateNode===null)throw Error(o(162));C=w.memoizedProps,ue(w.stateNode,_!==null?_.memoizedProps:C,C);return;case 3:le&&_!==null&&_.memoizedState.isDehydrated&&_t(w.stateNode.containerInfo);return;case 12:return;case 13:ob(w);return;case 19:ob(w);return;case 17:return}throw Error(o(163))}switch(w.tag){case 0:case 11:case 14:case 15:of(3,w,w.return),uy(3,w),of(5,w,w.return);return;case 12:return;case 13:ob(w);return;case 19:ob(w);return;case 3:le&&_!==null&&_.memoizedState.isDehydrated&&_t(w.stateNode.containerInfo);break;case 22:case 23:return}e:if(ae){switch(w.tag){case 1:case 5:case 6:break e;case 3:case 4:w=w.stateNode,vr(w.containerInfo,w.pendingChildren);break e}throw Error(o(163))}}function ob(_){var w=_.updateQueue;if(w!==null){_.updateQueue=null;var C=_.stateNode;C===null&&(C=_.stateNode=new Kne),w.forEach(function(D){var B=lre.bind(null,_,D);C.has(D)||(C.add(D),D.then(B,B))})}}function $ne(_,w){for(lt=w;lt!==null;){w=lt;var C=w.deletions;if(C!==null)for(var D=0;D<C.length;D++){var B=C[D];try{var G=_;ye?y4(G,B,w):f4(G,B,w);var se=B.alternate;se!==null&&(se.return=null),B.return=null}catch(St){Hs(B,w,St)}}if(C=w.child,w.subtreeFlags&12854&&C!==null)C.return=w,lt=C;else for(;lt!==null;){w=lt;try{var Se=w.flags;if(Se&32&&ye&&xt(w.stateNode),Se&512){var ze=w.alternate;if(ze!==null){var et=ze.ref;et!==null&&(typeof et=="function"?et(null):et.current=null)}}if(Se&8192)switch(w.tag){case 13:if(w.memoizedState!==null){var yt=w.alternate;(yt===null||yt.memoizedState===null)&&(O2=xr())}break;case 22:var Yt=w.memoizedState!==null,Dt=w.alternate,zi=Dt!==null&&Dt.memoizedState!==null;if(C=w,ye){e:if(D=C,B=Yt,G=null,ye)for(var At=D;;){if(At.tag===5){if(G===null){G=At;var $r=At.stateNode;B?kt($r):oe(At.stateNode,At.memoizedProps)}}else if(At.tag===6){if(G===null){var sa=At.stateNode;B?q(sa):xe(sa,At.memoizedProps)}}else if((At.tag!==22&&At.tag!==23||At.memoizedState===null||At===D)&&At.child!==null){At.child.return=At,At=At.child;continue}if(At===D)break;for(;At.sibling===null;){if(At.return===null||At.return===D)break e;G===At&&(G=null),At=At.return}G===At&&(G=null),At.sibling.return=At.return,At=At.sibling}}if(Yt&&!zi&&C.mode&1){lt=C;for(var De=C.child;De!==null;){for(C=lt=De;lt!==null;){D=lt;var Ae=D.child;switch(D.tag){case 0:case 11:case 14:case 15:of(4,D,D.return);break;case 1:sb(D,D.return);var ke=D.stateNode;if(typeof ke.componentWillUnmount=="function"){var ut=D.return;try{ke.props=D.memoizedProps,ke.state=D.memoizedState,ke.componentWillUnmount()}catch(St){Hs(D,ut,St)}}break;case 5:sb(D,D.return);break;case 22:if(D.memoizedState!==null){w4(C);continue}}Ae!==null?(Ae.return=D,lt=Ae):w4(C)}De=De.sibling}}}switch(Se&4102){case 2:v4(w),w.flags&=-3;break;case 6:v4(w),w.flags&=-3,T2(w.alternate,w);break;case 4096:w.flags&=-4097;break;case 4100:w.flags&=-4097,T2(w.alternate,w);break;case 4:T2(w.alternate,w)}}catch(St){Hs(w,w.return,St)}if(C=w.sibling,C!==null){C.return=w.return,lt=C;break}lt=w.return}}}function ere(_,w,C){lt=_,x4(_)}function x4(_,w,C){for(var D=(_.mode&1)!==0;lt!==null;){var B=lt,G=B.child;if(B.tag===22&&D){var se=B.memoizedState!==null||rb;if(!se){var Se=B.alternate,ze=Se!==null&&Se.memoizedState!==null||sf;Se=rb;var et=sf;if(rb=se,(sf=ze)&&!et)for(lt=B;lt!==null;)se=lt,ze=se.child,se.tag===22&&se.memoizedState!==null?b4(B):ze!==null?(ze.return=se,lt=ze):b4(B);for(;G!==null;)lt=G,x4(G),G=G.sibling;lt=B,rb=Se,sf=et}_4(_)}else B.subtreeFlags&8772&&G!==null?(G.return=B,lt=G):_4(_)}}function _4(_){for(;lt!==null;){var w=lt;if(w.flags&8772){var C=w.alternate;try{if(w.flags&8772)switch(w.tag){case 0:case 11:case 15:sf||uy(5,w);break;case 1:var D=w.stateNode;if(w.flags&4&&!sf)if(C===null)D.componentDidMount();else{var B=w.elementType===w.type?C.memoizedProps:Qa(w.type,C.memoizedProps);D.componentDidUpdate(B,C.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var G=w.updateQueue;G!==null&&pU(w,G,D);break;case 3:var se=w.updateQueue;if(se!==null){if(C=null,w.child!==null)switch(w.child.tag){case 5:C=Q(w.child.stateNode);break;case 1:C=w.child.stateNode}pU(w,se,C)}break;case 5:var Se=w.stateNode;C===null&&w.flags&4&&Ge(Se,w.type,w.memoizedProps,w);break;case 6:break;case 4:break;case 12:break;case 13:if(le&&w.memoizedState===null){var ze=w.alternate;if(ze!==null){var et=ze.memoizedState;if(et!==null){var yt=et.dehydrated;yt!==null&&mt(yt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}sf||w.flags&512&&M2(w)}catch(Yt){Hs(w,w.return,Yt)}}if(w===_){lt=null;break}if(C=w.sibling,C!==null){C.return=w.return,lt=C;break}lt=w.return}}function w4(_){for(;lt!==null;){var w=lt;if(w===_){lt=null;break}var C=w.sibling;if(C!==null){C.return=w.return,lt=C;break}lt=w.return}}function b4(_){for(;lt!==null;){var w=lt;try{switch(w.tag){case 0:case 11:case 15:var C=w.return;try{uy(4,w)}catch(ze){Hs(w,C,ze)}break;case 1:var D=w.stateNode;if(typeof D.componentDidMount=="function"){var B=w.return;try{D.componentDidMount()}catch(ze){Hs(w,B,ze)}}var G=w.return;try{M2(w)}catch(ze){Hs(w,G,ze)}break;case 5:var se=w.return;try{M2(w)}catch(ze){Hs(w,se,ze)}}}catch(ze){Hs(w,w.return,ze)}if(w===_){lt=null;break}var Se=w.sibling;if(Se!==null){Se.return=w.return,lt=Se;break}lt=w.return}}var ab=0,lb=1,cb=2,ub=3,hb=4;if(typeof Symbol=="function"&&Symbol.for){var hy=Symbol.for;ab=hy("selector.component"),lb=hy("selector.has_pseudo_class"),cb=hy("selector.role"),ub=hy("selector.test_id"),hb=hy("selector.text")}function P2(_){var w=Ee(_);if(w!=null){if(typeof w.memoizedProps["data-testname"]!="string")throw Error(o(364));return w}if(_=Ke(_),_===null)throw Error(o(362));return _.stateNode.current}function D2(_,w){switch(w.$$typeof){case ab:if(_.type===w.value)return!0;break;case lb:e:{w=w.value,_=[_,0];for(var C=0;C<_.length;){var D=_[C++],B=_[C++],G=w[B];if(D.tag!==5||!te(D)){for(;G!=null&&D2(D,G);)B++,G=w[B];if(B===w.length){w=!0;break e}else for(D=D.child;D!==null;)_.push(D,B),D=D.sibling}}w=!1}return w;case cb:if(_.tag===5&&_e(_.stateNode,w.value))return!0;break;case hb:if((_.tag===5||_.tag===6)&&(_=L(_),_!==null&&0<=_.indexOf(w.value)))return!0;break;case ub:if(_.tag===5&&(_=_.memoizedProps["data-testname"],typeof _=="string"&&_.toLowerCase()===w.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function I2(_){switch(_.$$typeof){case ab:return"<"+(E(_.value)||"Unknown")+">";case lb:return":has("+(I2(_)||"")+")";case cb:return'[role="'+_.value+'"]';case hb:return'"'+_.value+'"';case ub:return'[data-testname="'+_.value+'"]';default:throw Error(o(365))}}function S4(_,w){var C=[];_=[_,0];for(var D=0;D<_.length;){var B=_[D++],G=_[D++],se=w[G];if(B.tag!==5||!te(B)){for(;se!=null&&D2(B,se);)G++,se=w[G];if(G===w.length)C.push(B);else for(B=B.child;B!==null;)_.push(B,G),B=B.sibling}}return C}function L2(_,w){if(!Je)throw Error(o(363));_=P2(_),_=S4(_,w),w=[],_=Array.from(_);for(var C=0;C<_.length;){var D=_[C++];if(D.tag===5)te(D)||w.push(D.stateNode);else for(D=D.child;D!==null;)_.push(D),D=D.sibling}return w}var tre=Math.ceil,db=a.ReactCurrentDispatcher,B2=a.ReactCurrentOwner,Dn=a.ReactCurrentBatchConfig,oi=0,Vn=null,Hn=null,Nr=0,wo=0,bm=Yr(0),er=0,dy=null,Sm=0,fb=0,R2=0,fy=null,Gs=null,O2=0,F2=1/0;function Am(){F2=xr()+500}var pb=!1,N2=null,oh=null,mb=!1,ah=null,gb=0,py=0,k2=null,vb=-1,yb=0;function gs(){return oi&6?xr():vb!==-1?vb:vb=xr()}function lh(_){return _.mode&1?oi&2&&Nr!==0?Nr&-Nr:Nne.transition!==null?(yb===0&&(_=Iw,Iw<<=1,!(Iw&4194240)&&(Iw=64),yb=_),yb):(_=xi,_!==0?_:Be()):1}function na(_,w,C){if(50<py)throw py=0,k2=null,Error(o(185));var D=xb(_,w);return D===null?null:(K0(D,w,C),(!(oi&2)||D!==Vn)&&(D===Vn&&(!(oi&2)&&(fb|=w),er===4&&ch(D,Nr)),Vs(D,C),w===1&&oi===0&&!(_.mode&1)&&(Am(),Ow&&Ul())),D)}function xb(_,w){_.lanes|=w;var C=_.alternate;for(C!==null&&(C.lanes|=w),C=_,_=_.return;_!==null;)_.childLanes|=w,C=_.alternate,C!==null&&(C.childLanes|=w),C=_,_=_.return;return C.tag===3?C.stateNode:null}function Vs(_,w){var C=_.callbackNode;Tne(_,w);var D=Bw(_,_===Vn?Nr:0);if(D===0)C!==null&&cU(C),_.callbackNode=null,_.callbackPriority=0;else if(w=D&-D,_.callbackPriority!==w){if(C!=null&&cU(C),w===1)_.tag===0?Fne(M4.bind(null,_)):uU(M4.bind(null,_)),Ie?Pe(function(){oi===0&&Ul()}):XT(qT,Ul),C=null;else{switch(lU(D)){case 1:C=qT;break;case 4:C=Lne;break;case 16:C=YT;break;case 536870912:C=Bne;break;default:C=YT}C=R4(C,A4.bind(null,_))}_.callbackPriority=w,_.callbackNode=C}}function A4(_,w){if(vb=-1,yb=0,oi&6)throw Error(o(327));var C=_.callbackNode;if(cf()&&_.callbackNode!==C)return null;var D=Bw(_,_===Vn?Nr:0);if(D===0)return null;if(D&30||D&_.expiredLanes||w)w=_b(_,D);else{w=D;var B=oi;oi|=2;var G=T4();(Vn!==_||Nr!==w)&&(Am(),af(_,w));do try{rre();break}catch(Se){E4(_,Se)}while(1);KT(),db.current=G,oi=B,Hn!==null?w=0:(Vn=null,Nr=0,w=er)}if(w!==0){if(w===2&&(B=HT(_),B!==0&&(D=B,w=z2(_,B))),w===1)throw C=dy,af(_,0),ch(_,D),Vs(_,xr()),C;if(w===6)ch(_,D);else{if(B=_.current.alternate,!(D&30)&&!ire(B)&&(w=_b(_,D),w===2&&(G=HT(_),G!==0&&(D=G,w=z2(_,G))),w===1))throw C=dy,af(_,0),ch(_,D),Vs(_,xr()),C;switch(_.finishedWork=B,_.finishedLanes=D,w){case 0:case 1:throw Error(o(345));case 2:lf(_,Gs);break;case 3:if(ch(_,D),(D&130023424)===D&&(w=O2+500-xr(),10<w)){if(Bw(_,0)!==0)break;if(B=_.suspendedLanes,(B&D)!==D){gs(),_.pingedLanes|=_.suspendedLanes&B;break}_.timeoutHandle=ve(lf.bind(null,_,Gs),w);break}lf(_,Gs);break;case 4:if(ch(_,D),(D&4194240)===D)break;for(w=_.eventTimes,B=-1;0<D;){var se=31-Ya(D);G=1<<se,se=w[se],se>B&&(B=se),D&=~G}if(D=B,D=xr()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*tre(D/1960))-D,10<D){_.timeoutHandle=ve(lf.bind(null,_,Gs),D);break}lf(_,Gs);break;case 5:lf(_,Gs);break;default:throw Error(o(329))}}}return Vs(_,xr()),_.callbackNode===C?A4.bind(null,_):null}function z2(_,w){var C=fy;return _.current.memoizedState.isDehydrated&&(af(_,w).flags|=256),_=_b(_,w),_!==2&&(w=Gs,Gs=C,w!==null&&U2(w)),_}function U2(_){Gs===null?Gs=_:Gs.push.apply(Gs,_)}function ire(_){for(var w=_;;){if(w.flags&16384){var C=w.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var D=0;D<C.length;D++){var B=C[D],G=B.getSnapshot;B=B.value;try{if(!zl(G(),B))return!1}catch{return!1}}}if(C=w.child,w.subtreeFlags&16384&&C!==null)C.return=w,w=C;else{if(w===_)break;for(;w.sibling===null;){if(w.return===null||w.return===_)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function ch(_,w){for(w&=~R2,w&=~fb,_.suspendedLanes|=w,_.pingedLanes&=~w,_=_.expirationTimes;0<w;){var C=31-Ya(w),D=1<<C;_[C]=-1,w&=~D}}function M4(_){if(oi&6)throw Error(o(327));cf();var w=Bw(_,0);if(!(w&1))return Vs(_,xr()),null;var C=_b(_,w);if(_.tag!==0&&C===2){var D=HT(_);D!==0&&(w=D,C=z2(_,D))}if(C===1)throw C=dy,af(_,0),ch(_,w),Vs(_,xr()),C;if(C===6)throw Error(o(345));return _.finishedWork=_.current.alternate,_.finishedLanes=w,lf(_,Gs),Vs(_,xr()),null}function C4(_){ah!==null&&ah.tag===0&&!(oi&6)&&cf();var w=oi;oi|=1;var C=Dn.transition,D=xi;try{if(Dn.transition=null,xi=1,_)return _()}finally{xi=D,Dn.transition=C,oi=w,!(oi&6)&&Ul()}}function G2(){wo=bm.current,bt(bm)}function af(_,w){_.finishedWork=null,_.finishedLanes=0;var C=_.timeoutHandle;if(C!==pe&&(_.timeoutHandle=pe,de(C)),Hn!==null)for(C=Hn.return;C!==null;){var D=C;switch(r2(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Pw();break;case 3:_m(),bt(vn),bt(Wt),h2();break;case 5:c2(D);break;case 4:_m();break;case 13:bt(an);break;case 19:bt(an);break;case 10:ZT(D.type._context);break;case 22:case 23:G2()}C=C.return}if(Vn=_,Hn=_=uh(_.current,null),Nr=wo=w,er=0,dy=null,R2=fb=Sm=0,Gs=fy=null,Gl!==null){for(w=0;w<Gl.length;w++)if(C=Gl[w],D=C.interleaved,D!==null){C.interleaved=null;var B=D.next,G=C.pending;if(G!==null){var se=G.next;G.next=B,D.next=se}C.pending=D}Gl=null}return _}function E4(_,w){do{var C=Hn;try{if(KT(),Xw.current=Zw,qw){for(var D=yn.memoizedState;D!==null;){var B=D.queue;B!==null&&(B.pending=null),D=D.next}qw=!1}if(wm=0,_r=Jr=yn=null,ny=!1,ry=0,B2.current=null,C===null||C.return===null){er=1,dy=w,Hn=null;break}e:{var G=_,se=C.return,Se=C,ze=w;if(w=Nr,Se.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var et=ze,yt=Se,Yt=yt.tag;if(!(yt.mode&1)&&(Yt===0||Yt===11||Yt===15)){var Dt=yt.alternate;Dt?(yt.updateQueue=Dt.updateQueue,yt.memoizedState=Dt.memoizedState,yt.lanes=Dt.lanes):(yt.updateQueue=null,yt.memoizedState=null)}var zi=YU(se);if(zi!==null){zi.flags&=-257,QU(zi,se,Se,G,w),zi.mode&1&&qU(G,et,w),w=zi,ze=et;var At=w.updateQueue;if(At===null){var $r=new Set;$r.add(ze),w.updateQueue=$r}else At.add(ze);break e}else{if(!(w&1)){qU(G,et,w),V2();break e}ze=Error(o(426))}}else if(tn&&Se.mode&1){var sa=YU(se);if(sa!==null){!(sa.flags&65536)&&(sa.flags|=256),QU(sa,se,Se,G,w),a2(ze);break e}}G=ze,er!==4&&(er=2),fy===null?fy=[G]:fy.push(G),ze=y2(ze,Se),Se=se;do{switch(Se.tag){case 3:Se.flags|=65536,w&=-w,Se.lanes|=w;var De=WU(Se,ze,w);fU(Se,De);break e;case 1:G=ze;var Ae=Se.type,ke=Se.stateNode;if(!(Se.flags&128)&&(typeof Ae.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(oh===null||!oh.has(ke)))){Se.flags|=65536,w&=-w,Se.lanes|=w;var ut=XU(Se,G,w);fU(Se,ut);break e}}Se=Se.return}while(Se!==null)}D4(C)}catch(St){w=St,Hn===C&&C!==null&&(Hn=C=C.return);continue}break}while(1)}function T4(){var _=db.current;return db.current=Zw,_===null?Zw:_}function V2(){(er===0||er===3||er===2)&&(er=4),Vn===null||!(Sm&268435455)&&!(fb&268435455)||ch(Vn,Nr)}function _b(_,w){var C=oi;oi|=2;var D=T4();Vn===_&&Nr===w||af(_,w);do try{nre();break}catch(B){E4(_,B)}while(1);if(KT(),oi=C,db.current=D,Hn!==null)throw Error(o(261));return Vn=null,Nr=0,er}function nre(){for(;Hn!==null;)P4(Hn)}function rre(){for(;Hn!==null&&!Dne();)P4(Hn)}function P4(_){var w=B4(_.alternate,_,wo);_.memoizedProps=_.pendingProps,w===null?D4(_):Hn=w,B2.current=null}function D4(_){var w=_;do{var C=w.alternate;if(_=w.return,w.flags&32768){if(C=Jne(C,w),C!==null){C.flags&=32767,Hn=C;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{er=6,Hn=null;return}}else if(C=qne(C,w,wo),C!==null){Hn=C;return}if(w=w.sibling,w!==null){Hn=w;return}Hn=w=_}while(w!==null);er===0&&(er=5)}function lf(_,w){var C=xi,D=Dn.transition;try{Dn.transition=null,xi=1,sre(_,w,C)}finally{Dn.transition=D,xi=C}return null}function sre(_,w,C){do cf();while(ah!==null);if(oi&6)throw Error(o(327));var D=_.finishedWork,B=_.finishedLanes;if(D===null)return null;if(_.finishedWork=null,_.finishedLanes=0,D===_.current)throw Error(o(177));_.callbackNode=null,_.callbackPriority=0;var G=D.lanes|D.childLanes;if(Pne(_,G),_===Vn&&(Hn=Vn=null,Nr=0),!(D.subtreeFlags&2064)&&!(D.flags&2064)||mb||(mb=!0,R4(YT,function(){return cf(),null})),G=(D.flags&15990)!==0,D.subtreeFlags&15990||G){G=Dn.transition,Dn.transition=null;var se=xi;xi=1;var Se=oi;oi|=4,B2.current=null,Zne(_,D),$ne(_,D),j(_.containerInfo),_.current=D,ere(D),Ine(),oi=Se,xi=se,Dn.transition=G}else _.current=D;if(mb&&(mb=!1,ah=_,gb=B),G=_.pendingLanes,G===0&&(oh=null),Rne(D.stateNode),Vs(_,xr()),w!==null)for(C=_.onRecoverableError,D=0;D<w.length;D++)C(w[D]);if(pb)throw pb=!1,_=N2,N2=null,_;return gb&1&&_.tag!==0&&cf(),G=_.pendingLanes,G&1?_===k2?py++:(py=0,k2=_):py=0,Ul(),null}function cf(){if(ah!==null){var _=lU(gb),w=Dn.transition,C=xi;try{if(Dn.transition=null,xi=16>_?16:_,ah===null)var D=!1;else{if(_=ah,ah=null,gb=0,oi&6)throw Error(o(331));var B=oi;for(oi|=4,lt=_.current;lt!==null;){var G=lt,se=G.child;if(lt.flags&16){var Se=G.deletions;if(Se!==null){for(var ze=0;ze<Se.length;ze++){var et=Se[ze];for(lt=et;lt!==null;){var yt=lt;switch(yt.tag){case 0:case 11:case 15:of(8,yt,G)}var Yt=yt.child;if(Yt!==null)Yt.return=yt,lt=Yt;else for(;lt!==null;){yt=lt;var Dt=yt.sibling,zi=yt.return;if(p4(yt),yt===et){lt=null;break}if(Dt!==null){Dt.return=zi,lt=Dt;break}lt=zi}}}var At=G.alternate;if(At!==null){var $r=At.child;if($r!==null){At.child=null;do{var sa=$r.sibling;$r.sibling=null,$r=sa}while($r!==null)}}lt=G}}if(G.subtreeFlags&2064&&se!==null)se.return=G,lt=se;else e:for(;lt!==null;){if(G=lt,G.flags&2048)switch(G.tag){case 0:case 11:case 15:of(9,G,G.return)}var De=G.sibling;if(De!==null){De.return=G.return,lt=De;break e}lt=G.return}}var Ae=_.current;for(lt=Ae;lt!==null;){se=lt;var ke=se.child;if(se.subtreeFlags&2064&&ke!==null)ke.return=se,lt=ke;else e:for(se=Ae;lt!==null;){if(Se=lt,Se.flags&2048)try{switch(Se.tag){case 0:case 11:case 15:uy(9,Se)}}catch(St){Hs(Se,Se.return,St)}if(Se===se){lt=null;break e}var ut=Se.sibling;if(ut!==null){ut.return=Se.return,lt=ut;break e}lt=Se.return}}if(oi=B,Ul(),kl&&typeof kl.onPostCommitFiberRoot=="function")try{kl.onPostCommitFiberRoot(Rw,_)}catch{}D=!0}return D}finally{xi=C,Dn.transition=w}}return!1}function I4(_,w,C){w=y2(C,w),w=WU(_,w,1),sh(_,w),w=gs(),_=xb(_,1),_!==null&&(K0(_,1,w),Vs(_,w))}function Hs(_,w,C){if(_.tag===3)I4(_,_,C);else for(;w!==null;){if(w.tag===3){I4(w,_,C);break}else if(w.tag===1){var D=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(oh===null||!oh.has(D))){_=y2(C,_),_=XU(w,_,1),sh(w,_),_=gs(),w=xb(w,1),w!==null&&(K0(w,1,_),Vs(w,_));break}}w=w.return}}function ore(_,w,C){var D=_.pingCache;D!==null&&D.delete(w),w=gs(),_.pingedLanes|=_.suspendedLanes&C,Vn===_&&(Nr&C)===C&&(er===4||er===3&&(Nr&130023424)===Nr&&500>xr()-O2?af(_,0):R2|=C),Vs(_,w)}function L4(_,w){w===0&&(_.mode&1?(w=Lw,Lw<<=1,!(Lw&130023424)&&(Lw=4194304)):w=1);var C=gs();_=xb(_,w),_!==null&&(K0(_,w,C),Vs(_,C))}function are(_){var w=_.memoizedState,C=0;w!==null&&(C=w.retryLane),L4(_,C)}function lre(_,w){var C=0;switch(_.tag){case 13:var D=_.stateNode,B=_.memoizedState;B!==null&&(C=B.retryLane);break;case 19:D=_.stateNode;break;default:throw Error(o(314))}D!==null&&D.delete(w),L4(_,C)}var B4;B4=function(_,w,C){if(_!==null)if(_.memoizedProps!==w.pendingProps||vn.current)_o=!0;else{if(!(_.lanes&C)&&!(w.flags&128))return _o=!1,Qne(_,w,C);_o=!!(_.flags&131072)}else _o=!1,tn&&w.flags&1048576&&xU(w,Hw,w.index);switch(w.lanes=0,w.tag){case 2:var D=w.type;_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),_=w.pendingProps;var B=Ko(w,Wt.current);pm(w,C),B=f2(null,w,D,_,B,C);var G=p2();return w.flags|=1,typeof B=="object"&&B!==null&&typeof B.render=="function"&&B.$$typeof===void 0?(w.tag=1,w.memoizedState=null,w.updateQueue=null,Us(D)?(G=!0,Dw(w)):G=!1,w.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,e2(w),B.updater=Gw,w.stateNode=B,B._reactInternals=w,i2(w,D,_,C),w=w2(null,w,D,!0,G,C)):(w.tag=0,tn&&G&&n2(w),ms(null,w,B,C),w=w.child),w;case 16:D=w.elementType;e:{switch(_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),_=w.pendingProps,B=D._init,D=B(D._payload),w.type=D,B=w.tag=ure(D),_=Qa(D,_),B){case 0:w=_2(null,w,D,_,C);break e;case 1:w=n4(null,w,D,_,C);break e;case 11:w=ZU(null,w,D,_,C);break e;case 14:w=$U(null,w,D,Qa(D.type,_),C);break e}throw Error(o(306,D,""))}return w;case 0:return D=w.type,B=w.pendingProps,B=w.elementType===D?B:Qa(D,B),_2(_,w,D,B,C);case 1:return D=w.type,B=w.pendingProps,B=w.elementType===D?B:Qa(D,B),n4(_,w,D,B,C);case 3:e:{if(r4(w),_===null)throw Error(o(387));D=w.pendingProps,G=w.memoizedState,B=G.element,dU(_,w),Uw(w,D,null,C);var se=w.memoizedState;if(D=se.element,le&&G.isDehydrated)if(G={element:D,isDehydrated:!1,cache:se.cache,transitions:se.transitions},w.updateQueue.baseState=G,w.memoizedState=G,w.flags&256){B=Error(o(423)),w=s4(_,w,D,C,B);break e}else if(D!==B){B=Error(o(424)),w=s4(_,w,D,C,B);break e}else for(le&&(xo=$(w.stateNode.containerInfo),yo=w,tn=!0,Ja=null,Z0=!1),C=MU(w,null,D,C),w.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(vm(),D===B){w=Xc(_,w,C);break e}ms(_,w,D,C)}w=w.child}return w;case 5:return CU(w),_===null&&o2(w),D=w.type,B=w.pendingProps,G=_!==null?_.memoizedProps:null,se=B.children,ne(D,B)?se=null:G!==null&&ne(D,G)&&(w.flags|=32),i4(_,w),ms(_,w,se,C),w.child;case 6:return _===null&&o2(w),null;case 13:return o4(_,w,C);case 4:return l2(w,w.stateNode.containerInfo),D=w.pendingProps,_===null?w.child=ym(w,null,D,C):ms(_,w,D,C),w.child;case 11:return D=w.type,B=w.pendingProps,B=w.elementType===D?B:Qa(D,B),ZU(_,w,D,B,C);case 7:return ms(_,w,w.pendingProps,C),w.child;case 8:return ms(_,w,w.pendingProps.children,C),w.child;case 12:return ms(_,w,w.pendingProps.children,C),w.child;case 10:e:{if(D=w.type._context,B=w.pendingProps,G=w.memoizedProps,se=B.value,hU(w,D,se),G!==null)if(zl(G.value,se)){if(G.children===B.children&&!vn.current){w=Xc(_,w,C);break e}}else for(G=w.child,G!==null&&(G.return=w);G!==null;){var Se=G.dependencies;if(Se!==null){se=G.child;for(var ze=Se.firstContext;ze!==null;){if(ze.context===D){if(G.tag===1){ze=Vc(-1,C&-C),ze.tag=2;var et=G.updateQueue;if(et!==null){et=et.shared;var yt=et.pending;yt===null?ze.next=ze:(ze.next=yt.next,yt.next=ze),et.pending=ze}}G.lanes|=C,ze=G.alternate,ze!==null&&(ze.lanes|=C),$T(G.return,C,w),Se.lanes|=C;break}ze=ze.next}}else if(G.tag===10)se=G.type===w.type?null:G.child;else if(G.tag===18){if(se=G.return,se===null)throw Error(o(341));se.lanes|=C,Se=se.alternate,Se!==null&&(Se.lanes|=C),$T(se,C,w),se=G.sibling}else se=G.child;if(se!==null)se.return=G;else for(se=G;se!==null;){if(se===w){se=null;break}if(G=se.sibling,G!==null){G.return=se.return,se=G;break}se=se.return}G=se}ms(_,w,B.children,C),w=w.child}return w;case 9:return B=w.type,D=w.pendingProps.children,pm(w,C),B=Zo(B),D=D(B),w.flags|=1,ms(_,w,D,C),w.child;case 14:return D=w.type,B=Qa(D,w.pendingProps),B=Qa(D.type,B),$U(_,w,D,B,C);case 15:return e4(_,w,w.type,w.pendingProps,C);case 17:return D=w.type,B=w.pendingProps,B=w.elementType===D?B:Qa(D,B),_!==null&&(_.alternate=null,w.alternate=null,w.flags|=2),w.tag=1,Us(D)?(_=!0,Dw(w)):_=!1,pm(w,C),vU(w,D,B),i2(w,D,B,C),w2(null,w,D,!0,_,C);case 19:return u4(_,w,C);case 22:return t4(_,w,C)}throw Error(o(156,w.tag))};function R4(_,w){return XT(_,w)}function cre(_,w,C,D){this.tag=_,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(_,w,C,D){return new cre(_,w,C,D)}function H2(_){return _=_.prototype,!(!_||!_.isReactComponent)}function ure(_){if(typeof _=="function")return H2(_)?1:0;if(_!=null){if(_=_.$$typeof,_===m)return 11;if(_===y)return 14}return 2}function uh(_,w){var C=_.alternate;return C===null?(C=ra(_.tag,w,_.key,_.mode),C.elementType=_.elementType,C.type=_.type,C.stateNode=_.stateNode,C.alternate=_,_.alternate=C):(C.pendingProps=w,C.type=_.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=_.flags&14680064,C.childLanes=_.childLanes,C.lanes=_.lanes,C.child=_.child,C.memoizedProps=_.memoizedProps,C.memoizedState=_.memoizedState,C.updateQueue=_.updateQueue,w=_.dependencies,C.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},C.sibling=_.sibling,C.index=_.index,C.ref=_.ref,C}function wb(_,w,C,D,B,G){var se=2;if(D=_,typeof _=="function")H2(_)&&(se=1);else if(typeof _=="string")se=5;else e:switch(_){case h:return uf(C.children,B,G,w);case u:se=8,B|=8;break;case d:return _=ra(12,C,w,B|2),_.elementType=d,_.lanes=G,_;case g:return _=ra(13,C,w,B),_.elementType=g,_.lanes=G,_;case v:return _=ra(19,C,w,B),_.elementType=v,_.lanes=G,_;case b:return bb(C,B,G,w);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case f:se=10;break e;case p:se=9;break e;case m:se=11;break e;case y:se=14;break e;case x:se=16,D=null;break e}throw Error(o(130,_==null?_:typeof _,""))}return w=ra(se,C,w,B),w.elementType=_,w.type=D,w.lanes=G,w}function uf(_,w,C,D){return _=ra(7,_,D,w),_.lanes=C,_}function bb(_,w,C,D){return _=ra(22,_,D,w),_.elementType=b,_.lanes=C,_.stateNode={},_}function j2(_,w,C){return _=ra(6,_,null,w),_.lanes=C,_}function W2(_,w,C){return w=ra(4,_.children!==null?_.children:[],_.key,w),w.lanes=C,w.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},w}function hre(_,w,C,D,B){this.tag=w,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=pe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jT(0),this.expirationTimes=jT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jT(0),this.identifierPrefix=D,this.onRecoverableError=B,le&&(this.mutableSourceEagerHydrationData=null)}function O4(_,w,C,D,B,G,se,Se,ze){return _=new hre(_,w,C,Se,ze),w===1?(w=1,G===!0&&(w|=8)):w=0,G=ra(3,null,null,w),_.current=G,G.stateNode=_,G.memoizedState={element:D,isDehydrated:C,cache:null,transitions:null},e2(G),_}function F4(_){if(!_)return Qr;_=_._reactInternals;e:{if(T(_)!==_||_.tag!==1)throw Error(o(170));var w=_;do{switch(w.tag){case 3:w=w.stateNode.context;break e;case 1:if(Us(w.type)){w=w.stateNode.__reactInternalMemoizedMergedChildContext;break e}}w=w.return}while(w!==null);throw Error(o(171))}if(_.tag===1){var C=_.type;if(Us(C))return oU(_,C,w)}return w}function N4(_){var w=_._reactInternals;if(w===void 0)throw typeof _.render=="function"?Error(o(188)):(_=Object.keys(_).join(","),Error(o(268,_)));return _=k(w),_===null?null:_.stateNode}function k4(_,w){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var C=_.retryLane;_.retryLane=C!==0&&C<w?C:w}}function X2(_,w){k4(_,w),(_=_.alternate)&&k4(_,w)}function dre(_){return _=k(_),_===null?null:_.stateNode}function fre(){return null}return i.attemptContinuousHydration=function(_){if(_.tag===13){var w=gs();na(_,134217728,w),X2(_,134217728)}},i.attemptHydrationAtCurrentPriority=function(_){if(_.tag===13){var w=gs(),C=lh(_);na(_,C,w),X2(_,C)}},i.attemptSynchronousHydration=function(_){switch(_.tag){case 3:var w=_.stateNode;if(w.current.memoizedState.isDehydrated){var C=J0(w.pendingLanes);C!==0&&(WT(w,C|1),Vs(w,xr()),!(oi&6)&&(Am(),Ul()))}break;case 13:var D=gs();C4(function(){return na(_,1,D)}),X2(_,1)}},i.batchedUpdates=function(_,w){var C=oi;oi|=1;try{return _(w)}finally{oi=C,oi===0&&(Am(),Ow&&Ul())}},i.createComponentSelector=function(_){return{$$typeof:ab,value:_}},i.createContainer=function(_,w,C,D,B,G,se){return O4(_,w,!1,null,C,D,B,G,se)},i.createHasPseudoClassSelector=function(_){return{$$typeof:lb,value:_}},i.createHydrationContainer=function(_,w,C,D,B,G,se,Se,ze){return _=O4(C,D,!0,_,B,G,se,Se,ze),_.context=F4(null),C=_.current,D=gs(),B=lh(C),G=Vc(D,B),G.callback=w??null,sh(C,G),_.current.lanes=B,K0(_,B,D),Vs(_,D),_},i.createPortal=function(_,w,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:D==null?null:""+D,children:_,containerInfo:w,implementation:C}},i.createRoleSelector=function(_){return{$$typeof:cb,value:_}},i.createTestNameSelector=function(_){return{$$typeof:ub,value:_}},i.createTextSelector=function(_){return{$$typeof:hb,value:_}},i.deferredUpdates=function(_){var w=xi,C=Dn.transition;try{return Dn.transition=null,xi=16,_()}finally{xi=w,Dn.transition=C}},i.discreteUpdates=function(_,w,C,D,B){var G=xi,se=Dn.transition;try{return Dn.transition=null,xi=1,_(w,C,D,B)}finally{xi=G,Dn.transition=se,oi===0&&Am()}},i.findAllNodes=L2,i.findBoundingRects=function(_,w){if(!Je)throw Error(o(363));w=L2(_,w),_=[];for(var C=0;C<w.length;C++)_.push(U(w[C]));for(w=_.length-1;0<w;w--){C=_[w];for(var D=C.x,B=D+C.width,G=C.y,se=G+C.height,Se=w-1;0<=Se;Se--)if(w!==Se){var ze=_[Se],et=ze.x,yt=et+ze.width,Yt=ze.y,Dt=Yt+ze.height;if(D>=et&&G>=Yt&&B<=yt&&se<=Dt){_.splice(w,1);break}else if(D!==et||C.width!==ze.width||Dt<G||Yt>se){if(!(G!==Yt||C.height!==ze.height||yt<D||et>B)){et>D&&(ze.width+=et-D,ze.x=D),yt<B&&(ze.width=B-et),_.splice(w,1);break}}else{Yt>G&&(ze.height+=Yt-G,ze.y=G),Dt<se&&(ze.height=se-Yt),_.splice(w,1);break}}}return _},i.findHostInstance=N4,i.findHostInstanceWithNoPortals=function(_){return _=I(_),_=_!==null?F(_):null,_===null?null:_.stateNode},i.findHostInstanceWithWarning=function(_){return N4(_)},i.flushControlled=function(_){var w=oi;oi|=1;var C=Dn.transition,D=xi;try{Dn.transition=null,xi=1,_()}finally{xi=D,Dn.transition=C,oi=w,oi===0&&(Am(),Ul())}},i.flushPassiveEffects=cf,i.flushSync=C4,i.focusWithin=function(_,w){if(!Je)throw Error(o(363));for(_=P2(_),w=S4(_,w),w=Array.from(w),_=0;_<w.length;){var C=w[_++];if(!te(C)){if(C.tag===5&&we(C.stateNode))return!0;for(C=C.child;C!==null;)w.push(C),C=C.sibling}}return!1},i.getCurrentUpdatePriority=function(){return xi},i.getFindAllNodesFailureDescription=function(_,w){if(!Je)throw Error(o(363));var C=0,D=[];_=[P2(_),0];for(var B=0;B<_.length;){var G=_[B++],se=_[B++],Se=w[se];if((G.tag!==5||!te(G))&&(D2(G,Se)&&(D.push(I2(Se)),se++,se>C&&(C=se)),se<w.length))for(G=G.child;G!==null;)_.push(G,se),G=G.sibling}if(C<w.length){for(_=[];C<w.length;C++)_.push(I2(w[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+_.join(" > ")}return null},i.getPublicRootInstance=function(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return Q(_.child.stateNode);default:return _.child.stateNode}},i.injectIntoDevTools=function(_){if(_={bundleType:_.bundleType,version:_.version,rendererPackageName:_.rendererPackageName,rendererConfig:_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:dre,findFiberByHostInstance:_.findFiberByHostInstance||fre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")_=!1;else{var w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(w.isDisabled||!w.supportsFiber)_=!0;else{try{Rw=w.inject(_),kl=w}catch{}_=!!w.checkDCE}}return _},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(_,w,C,D){if(!Je)throw Error(o(363));_=L2(_,w);var B=Me(_,C,D).disconnect;return{disconnect:function(){B()}}},i.registerMutableSourceForHydration=function(_,w){var C=w._getVersion;C=C(w._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[w,C]:_.mutableSourceEagerHydrationData.push(w,C)},i.runWithPriority=function(_,w){var C=xi;try{return xi=_,w()}finally{xi=C}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(_,w,C,D){var B=w.current,G=gs(),se=lh(B);return C=F4(C),w.context===null?w.context=C:w.pendingContext=C,w=Vc(G,se),w.payload={element:_},D=D===void 0?null:D,D!==null&&(w.callback=D),sh(B,w),_=na(B,se,G),_!==null&&zw(_,B,se),se},i};tJ.exports=pme;var mme=tJ.exports;const gme=UO(mme),vme=t=>typeof t=="object"&&typeof t.then=="function",op=[];function rJ(t,e,i=(n,r)=>n===r){if(t===e)return!0;if(!t||!e)return!1;const n=t.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!i(t[r],e[r]))return!1;return!0}function sJ(t,e=null,i=!1,n={}){e===null&&(e=[t]);for(const s of op)if(rJ(e,s.keys,s.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!i)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=op.indexOf(r);s!==-1&&op.splice(s,1)},promise:(vme(t)?t:t(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(op.push(r),!i)throw r.promise}const yme=(t,e,i)=>sJ(t,e,!1,i),xme=(t,e,i)=>void sJ(t,e,!0,i),_me=t=>{if(t===void 0||t.length===0)op.splice(0,op.length);else{const e=op.find(i=>rJ(t,i.keys,i.equal));e&&e.remove()}},TN={},wme=t=>void Object.assign(TN,t);function bme(t,e){function i(h,{args:u=[],attach:d,...f},p){let m=`${h[0].toUpperCase()}${h.slice(1)}`,g;if(h==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=f.object;g=Ag(v,{type:h,root:p,attach:d,primitive:!0})}else{const v=TN[m];if(!v)throw new Error(`R3F: ${m} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");g=Ag(new v(...u),{type:h,root:p,attach:d,memoizedProps:{args:u}})}return g.__r3f.attach===void 0&&(g instanceof $t?g.__r3f.attach="geometry":g instanceof Zn&&(g.__r3f.attach="material")),m!=="inject"&&iD(g,f),g}function n(h,u){let d=!1;if(u){var f,p;(f=u.__r3f)!=null&&f.attach?tD(h,u,u.__r3f.attach):u.isObject3D&&h.isObject3D&&(h.add(u),d=!0),d||(p=h.__r3f)==null||p.objects.push(u),u.__r3f||Ag(u,{}),u.__r3f.parent=h,dB(u),Mg(u)}}function r(h,u,d){let f=!1;if(u){var p,m;if((p=u.__r3f)!=null&&p.attach)tD(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){u.parent=h,u.dispatchEvent({type:"added"});const g=h.children.filter(y=>y!==u),v=g.indexOf(d);h.children=[...g.slice(0,v),u,...g.slice(v)],f=!0}f||(m=h.__r3f)==null||m.objects.push(u),u.__r3f||Ag(u,{}),u.__r3f.parent=h,dB(u),Mg(u)}}function s(h,u,d=!1){h&&[...h].forEach(f=>o(u,f,d))}function o(h,u,d){if(u){var f,p,m;if(u.__r3f&&(u.__r3f.parent=null),(f=h.__r3f)!=null&&f.objects&&(h.__r3f.objects=h.__r3f.objects.filter(b=>b!==u)),(p=u.__r3f)!=null&&p.attach)CV(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){var g;h.remove(u),(g=u.__r3f)!=null&&g.root&&Dme(u.__r3f.root,u)}const y=(m=u.__r3f)==null?void 0:m.primitive,x=d===void 0?u.dispose!==null&&!y:d;if(!y){var v;s((v=u.__r3f)==null?void 0:v.objects,u,x),s(u.children,u,x)}delete u.__r3f,x&&u.dispose&&u.type!=="Scene"&&uB.unstable_scheduleCallback(uB.unstable_IdlePriority,()=>{try{u.dispose()}catch{}}),Mg(h)}}function a(h,u,d,f){var p;const m=(p=h.__r3f)==null?void 0:p.parent;if(!m)return;const g=i(u,d,h.__r3f.root);if(h.children){for(const v of h.children)v.__r3f&&n(g,v);h.children=h.children.filter(v=>!v.__r3f)}h.__r3f.objects.forEach(v=>n(g,v)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(m,h),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),n(m,g),g.raycast&&g.__r3f.eventCount&&g.__r3f.root.getState().internal.interaction.push(g),[f,f.alternate].forEach(v=>{v!==null&&(v.stateNode=g,v.ref&&(typeof v.ref=="function"?v.ref(g):v.ref.current=g))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:gme({createInstance:i,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,u)=>{if(!u)return;const d=h.getState().scene;d.__r3f&&(d.__r3f.root=h,n(d,u))},removeChildFromContainer:(h,u)=>{u&&o(h.getState().scene,u)},insertInContainerBefore:(h,u,d)=>{if(!u||!d)return;const f=h.getState().scene;f.__r3f&&r(f,u,d)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var u;return!!((u=h==null?void 0:h.__r3f)!=null?u:{}).handlers},prepareUpdate(h,u,d,f){var p;if(((p=h==null?void 0:h.__r3f)!=null?p:{}).primitive&&f.object&&f.object!==h)return[!0];{const{args:g=[],children:v,...y}=f,{args:x=[],children:b,...S}=d;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((E,M)=>E!==x[M]))return[!0];const A=dJ(h,y,S,!0);return A.changes.length?[!1,A]:null}},commitUpdate(h,[u,d],f,p,m,g){u?a(h,f,m,g):iD(h,d)},commitMount(h,u,d,f){var p;const m=(p=h.__r3f)!=null?p:{};h.raycast&&m.handlers&&m.eventCount&&h.__r3f.root.getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>Ag(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var u;const{attach:d,parent:f}=(u=h.__r3f)!=null?u:{};d&&f&&CV(f,h,d),h.isObject3D&&(h.visible=!1),Mg(h)},unhideInstance(h,u){var d;const{attach:f,parent:p}=(d=h.__r3f)!=null?d:{};f&&p&&tD(p,h,f),(h.isObject3D&&u.visible==null||u.visible)&&(h.visible=!0),Mg(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():qg.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&$i.fun(performance.now)?performance.now:$i.fun(Date.now)?Date.now:()=>0,scheduleTimeout:$i.fun(setTimeout)?setTimeout:void 0,cancelTimeout:$i.fun(clearTimeout)?clearTimeout:void 0}),applyProps:iD}}var bV,SV;const eD=t=>"colorSpace"in t||"outputColorSpace"in t,oJ=()=>{var t;return(t=TN.ColorManagement)!=null?t:null},aJ=t=>t&&t.isOrthographicCamera,Sme=t=>t&&t.hasOwnProperty("current"),sw=typeof window<"u"&&((bV=window.document)!=null&&bV.createElement||((SV=window.navigator)==null?void 0:SV.product)==="ReactNative")?me.useLayoutEffect:me.useEffect;function lJ(t){const e=me.useRef(t);return sw(()=>void(e.current=t),[t]),e}function Ame({set:t}){return sw(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class cJ extends me.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}cJ.getDerivedStateFromError=()=>({error:!0});const uJ="__default",AV=new Map,Mme=t=>t&&!!t.memoized&&!!t.changes;function hJ(t){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],i),t[1]):t}const Oy=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},$i={obj:t=>t===Object(t)&&!$i.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:i="shallow",objects:n="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if($i.str(t)||$i.num(t))return t===e;const s=$i.obj(t);if(s&&n==="reference")return t===e;const o=$i.arr(t);if(o&&i==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&i==="shallow"&&n==="shallow"){for(a in r?e:t)if(!$i.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if($i.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function Cme(t){const e={nodes:{},materials:{}};return t&&t.traverse(i=>{i.name&&(e.nodes[i.name]=i),i.material&&!e.materials[i.material.name]&&(e.materials[i.material.name]=i.material)}),e}function Eme(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function Ag(t,e){const i=t;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function hB(t,e){let i=t;if(e.includes("-")){const n=e.split("-"),r=n.pop();return i=n.reduce((s,o)=>s[o],t),{target:i,key:r}}else return{target:i,key:e}}const MV=/-\d+$/;function tD(t,e,i){if($i.str(i)){if(MV.test(i)){const s=i.replace(MV,""),{target:o,key:a}=hB(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:r}=hB(t,i);e.__r3f.previousAttach=n[r],n[r]=e}else e.__r3f.previousAttach=i(t,e)}function CV(t,e,i){var n,r;if($i.str(i)){const{target:s,key:o}=hB(t,i),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function dJ(t,{children:e,key:i,ref:n,...r},{children:s,key:o,ref:a,...l}={},c=!1){var h;const u=(h=t==null?void 0:t.__r3f)!=null?h:{},d=Object.entries(r),f=[];if(c){const m=Object.keys(l);for(let g=0;g<m.length;g++)r.hasOwnProperty(m[g])||d.unshift([m[g],uJ+"remove"])}d.forEach(([m,g])=>{var v;if((v=t.__r3f)!=null&&v.primitive&&m==="object"||$i.equ(g,l[m]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(m))return f.push([m,g,!0,[]]);let y=[];m.includes("-")&&(y=m.split("-")),f.push([m,g,!1,y]);for(const x in r){const b=r[x];x.startsWith(`${m}-`)&&f.push([x,b,!1,x.split("-")])}});const p={...r};return u.memoizedProps&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u.memoizedProps&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}function iD(t,e){var i,n,r;const s=(i=t.__r3f)!=null?i:{},o=s.root,a=(n=o==null||o.getState==null?void 0:o.getState())!=null?n:{},{memoized:l,changes:c}=Mme(e)?e:dJ(t,e),h=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[f,p,m,g]=c[d];if(eD(t)){const b="srgb",S="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?b:S):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?b:S)}let v=t,y=v[f];if(g.length&&(y=g.reduce((x,b)=>x[b],t),!(y&&y.set))){const[x,...b]=g.reverse();v=b.reverse().reduce((S,A)=>S[A],t),f=x}if(p===uJ+"remove")if(v.constructor){let x=AV.get(v.constructor);x||(x=new v.constructor,AV.set(v.constructor,x)),p=x[f]}else p=0;if(m)p?s.handlers[f]=p:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(y&&y.set&&(y.copy||y instanceof wp)){if(Array.isArray(p))y.fromArray?y.fromArray(p):y.set(...p);else if(y.copy&&p&&p.constructor&&y.constructor===p.constructor)y.copy(p);else if(p!==void 0){const x=y instanceof ct;!x&&y.setScalar?y.setScalar(p):y instanceof wp&&p instanceof wp?y.mask=p.mask:y.set(p),!oJ()&&!a.linear&&x&&y.convertSRGBToLinear()}}else if(v[f]=p,v[f]instanceof on&&v[f].format===Ys&&v[f].type===Xu){const x=v[f];eD(x)&&eD(a.gl)?x.colorSpace=a.gl.outputColorSpace:x.encoding=a.gl.outputEncoding}Mg(t)}if(s.parent&&a.internal&&t.raycast&&h!==s.eventCount){const d=a.internal.interaction.indexOf(t);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(t)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(r=t.__r3f)!=null&&r.parent&&dB(t),t}function Mg(t){var e,i;const n=(e=t.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();n&&n.internal.frames===0&&n.invalidate()}function dB(t){t.onUpdate==null||t.onUpdate(t)}function Tme(t,e){t.manual||(aJ(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function MS(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function Pme(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return qg.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return qg.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return qg.ContinuousEventPriority;default:return qg.DefaultEventPriority}}function fJ(t,e,i,n){const r=i.get(e);r&&(i.delete(e),i.size===0&&(t.delete(n),r.target.releasePointerCapture(n)))}function Dme(t,e){const{internal:i}=t.getState();i.interaction=i.interaction.filter(n=>n!==e),i.initialHits=i.initialHits.filter(n=>n!==e),i.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&i.hovered.delete(r)}),i.capturedMap.forEach((n,r)=>{fJ(i.capturedMap,e,n,r)})}function Ime(t){function e(l){const{internal:c}=t.getState(),h=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+u*u))}function i(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+h]}))}function n(l,c){const h=t.getState(),u=new Set,d=[],f=c?c(h.internal.interaction):h.internal.interaction;for(let v=0;v<f.length;v++){const y=Oy(f[v]);y&&(y.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function p(v){const y=Oy(v);if(!y||!y.events.enabled||y.raycaster.camera===null)return[];if(y.raycaster.camera===void 0){var x;y.events.compute==null||y.events.compute(l,y,(x=y.previousRoot)==null?void 0:x.getState()),y.raycaster.camera===void 0&&(y.raycaster.camera=null)}return y.raycaster.camera?y.raycaster.intersectObject(v,!0):[]}let m=f.flatMap(p).sort((v,y)=>{const x=Oy(v.object),b=Oy(y.object);return!x||!b?v.distance-y.distance:b.events.priority-x.events.priority||v.distance-y.distance}).filter(v=>{const y=MS(v);return u.has(y)?!1:(u.add(y),!0)});h.events.filter&&(m=h.events.filter(m,h));for(const v of m){let y=v.object;for(;y;){var g;(g=y.__r3f)!=null&&g.eventCount&&d.push({...v,eventObject:y}),y=y.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let v of h.internal.capturedMap.get(l.pointerId).values())u.has(MS(v.intersection))||d.push(v.intersection);return d}function r(l,c,h,u){const d=t.getState();if(l.length){const f={stopped:!1};for(const p of l){const m=Oy(p.object)||d,{raycaster:g,pointer:v,camera:y,internal:x}=m,b=new ie(v.x,v.y,0).unproject(y),S=P=>{var I,k;return(I=(k=x.capturedMap.get(P))==null?void 0:k.has(p.eventObject))!=null?I:!1},A=P=>{const I={intersection:p,target:c.target};x.capturedMap.has(P)?x.capturedMap.get(P).set(p.eventObject,I):x.capturedMap.set(P,new Map([[p.eventObject,I]])),c.target.setPointerCapture(P)},E=P=>{const I=x.capturedMap.get(P);I&&fJ(x.capturedMap,p.eventObject,I,P)};let M={};for(let P in c){let I=c[P];typeof I!="function"&&(M[P]=I)}let T={...p,...M,pointer:v,intersections:l,stopped:f.stopped,delta:h,unprojectedPoint:b,ray:g.ray,camera:y,stopPropagation(){const P="pointerId"in c&&x.capturedMap.get(c.pointerId);if((!P||P.has(p.eventObject))&&(T.stopped=f.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(I=>I.eventObject===p.eventObject))){const I=l.slice(0,l.indexOf(p));s([...I,p])}},target:{hasPointerCapture:S,setPointerCapture:A,releasePointerCapture:E},currentTarget:{hasPointerCapture:S,setPointerCapture:A,releasePointerCapture:E},nativeEvent:c};if(u(T),f.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const h of c.hovered.values())if(!l.length||!l.find(u=>u.object===h.object&&u.index===h.index&&u.instanceId===h.instanceId)){const d=h.eventObject.__r3f,f=d==null?void 0:d.handlers;if(c.hovered.delete(MS(h)),d!=null&&d.eventCount){const p={...h,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let h=0;h<c.length;h++){const u=c[h].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:h}=t.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),s([]))})}}return function(h){const{onPointerMissed:u,internal:d}=t.getState();d.lastEvent.current=h;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",g=n(h,f?i:void 0),v=p?e(h):0;l==="onPointerDown"&&(d.initialClick=[h.offsetX,h.offsetY],d.initialHits=g.map(x=>x.eventObject)),p&&!g.length&&v<=2&&(o(h,d.interaction),u&&u(h)),f&&s(g);function y(x){const b=x.eventObject,S=b.__r3f,A=S==null?void 0:S.handlers;if(S!=null&&S.eventCount)if(f){if(A.onPointerOver||A.onPointerEnter||A.onPointerOut||A.onPointerLeave){const E=MS(x),M=d.hovered.get(E);M?M.stopped&&x.stopPropagation():(d.hovered.set(E,x),A.onPointerOver==null||A.onPointerOver(x),A.onPointerEnter==null||A.onPointerEnter(x))}A.onPointerMove==null||A.onPointerMove(x)}else{const E=A[l];E?(!p||d.initialHits.includes(b))&&(o(h,d.interaction.filter(M=>!d.initialHits.includes(M))),E(x)):p&&d.initialHits.includes(b)&&o(h,d.interaction.filter(M=>!d.initialHits.includes(M)))}}r(g,h,v,y)}}return{handlePointer:a}}const pJ=t=>!!(t!=null&&t.render),mJ=me.createContext(null),Lme=(t,e)=>{const i=eJ((a,l)=>{const c=new ie,h=new ie,u=new ie;function d(v=l().camera,y=h,x=l().size){const{width:b,height:S,top:A,left:E}=x,M=b/S;y instanceof ie?u.copy(y):u.set(...y);const T=v.getWorldPosition(c).distanceTo(u);if(aJ(v))return{width:b/v.zoom,height:S/v.zoom,top:A,left:E,factor:1,distance:T,aspect:M};{const P=v.fov*Math.PI/180,I=2*Math.tan(P/2)*T,k=I*(b/S);return{width:k,height:I,top:A,left:E,factor:b/k,distance:T,aspect:M}}}let f;const p=v=>a(y=>({performance:{...y.performance,current:v}})),m=new Ve;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>t(l(),v),advance:(v,y)=>e(v,y,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new AN,pointer:m,mouse:m,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();f&&clearTimeout(f),v.performance.current!==v.performance.min&&p(v.performance.min),f=setTimeout(()=>p(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>a(y=>({...y,events:{...y.events,...v}})),setSize:(v,y,x,b,S)=>{const A=l().camera,E={width:v,height:y,top:b||0,left:S||0,updateStyle:x};a(M=>({size:E,viewport:{...M.viewport,...d(A,h,E)}}))},setDpr:v=>a(y=>{const x=hJ(v);return{viewport:{...y.viewport,dpr:x,initialDpr:y.viewport.initialDpr||x}}}),setFrameloop:(v="always")=>{const y=l().clock;y.stop(),y.elapsedTime=0,v!=="never"&&(y.start(),y.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:me.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,y,x)=>{const b=l().internal;return b.priority=b.priority+(y>0?1:0),b.subscribers.push({ref:v,priority:y,store:x}),b.subscribers=b.subscribers.sort((S,A)=>S.priority-A.priority),()=>{const S=l().internal;S!=null&&S.subscribers&&(S.priority=S.priority-(y>0?1:0),S.subscribers=S.subscribers.filter(A=>A.ref!==v))}}}}}),n=i.getState();let r=n.size,s=n.viewport.dpr,o=n.camera;return i.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:u}=i.getState();if(l!==r||c.dpr!==s){var d;r=l,s=c.dpr,Tme(a,l),h.setPixelRatio(c.dpr);const f=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,f)}a!==o&&(o=a,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),i.subscribe(a=>t(a)),i};let CS,Bme=new Set,Rme=new Set,Ome=new Set;function nD(t,e){if(t.size)for(const{callback:i}of t.values())i(e)}function Fy(t,e){switch(t){case"before":return nD(Bme,e);case"after":return nD(Rme,e);case"tail":return nD(Ome,e)}}let rD,sD;function oD(t,e,i){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(n=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),rD=e.internal.subscribers,CS=0;CS<rD.length;CS++)sD=rD[CS],sD.ref.current(sD.store.getState(),n,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Fme(t){let e=!1,i,n,r;function s(l){n=requestAnimationFrame(s),e=!0,i=0,Fy("before",l);for(const h of t.values()){var c;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((c=r.gl.xr)!=null&&c.isPresenting)&&(i+=oD(l,r))}if(Fy("after",l),i===0)return Fy("tail",l),e=!1,cancelAnimationFrame(n)}function o(l,c=1){var h;if(!l)return t.forEach(u=>o(u.store.getState()),c);(h=l.gl.xr)!=null&&h.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,h,u){if(c&&Fy("before",l),h)oD(l,h,u);else for(const d of t.values())oD(l,d.store.getState());c&&Fy("after",l)}return{loop:s,invalidate:o,advance:a}}function gJ(){const t=me.useContext(mJ);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function _a(t=i=>i,e){return gJ()(t,e)}function ow(t,e=0){const i=gJ(),n=i.getState().internal.subscribe,r=lJ(t);return sw(()=>n(r,e,i),[e,n,i]),null}function vJ(t,e){return function(i,...n){const r=new i;return t&&t(r),Promise.all(n.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,Cme(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function aw(t,e,i,n){const r=Array.isArray(e)?e:[e],s=yme(vJ(i,n),[t,...r],{equal:$i.equ});return Array.isArray(e)?s:s[0]}aw.preload=function(t,e,i){const n=Array.isArray(e)?e:[e];return xme(vJ(i),[t,...n])};aw.clear=function(t,e){const i=Array.isArray(e)?e:[e];return _me([t,...i])};const Kv=new Map,{invalidate:EV,advance:TV}=Fme(Kv),{reconciler:cC,applyProps:jm}=bme(Kv,Pme),Wm={objects:"shallow",strict:!1},Nme=(t,e)=>{const i=typeof t=="function"?t(e):t;return pJ(i)?i:new QE({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function kme(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:i,height:n,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:i,height:n,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function zme(t){const e=Kv.get(t),i=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||Lme(EV,TV),o=i||cC.createContainer(s,qg.ConcurrentRoot,null,!1,null,"",r,null);e||Kv.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(h={}){let{gl:u,size:d,scene:f,events:p,onCreated:m,shadows:g=!1,linear:v=!1,flat:y=!1,legacy:x=!1,orthographic:b=!1,frameloop:S="always",dpr:A=[1,2],performance:E,raycaster:M,camera:T,onPointerMissed:P}=h,I=s.getState(),k=I.gl;I.gl||I.set({gl:k=Nme(u,t)});let R=I.raycaster;R||I.set({raycaster:R=new KQ});const{params:F,...V}=M||{};if($i.equ(V,R,Wm)||jm(R,{...V}),$i.equ(F,R.params,Wm)||jm(R,{params:{...R.params,...F}}),!I.camera||I.camera===c&&!$i.equ(c,T,Wm)){c=T;const J=T instanceof G_,H=J?T:b?new Ra(0,0,0,0,.1,1e3):new sn(75,0,.1,1e3);J||(H.position.z=5,T&&jm(H,T),!I.camera&&!(T!=null&&T.rotation)&&H.lookAt(0,0,0)),I.set({camera:H})}if(!I.scene){let J;f instanceof Q1?J=f:(J=new Q1,f&&jm(J,f)),I.set({scene:Ag(J)})}if(!I.xr){const J=(K,ne)=>{const W=s.getState();W.frameloop!=="never"&&TV(K,!0,W,ne)},H=()=>{const K=s.getState();K.gl.xr.enabled=K.gl.xr.isPresenting,K.gl.xr.setAnimationLoop(K.gl.xr.isPresenting?J:null),K.gl.xr.isPresenting||EV(K)},Z={connect(){const K=s.getState().gl;K.xr.addEventListener("sessionstart",H),K.xr.addEventListener("sessionend",H)},disconnect(){const K=s.getState().gl;K.xr.removeEventListener("sessionstart",H),K.xr.removeEventListener("sessionend",H)}};k.xr&&Z.connect(),I.set({xr:Z})}if(k.shadowMap){const J=k.shadowMap.enabled,H=k.shadowMap.type;if(k.shadowMap.enabled=!!g,$i.boo(g))k.shadowMap.type=Qx;else if($i.str(g)){var Q;const Z={basic:aY,percentage:VE,soft:Qx,variance:tp};k.shadowMap.type=(Q=Z[g])!=null?Q:Qx}else $i.obj(g)&&Object.assign(k.shadowMap,g);(J!==k.shadowMap.enabled||H!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const X=oJ();X&&("enabled"in X?X.enabled=!x:"legacyMode"in X&&(X.legacyMode=x)),jm(k,{outputEncoding:v?3e3:3001,toneMapping:y?Al:GF}),I.legacy!==x&&I.set(()=>({legacy:x})),I.linear!==v&&I.set(()=>({linear:v})),I.flat!==y&&I.set(()=>({flat:y})),u&&!$i.fun(u)&&!pJ(u)&&!$i.equ(u,k,Wm)&&jm(k,u),p&&!I.events.handlers&&I.set({events:p(s)});const j=kme(t,d);return $i.equ(j,I.size,Wm)||I.setSize(j.width,j.height,j.updateStyle,j.top,j.left),A&&I.viewport.dpr!==hJ(A)&&I.setDpr(A),I.frameloop!==S&&I.setFrameloop(S),I.onPointerMissed||I.set({onPointerMissed:P}),E&&!$i.equ(E,I.performance,Wm)&&I.set(J=>({performance:{...J.performance,...E}})),a=m,l=!0,this},render(h){return l||this.configure(),cC.updateContainer(me.createElement(Ume,{store:s,children:h,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){yJ(t)}}}function Ume({store:t,children:e,onCreated:i,rootElement:n}){return sw(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),i&&i(r),t.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),me.createElement(mJ.Provider,{value:t},e)}function yJ(t,e){const i=Kv.get(t),n=i==null?void 0:i.fiber;if(n){const r=i==null?void 0:i.store.getState();r&&(r.internal.active=!1),cC.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),Eme(r),Kv.delete(t),e&&e(t)}catch{}},500)})}}cC.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:me.version});function Dl(){return Dl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Dl.apply(this,arguments)}function fB(t,e,i){var n,r,s,o,a;e==null&&(e=100);function l(){var h=Date.now()-o;h<e&&h>=0?n=setTimeout(l,e-h):(n=null,i||(a=t.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var h=i&&!n;return n||(n=setTimeout(l,e)),h&&(a=t.apply(s,r),s=r=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=t.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}fB.debounce=fB;var Gme=fB;const PV=UO(Gme);function Vme(t){let{debounce:e,scroll:i,polyfill:n,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=me.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=me.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,u=me.useRef(!1);me.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,f,p]=me.useMemo(()=>{const y=()=>{if(!l.current.element)return;const{left:x,top:b,width:S,height:A,bottom:E,right:M,x:T,y:P}=l.current.element.getBoundingClientRect(),I={left:x,top:b,width:S,height:A,bottom:E,right:M,x:T,y:P};l.current.element instanceof HTMLElement&&r&&(I.height=l.current.element.offsetHeight,I.width=l.current.element.offsetWidth),Object.freeze(I),u.current&&!Xme(l.current.lastBounds,I)&&a(l.current.lastBounds=I)};return[y,h?PV(y,h):y,c?PV(y,c):y]},[a,r,c,h]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function g(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),i&&l.current.scrollContainers&&l.current.scrollContainers.forEach(y=>y.addEventListener("scroll",p,{capture:!0,passive:!0})))}const v=y=>{!y||y===l.current.element||(m(),l.current.element=y,l.current.scrollContainers=xJ(y),g())};return jme(p,!!i),Hme(f),me.useEffect(()=>{m(),g()},[i,p,f]),me.useEffect(()=>m,[]),[v,o,d]}function Hme(t){me.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function jme(t,e){me.useEffect(()=>{if(e){const i=t;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[t,e])}function xJ(t){const e=[];if(!t||t===document.body)return e;const{overflow:i,overflowX:n,overflowY:r}=window.getComputedStyle(t);return[i,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...xJ(t.parentElement)]}const Wme=["x","y","top","bottom","left","right","width","height"],Xme=(t,e)=>Wme.every(i=>t[i]===e[i]);var qme=Object.defineProperty,Yme=Object.defineProperties,Qme=Object.getOwnPropertyDescriptors,DV=Object.getOwnPropertySymbols,Jme=Object.prototype.hasOwnProperty,Kme=Object.prototype.propertyIsEnumerable,IV=(t,e,i)=>e in t?qme(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,LV=(t,e)=>{for(var i in e||(e={}))Jme.call(e,i)&&IV(t,i,e[i]);if(DV)for(var i of DV(e))Kme.call(e,i)&&IV(t,i,e[i]);return t},Zme=(t,e)=>Yme(t,Qme(e));function _J(t,e,i){if(!t)return;if(i(t)===!0)return t;let n=e?t.return:t.child;for(;n;){const r=_J(n,e,i);if(r)return r;n=e?null:n.sibling}}function wJ(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const PN=wJ(me.createContext(null));class bJ extends me.Component{render(){return me.createElement(PN.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:BV,ReactCurrentDispatcher:RV}=me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function $me(){const t=me.useContext(PN);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=me.useId();return me.useMemo(()=>{for(const n of[BV==null?void 0:BV.current,t,t==null?void 0:t.alternate]){if(!n)continue;const r=_J(n,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function ege(){var t,e;const i=$me(),[n]=me.useState(()=>new Map);n.clear();let r=i;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==PN&&!n.has(s)&&n.set(s,(e=RV==null?void 0:RV.current)==null?void 0:e.readContext(wJ(s))),r=r.return}return n}function tge(){const t=ege();return me.useMemo(()=>Array.from(t.keys()).reduce((e,i)=>n=>me.createElement(e,null,me.createElement(i.Provider,Zme(LV({},n),{value:t.get(i)}))),e=>me.createElement(bJ,LV({},e))),[t])}const aD={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function ige(t){const{handlePointer:e}=Ime(t);return{priority:1,enabled:!0,compute(i,n,r){n.pointer.set(i.offsetX/n.size.width*2-1,-(i.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(aD).reduce((i,n)=>({...i,[n]:e(n)}),{}),update:()=>{var i;const{events:n,internal:r}=t.getState();(i=r.lastEvent)!=null&&i.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:i=>{var n;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:i}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([o,a])=>{const[l,c]=aD[o];i.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:i,events:n}=t.getState();if(n.connected){var r;Object.entries((r=n.handlers)!=null?r:[]).forEach(([s,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=aD[s];n.connected.removeEventListener(a,o)}}),i(s=>({events:{...s.events,connected:void 0}}))}}}}const nge=me.forwardRef(function({children:e,fallback:i,resize:n,style:r,gl:s,events:o=ige,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:m,performance:g,raycaster:v,camera:y,onPointerMissed:x,onCreated:b,...S},A){me.useMemo(()=>wme(hme),[]);const E=tge(),[M,T]=Vme({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=me.useRef(null),I=me.useRef(null);me.useImperativeHandle(A,()=>P.current);const k=lJ(x),[R,F]=me.useState(!1),[V,Q]=me.useState(!1);if(R)throw R;if(V)throw V;const X=me.useRef(null);sw(()=>{const Y=P.current;T.width>0&&T.height>0&&Y&&(X.current||(X.current=zme(Y)),X.current.configure({gl:s,events:o,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:m,performance:g,raycaster:v,camera:y,size:T,onPointerMissed:(...j)=>k.current==null?void 0:k.current(...j),onCreated:j=>{j.events.connect==null||j.events.connect(a?Sme(a)?a.current:a:I.current),l&&j.setEvents({compute:(J,H)=>{const Z=J[l+"X"],K=J[l+"Y"];H.pointer.set(Z/H.size.width*2-1,-(K/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),b==null||b(j)}}),X.current.render(me.createElement(E,null,me.createElement(cJ,{set:Q},me.createElement(me.Suspense,{fallback:me.createElement(Ame,{set:F})},e)))))}),me.useEffect(()=>{const Y=P.current;if(Y)return()=>yJ(Y)},[]);const z=a?"none":"auto";return me.createElement("div",Dl({ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:z,...r}},S),me.createElement("div",{ref:M,style:{width:"100%",height:"100%"}},me.createElement("canvas",{ref:P,style:{display:"block"}},i)))}),SJ=me.forwardRef(function(e,i){return me.createElement(bJ,null,me.createElement(nge,Dl({},e,{ref:i})))}),lw=new ie,DN=new ie,rge=new ie;function sge(t,e,i){const n=lw.setFromMatrixPosition(t.matrixWorld);n.project(e);const r=i.width/2,s=i.height/2;return[n.x*r+r,-(n.y*s)+s]}function oge(t,e){const i=lw.setFromMatrixPosition(t.matrixWorld),n=DN.setFromMatrixPosition(e.matrixWorld),r=i.sub(n),s=e.getWorldDirection(rge);return r.angleTo(s)>Math.PI/2}function age(t,e,i,n){const r=lw.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),i.setFromCamera(s,e);const o=i.intersectObjects(n,!0);if(o.length){const a=o[0].distance;return r.distanceTo(i.ray.origin)<a}return!0}function lge(t,e){if(e instanceof Ra)return e.zoom;if(e instanceof sn){const i=lw.setFromMatrixPosition(t.matrixWorld),n=DN.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=i.distanceTo(n);return 1/(2*Math.tan(r/2)*s)}else return 1}function cge(t,e,i){if(e instanceof sn||e instanceof Ra){const n=lw.setFromMatrixPosition(t.matrixWorld),r=DN.setFromMatrixPosition(e.matrixWorld),s=n.distanceTo(r),o=(i[1]-i[0])/(e.far-e.near),a=i[1]-o*e.far;return Math.round(o*s+a)}}const pB=t=>Math.abs(t)<1e-10?0:t;function AJ(t,e,i=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=pB(e[r]*t.elements[r])+(r!==15?",":")");return i+n}const uge=(t=>e=>AJ(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),hge=(t=>(e,i)=>AJ(e,t(i),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function dge(t){return t&&typeof t=="object"&&"current"in t}const fge=me.forwardRef(({children:t,eps:e=.001,style:i,className:n,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:u,onOcclude:d,castShadow:f,receiveShadow:p,material:m,geometry:g,zIndexRange:v=[16777271,0],calculatePosition:y=sge,as:x="div",wrapperClass:b,pointerEvents:S="auto",...A},E)=>{const{gl:M,camera:T,scene:P,size:I,raycaster:k,events:R,viewport:F}=_a(),[V]=me.useState(()=>document.createElement(x)),Q=me.useRef(),X=me.useRef(null),z=me.useRef(0),Y=me.useRef([0,0]),j=me.useRef(null),J=me.useRef(null),H=(a==null?void 0:a.current)||R.connected||M.domElement.parentNode,Z=me.useRef(null),K=me.useRef(!1),ne=me.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&dge(u[0]),[u]);me.useLayoutEffect(()=>{const ce=M.domElement;u&&u==="blending"?(ce.style.zIndex=`${Math.floor(v[0]/2)}`,ce.style.position="absolute",ce.style.pointerEvents="none"):(ce.style.zIndex=null,ce.style.position=null,ce.style.pointerEvents=null)},[u]),me.useLayoutEffect(()=>{if(X.current){const ce=Q.current=Jq(V);if(P.updateMatrixWorld(),h)V.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const ye=y(X.current,T,I);V.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${ye[0]}px,${ye[1]}px,0);transform-origin:0 0;`}return H&&(r?H.prepend(V):H.appendChild(V)),()=>{H&&H.removeChild(V),ce.unmount()}}},[H,h]),me.useLayoutEffect(()=>{b&&(V.className=b)},[b]);const W=me.useMemo(()=>h?{position:"absolute",top:0,left:0,width:I.width,height:I.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-I.height/2,left:-I.width/2,width:I.width,height:I.height},...i},[i,s,o,I,h]),ve=me.useMemo(()=>({position:"absolute",pointerEvents:S}),[S]);me.useLayoutEffect(()=>{if(K.current=!1,h){var ce;(ce=Q.current)==null||ce.render(me.createElement("div",{ref:j,style:W},me.createElement("div",{ref:J,style:ve},me.createElement("div",{ref:E,className:n,style:i,children:t}))))}else{var ye;(ye=Q.current)==null||ye.render(me.createElement("div",{ref:E,style:W,className:n,children:t}))}});const de=me.useRef(!0);ow(ce=>{if(X.current){T.updateMatrixWorld(),X.current.updateWorldMatrix(!0,!1);const ye=h?Y.current:y(X.current,T,I);if(h||Math.abs(z.current-T.zoom)>e||Math.abs(Y.current[0]-ye[0])>e||Math.abs(Y.current[1]-ye[1])>e){const ae=oge(X.current,T);let le=!1;ne&&(u!=="blending"?le=[P]:Array.isArray(u)&&(le=u.map(Ue=>Ue.current)));const Ee=de.current;if(le){const Ue=age(X.current,T,k,le);de.current=Ue&&!ae}else de.current=!ae;Ee!==de.current&&(d?d(!de.current):V.style.display=de.current?"block":"none");const Te=Math.floor(v[0]/2),Be=u?ne?[v[0],Te]:[Te-1,0]:v;if(V.style.zIndex=`${cge(X.current,T,Be)}`,h){const[Ue,Ie]=[I.width/2,I.height/2],Pe=T.projectionMatrix.elements[5]*Ie,{isOrthographicCamera:Je,top:Ke,left:U,bottom:L,right:te}=T,_e=uge(T.matrixWorldInverse),we=Je?`scale(${Pe})translate(${pB(-(te+U)/2)}px,${pB((Ke+L)/2)}px)`:`translateZ(${Pe}px)`;let Me=X.current.matrixWorld;c&&(Me=T.matrixWorldInverse.clone().transpose().copyPosition(Me).scale(X.current.scale),Me.elements[3]=Me.elements[7]=Me.elements[11]=0,Me.elements[15]=1),V.style.width=I.width+"px",V.style.height=I.height+"px",V.style.perspective=Je?"":`${Pe}px`,j.current&&J.current&&(j.current.style.transform=`${we}${_e}translate(${Ue}px,${Ie}px)`,J.current.style.transform=hge(Me,1/((l||10)/400)))}else{const Ue=l===void 0?1:lge(X.current,T)*l;V.style.transform=`translate3d(${ye[0]}px,${ye[1]}px,0) scale(${Ue})`}Y.current=ye,z.current=T.zoom}}if(!ne&&Z.current&&!K.current)if(h){if(j.current){const ye=j.current.children[0];if(ye!=null&&ye.clientWidth&&ye!=null&&ye.clientHeight){const{isOrthographicCamera:ae}=T;if(ae||g)A.scale&&(Array.isArray(A.scale)?A.scale instanceof ie?Z.current.scale.copy(A.scale.clone().divideScalar(1)):Z.current.scale.set(1/A.scale[0],1/A.scale[1],1/A.scale[2]):Z.current.scale.setScalar(1/A.scale));else{const le=(l||10)/400,Ee=ye.clientWidth*le,Te=ye.clientHeight*le;Z.current.scale.set(Ee,Te,1)}K.current=!0}}}else{const ye=V.children[0];if(ye!=null&&ye.clientWidth&&ye!=null&&ye.clientHeight){const ae=1/F.factor,le=ye.clientWidth*ae,Ee=ye.clientHeight*ae;Z.current.scale.set(le,Ee,1),K.current=!0}Z.current.lookAt(ce.camera.position)}});const pe=me.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return me.createElement("group",Dl({},A,{ref:X}),u&&!ne&&me.createElement("mesh",{castShadow:f,receiveShadow:p,ref:Z},g||me.createElement("planeGeometry",null),m||me.createElement("shaderMaterial",{side:ml,vertexShader:pe.vertexShader,fragmentShader:pe.fragmentShader})))});let Ny=0;const pge=eJ(t=>(Xg.onStart=(e,i,n)=>{t({active:!0,item:e,loaded:i,total:n,progress:(i-Ny)/(n-Ny)*100})},Xg.onLoad=()=>{t({active:!1})},Xg.onError=e=>t(i=>({errors:[...i.errors,e]})),Xg.onProgress=(e,i,n)=>{i===n&&(Ny=n),t({active:!0,item:e,loaded:i,total:n,progress:(i-Ny)/(n-Ny)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function MJ(t){return function(e){t.forEach(function(i){typeof i=="function"?i(e):i!=null&&(i.current=e)})}}function OV(t,e){if(e===KY)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===oC||e===jF){let i=t.getIndex();if(i===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),i=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const n=i.count-2,r=[];if(i)if(e===oC)for(let o=1;o<=n;o++)r.push(i.getX(0)),r.push(i.getX(o)),r.push(i.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(i.getX(o)),r.push(i.getX(o+1)),r.push(i.getX(o+2))):(r.push(i.getX(o+2)),r.push(i.getX(o+1)),r.push(i.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}var mge=Object.defineProperty,gge=(t,e,i)=>e in t?mge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,Jt=(t,e,i)=>(gge(t,typeof e!="symbol"?e+"":e,i),i);const FV=(t,e)=>(t%e+e)%e;let vge=class extends Oc{constructor(e,i){super(),Jt(this,"object"),Jt(this,"domElement"),Jt(this,"enabled",!0),Jt(this,"target",new ie),Jt(this,"minDistance",0),Jt(this,"maxDistance",1/0),Jt(this,"minZoom",0),Jt(this,"maxZoom",1/0),Jt(this,"minPolarAngle",0),Jt(this,"maxPolarAngle",Math.PI),Jt(this,"minAzimuthAngle",-1/0),Jt(this,"maxAzimuthAngle",1/0),Jt(this,"enableDamping",!1),Jt(this,"dampingFactor",.05),Jt(this,"enableZoom",!0),Jt(this,"zoomSpeed",1),Jt(this,"enableRotate",!0),Jt(this,"rotateSpeed",1),Jt(this,"enablePan",!0),Jt(this,"panSpeed",1),Jt(this,"screenSpacePanning",!0),Jt(this,"keyPanSpeed",7),Jt(this,"autoRotate",!1),Jt(this,"autoRotateSpeed",2),Jt(this,"reverseOrbit",!1),Jt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Jt(this,"mouseButtons",{LEFT:Rf.ROTATE,MIDDLE:Rf.DOLLY,RIGHT:Rf.PAN}),Jt(this,"touches",{ONE:Of.ROTATE,TWO:Of.DOLLY_PAN}),Jt(this,"target0"),Jt(this,"position0"),Jt(this,"zoom0"),Jt(this,"_domElementKeyEvents",null),Jt(this,"getPolarAngle"),Jt(this,"getAzimuthalAngle"),Jt(this,"setPolarAngle"),Jt(this,"setAzimuthalAngle"),Jt(this,"getDistance"),Jt(this,"listenToKeyEvents"),Jt(this,"saveState"),Jt(this,"reset"),Jt(this,"update"),Jt(this,"connect"),Jt(this,"dispose"),this.object=e,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=re=>{let be=FV(re,2*Math.PI),Re=h.phi;Re<0&&(Re+=2*Math.PI),be<0&&(be+=2*Math.PI);let Ne=Math.abs(be-Re);2*Math.PI-Ne<Ne&&(be<Re?be+=2*Math.PI:Re+=2*Math.PI),u.phi=be-Re,n.update()},this.setAzimuthalAngle=re=>{let be=FV(re,2*Math.PI),Re=h.theta;Re<0&&(Re+=2*Math.PI),be<0&&(be+=2*Math.PI);let Ne=Math.abs(be-Re);2*Math.PI-Ne<Ne&&(be<Re?be+=2*Math.PI:Re+=2*Math.PI),u.theta=be-Re,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=re=>{re.addEventListener("keydown",te),this._domElementKeyEvents=re},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const re=new ie,be=new Ir().setFromUnitVectors(e.up,new ie(0,1,0)),Re=be.clone().invert(),Ne=new ie,tt=new Ir,xt=2*Math.PI;return function(){const q=n.object.position;re.copy(q).sub(n.target),re.applyQuaternion(be),h.setFromVector3(re),n.autoRotate&&l===a.NONE&&k(P()),n.enableDamping?(h.theta+=u.theta*n.dampingFactor,h.phi+=u.phi*n.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let oe=n.minAzimuthAngle,xe=n.maxAzimuthAngle;return isFinite(oe)&&isFinite(xe)&&(oe<-Math.PI?oe+=xt:oe>Math.PI&&(oe-=xt),xe<-Math.PI?xe+=xt:xe>Math.PI&&(xe-=xt),oe<=xe?h.theta=Math.max(oe,Math.min(xe,h.theta)):h.theta=h.theta>(oe+xe)/2?Math.max(oe,h.theta):Math.min(xe,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),n.enableDamping===!0?n.target.addScaledVector(f,n.dampingFactor):n.target.add(f),re.setFromSpherical(h),re.applyQuaternion(Re),q.copy(n.target).add(re),n.object.lookAt(n.target),n.enableDamping===!0?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,f.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,p||Ne.distanceToSquared(n.object.position)>c||8*(1-tt.dot(n.object.quaternion))>c?(n.dispatchEvent(r),Ne.copy(n.object.position),tt.copy(n.object.quaternion),p=!1,!0):!1}})(),this.connect=re=>{re===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),n.domElement=re,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Me),n.domElement.addEventListener("pointerdown",Ue),n.domElement.addEventListener("pointercancel",Je),n.domElement.addEventListener("wheel",L)},this.dispose=()=>{var re,be,Re,Ne,tt,xt;(re=n.domElement)==null||re.removeEventListener("contextmenu",Me),(be=n.domElement)==null||be.removeEventListener("pointerdown",Ue),(Re=n.domElement)==null||Re.removeEventListener("pointercancel",Je),(Ne=n.domElement)==null||Ne.removeEventListener("wheel",L),(tt=n.domElement)==null||tt.ownerDocument.removeEventListener("pointermove",Ie),(xt=n.domElement)==null||xt.ownerDocument.removeEventListener("pointerup",Pe),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",te)};const n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new cB,u=new cB;let d=1;const f=new ie;let p=!1;const m=new Ve,g=new Ve,v=new Ve,y=new Ve,x=new Ve,b=new Ve,S=new Ve,A=new Ve,E=new Ve,M=[],T={};function P(){return 2*Math.PI/60/60*n.autoRotateSpeed}function I(){return Math.pow(.95,n.zoomSpeed)}function k(re){n.reverseOrbit?u.theta+=re:u.theta-=re}function R(re){n.reverseOrbit?u.phi+=re:u.phi-=re}const F=(()=>{const re=new ie;return function(Re,Ne){re.setFromMatrixColumn(Ne,0),re.multiplyScalar(-Re),f.add(re)}})(),V=(()=>{const re=new ie;return function(Re,Ne){n.screenSpacePanning===!0?re.setFromMatrixColumn(Ne,1):(re.setFromMatrixColumn(Ne,0),re.crossVectors(n.object.up,re)),re.multiplyScalar(Re),f.add(re)}})(),Q=(()=>{const re=new ie;return function(Re,Ne){const tt=n.domElement;if(tt&&n.object instanceof sn&&n.object.isPerspectiveCamera){const xt=n.object.position;re.copy(xt).sub(n.target);let kt=re.length();kt*=Math.tan(n.object.fov/2*Math.PI/180),F(2*Re*kt/tt.clientHeight,n.object.matrix),V(2*Ne*kt/tt.clientHeight,n.object.matrix)}else tt&&n.object instanceof Ra&&n.object.isOrthographicCamera?(F(Re*(n.object.right-n.object.left)/n.object.zoom/tt.clientWidth,n.object.matrix),V(Ne*(n.object.top-n.object.bottom)/n.object.zoom/tt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function X(re){n.object instanceof sn&&n.object.isPerspectiveCamera?d/=re:n.object instanceof Ra&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*re)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function z(re){n.object instanceof sn&&n.object.isPerspectiveCamera?d*=re:n.object instanceof Ra&&n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/re)),n.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Y(re){m.set(re.clientX,re.clientY)}function j(re){S.set(re.clientX,re.clientY)}function J(re){y.set(re.clientX,re.clientY)}function H(re){g.set(re.clientX,re.clientY),v.subVectors(g,m).multiplyScalar(n.rotateSpeed);const be=n.domElement;be&&(k(2*Math.PI*v.x/be.clientHeight),R(2*Math.PI*v.y/be.clientHeight)),m.copy(g),n.update()}function Z(re){A.set(re.clientX,re.clientY),E.subVectors(A,S),E.y>0?X(I()):E.y<0&&z(I()),S.copy(A),n.update()}function K(re){x.set(re.clientX,re.clientY),b.subVectors(x,y).multiplyScalar(n.panSpeed),Q(b.x,b.y),y.copy(x),n.update()}function ne(re){re.deltaY<0?z(I()):re.deltaY>0&&X(I()),n.update()}function W(re){let be=!1;switch(re.code){case n.keys.UP:Q(0,n.keyPanSpeed),be=!0;break;case n.keys.BOTTOM:Q(0,-n.keyPanSpeed),be=!0;break;case n.keys.LEFT:Q(n.keyPanSpeed,0),be=!0;break;case n.keys.RIGHT:Q(-n.keyPanSpeed,0),be=!0;break}be&&(re.preventDefault(),n.update())}function ve(){if(M.length==1)m.set(M[0].pageX,M[0].pageY);else{const re=.5*(M[0].pageX+M[1].pageX),be=.5*(M[0].pageY+M[1].pageY);m.set(re,be)}}function de(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const re=.5*(M[0].pageX+M[1].pageX),be=.5*(M[0].pageY+M[1].pageY);y.set(re,be)}}function pe(){const re=M[0].pageX-M[1].pageX,be=M[0].pageY-M[1].pageY,Re=Math.sqrt(re*re+be*be);S.set(0,Re)}function ce(){n.enableZoom&&pe(),n.enablePan&&de()}function ye(){n.enableZoom&&pe(),n.enableRotate&&ve()}function ae(re){if(M.length==1)g.set(re.pageX,re.pageY);else{const Re=Ge(re),Ne=.5*(re.pageX+Re.x),tt=.5*(re.pageY+Re.y);g.set(Ne,tt)}v.subVectors(g,m).multiplyScalar(n.rotateSpeed);const be=n.domElement;be&&(k(2*Math.PI*v.x/be.clientHeight),R(2*Math.PI*v.y/be.clientHeight)),m.copy(g)}function le(re){if(M.length==1)x.set(re.pageX,re.pageY);else{const be=Ge(re),Re=.5*(re.pageX+be.x),Ne=.5*(re.pageY+be.y);x.set(Re,Ne)}b.subVectors(x,y).multiplyScalar(n.panSpeed),Q(b.x,b.y),y.copy(x)}function Ee(re){const be=Ge(re),Re=re.pageX-be.x,Ne=re.pageY-be.y,tt=Math.sqrt(Re*Re+Ne*Ne);A.set(0,tt),E.set(0,Math.pow(A.y/S.y,n.zoomSpeed)),X(E.y),S.copy(A)}function Te(re){n.enableZoom&&Ee(re),n.enablePan&&le(re)}function Be(re){n.enableZoom&&Ee(re),n.enableRotate&&ae(re)}function Ue(re){var be,Re;n.enabled!==!1&&(M.length===0&&((be=n.domElement)==null||be.ownerDocument.addEventListener("pointermove",Ie),(Re=n.domElement)==null||Re.ownerDocument.addEventListener("pointerup",Pe)),We(re),re.pointerType==="touch"?_e(re):Ke(re))}function Ie(re){n.enabled!==!1&&(re.pointerType==="touch"?we(re):U(re))}function Pe(re){var be,Re,Ne;Le(re),M.length===0&&((be=n.domElement)==null||be.releasePointerCapture(re.pointerId),(Re=n.domElement)==null||Re.ownerDocument.removeEventListener("pointermove",Ie),(Ne=n.domElement)==null||Ne.ownerDocument.removeEventListener("pointerup",Pe)),n.dispatchEvent(o),l=a.NONE}function Je(re){Le(re)}function Ke(re){let be;switch(re.button){case 0:be=n.mouseButtons.LEFT;break;case 1:be=n.mouseButtons.MIDDLE;break;case 2:be=n.mouseButtons.RIGHT;break;default:be=-1}switch(be){case Rf.DOLLY:if(n.enableZoom===!1)return;j(re),l=a.DOLLY;break;case Rf.ROTATE:if(re.ctrlKey||re.metaKey||re.shiftKey){if(n.enablePan===!1)return;J(re),l=a.PAN}else{if(n.enableRotate===!1)return;Y(re),l=a.ROTATE}break;case Rf.PAN:if(re.ctrlKey||re.metaKey||re.shiftKey){if(n.enableRotate===!1)return;Y(re),l=a.ROTATE}else{if(n.enablePan===!1)return;J(re),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function U(re){if(n.enabled!==!1)switch(l){case a.ROTATE:if(n.enableRotate===!1)return;H(re);break;case a.DOLLY:if(n.enableZoom===!1)return;Z(re);break;case a.PAN:if(n.enablePan===!1)return;K(re);break}}function L(re){n.enabled===!1||n.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(re.preventDefault(),n.dispatchEvent(s),ne(re),n.dispatchEvent(o))}function te(re){n.enabled===!1||n.enablePan===!1||W(re)}function _e(re){switch(ue(re),M.length){case 1:switch(n.touches.ONE){case Of.ROTATE:if(n.enableRotate===!1)return;ve(),l=a.TOUCH_ROTATE;break;case Of.PAN:if(n.enablePan===!1)return;de(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case Of.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ce(),l=a.TOUCH_DOLLY_PAN;break;case Of.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ye(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(s)}function we(re){switch(ue(re),l){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;ae(re),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;le(re),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Te(re),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Be(re),n.update();break;default:l=a.NONE}}function Me(re){n.enabled!==!1&&re.preventDefault()}function We(re){M.push(re)}function Le(re){delete T[re.pointerId];for(let be=0;be<M.length;be++)if(M[be].pointerId==re.pointerId){M.splice(be,1);return}}function ue(re){let be=T[re.pointerId];be===void 0&&(be=new Ve,T[re.pointerId]=be),be.set(re.pageX,re.pageY)}function Ge(re){const be=re.pointerId===M[0].pointerId?M[1]:M[0];return T[be.pointerId]}i!==void 0&&this.connect(i),this.update()}};class IN extends ks{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(i){return new bge(i)}),this.register(function(i){return new Dge(i)}),this.register(function(i){return new Ige(i)}),this.register(function(i){return new Lge(i)}),this.register(function(i){return new Age(i)}),this.register(function(i){return new Mge(i)}),this.register(function(i){return new Cge(i)}),this.register(function(i){return new Ege(i)}),this.register(function(i){return new wge(i)}),this.register(function(i){return new Tge(i)}),this.register(function(i){return new Sge(i)}),this.register(function(i){return new Pge(i)}),this.register(function(i){return new xge(i)}),this.register(function(i){return new Bge(i)}),this.register(function(i){return new Rge(i)})}load(e,i,n,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=bc.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new jo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){i(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,i,n,r){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(bc.decodeText(new Uint8Array(e.slice(0,4)))===CJ){try{o[pi.KHR_BINARY_GLTF]=new Oge(e)}catch(h){r&&r(h);return}s=JSON.parse(o[pi.KHR_BINARY_GLTF].content)}else s=JSON.parse(bc.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new Yge(s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const h=this.pluginCallbacks[c](l);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const h=s.extensionsUsed[c],u=s.extensionsRequired||[];switch(h){case pi.KHR_MATERIALS_UNLIT:o[h]=new _ge;break;case pi.KHR_DRACO_MESH_COMPRESSION:o[h]=new Fge(s,this.dracoLoader);break;case pi.KHR_TEXTURE_TRANSFORM:o[h]=new Nge;break;case pi.KHR_MESH_QUANTIZATION:o[h]=new kge;break;default:u.indexOf(h)>=0&&a[h]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(e,i){const n=this;return new Promise(function(r,s){n.parse(e,i,r,s)})}}function yge(){let t={};return{get:function(e){return t[e]},add:function(e,i){t[e]=i},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const pi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class xge{constructor(e){this.parser=e,this.name=pi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,i=this.parser.json.nodes||[];for(let n=0,r=i.length;n<r;n++){const s=i[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const i=this.parser,n="light:"+e;let r=i.cache.get(n);if(r)return r;const s=i.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new ct(16777215);l.color!==void 0&&h.fromArray(l.color);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new bN(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new wN(h),c.distance=u;break;case"spot":c=new _N(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,zh(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=i.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),i.cache.add(n,r),r}getDependency(e,i){if(e==="light")return this._loadLight(i)}createNodeAttachment(e){const i=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return n._getNodeRef(i.cache,a,l)})}}class _ge{constructor(){this.name=pi.KHR_MATERIALS_UNLIT}getMaterialType(){return Bo}extendParams(e,i,n){const r=[];e.color=new ct(1,1,1),e.opacity=1;const s=i.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,3001))}return Promise.all(r)}}class wge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,i){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(i.emissiveIntensity=s),Promise.resolve()}}class bge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(i.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(i.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(i,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new Ve(a,a)}return Promise.all(s)}}class Sge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(i.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(i.iridescenceIOR=o.iridescenceIor),i.iridescenceThicknessRange===void 0&&(i.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(i.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(i.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(i,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Age{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];i.sheenColor=new ct(0,0,0),i.sheenRoughness=0,i.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&i.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(i.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(i,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(i,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Mge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(i.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(i,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Cge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(i,"thicknessMap",o.thicknessTexture)),i.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return i.attenuationColor=new ct(a[0],a[1],a[2]),Promise.all(s)}}class Ege{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return i.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Tge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];i.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(i,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return i.specularColor=new ct(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(n.assignTexture(i,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class Pge{constructor(e){this.parser=e,this.name=pi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Fc}extendMaterialParams(e,i){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(i.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(i.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(i,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Dge{constructor(e){this.parser=e,this.name=pi.KHR_TEXTURE_BASISU}loadTexture(e){const i=this.parser,n=i.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=i.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(e,s.source,o)}}class Ige{constructor(e){this.parser=e,this.name=pi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const i=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class Lge{constructor(e){this.parser=e,this.name=pi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const i=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class Bge{constructor(e){this.name=pi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const i=this.parser.json,n=i.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,u=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,u,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(h*u);return o.decodeGltfBuffer(new Uint8Array(f),h,u,d,r.mode,r.filter),f})})}else return null}}class Rge{constructor(e){this.name=pi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const i=this.parser.json,n=i.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const r=i.meshes[n.mesh];for(const c of r.primitives)if(c.mode!==ga.TRIANGLES&&c.mode!==ga.TRIANGLE_STRIP&&c.mode!==ga.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=n.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,f=[];for(const p of u){const m=new Nt,g=new ie,v=new Ir,y=new ie(1,1,1),x=new nN(p.geometry,p.material,d);for(let b=0;b<d;b++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,b),l.SCALE&&y.fromBufferAttribute(l.SCALE,b),x.setMatrixAt(b,m.compose(g,v,y));for(const b in l)b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&p.geometry.setAttribute(b,l[b]);vi.prototype.copy.call(x,p),this.parser.assignFinalMaterial(x),f.push(x)}return h.isGroup?(h.clear(),h.add(...f),h):f[0]}))}}const CJ="glTF",ky=12,NV={JSON:1313821514,BIN:5130562};class Oge{constructor(e){this.name=pi.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(e,0,ky);if(this.header={magic:bc.decodeText(new Uint8Array(e.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==CJ)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-ky,r=new DataView(e,ky);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===NV.JSON){const l=new Uint8Array(e,ky+s,o);this.content=bc.decodeText(l)}else if(a===NV.BIN){const l=ky+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Fge{constructor(e,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=pi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(e,i){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const u=mB[h]||h.toLowerCase();a[u]=o[h]}for(const h in e.attributes){const u=mB[h]||h.toLowerCase();if(o[h]!==void 0){const d=n.accessors[e.attributes[h]],f=mv[d.componentType];c[u]=f.name,l[u]=d.normalized===!0}}return i.getDependency("bufferView",s).then(function(h){return new Promise(function(u){r.decodeDracoFile(h,function(d){for(const f in d.attributes){const p=d.attributes[f],m=l[f];m!==void 0&&(p.normalized=m)}u(d)},a,c)})})}}class Nge{constructor(){this.name=pi.KHR_TEXTURE_TRANSFORM}extendTexture(e,i){return(i.texCoord===void 0||i.texCoord===e.channel)&&i.offset===void 0&&i.rotation===void 0&&i.scale===void 0||(e=e.clone(),i.texCoord!==void 0&&(e.channel=i.texCoord),i.offset!==void 0&&e.offset.fromArray(i.offset),i.rotation!==void 0&&(e.rotation=i.rotation),i.scale!==void 0&&e.repeat.fromArray(i.scale),e.needsUpdate=!0),e}}class kge{constructor(){this.name=pi.KHR_MESH_QUANTIZATION}}class EJ extends P0{constructor(e,i,n,r){super(e,i,n,r)}copySampleValue_(e){const i=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)i[o]=n[s+o];return i}interpolate_(e,i,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-i,u=(n-i)/h,d=u*u,f=d*u,p=e*c,m=p-c,g=-2*f+3*d,v=f-d,y=1-g,x=v-d+u;for(let b=0;b!==a;b++){const S=o[m+b+a],A=o[m+b+l]*h,E=o[p+b+a],M=o[p+b]*h;s[b]=y*S+x*A+g*E+v*M}return s}}const zge=new Ir;class Uge extends EJ{interpolate_(e,i,n,r){const s=super.interpolate_(e,i,n,r);return zge.fromArray(s).normalize().toArray(s),s}}const ga={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},mv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kV={9728:Sn,9729:bi,9984:j1,9985:jE,9986:fv,9987:Tc},zV={33071:Hr,33648:Vv,10497:Pd},lD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},mB={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...N_.replace(/\D+/g,"")>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},yh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Gge={CUBICSPLINE:void 0,LINEAR:Up,STEP:jv},cD={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Vge(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new rw({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ec})),t.DefaultMaterial}function xf(t,e,i){for(const n in i.extensions)t[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=i.extensions[n])}function zh(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Hge(t,e,i){let n=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(n=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(n){const d=u.POSITION!==void 0?i.getDependency("accessor",u.POSITION):t.attributes.position;o.push(d)}if(r){const d=u.NORMAL!==void 0?i.getDependency("accessor",u.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?i.getDependency("accessor",u.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return n&&(t.morphAttributes.position=h),r&&(t.morphAttributes.normal=u),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function jge(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let i=0,n=e.weights.length;i<n;i++)t.morphTargetInfluences[i]=e.weights[i];if(e.extras&&Array.isArray(e.extras.targetNames)){const i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++)t.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Wge(t){let e;const i=t.extensions&&t.extensions[pi.KHR_DRACO_MESH_COMPRESSION];if(i?e="draco:"+i.bufferView+":"+i.indices+":"+uD(i.attributes):e=t.indices+":"+uD(t.attributes)+":"+t.mode,t.targets!==void 0)for(let n=0,r=t.targets.length;n<r;n++)e+=":"+uD(t.targets[n]);return e}function uD(t){let e="";const i=Object.keys(t).sort();for(let n=0,r=i.length;n<r;n++)e+=i[n]+":"+t[i[n]]+";";return e}function gB(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Xge(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const qge=new Nt;class Yge{constructor(e={},i={}){this.json=e,this.extensions={},this.plugins={},this.options=i,this.cache=new yge,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new yN(this.options.manager):this.textureLoader=new YQ(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new jo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,i){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};xf(s,a,r),zh(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(i)}_markDefs(){const e=this.json.nodes||[],i=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=i.length;r<s;r++){const o=i[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,i){i!==void 0&&(e.refs[i]===void 0&&(e.refs[i]=e.uses[i]=0),e.refs[i]++)}_getNodeRef(e,i,n){if(e.refs[i]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[i]++,r}_invokeOne(e){const i=Object.values(this.plugins);i.push(this);for(let n=0;n<i.length;n++){const r=e(i[n]);if(r)return r}return null}_invokeAll(e){const i=Object.values(this.plugins);i.unshift(this);const n=[];for(let r=0;r<i.length;r++){const s=e(i[r]);s&&n.push(s)}return n}getDependency(e,i){const n=e+":"+i;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(i);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(i)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(i)});break;case"accessor":r=this.loadAccessor(i);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(i)});break;case"buffer":r=this.loadBuffer(i);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(i)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(i)});break;case"skin":r=this.loadSkin(i);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(i)});break;case"camera":r=this.loadCamera(i);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,i)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let i=this.cache.get(e);if(!i){const n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];i=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,i)}return i}loadBuffer(e){const i=this.json.buffers[e],n=this.fileLoader;if(i.type&&i.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&e===0)return Promise.resolve(this.extensions[pi.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(bc.resolveURL(i.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(e){const i=this.json.bufferViews[e];return this.getDependency("buffer",i.buffer).then(function(n){const r=i.byteLength||0,s=i.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){const i=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=lD[r.type],a=mv[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Ai(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=lD[r.type],c=mv[r.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let m,g;if(f&&f!==u){const v=Math.floor(d/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count;let x=i.cache.get(y);x||(m=new c(a,v*f,r.count*f/h),x=new H_(m,f/h),i.cache.add(y,x)),g=new Id(x,l,d%f/h,p)}else a===null?m=new c(r.count*l):m=new c(a,d,r.count*l),g=new Ai(m,l,p);if(r.sparse!==void 0){const v=lD.SCALAR,y=mv[r.sparse.indices.componentType],x=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,S=new y(o[1],x,r.sparse.count*v),A=new c(o[2],b,r.sparse.count*l);a!==null&&(g=new Ai(g.array.slice(),g.itemSize,g.normalized));for(let E=0,M=S.length;E<M;E++){const T=S[E];if(g.setX(T,A[E*l]),l>=2&&g.setY(T,A[E*l+1]),l>=3&&g.setZ(T,A[E*l+2]),l>=4&&g.setW(T,A[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const i=this.json,n=this.options,s=i.textures[e].source,o=i.images[s];let a=this.textureLoader;if(o.uri){const l=n.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,i,n){const r=this,s=this.json,o=s.textures[e],a=s.images[i],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(i,n).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=kV[d.magFilter]||bi,h.minFilter=kV[d.minFilter]||Tc,h.wrapS=zV[d.wrapS]||Pd,h.wrapT=zV[d.wrapT]||Pd,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,i){const n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=n.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,f){let p=d;i.isImageBitmapLoader===!0&&(p=function(m){const g=new on(m);g.needsUpdate=!0,d(g)}),i.load(bc.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||Xge(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,i,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[pi.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[pi.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[pi.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&("colorSpace"in o?o.colorSpace=r===3001?"srgb":"srgb-linear":o.encoding=r),e[i]=o,o})}assignFinalMaterial(e){const i=e.geometry;let n=e.material;const r=i.attributes.tangent===void 0,s=i.attributes.color!==void 0,o=i.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new W_,Zn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new ps,Zn.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return rw}loadMaterial(e){const i=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[pi.KHR_MATERIALS_UNLIT]){const u=r[pi.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,i))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new ct(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(i.assignTexture(a,"map",u.baseColorTexture,3001)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(i.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(i.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=ml);const h=s.alphaMode||cD.OPAQUE;if(h===cD.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===cD.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Bo&&(c.push(i.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ve(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return s.occlusionTexture!==void 0&&o!==Bo&&(c.push(i.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Bo&&(a.emissive=new ct().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==Bo&&c.push(i.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),zh(u,s),i.associations.set(u,{materials:e}),s.extensions&&xf(r,u,s),u})}createUniqueName(e){const i=gi.sanitizeNodeName(e||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(e){const i=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[pi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,i).then(function(l){return UV(l,a,i)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=Wge(c),u=r[h];if(u)o.push(u.promise);else{let d;c.extensions&&c.extensions[pi.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=UV(new $t,c,i),r[h]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const i=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?Vge(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(i.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let f=0,p=h.length;f<p;f++){const m=h[f],g=o[f];let v;const y=c[f];if(g.mode===ga.TRIANGLES||g.mode===ga.TRIANGLE_STRIP||g.mode===ga.TRIANGLE_FAN||g.mode===void 0)v=s.isSkinnedMesh===!0?new iN(m,y):new cr(m,y),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),g.mode===ga.TRIANGLE_STRIP?v.geometry=OV(v.geometry,jF):g.mode===ga.TRIANGLE_FAN&&(v.geometry=OV(v.geometry,oC));else if(g.mode===ga.LINES)v=new Bl(m,y);else if(g.mode===ga.LINE_STRIP)v=new qu(m,y);else if(g.mode===ga.LINE_LOOP)v=new rN(m,y);else if(g.mode===ga.POINTS)v=new sN(m,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(v.geometry.morphAttributes).length>0&&jge(v,s),v.name=i.createUniqueName(s.name||"mesh_"+e),zh(v,s),g.extensions&&xf(r,v,g),i.assignFinalMaterial(v),u.push(v)}for(let f=0,p=u.length;f<p;f++)i.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return s.extensions&&xf(r,u[0],s),u[0];const d=new Pu;s.extensions&&xf(r,d,s),i.associations.set(d,{meshes:e});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}loadCamera(e){let i;const n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?i=new sn(nQ.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(i=new Ra(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(i.name=this.createUniqueName(n.name)),zh(i,n),Promise.resolve(i)}loadSkin(e){const i=this.json.skins[e],n=[];for(let r=0,s=i.joints.length;r<s;r++)n.push(this._loadNodeShallow(i.joints[r]));return i.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",i.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const u=o[c];if(u){a.push(u);const d=new Nt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[c])}return new j_(a,l)})}loadAnimation(e){const n=this.json.animations[e],r=n.name?n.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let h=0,u=n.channels.length;h<u;h++){const d=n.channels[h],f=n.samplers[d.sampler],p=d.target,m=p.node,g=n.parameters!==void 0?n.parameters[f.input]:f.input,v=n.parameters!==void 0?n.parameters[f.output]:f.output;p.node!==void 0&&(s.push(this.getDependency("node",m)),o.push(this.getDependency("accessor",g)),a.push(this.getDependency("accessor",v)),l.push(f),c.push(p))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(h){const u=h[0],d=h[1],f=h[2],p=h[3],m=h[4],g=[];for(let v=0,y=u.length;v<y;v++){const x=u[v],b=d[v],S=f[v],A=p[v],E=m[v];if(x===void 0)continue;x.updateMatrix();let M;switch(yh[E.path]){case yh.weights:M=Yv;break;case yh.rotation:M=Ld;break;case yh.position:case yh.scale:default:M=Qv;break}const T=x.name?x.name:x.uuid,P=A.interpolation!==void 0?Gge[A.interpolation]:Up,I=[];yh[E.path]===yh.weights?x.traverse(function(R){R.morphTargetInfluences&&I.push(R.name?R.name:R.uuid)}):I.push(T);let k=S.array;if(S.normalized){const R=gB(k.constructor),F=new Float32Array(k.length);for(let V=0,Q=k.length;V<Q;V++)F[V]=k[V]*R;k=F}for(let R=0,F=I.length;R<F;R++){const V=new M(I[R]+"."+yh[E.path],b.array,k,P);A.interpolation==="CUBICSPLINE"&&(V.createInterpolant=function(X){const z=this instanceof Ld?Uge:EJ;return new z(this.times,this.values,this.getValueSize()/3,X)},V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(V)}}return new Jv(r,void 0,g)})}createNodeMesh(e){const i=this.json,n=this,r=i.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this.json,n=this,r=i.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(n.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(f){f.isSkinnedMesh&&f.bind(d,qge)});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}_loadNodeShallow(e){const i=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=i.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new ZE:c.length>1?h=new Pu:c.length===1?h=c[0]:h=new vi,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=o),zh(h,s),s.extensions&&xf(n,h,s),s.matrix!==void 0){const u=new Nt;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const i=this.extensions,n=this.json.scenes[e],r=this,s=new Pu;n.name&&(s.name=r.createUniqueName(n.name)),zh(s,n),n.extensions&&xf(i,s,n);const o=n.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,f]of r.associations)(d instanceof Zn||d instanceof on)&&u.set(d,f);return h.traverse(d=>{const f=r.associations.get(d);f!=null&&u.set(d,f)}),u};return r.associations=c(s),s})}}function Qge(t,e,i){const n=e.attributes,r=new jd;if(n.POSITION!==void 0){const a=i.json.accessors[n.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new ie(l[0],l[1],l[2]),new ie(c[0],c[1],c[2])),a.normalized){const h=gB(mv[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new ie,l=new ie;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=i.json.accessors[u.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=gB(mv[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}t.boundingBox=r;const o=new Wd;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=o}function UV(t,e,i){const n=e.attributes,r=[];function s(o,a){return i.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in n){const a=mB[o]||o.toLowerCase();a in t.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!t.index){const o=i.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});r.push(o)}return zh(t,e),Qge(t,e,i),Promise.all(r).then(function(){return e.targets!==void 0?Hge(t,e.targets,i):t})}const hD=new WeakMap;class Jge extends ks{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,i,n,r){const s=new jo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(i).catch(r)},n,r)}decodeDracoFile(e,i,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(i)}decodeGeometry(e,i){for(const l in i.attributeTypes){const c=i.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(i.attributeTypes[l]=c.name)}const n=JSON.stringify(i);if(hD.has(e)){const l=hD.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:i,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),hD.set(e,{key:n,promise:a}),a}_createGeometry(e){const i=new $t;e.index&&i.setIndex(new Ai(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,a=r.itemSize;i.setAttribute(s,new Ai(o,a))}return i}_loadLibrary(e,i){const n=new jo(this.manager);return n.setPath(this.decoderPath),n.setResponseType(i),n.setWithCredentials(this.withCredentials),new Promise((r,s)=>{n.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",i=[];return e?i.push(this._loadLibrary("draco_decoder.js","text")):(i.push(this._loadLibrary("draco_wasm_wrapper.js","text")),i.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(i).then(n=>{const r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const s=Kge.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,i){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=i,n._taskLoad+=i,n})}_releaseTask(e,i){e._taskLoad-=e._taskCosts[i],delete e._callbacks[i],delete e._taskCosts[i]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Kge(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=i(u,d,f,c),m=p.attributes.map(g=>g.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){const h=c.attributeIDs,u=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const m={index:null,attributes:[]};for(const g in h){const v=self[u[g]];let y,x;if(c.useUniqueIDs)x=h[g],y=a.GetAttributeByUniqueId(d,x);else{if(x=a.GetAttributeId(d,o[h[g]]),x===-1)continue;y=a.GetAttribute(d,x)}m.attributes.push(r(o,a,d,g,v,y))}return p===o.TRIANGULAR_MESH&&(m.index=n(o,a,d)),o.destroy(d),m}function n(o,a,l){const h=l.num_faces()*3,u=h*4,d=o._malloc(u);a.GetTrianglesUInt32Array(l,u,d);const f=new Uint32Array(o.HEAPF32.buffer,d,h).slice();return o._free(d),{array:f,itemSize:1}}function r(o,a,l,c,h,u){const d=u.num_components(),p=l.num_points()*d,m=p*h.BYTES_PER_ELEMENT,g=s(o,h),v=o._malloc(m);a.GetAttributeDataArrayForAllPoints(l,u,g,m,v);const y=new h(o.HEAPF32.buffer,v,p).slice();return o._free(v),{name:c,array:y,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let ES;const dD=()=>{if(ES)return ES;const t="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=t;WebAssembly.validate(i)&&(r=e);let s;const o=WebAssembly.instantiate(a(r),{}).then(u=>{s=u.instance,s.exports.__wasm_call_ctors()});function a(u){const d=new Uint8Array(u.length);for(let p=0;p<u.length;++p){const m=u.charCodeAt(p);d[p]=m>96?m-71:m>64?m-65:m>47?m+4:m>46?63:62}let f=0;for(let p=0;p<u.length;++p)d[f++]=d[p]<60?n[d[p]]:(d[p]-60)*64+d[++p];return d.buffer.slice(0,f)}function l(u,d,f,p,m,g){const v=s.exports.sbrk,y=f+3&-4,x=v(y*p),b=v(m.length),S=new Uint8Array(s.exports.memory.buffer);S.set(m,b);const A=u(x,f,p,b,m.length);if(A===0&&g&&g(x,y,p),d.set(S.subarray(x,x+f*p)),v(x-v(0)),A!==0)throw new Error(`Malformed buffer data: ${A}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return ES={ready:o,supported:!0,decodeVertexBuffer(u,d,f,p,m){l(s.exports.meshopt_decodeVertexBuffer,u,d,f,p,s.exports[c[m]])},decodeIndexBuffer(u,d,f,p){l(s.exports.meshopt_decodeIndexBuffer,u,d,f,p)},decodeIndexSequence(u,d,f,p){l(s.exports.meshopt_decodeIndexSequence,u,d,f,p)},decodeGltfBuffer(u,d,f,p,m,g){l(s.exports[h[m]],u,d,f,p,s.exports[c[g]])}},ES};let TS=null;function TJ(t,e,i){return n=>{i&&i(n),t&&(TS||(TS=new Jge),TS.setDecoderPath(typeof t=="string"?t:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),n.setDRACOLoader(TS)),e&&n.setMeshoptDecoder(typeof dD=="function"?dD():dD)}}function LN(t,e=!0,i=!0,n){return aw(IN,t,TJ(e,i,n))}LN.preload=(t,e=!0,i=!0,n)=>aw.preload(IN,t,TJ(e,i,n));LN.clear=t=>aw.clear(IN,t);const Zge=me.forwardRef(({makeDefault:t,camera:e,regress:i,domElement:n,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},h)=>{const u=_a(A=>A.invalidate),d=_a(A=>A.camera),f=_a(A=>A.gl),p=_a(A=>A.events),m=_a(A=>A.setEvents),g=_a(A=>A.set),v=_a(A=>A.get),y=_a(A=>A.performance),x=e||d,b=n||p.connected||f.domElement,S=me.useMemo(()=>new vge(x),[x]);return ow(()=>{S.enabled&&S.update()},-1),me.useEffect(()=>(s&&S.connect(s===!0?b:s),S.connect(b),()=>void S.dispose()),[s,b,i,S,u]),me.useEffect(()=>{const A=T=>{u(),i&&y.regress(),o&&o(T)},E=T=>{a&&a(T)},M=T=>{l&&l(T)};return S.addEventListener("change",A),S.addEventListener("start",E),S.addEventListener("end",M),()=>{S.removeEventListener("start",E),S.removeEventListener("end",M),S.removeEventListener("change",A)}},[o,a,l,S,u,m]),me.useEffect(()=>{if(t){const A=v().controls;return g({controls:S}),()=>g({controls:A})}},[t,S]),me.createElement("primitive",Dl({ref:h,object:S,enableDamping:r},c))});class $ge extends W_{constructor(e){super(e),this.onBeforeCompile=(i,n)=>{const{isWebGL2:r}=n.capabilities;i.fragmentShader=i.fragmentShader.replace("#include <output_fragment>",`
        ${r?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const eve=me.forwardRef((t,e)=>{const[i]=me.useState(()=>new $ge(null));return me.createElement("primitive",Dl({},t,{object:i,ref:e,attach:"material"}))});let _f,zy;const tve=me.createContext(null),GV=new Nt,VV=new ie,ive=me.forwardRef(({children:t,range:e,limit:i=1e3,...n},r)=>{const s=me.useRef(null),[o,a]=me.useState([]),[[l,c,h]]=me.useState(()=>[new Float32Array(i*3),Float32Array.from({length:i*3},()=>1),Float32Array.from({length:i},()=>1)]);me.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),ow(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),GV.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(i,e!==void 0?e:i,o.length),_f=0;_f<o.length;_f++)zy=o[_f].current,zy.getWorldPosition(VV).applyMatrix4(GV),VV.toArray(l,_f*3),s.current.geometry.attributes.position.needsUpdate=!0,zy.matrixWorldNeedsUpdate=!0,zy.color.toArray(c,_f*3),s.current.geometry.attributes.color.needsUpdate=!0,h.set([zy.size],_f),s.current.geometry.attributes.size.needsUpdate=!0});const u=me.useMemo(()=>({getParent:()=>s,subscribe:d=>(a(f=>[...f,d]),()=>a(f=>f.filter(p=>p.current!==d.current)))}),[]);return me.createElement("points",Dl({userData:{instances:o},matrixAutoUpdate:!1,ref:MJ([r,s]),raycast:()=>null},n),me.createElement("bufferGeometry",null,me.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:yp}),me.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:yp}),me.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:yp})),me.createElement(tve.Provider,{value:u},t))}),nve=me.forwardRef(({children:t,positions:e,colors:i,sizes:n,stride:r=3,...s},o)=>{const a=me.useRef(null);return ow(()=>{const l=a.current.geometry.attributes;l.position.needsUpdate=!0,i&&(l.color.needsUpdate=!0),n&&(l.size.needsUpdate=!0)}),me.createElement("points",Dl({ref:MJ([o,a])},s),me.createElement("bufferGeometry",null,me.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/r,array:e,itemSize:r,usage:yp}),i&&me.createElement("bufferAttribute",{attach:"attributes-color",count:i.length/r,array:i,itemSize:3,usage:yp}),n&&me.createElement("bufferAttribute",{attach:"attributes-size",count:n.length/r,array:n,itemSize:1,usage:yp})),t)}),rve=me.forwardRef((t,e)=>t.positions instanceof Float32Array?me.createElement(nve,Dl({},t,{ref:e})):me.createElement(ive,Dl({},t,{ref:e})));var PJ={exports:{}},sve="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ove=sve,ave=ove;function DJ(){}function IJ(){}IJ.resetWarningCache=DJ;var lve=function(){function t(n,r,s,o,a,l){if(l!==ave){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:IJ,resetWarningCache:DJ};return i.PropTypes=i,i};PJ.exports=lve();var LJ=PJ.exports;function BJ({all:t,scene:e,camera:i}){const n=_a(({gl:o})=>o),r=_a(({camera:o})=>o),s=_a(({scene:o})=>o);return me.useLayoutEffect(()=>{const o=[];t&&(e||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),n.compile(e||s,i||r);const a=new KF(128);new JF(.01,1e5,a).update(n,e||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}const cve=()=>{const{progress:t}=pge();return ei(fge,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[Ye("span",{className:"canvas-loader"}),ei("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:[t.toFixed(2),"%"]})]})},uve=()=>{const t=LN("./planet/scene.gltf");return Ye("primitive",{object:t.scene,scale:2.5,"position-y":0,"rotation-y":0})},hve=()=>Ye(SJ,{shadows:!0,frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:ei(me.Suspense,{fallback:Ye(cve,{}),children:[Ye(Zge,{autoRotate:!0,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),Ye(uve,{}),Ye(BJ,{all:!0})]})});function gv(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function HV(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function jV(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?HV(Object(i),!0).forEach(function(n){gv(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):HV(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function RJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}new Ve;new Ve;var aa=function t(e,i,n){var r=this;RJ(this,t),gv(this,"dot2",function(s,o){return r.x*s+r.y*o}),gv(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=e,this.y=i,this.z=n},dve=[new aa(1,1,0),new aa(-1,1,0),new aa(1,-1,0),new aa(-1,-1,0),new aa(1,0,1),new aa(-1,0,1),new aa(1,0,-1),new aa(-1,0,-1),new aa(0,1,1),new aa(0,-1,1),new aa(0,1,-1),new aa(0,-1,-1)],WV=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],XV=new Array(512),qV=new Array(512),fve=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var i=0;i<256;i++){var n;i&1?n=WV[i]^e&255:n=WV[i]^e>>8&255,XV[i]=XV[i+256]=n,qV[i]=qV[i+256]=dve[n%12]}};fve(0);function pve(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var i=0;i<e.length;i++)t=(t+(i+1)*(e.charCodeAt(i)%96))%2147483647}return t===0&&(t=311),t}function YV(t){var e=pve(t);return function(){var i=e*48271%2147483647;return e=i,i/2147483647}}var mve=function t(e){var i=this;RJ(this,t),gv(this,"seed",0),gv(this,"init",function(n){i.seed=n,i.value=YV(n)}),gv(this,"value",YV(this.seed)),this.init(e)},gve=new mve(Math.random()),vve={radius:1,center:[0,0,0]};function yve(t,e){for(var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gve,n=jV(jV({},vve),e),r=n.radius,s=n.center,o=0;o<t.length;o+=3){var a=Math.pow(i.value(),.3333333333333333),l=i.value()*2-1,c=i.value()*2-1,h=i.value()*2-1,u=Math.sqrt(l*l+c*c+h*h);l=a*l/u,c=a*c/u,h=a*h/u,t[o]=l*r+s[0],t[o+1]=c*r+s[1],t[o+2]=h*r+s[2]}return t}const xve=t=>{const e=me.useRef(),[i]=me.useState(()=>yve(new Float32Array(5e3),{radius:1}));return ow((n,r)=>{e.current.rotation.x-=r/10,e.current.rotation.y-=r/15}),Ye("group",{rotation:[0,0,Math.PI/4],children:Ye(rve,{ref:e,positions:i,stride:3,frustumCulled:!0,...t,children:Ye(eve,{transparent:!0,color:"#f272c8",size:7e-4,sizeAttenuation:!0,depthWrite:!1})})})},_ve=()=>Ye("div",{className:"w-full h-auto absolute inset-0 z-[-1]",children:ei(SJ,{camera:{position:[0,0,1]},children:[Ye(me.Suspense,{fallback:null,children:Ye(xve,{})}),Ye(BJ,{all:!0})]})}),OJ=me.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),rT=me.createContext({});function wve(){return me.useContext(rT).visualElement}const BN=me.createContext(null),sT=typeof document<"u",QV=sT?me.useLayoutEffect:me.useEffect,FJ=me.createContext({strict:!1});function bve(t,e,i,n){const r=wve(),s=me.useContext(FJ),o=me.useContext(BN),a=me.useContext(OJ).reducedMotion,l=me.useRef();n=n||s.renderer,!l.current&&n&&(l.current=n(t,{visualState:e,parent:r,props:i,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;return me.useInsertionEffect(()=>{c&&c.update(i,o)}),QV(()=>{c&&c.render()}),me.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?QV:me.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function Yg(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Sve(t,e,i){return me.useCallback(n=>{n&&t.mount&&t.mount(n),e&&(n?e.mount(n):e.unmount()),i&&(typeof i=="function"?i(n):Yg(i)&&(i.current=n))},[e])}function t_(t){return typeof t=="string"||Array.isArray(t)}function oT(t){return typeof t=="object"&&typeof t.start=="function"}const RN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ON=["initial",...RN];function aT(t){return oT(t.animate)||ON.some(e=>t_(t[e]))}function NJ(t){return!!(aT(t)||t.variants)}function Ave(t,e){if(aT(t)){const{initial:i,animate:n}=t;return{initial:i===!1||t_(i)?i:void 0,animate:t_(n)?n:void 0}}return t.inherit!==!1?e:{}}function Mve(t){const{initial:e,animate:i}=Ave(t,me.useContext(rT));return me.useMemo(()=>({initial:e,animate:i}),[JV(e),JV(i)])}function JV(t){return Array.isArray(t)?t.join(" "):t}const KV={animation:["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},i_={};for(const t in KV)i_[t]={isEnabled:e=>KV[t].some(i=>!!e[i])};function Cve(t){for(const e in t)i_[e]={...i_[e],...t[e]}}function kJ(t){const e=me.useRef(null);return e.current===null&&(e.current=t()),e.current}const $x={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Eve=1;function Tve(){return kJ(()=>{if($x.hasEverUpdated)return Eve++})}const zJ=me.createContext({}),UJ=me.createContext({}),Pve=Symbol.for("motionComponentSymbol");function Dve({preloadedFeatures:t,createVisualElement:e,useRender:i,useVisualState:n,Component:r}){t&&Cve(t);function s(a,l){let c;const h={...me.useContext(OJ),...a,layoutId:Ive(a)},{isStatic:u}=h,d=Mve(a),f=u?void 0:Tve(),p=n(a,u);if(!u&&sT){d.visualElement=bve(r,p,h,e);const m=me.useContext(UJ),g=me.useContext(FJ).strict;d.visualElement&&(c=d.visualElement.loadFeatures(h,g,t,f,m))}return me.createElement(rT.Provider,{value:d},c&&d.visualElement?me.createElement(c,{visualElement:d.visualElement,...h}):null,i(r,a,f,Sve(p,d.visualElement,l),p,u,d.visualElement))}const o=me.forwardRef(s);return o[Pve]=r,o}function Ive({layoutId:t}){const e=me.useContext(zJ).id;return e&&t!==void 0?e+"-"+t:t}function Lve(t){function e(n,r={}){return Dve(t(n,r))}if(typeof Proxy>"u")return e;const i=new Map;return new Proxy(e,{get:(n,r)=>(i.has(r)||i.set(r,e(r)),i.get(r))})}const Bve=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function FN(t){return typeof t!="string"||t.includes("-")?!1:!!(Bve.indexOf(t)>-1||/[A-Z]/.test(t))}const uC={};function Rve(t){Object.assign(uC,t)}const lT=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],rm=new Set(lT);function GJ(t,{layout:e,layoutId:i}){return rm.has(t)||t.startsWith("origin")||(e||i!==void 0)&&(!!uC[t]||t==="opacity")}const po=t=>!!(t&&t.getVelocity),Ove={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Fve=lT.length;function Nve(t,{enableHardwareAcceleration:e=!0,allowTransformNone:i=!0},n,r){let s="";for(let o=0;o<Fve;o++){const a=lT[o];if(t[a]!==void 0){const l=Ove[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(t,n?"":s):i&&n&&(s="none"),s}const VJ=t=>e=>typeof e=="string"&&e.startsWith(t),HJ=VJ("--"),vB=VJ("var(--"),kve=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Zv=(t,e,i)=>Math.min(Math.max(i,t),e),sm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},e1={...sm,transform:t=>Zv(0,1,t)},PS={...sm,default:1},t1=t=>Math.round(t*1e5)/1e5,n_=/(-)?([\d]*\.?[\d])+/g,yB=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,zve=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function cw(t){return typeof t=="string"}const uw=t=>({test:e=>cw(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Oh=uw("deg"),Sc=uw("%"),Ft=uw("px"),Uve=uw("vh"),Gve=uw("vw"),ZV={...Sc,parse:t=>Sc.parse(t)/100,transform:t=>Sc.transform(t*100)},$V={...sm,transform:Math.round},jJ={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Oh,rotateX:Oh,rotateY:Oh,rotateZ:Oh,scale:PS,scaleX:PS,scaleY:PS,scaleZ:PS,skew:Oh,skewX:Oh,skewY:Oh,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:e1,originX:ZV,originY:ZV,originZ:Ft,zIndex:$V,fillOpacity:e1,strokeOpacity:e1,numOctaves:$V};function NN(t,e,i,n){const{style:r,vars:s,transform:o,transformOrigin:a}=t;let l=!1,c=!1,h=!0;for(const u in e){const d=e[u];if(HJ(u)){s[u]=d;continue}const f=jJ[u],p=kve(d,f);if(rm.has(u)){if(l=!0,o[u]=p,!h)continue;d!==(f.default||0)&&(h=!1)}else u.startsWith("origin")?(c=!0,a[u]=p):r[u]=p}if(e.transform||(l||n?r.transform=Nve(t.transform,i,h,n):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${u} ${d} ${f}`}}const kN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function WJ(t,e,i){for(const n in e)!po(e[n])&&!GJ(n,i)&&(t[n]=e[n])}function Vve({transformTemplate:t},e,i){return me.useMemo(()=>{const n=kN();return NN(n,e,{enableHardwareAcceleration:!i},t),Object.assign({},n.vars,n.style)},[e])}function Hve(t,e,i){const n=t.style||{},r={};return WJ(r,n,t),Object.assign(r,Vve(t,e,i)),t.transformValues?t.transformValues(r):r}function jve(t,e,i){const n={},r=Hve(t,e,i);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const Wve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function hC(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||Wve.has(t)}let XJ=t=>!hC(t);function Xve(t){t&&(XJ=e=>e.startsWith("on")?!hC(e):t(e))}try{Xve(require("@emotion/is-prop-valid").default)}catch{}function qve(t,e,i){const n={};for(const r in t)r==="values"&&typeof t.values=="object"||(XJ(r)||i===!0&&hC(r)||!e&&!hC(r)||t.draggable&&r.startsWith("onDrag"))&&(n[r]=t[r]);return n}function eH(t,e,i){return typeof t=="string"?t:Ft.transform(e+i*t)}function Yve(t,e,i){const n=eH(e,t.x,t.width),r=eH(i,t.y,t.height);return`${n} ${r}`}const Qve={offset:"stroke-dashoffset",array:"stroke-dasharray"},Jve={offset:"strokeDashoffset",array:"strokeDasharray"};function Kve(t,e,i=1,n=0,r=!0){t.pathLength=1;const s=r?Qve:Jve;t[s.offset]=Ft.transform(-n);const o=Ft.transform(e),a=Ft.transform(i);t[s.array]=`${o} ${a}`}function zN(t,{attrX:e,attrY:i,originX:n,originY:r,pathLength:s,pathSpacing:o=1,pathOffset:a=0,...l},c,h,u){if(NN(t,l,c,u),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:f,dimensions:p}=t;d.transform&&(p&&(f.transform=d.transform),delete d.transform),p&&(n!==void 0||r!==void 0||f.transform)&&(f.transformOrigin=Yve(p,n!==void 0?n:.5,r!==void 0?r:.5)),e!==void 0&&(d.x=e),i!==void 0&&(d.y=i),s!==void 0&&Kve(d,s,o,a,!1)}const qJ=()=>({...kN(),attrs:{}}),UN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Zve(t,e,i,n){const r=me.useMemo(()=>{const s=qJ();return zN(s,e,{enableHardwareAcceleration:!1},UN(n),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};WJ(s,t.style,t),r.style={...s,...r.style}}return r}function $ve(t=!1){return(i,n,r,s,{latestValues:o},a)=>{const c=(FN(i)?Zve:jve)(n,o,a,i),u={...qve(n,typeof i=="string",t),...c,ref:s},{children:d}=n,f=me.useMemo(()=>po(d)?d.get():d,[d]);return r&&(u["data-projection-id"]=r),me.createElement(i,{...u,children:f})}}const GN=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function YJ(t,{style:e,vars:i},n,r){Object.assign(t.style,e,r&&r.getProjectionStyles(n));for(const s in i)t.style.setProperty(s,i[s])}const QJ=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function JJ(t,e,i,n){YJ(t,e,void 0,n);for(const r in e.attrs)t.setAttribute(QJ.has(r)?r:GN(r),e.attrs[r])}function VN(t,e){const{style:i}=t,n={};for(const r in i)(po(i[r])||e.style&&po(e.style[r])||GJ(r,t))&&(n[r]=i[r]);return n}function KJ(t,e){const i=VN(t,e);for(const n in t)if(po(t[n])||po(e[n])){const r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;i[r]=t[n]}return i}function HN(t,e,i,n={},r={}){return typeof e=="function"&&(e=e(i!==void 0?i:t.custom,n,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(i!==void 0?i:t.custom,n,r)),e}const dC=t=>Array.isArray(t),e0e=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),t0e=t=>dC(t)?t[t.length-1]||0:t;function yM(t){const e=po(t)?t.get():t;return e0e(e)?e.toValue():e}function i0e({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:i},n,r,s){const o={latestValues:n0e(n,r,s,t),renderState:e()};return i&&(o.mount=a=>i(n,a,o)),o}const ZJ=t=>(e,i)=>{const n=me.useContext(rT),r=me.useContext(BN),s=()=>i0e(t,e,n,r);return i?s():kJ(s)};function n0e(t,e,i,n){const r={},s=n(t,{});for(const d in s)r[d]=yM(s[d]);let{initial:o,animate:a}=t;const l=aT(t),c=NJ(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=i?i.initial===!1:!1;h=h||o===!1;const u=h?a:o;return u&&typeof u!="boolean"&&!oT(u)&&(Array.isArray(u)?u:[u]).forEach(f=>{const p=HN(t,f);if(!p)return;const{transitionEnd:m,transition:g,...v}=p;for(const y in v){let x=v[y];if(Array.isArray(x)){const b=h?x.length-1:0;x=x[b]}x!==null&&(r[y]=x)}for(const y in m)r[y]=m[y]}),r}const r0e={useVisualState:ZJ({scrapeMotionValuesFromProps:KJ,createRenderState:qJ,onMount:(t,e,{renderState:i,latestValues:n})=>{try{i.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}zN(i,n,{enableHardwareAcceleration:!1},UN(e.tagName),t.transformTemplate),JJ(e,i)}})},s0e={useVisualState:ZJ({scrapeMotionValuesFromProps:VN,createRenderState:kN})};function o0e(t,{forwardMotionProps:e=!1},i,n){return{...FN(t)?r0e:s0e,preloadedFeatures:i,useRender:$ve(e),createVisualElement:n,Component:t}}function Du(t,e,i,n={passive:!0}){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i)}const $J=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function cT(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const a0e=t=>e=>$J(e)&&t(e,cT(e));function Fu(t,e,i,n){return Du(t,e,a0e(i),n)}const l0e=(t,e)=>i=>e(t(i)),gd=(...t)=>t.reduce(l0e);function eK(t){let e=null;return()=>{const i=()=>{e=null};return e===null?(e=t,i):!1}}const tH=eK("dragHorizontal"),iH=eK("dragVertical");function tK(t){let e=!1;if(t==="y")e=iH();else if(t==="x")e=tH();else{const i=tH(),n=iH();i&&n?e=()=>{i(),n()}:(i&&i(),n&&n())}return e}function iK(){const t=tK(!0);return t?(t(),!1):!0}class Yd{constructor(e){this.isMounted=!1,this.node=e}update(){}}function nH(t,e){const i="pointer"+(e?"enter":"leave"),n="onHover"+(e?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||iK())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[n]&&a[n](s,o)};return Fu(t.current,i,r,{passive:!t.getProps()[n]})}class c0e extends Yd{mount(){this.unmount=gd(nH(this.node,!0),nH(this.node,!1))}unmount(){}}class u0e extends Yd{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gd(Du(this.node.current,"focus",()=>this.onFocus()),Du(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const nK=(t,e)=>e?t===e?!0:nK(t,e.parentElement):!1,Oa=t=>t;function fD(t,e){if(!e)return;const i=new PointerEvent("pointer"+t);e(i,cT(i))}class h0e extends Yd{constructor(){super(...arguments),this.removeStartListeners=Oa,this.removeEndListeners=Oa,this.removeAccessibleListeners=Oa,this.startPointerPress=(e,i)=>{if(this.removeEndListeners(),this.isPressing)return;const n=this.node.getProps(),s=Fu(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:h}=this.node.getProps();nK(this.node.current,a.target)?c&&c(a,l):h&&h(a,l)},{passive:!(n.onTap||n.onPointerUp)}),o=Fu(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=gd(s,o),this.startPress(e,i)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||fD("up",this.node.getProps().onTap)};this.removeEndListeners(),this.removeEndListeners=Du(this.node.current,"keyup",o),fD("down",(a,l)=>{this.startPress(a,l)})},i=Du(this.node.current,"keydown",e),n=()=>{this.isPressing&&fD("cancel",(s,o)=>this.cancelPress(s,o))},r=Du(this.node.current,"blur",n);this.removeAccessibleListeners=gd(i,r)}}startPress(e,i){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&n(e,i)}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!iK()}cancelPress(e,i){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&n(e,i)}mount(){const e=this.node.getProps(),i=Fu(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=Du(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=gd(i,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const xB=new WeakMap,pD=new WeakMap,d0e=t=>{const e=xB.get(t.target);e&&e(t)},f0e=t=>{t.forEach(d0e)};function p0e({root:t,...e}){const i=t||document;pD.has(i)||pD.set(i,{});const n=pD.get(i),r=JSON.stringify(e);return n[r]||(n[r]=new IntersectionObserver(f0e,{root:t,...e})),n[r]}function m0e(t,e,i){const n=p0e(e);return xB.set(t,i),n.observe(t),()=>{xB.delete(t),n.unobserve(t)}}const g0e={some:0,all:1};class v0e extends Yd{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}viewportFallback(){requestAnimationFrame(()=>{this.hasEnteredView=!0;const{onViewportEnter:e}=this.node.getProps();e&&e(null),this.node.animationState&&this.node.animationState.setActive("whileInView",!0)})}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:i,margin:n,amount:r="some",once:s,fallback:o=!0}=e;if(typeof IntersectionObserver>"u"){o&&this.viewportFallback();return}const a={root:i?i.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:g0e[r]},l=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=h?u:d;f&&f(c)};return m0e(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:i}=this.node;["amount","margin","root"].some(y0e(e,i))&&this.startObserver()}unmount(){}}function y0e({viewport:t={}},{viewport:e={}}={}){return i=>t[i]!==e[i]}const x0e={inView:{Feature:v0e},tap:{Feature:h0e},focus:{Feature:u0e},hover:{Feature:c0e}};function rK(t,e){if(!Array.isArray(e))return!1;const i=e.length;if(i!==t.length)return!1;for(let n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}const _0e=t=>/^\-?\d*\.?\d+$/.test(t),w0e=t=>/^0[^.\s]+$/.test(t),Nu={delta:0,timestamp:0},sK=1/60*1e3,b0e=typeof performance<"u"?()=>performance.now():()=>Date.now(),oK=typeof window<"u"?t=>window.requestAnimationFrame(t):t=>setTimeout(()=>t(b0e()),sK);function S0e(t){let e=[],i=[],n=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,c=!1,h=!1)=>{const u=h&&r,d=u?e:i;return c&&o.add(l),d.indexOf(l)===-1&&(d.push(l),u&&r&&(n=e.length)),l},cancel:l=>{const c=i.indexOf(l);c!==-1&&i.splice(c,1),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[e,i]=[i,e],i.length=0,n=e.length,n)for(let c=0;c<n;c++){const h=e[c];h(l),o.has(h)&&(a.schedule(h),t())}r=!1,s&&(s=!1,a.process(l))}};return a}const A0e=40;let _B=!0,r_=!1,wB=!1;const hw=["read","update","preRender","render","postRender"],uT=hw.reduce((t,e)=>(t[e]=S0e(()=>r_=!0),t),{}),Ls=hw.reduce((t,e)=>{const i=uT[e];return t[e]=(n,r=!1,s=!1)=>(r_||C0e(),i.schedule(n,r,s)),t},{}),Bd=hw.reduce((t,e)=>(t[e]=uT[e].cancel,t),{}),mD=hw.reduce((t,e)=>(t[e]=()=>uT[e].process(Nu),t),{}),M0e=t=>uT[t].process(Nu),aK=t=>{r_=!1,Nu.delta=_B?sK:Math.max(Math.min(t-Nu.timestamp,A0e),1),Nu.timestamp=t,wB=!0,hw.forEach(M0e),wB=!1,r_&&(_B=!1,oK(aK))},C0e=()=>{r_=!0,_B=!0,wB||oK(aK)};function jN(t,e){t.indexOf(e)===-1&&t.push(e)}function WN(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class XN{constructor(){this.subscriptions=[]}add(e){return jN(this.subscriptions,e),()=>WN(this.subscriptions,e)}notify(e,i,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,i,n);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,i,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function qN(t,e){return e?t*(1e3/e):0}const E0e=t=>!isNaN(parseFloat(t));class T0e{constructor(e,i={}){this.version="9.1.7",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,r=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:o}=Nu;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,Ls.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Ls.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=E0e(this.current),this.owner=i.owner}onChange(e){return this.on("change",e)}on(e,i){this.events[e]||(this.events[e]=new XN);const n=this.events[e].add(i);return e==="change"?()=>{n(),Ls.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,i){this.passiveEffect=e,this.stopPassiveEffect=i}set(e,i=!0){!i||!this.passiveEffect?this.updateAndNotify(e,i):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,i,n){this.set(i),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?qN(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=e(i)||null,this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){this.animation=null}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $v(t,e){return new T0e(t,e)}const YN=(t,e)=>i=>!!(cw(i)&&zve.test(i)&&i.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(i,e)),lK=(t,e,i)=>n=>{if(!cw(n))return n;const[r,s,o,a]=n.match(n_);return{[t]:parseFloat(r),[e]:parseFloat(s),[i]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},P0e=t=>Zv(0,255,t),gD={...sm,transform:t=>Math.round(P0e(t))},ap={test:YN("rgb","red"),parse:lK("red","green","blue"),transform:({red:t,green:e,blue:i,alpha:n=1})=>"rgba("+gD.transform(t)+", "+gD.transform(e)+", "+gD.transform(i)+", "+t1(e1.transform(n))+")"};function D0e(t){let e="",i="",n="",r="";return t.length>5?(e=t.substring(1,3),i=t.substring(3,5),n=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),i=t.substring(2,3),n=t.substring(3,4),r=t.substring(4,5),e+=e,i+=i,n+=n,r+=r),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const bB={test:YN("#"),parse:D0e,transform:ap.transform},Qg={test:YN("hsl","hue"),parse:lK("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:i,alpha:n=1})=>"hsla("+Math.round(t)+", "+Sc.transform(t1(e))+", "+Sc.transform(t1(i))+", "+t1(e1.transform(n))+")"},As={test:t=>ap.test(t)||bB.test(t)||Qg.test(t),parse:t=>ap.test(t)?ap.parse(t):Qg.test(t)?Qg.parse(t):bB.parse(t),transform:t=>cw(t)?t:t.hasOwnProperty("red")?ap.transform(t):Qg.transform(t)},cK="${c}",uK="${n}";function I0e(t){var e,i;return isNaN(t)&&cw(t)&&(((e=t.match(n_))===null||e===void 0?void 0:e.length)||0)+(((i=t.match(yB))===null||i===void 0?void 0:i.length)||0)>0}function fC(t){typeof t=="number"&&(t=`${t}`);const e=[];let i=0,n=0;const r=t.match(yB);r&&(i=r.length,t=t.replace(yB,cK),e.push(...r.map(As.parse)));const s=t.match(n_);return s&&(n=s.length,t=t.replace(n_,uK),e.push(...s.map(sm.parse))),{values:e,numColors:i,numNumbers:n,tokenised:t}}function hK(t){return fC(t).values}function dK(t){const{values:e,numColors:i,tokenised:n}=fC(t),r=e.length;return s=>{let o=n;for(let a=0;a<r;a++)o=o.replace(a<i?cK:uK,a<i?As.transform(s[a]):t1(s[a]));return o}}const L0e=t=>typeof t=="number"?0:t;function B0e(t){const e=hK(t);return dK(t)(e.map(L0e))}const Rd={test:I0e,parse:hK,createTransformer:dK,getAnimatableNone:B0e},R0e=new Set(["brightness","contrast","saturate","opacity"]);function O0e(t){const[e,i]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=i.match(n_)||[];if(!n)return t;const r=i.replace(n,"");let s=R0e.has(e)?1:0;return n!==i&&(s*=100),e+"("+s+r+")"}const F0e=/([a-z-]*)\(.*?\)/g,SB={...Rd,getAnimatableNone:t=>{const e=t.match(F0e);return e?e.map(O0e).join(" "):t}},N0e={...jJ,color:As,backgroundColor:As,outlineColor:As,fill:As,stroke:As,borderColor:As,borderTopColor:As,borderRightColor:As,borderBottomColor:As,borderLeftColor:As,filter:SB,WebkitFilter:SB},QN=t=>N0e[t];function JN(t,e){let i=QN(t);return i!==SB&&(i=Rd),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const fK=t=>e=>e.test(t),k0e={test:t=>t==="auto",parse:t=>t},pK=[sm,Ft,Sc,Oh,Gve,Uve,k0e],Uy=t=>pK.find(fK(t)),z0e=[...pK,As,Rd],U0e=t=>z0e.find(fK(t));function G0e(t){const e={};return t.values.forEach((i,n)=>e[n]=i.get()),e}function V0e(t){const e={};return t.values.forEach((i,n)=>e[n]=i.getVelocity()),e}function hT(t,e,i){const n=t.getProps();return HN(n,e,i!==void 0?i:n.custom,G0e(t),V0e(t))}function H0e(t,e,i){t.hasValue(e)?t.getValue(e).set(i):t.addValue(e,$v(i))}function j0e(t,e){const i=hT(t,e);let{transitionEnd:n={},transition:r={},...s}=i?t.makeTargetAnimatable(i,!1):{};s={...s,...n};for(const o in s){const a=t0e(s[o]);H0e(t,o,a)}}function W0e(t,e,i){var n,r;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],c=e[l];let h=null;Array.isArray(c)&&(h=c[0]),h===null&&(h=(r=(n=i[l])!==null&&n!==void 0?n:t.readValue(l))!==null&&r!==void 0?r:e[l]),h!=null&&(typeof h=="string"&&(_0e(h)||w0e(h))?h=parseFloat(h):!U0e(h)&&Rd.test(c)&&(h=JN(l,c)),t.addValue(l,$v(h,{owner:t})),i[l]===void 0&&(i[l]=h),h!==null&&t.setBaseTarget(l,h))}}function X0e(t,e){return e?(e[t]||e.default||e).from:void 0}function q0e(t,e,i){const n={};for(const r in t){const s=X0e(r,e);if(s!==void 0)n[r]=s;else{const o=i.getValue(r);o&&(n[r]=o.get())}}return n}function pC(t){return!!(po(t)&&t.add)}const Y0e="framerAppearId",Q0e="data-"+GN(Y0e);let J0e=Oa,mC=Oa;const xM=t=>t*1e3,K0e={current:!1},KN=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,ZN=t=>e=>1-t(1-e),$N=t=>t*t,Z0e=ZN($N),ek=KN($N),hn=(t,e,i)=>-i*t+i*e+t;function vD(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function $0e({hue:t,saturation:e,lightness:i,alpha:n}){t/=360,e/=100,i/=100;let r=0,s=0,o=0;if(!e)r=s=o=i;else{const a=i<.5?i*(1+e):i+e-i*e,l=2*i-a;r=vD(l,a,t+1/3),s=vD(l,a,t),o=vD(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:n}}const yD=(t,e,i)=>{const n=t*t;return Math.sqrt(Math.max(0,i*(e*e-n)+n))},eye=[bB,ap,Qg],tye=t=>eye.find(e=>e.test(t));function rH(t){const e=tye(t);let i=e.parse(t);return e===Qg&&(i=$0e(i)),i}const mK=(t,e)=>{const i=rH(t),n=rH(e),r={...i};return s=>(r.red=yD(i.red,n.red,s),r.green=yD(i.green,n.green,s),r.blue=yD(i.blue,n.blue,s),r.alpha=hn(i.alpha,n.alpha,s),ap.transform(r))};function gK(t,e){return typeof t=="number"?i=>hn(t,e,i):As.test(t)?mK(t,e):yK(t,e)}const vK=(t,e)=>{const i=[...t],n=i.length,r=t.map((s,o)=>gK(s,e[o]));return s=>{for(let o=0;o<n;o++)i[o]=r[o](s);return i}},iye=(t,e)=>{const i={...t,...e},n={};for(const r in i)t[r]!==void 0&&e[r]!==void 0&&(n[r]=gK(t[r],e[r]));return r=>{for(const s in n)i[s]=n[s](r);return i}},yK=(t,e)=>{const i=Rd.createTransformer(e),n=fC(t),r=fC(e);return n.numColors===r.numColors&&n.numNumbers>=r.numNumbers?gd(vK(n.values,r.values),i):o=>`${o>0?e:t}`},s_=(t,e,i)=>{const n=e-t;return n===0?1:(i-t)/n},sH=(t,e)=>i=>hn(t,e,i);function nye(t){return typeof t=="number"?sH:typeof t=="string"?As.test(t)?mK:yK:Array.isArray(t)?vK:typeof t=="object"?iye:sH}function rye(t,e,i){const n=[],r=i||nye(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]:e;a=gd(l,a)}n.push(a)}return n}function xK(t,e,{clamp:i=!0,ease:n,mixer:r}={}){const s=t.length;mC(s===e.length),mC(!n||!Array.isArray(n)||n.length===s-1),t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=rye(e,n,r),a=o.length,l=c=>{let h=0;if(a>1)for(;h<t.length-2&&!(c<t[h+1]);h++);const u=s_(t[h],t[h+1],c);return o[h](u)};return i?c=>l(Zv(t[0],t[s-1],c)):l}function sye(t,e){const i=t[t.length-1];for(let n=1;n<=e;n++){const r=s_(0,e,n);t.push(hn(i,1,r))}}function oye(t){const e=[0];return sye(e,t.length-1),e}function aye(t,e){return t.map(i=>i*e)}const _K=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t,lye=1e-7,cye=12;function uye(t,e,i,n,r){let s,o,a=0;do o=e+(i-e)/2,s=_K(o,n,r)-t,s>0?i=o:e=o;while(Math.abs(s)>lye&&++a<cye);return o}function wK(t,e,i,n){if(t===e&&i===n)return Oa;const r=s=>uye(s,0,1,t,i);return s=>s===0||s===1?s:_K(r(s),e,n)}const bK=t=>1-Math.sin(Math.acos(t)),tk=ZN(bK),hye=KN(tk),SK=wK(.33,1.53,.69,.99),ik=ZN(SK),dye=KN(ik),fye=t=>(t*=2)<1?.5*ik(t):.5*(2-Math.pow(2,-10*(t-1))),pye={linear:Oa,easeIn:$N,easeInOut:ek,easeOut:Z0e,circIn:bK,circInOut:hye,circOut:tk,backIn:ik,backInOut:dye,backOut:SK,anticipate:fye},oH=t=>{if(Array.isArray(t)){mC(t.length===4);const[e,i,n,r]=t;return wK(e,i,n,r)}else if(typeof t=="string")return pye[t];return t},mye=t=>Array.isArray(t)&&typeof t[0]!="number";function gye(t,e){return t.map(()=>e||ek).splice(0,t.length-1)}function AB({keyframes:t,ease:e=ek,times:i,duration:n=300}){t=[...t];const r=mye(e)?e.map(oH):oH(e),s={done:!1,value:t[0]},o=aye(i&&i.length===t.length?i:oye(t),n);function a(){return xK(o,t,{ease:Array.isArray(r)?r:gye(t,r)})}let l=a();return{next:c=>(s.value=l(c),s.done=c>=n,s),flipTarget:()=>{t.reverse(),l=a()}}}const xD=.001,vye=.01,aH=10,yye=.05,xye=1;function _ye({duration:t=800,bounce:e=.25,velocity:i=0,mass:n=1}){let r,s;J0e(t<=aH*1e3);let o=1-e;o=Zv(yye,xye,o),t=Zv(vye,aH,t/1e3),o<1?(r=c=>{const h=c*o,u=h*t,d=h-i,f=MB(c,o),p=Math.exp(-u);return xD-d/f*p},s=c=>{const u=c*o*t,d=u*i+i,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),m=MB(Math.pow(c,2),o);return(-r(c)+xD>0?-1:1)*((d-f)*p)/m}):(r=c=>{const h=Math.exp(-c*t),u=(c-i)*t+1;return-xD+h*u},s=c=>{const h=Math.exp(-c*t),u=(i-c)*(t*t);return h*u});const a=5/t,l=bye(r,s,a);if(t=t*1e3,isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const wye=12;function bye(t,e,i){let n=i;for(let r=1;r<wye;r++)n=n-t(n)/e(n);return n}function MB(t,e){return t*Math.sqrt(1-e*e)}const Sye=["duration","bounce"],Aye=["stiffness","damping","mass"];function lH(t,e){return e.some(i=>t[i]!==void 0)}function Mye(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!lH(t,Aye)&&lH(t,Sye)){const i=_ye(t);e={...e,...i,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}const Cye=5;function AK({keyframes:t,restDelta:e,restSpeed:i,...n}){let r=t[0],s=t[t.length-1];const o={done:!1,value:r},{stiffness:a,damping:l,mass:c,velocity:h,duration:u,isResolvedFromDuration:d}=Mye(n);let f=Eye,p=h?-(h/1e3):0;const m=l/(2*Math.sqrt(a*c));function g(){const v=s-r,y=Math.sqrt(a/c)/1e3,x=Math.abs(v)<5;if(i||(i=x?.01:2),e||(e=x?.005:.5),m<1){const b=MB(y,m);f=S=>{const A=Math.exp(-m*y*S);return s-A*((p+m*y*v)/b*Math.sin(b*S)+v*Math.cos(b*S))}}else if(m===1)f=b=>s-Math.exp(-y*b)*(v+(p+y*v)*b);else{const b=y*Math.sqrt(m*m-1);f=S=>{const A=Math.exp(-m*y*S),E=Math.min(b*S,300);return s-A*((p+m*y*v)*Math.sinh(E)+b*v*Math.cosh(E))/b}}}return g(),{next:v=>{const y=f(v);if(d)o.done=v>=u;else{let x=p;if(v!==0)if(m<1){const A=Math.max(0,v-Cye);x=qN(y-f(A),v-A)}else x=0;const b=Math.abs(x)<=i,S=Math.abs(s-y)<=e;o.done=b&&S}return o.value=o.done?s:y,o},flipTarget:()=>{p=-p,[r,s]=[s,r],g()}}}AK.needsInterpolation=(t,e)=>typeof t=="string"||typeof e=="string";const Eye=t=>0;function Tye({keyframes:t=[0],velocity:e=0,power:i=.8,timeConstant:n=350,restDelta:r=.5,modifyTarget:s}){const o=t[0],a={done:!1,value:o};let l=i*e;const c=o+l,h=s===void 0?c:s(c);return h!==c&&(l=h-o),{next:u=>{const d=-l*Math.exp(-u/n);return a.done=!(d>r||d<-r),a.value=a.done?h:h+d,a},flipTarget:()=>{}}}const Pye={decay:Tye,keyframes:AB,tween:AB,spring:AK};function MK(t,e,i=0){return t-e-i}function Dye(t,e=0,i=0,n=!0){return n?MK(e+-t,e,i):e-(t-e)+i}function Iye(t,e,i,n){return n?t>=e+i:t<=-i}const Lye=t=>{const e=({delta:i})=>t(i);return{start:()=>Ls.update(e,!0),stop:()=>Bd.update(e)}};function gC({duration:t,driver:e=Lye,elapsed:i=0,repeat:n=0,repeatType:r="loop",repeatDelay:s=0,keyframes:o,autoplay:a=!0,onPlay:l,onStop:c,onComplete:h,onRepeat:u,onUpdate:d,type:f="keyframes",...p}){const m=i;let g,v=0,y=t,x=!1,b=!0,S;const A=Pye[o.length>2?"keyframes":f]||AB,E=o[0],M=o[o.length-1];let T={done:!1,value:E};const{needsInterpolation:P}=A;P&&P(E,M)&&(S=xK([0,100],[E,M],{clamp:!1}),o=[0,100]);const I=A({...p,duration:t,keyframes:o});function k(){v++,r==="reverse"?(b=v%2===0,i=Dye(i,y,s,b)):(i=MK(i,y,s),r==="mirror"&&I.flipTarget()),x=!1,u&&u()}function R(){g&&g.stop(),h&&h()}function F(Q){b||(Q=-Q),i+=Q,x||(T=I.next(Math.max(0,i)),S&&(T.value=S(T.value)),x=b?T.done:i<=0),d&&d(T.value),x&&(v===0&&(y=y!==void 0?y:i),v<n?Iye(i,y,s,b)&&k():R())}function V(){l&&l(),g=e(F),g.start()}return a&&V(),{stop:()=>{c&&c(),g&&g.stop()},set currentTime(Q){i=m,F(Q)},sample:Q=>{i=m;const X=t&&typeof t=="number"?Math.max(t*.5,50):50;let z=0;for(F(0);z<=Q;){const Y=Q-z;F(Math.min(Y,X)),z+=X}return T}}}function Bye(t){return!t||Array.isArray(t)||typeof t=="string"&&CK[t]}const Tx=([t,e,i,n])=>`cubic-bezier(${t}, ${e}, ${i}, ${n})`,CK={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Tx([0,.65,.55,1]),circOut:Tx([.55,0,1,.45]),backIn:Tx([.31,.01,.66,-.59]),backOut:Tx([.33,1.53,.69,.99])};function Rye(t){if(t)return Array.isArray(t)?Tx(t):CK[t]}function Oye(t,e,i,{delay:n=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){return t.animate({[e]:i,offset:l},{delay:n,duration:r,easing:Rye(a),fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const cH={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},_D={},EK={};for(const t in cH)EK[t]=()=>(_D[t]===void 0&&(_D[t]=cH[t]()),_D[t]);function Fye(t,{repeat:e,repeatType:i="loop"}){const n=e&&i!=="loop"&&e%2===1?0:t.length-1;return t[n]}const Nye=new Set(["opacity","clipPath","filter","transform"]),DS=10;function kye(t,e,{onUpdate:i,onComplete:n,...r}){if(!(EK.waapi()&&Nye.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0))return!1;let{keyframes:o,duration:a=300,elapsed:l=0,ease:c}=r;if(r.type==="spring"||!Bye(r.ease)){if(r.repeat===1/0)return;const u=gC({...r,elapsed:0});let d={done:!1,value:o[0]};const f=[];let p=0;for(;!d.done&&p<2e4;)d=u.sample(p),f.push(d.value),p+=DS;o=f,a=p-DS,c="linear"}const h=Oye(t.owner.current,e,o,{...r,delay:-l,duration:a,ease:c});return h.onfinish=()=>{t.set(Fye(o,r)),Ls.update(()=>h.cancel()),n&&n()},{get currentTime(){return h.currentTime||0},set currentTime(u){h.currentTime=u},stop:()=>{const{currentTime:u}=h;if(u){const d=gC({...r,autoplay:!1});t.setWithVelocity(d.sample(u-DS).value,d.sample(u).value,DS)}Ls.update(()=>h.cancel())}}}function TK(t,e){const i=performance.now(),n=({timestamp:r})=>{const s=r-i;s>=e&&(Bd.read(n),t(s-e))};return Ls.read(n,!0),()=>Bd.read(n)}function zye({keyframes:t,elapsed:e,onUpdate:i,onComplete:n}){const r=()=>{i&&i(t[t.length-1]),n&&n()};return e?{stop:TK(r,-e)}:r()}function Uye({keyframes:t,velocity:e=0,min:i,max:n,power:r=.8,timeConstant:s=750,bounceStiffness:o=500,bounceDamping:a=10,restDelta:l=1,modifyTarget:c,driver:h,onUpdate:u,onComplete:d,onStop:f}){const p=t[0];let m;function g(b){return i!==void 0&&b<i||n!==void 0&&b>n}function v(b){return i===void 0?n:n===void 0||Math.abs(i-b)<Math.abs(n-b)?i:n}function y(b){m&&m.stop(),m=gC({keyframes:[0,1],velocity:0,...b,driver:h,onUpdate:S=>{u&&u(S),b.onUpdate&&b.onUpdate(S)},onComplete:d,onStop:f})}function x(b){y({type:"spring",stiffness:o,damping:a,restDelta:l,...b})}if(g(p))x({velocity:e,keyframes:[p,v(p)]});else{let b=r*e+p;typeof c<"u"&&(b=c(b));const S=v(b),A=S===i?-1:1;let E,M;const T=P=>{E=M,M=P,e=qN(P-E,Nu.delta),(A===1&&P>S||A===-1&&P<S)&&x({keyframes:[P,S],velocity:e})};y({type:"decay",keyframes:[p,0],velocity:e,timeConstant:s,power:r,restDelta:l,modifyTarget:c,onUpdate:g(b)?T:void 0})}return{stop:()=>m&&m.stop()}}const Gye={type:"spring",stiffness:500,damping:25,restSpeed:10},Vye=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Hye={type:"keyframes",duration:.8},jye={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Wye=(t,{keyframes:e})=>e.length>2?Hye:rm.has(t)?t.startsWith("scale")?Vye(e[1]):Gye:jye,CB=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&Rd.test(e)&&!e.startsWith("url("));function Xye({when:t,delay:e,delayChildren:i,staggerChildren:n,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}function uH(t){return t===0||typeof t=="string"&&parseFloat(t)===0&&t.indexOf(" ")===-1}function hH(t){return typeof t=="number"?0:JN("",t)}function PK(t,e){return t[e]||t.default||t}function qye(t,e,i,n){const r=CB(e,i);let s=n.from!==void 0?n.from:t.get();return s==="none"&&r&&typeof i=="string"?s=JN(e,i):uH(s)&&typeof i=="string"?s=hH(i):!Array.isArray(i)&&uH(i)&&typeof s=="string"&&(i=hH(s)),Array.isArray(i)?(i[0]===null&&(i[0]=s),i):[s,i]}const nk=(t,e,i,n={})=>r=>{const s=PK(n,t)||{},o=s.delay||n.delay||0;let{elapsed:a=0}=n;a=a-xM(o);const l=qye(e,t,i,s),c=l[0],h=l[l.length-1],u=CB(t,c),d=CB(t,h);let f={keyframes:l,velocity:e.getVelocity(),...s,elapsed:a,onUpdate:p=>{e.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(!u||!d||K0e.current||s.type===!1)return zye(f);if(s.type==="inertia")return Uye(f);if(Xye(s)||(f={...f,...Wye(t,f)}),f.duration&&(f.duration=xM(f.duration)),f.repeatDelay&&(f.repeatDelay=xM(f.repeatDelay)),e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const p=kye(e,t,f);if(p)return p}return gC(f)};function Yye(t,e,i={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const r=e.map(s=>EB(t,s,i));n=Promise.all(r)}else if(typeof e=="string")n=EB(t,e,i);else{const r=typeof e=="function"?hT(t,e,i.custom):e;n=DK(t,r,i)}return n.then(()=>t.notify("AnimationComplete",e))}function EB(t,e,i={}){const n=hT(t,e,i.custom);let{transition:r=t.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(r=i.transitionOverride);const s=n?()=>DK(t,n,i):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:u}=r;return Qye(t,e,c+l,h,u,i)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(c)}else return Promise.all([s(),o(i.delay)])}function DK(t,e,{delay:i=0,transitionOverride:n,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");n&&(s=n);const c=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const u in a){const d=t.getValue(u),f=a[u];if(!d||f===void 0||h&&Kye(h,u))continue;const p={delay:i,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const g=t.getProps()[Q0e];g&&(p.elapsed=window.HandoffAppearAnimations(g,u,d,Ls))}let m=d.start(nk(u,d,f,t.shouldReduceMotion&&rm.has(u)?{type:!1}:p));pC(l)&&(l.add(u),m=m.then(()=>l.remove(u))),c.push(m)}return Promise.all(c).then(()=>{o&&j0e(t,o)})}function Qye(t,e,i=0,n=0,r=1,s){const o=[],a=(t.variantChildren.size-1)*n,l=r===1?(c=0)=>c*n:(c=0)=>a-c*n;return Array.from(t.variantChildren).sort(Jye).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(EB(c,e,{...s,delay:i+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Jye(t,e){return t.sortNodePosition(e)}function Kye({protectedKeys:t,needsAnimating:e},i){const n=t.hasOwnProperty(i)&&e[i]!==!0;return e[i]=!1,n}const Zye=[...RN].reverse(),$ye=RN.length;function exe(t){return e=>Promise.all(e.map(({animation:i,options:n})=>Yye(t,i,n)))}function txe(t){let e=exe(t);const i=nxe();let n=!0;const r=(l,c)=>{const h=hT(t,c);if(h){const{transition:u,transitionEnd:d,...f}=h;l={...l,...f,...d}}return l};function s(l){e=l(t)}function o(l,c){const h=t.getProps(),u=t.getVariantContext(!0)||{},d=[],f=new Set;let p={},m=1/0;for(let v=0;v<$ye;v++){const y=Zye[v],x=i[y],b=h[y]!==void 0?h[y]:u[y],S=t_(b),A=y===c?x.isActive:null;A===!1&&(m=v);let E=b===u[y]&&b!==h[y]&&S;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),x.protectedKeys={...p},!x.isActive&&A===null||!b&&!x.prevProp||oT(b)||typeof b=="boolean")continue;const M=ixe(x.prevProp,b);let T=M||y===c&&x.isActive&&!E&&S||v>m&&S;const P=Array.isArray(b)?b:[b];let I=P.reduce(r,{});A===!1&&(I={});const{prevResolvedValues:k={}}=x,R={...k,...I},F=V=>{T=!0,f.delete(V),x.needsAnimating[V]=!0};for(const V in R){const Q=I[V],X=k[V];p.hasOwnProperty(V)||(Q!==X?dC(Q)&&dC(X)?!rK(Q,X)||M?F(V):x.protectedKeys[V]=!0:Q!==void 0?F(V):f.add(V):Q!==void 0&&f.has(V)?F(V):x.protectedKeys[V]=!0)}x.prevProp=b,x.prevResolvedValues=I,x.isActive&&(p={...p,...I}),n&&t.blockInitialAnimation&&(T=!1),T&&!E&&d.push(...P.map(V=>({animation:V,options:{type:y,...l}})))}if(f.size){const v={};f.forEach(y=>{const x=t.getBaseTarget(y);x!==void 0&&(v[y]=x)}),d.push({animation:v})}let g=!!d.length;return n&&h.initial===!1&&!t.manuallyAnimateOnMount&&(g=!1),n=!1,g?e(d):Promise.resolve()}function a(l,c,h){var u;if(i[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),i[l].isActive=c;const d=o(h,l);for(const f in i)i[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>i}}function ixe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!rK(e,t):!1}function wf(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function nxe(){return{animate:wf(!0),whileInView:wf(),whileHover:wf(),whileTap:wf(),whileDrag:wf(),whileFocus:wf(),exit:wf()}}class rxe extends Yd{constructor(e){super(e),e.animationState||(e.animationState=txe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),oT(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:i}=this.node.prevProps||{};e!==i&&this.updateAnimationControlsSubscription()}unmount(){}}let sxe=0;class oxe extends Yd{constructor(){super(...arguments),this.id=sxe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:i,custom:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e,{custom:n??this.node.getProps().custom});i&&!e&&s.then(()=>i(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const axe={animation:{Feature:rxe},exit:{Feature:oxe}},dH=(t,e)=>Math.abs(t-e);function lxe(t,e){const i=dH(t.x,e.x),n=dH(t.y,e.y);return Math.sqrt(i**2+n**2)}class IK{constructor(e,i,{transformPagePoint:n}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=bD(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,u=lxe(c.offset,{x:0,y:0})>=3;if(!h&&!u)return;const{point:d}=c,{timestamp:f}=Nu;this.history.push({...d,timestamp:f});const{onStart:p,onMove:m}=this.handlers;h||(p&&p(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,c)},this.handlePointerMove=(c,h)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=wD(h,this.transformPagePoint),Ls.update(this.updatePoint,!0)},this.handlePointerUp=(c,h)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:u,onSessionEnd:d}=this.handlers,f=bD(c.type==="pointercancel"?this.lastMoveEventInfo:wD(h,this.transformPagePoint),this.history);this.startEvent&&u&&u(c,f),d&&d(c,f)},!$J(e))return;this.handlers=i,this.transformPagePoint=n;const r=cT(e),s=wD(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=Nu;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=i;l&&l(e,bD(s,this.history)),this.removeListeners=gd(Fu(window,"pointermove",this.handlePointerMove),Fu(window,"pointerup",this.handlePointerUp),Fu(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Bd.update(this.updatePoint)}}function wD(t,e){return e?{point:e(t.point)}:t}function fH(t,e){return{x:t.x-e.x,y:t.y-e.y}}function bD({point:t},e){return{point:t,delta:fH(t,LK(e)),offset:fH(t,cxe(e)),velocity:uxe(e,.1)}}function cxe(t){return t[0]}function LK(t){return t[t.length-1]}function uxe(t,e){if(t.length<2)return{x:0,y:0};let i=t.length-1,n=null;const r=LK(t);for(;i>=0&&(n=t[i],!(r.timestamp-n.timestamp>xM(e)));)i--;if(!n)return{x:0,y:0};const s=(r.timestamp-n.timestamp)/1e3;if(s===0)return{x:0,y:0};const o={x:(r.x-n.x)/s,y:(r.y-n.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Wo(t){return t.max-t.min}function TB(t,e=0,i=.01){return Math.abs(t-e)<=i}function pH(t,e,i,n=.5){t.origin=n,t.originPoint=hn(e.min,e.max,t.origin),t.scale=Wo(i)/Wo(e),(TB(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=hn(i.min,i.max,t.origin)-t.originPoint,(TB(t.translate)||isNaN(t.translate))&&(t.translate=0)}function i1(t,e,i,n){pH(t.x,e.x,i.x,n?n.originX:void 0),pH(t.y,e.y,i.y,n?n.originY:void 0)}function mH(t,e,i){t.min=i.min+e.min,t.max=t.min+Wo(e)}function hxe(t,e,i){mH(t.x,e.x,i.x),mH(t.y,e.y,i.y)}function gH(t,e,i){t.min=e.min-i.min,t.max=t.min+Wo(e)}function n1(t,e,i){gH(t.x,e.x,i.x),gH(t.y,e.y,i.y)}function dxe(t,{min:e,max:i},n){return e!==void 0&&t<e?t=n?hn(e,t,n.min):Math.max(t,e):i!==void 0&&t>i&&(t=n?hn(i,t,n.max):Math.min(t,i)),t}function vH(t,e,i){return{min:e!==void 0?t.min+e:void 0,max:i!==void 0?t.max+i-(t.max-t.min):void 0}}function fxe(t,{top:e,left:i,bottom:n,right:r}){return{x:vH(t.x,i,r),y:vH(t.y,e,n)}}function yH(t,e){let i=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([i,n]=[n,i]),{min:i,max:n}}function pxe(t,e){return{x:yH(t.x,e.x),y:yH(t.y,e.y)}}function mxe(t,e){let i=.5;const n=Wo(t),r=Wo(e);return r>n?i=s_(e.min,e.max-n,t.min):n>r&&(i=s_(t.min,t.max-r,e.min)),Zv(0,1,i)}function gxe(t,e){const i={};return e.min!==void 0&&(i.min=e.min-t.min),e.max!==void 0&&(i.max=e.max-t.min),i}const PB=.35;function vxe(t=PB){return t===!1?t=0:t===!0&&(t=PB),{x:xH(t,"left","right"),y:xH(t,"top","bottom")}}function xH(t,e,i){return{min:_H(t,e),max:_H(t,i)}}function _H(t,e){return typeof t=="number"?t:t[e]||0}const wH=()=>({translate:0,scale:1,origin:0,originPoint:0}),r1=()=>({x:wH(),y:wH()}),bH=()=>({min:0,max:0}),qn=()=>({x:bH(),y:bH()});function oc(t){return[t("x"),t("y")]}function BK({top:t,left:e,right:i,bottom:n}){return{x:{min:e,max:i},y:{min:t,max:n}}}function yxe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function xxe(t,e){if(!e)return t;const i=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:i.y,left:i.x,bottom:n.y,right:n.x}}function SD(t){return t===void 0||t===1}function DB({scale:t,scaleX:e,scaleY:i}){return!SD(t)||!SD(e)||!SD(i)}function Nf(t){return DB(t)||RK(t)||t.z||t.rotate||t.rotateX||t.rotateY}function RK(t){return SH(t.x)||SH(t.y)}function SH(t){return t&&t!=="0%"}function vC(t,e,i){const n=t-i,r=e*n;return i+r}function AH(t,e,i,n,r){return r!==void 0&&(t=vC(t,r,n)),vC(t,i,n)+e}function IB(t,e=0,i=1,n,r){t.min=AH(t.min,e,i,n,r),t.max=AH(t.max,e,i,n,r)}function OK(t,{x:e,y:i}){IB(t.x,e.translate,e.scale,e.originPoint),IB(t.y,i.translate,i.scale,i.originPoint)}function _xe(t,e,i,n=!1){const r=i.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=i[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Jg(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,OK(t,o)),n&&Nf(s.latestValues)&&Jg(t,s.latestValues))}e.x=MH(e.x),e.y=MH(e.y)}function MH(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Uh(t,e){t.min=t.min+e,t.max=t.max+e}function CH(t,e,[i,n,r]){const s=e[r]!==void 0?e[r]:.5,o=hn(t.min,t.max,s);IB(t,e[i],e[n],o,e.scale)}const wxe=["x","scaleX","originX"],bxe=["y","scaleY","originY"];function Jg(t,e){CH(t.x,e,wxe),CH(t.y,e,bxe)}function FK(t,e){return BK(xxe(t.getBoundingClientRect(),e))}function Sxe(t,e,i){const n=FK(t,i),{scroll:r}=e;return r&&(Uh(n.x,r.offset.x),Uh(n.y,r.offset.y)),n}const Axe=new WeakMap;class Mxe{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=qn(),this.visualElement=e}start(e,{snapToCursor:i=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const r=l=>{this.stopAnimation(),i&&this.snapToCursor(cT(l,"page").point)},s=(l,c)=>{const{drag:h,dragPropagation:u,onDragStart:d}=this.getProps();if(h&&!u&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=tK(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),oc(p=>{let m=this.getAxisMotionValue(p).get()||0;if(Sc.test(m)){const{projection:g}=this.visualElement;if(g&&g.layout){const v=g.layout.layoutBox[p];v&&(m=Wo(v)*(parseFloat(m)/100))}}this.originPoint[p]=m}),d&&d(l,c);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,c)=>{const{dragPropagation:h,dragDirectionLock:u,onDirectionLock:d,onDrag:f}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:p}=c;if(u&&this.currentDirection===null){this.currentDirection=Cxe(p),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,p),this.updateAxis("y",c.point,p),this.visualElement.render(),f&&f(l,c)},a=(l,c)=>this.stop(l,c);this.panSession=new IK(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,i){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=i;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&s(e,i)}cancel(){this.isDragging=!1;const{projection:e,animationState:i}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(e,i,n){const{drag:r}=this.getProps();if(!n||!IS(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=dxe(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:i}=this.getProps(),{layout:n}=this.visualElement.projection||{},r=this.constraints;e&&Yg(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=fxe(n.layoutBox,e):this.constraints=!1,this.elastic=vxe(i),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&oc(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=gxe(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:i}=this.getProps();if(!e||!Yg(e))return!1;const n=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Sxe(n,r.root,this.visualElement.getTransformPagePoint());let o=pxe(r.layout.layoutBox,s);if(i){const a=i(yxe(o));this.hasMutatedConstraints=!!a,a&&(o=BK(a))}return o}startAnimation(e){const{drag:i,dragMomentum:n,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=oc(h=>{if(!IS(h,i,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:n?e[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(h,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,i){const n=this.getAxisMotionValue(e);return n.start(nk(e,n,0,i))}stopAnimation(){oc(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const i="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),r=n[i];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){oc(i=>{const{drag:n}=this.getProps();if(!IS(i,n,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(i);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[i];s.set(e[i]-hn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:i}=this.getProps(),{projection:n}=this.visualElement;if(!Yg(i)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};oc(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=mxe({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),oc(o=>{if(!IS(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(hn(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;Axe.set(this.visualElement,this);const e=this.visualElement.current,i=Fu(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Yg(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),n();const o=Du(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(oc(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),i(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=PB,dragMomentum:a=!0}=e;return{...e,drag:i,dragDirectionLock:n,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function IS(t,e,i){return(e===!0||e===t)&&(i===null||i===t)}function Cxe(t,e=10){let i=null;return Math.abs(t.y)>e?i="y":Math.abs(t.x)>e&&(i="x"),i}class Exe extends Yd{constructor(e){super(e),this.removeGroupControls=Oa,this.removeListeners=Oa,this.controls=new Mxe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Oa}unmount(){this.removeGroupControls(),this.removeListeners()}}class Txe extends Yd{constructor(){super(...arguments),this.removePointerDownListener=Oa}onPointerDown(e){this.session=new IK(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:i,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:e,onStart:i,onMove:n,onEnd:(s,o)=>{delete this.session,r&&r(s,o)}}}mount(){this.removePointerDownListener=Fu(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Pxe(){const t=me.useContext(BN);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:i,register:n}=t,r=me.useId();return me.useEffect(()=>n(r),[]),!e&&i?[!1,()=>i&&i(r)]:[!0]}function EH(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Gy={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ft.test(t))t=parseFloat(t);else return t;const i=EH(t,e.target.x),n=EH(t,e.target.y);return`${i}% ${n}%`}},NK=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Dxe(t){const e=NK.exec(t);if(!e)return[,];const[,i,n]=e;return[i,n]}function LB(t,e,i=1){const[n,r]=Dxe(t);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);return s?s.trim():vB(r)?LB(r,e,i+1):r}function Ixe(t,{...e},i){const n=t.current;if(!(n instanceof Element))return{target:e,transitionEnd:i};i&&(i={...i}),t.values.forEach(r=>{const s=r.get();if(!vB(s))return;const o=LB(s,n);o&&r.set(o)});for(const r in e){const s=e[r];if(!vB(s))continue;const o=LB(s,n);o&&(e[r]=o,i&&i[r]===void 0&&(i[r]=s))}return{target:e,transitionEnd:i}}const TH="_$css",Lxe={correct:(t,{treeScale:e,projectionDelta:i})=>{const n=t,r=t.includes("var("),s=[];r&&(t=t.replace(NK,f=>(s.push(f),TH)));const o=Rd.parse(t);if(o.length>5)return n;const a=Rd.createTransformer(t),l=typeof o[0]!="number"?1:0,c=i.x.scale*e.x,h=i.y.scale*e.y;o[0+l]/=c,o[1+l]/=h;const u=hn(c,h,.5);typeof o[2+l]=="number"&&(o[2+l]/=u),typeof o[3+l]=="number"&&(o[3+l]/=u);let d=a(o);if(r){let f=0;d=d.replace(TH,()=>{const p=s[f];return f++,p})}return d}};class Bxe extends w0.Component{componentDidMount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:n,layoutId:r}=this.props,{projection:s}=e;Rve(Rxe),s&&(i.group&&i.group.add(s),n&&n.register&&r&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),$x.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:i,visualElement:n,drag:r,isPresent:s}=this.props,o=n.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==i||i===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||Ls.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),!e.currentAnimation&&e.isLead()&&this.safeToRemove())}componentWillUnmount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:n}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function kK(t){const[e,i]=Pxe(),n=me.useContext(zJ);return w0.createElement(Bxe,{...t,layoutGroup:n,switchLayoutGroup:me.useContext(UJ),isPresent:e,safeToRemove:i})}const Rxe={borderRadius:{...Gy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gy,borderTopRightRadius:Gy,borderBottomLeftRadius:Gy,borderBottomRightRadius:Gy,boxShadow:Lxe};function Oxe(t,e,i={}){const n=po(t)?t:$v(t);return n.start(nk("",n,e,i)),{stop:()=>n.stop(),isAnimating:()=>n.isAnimating()}}const zK=["TopLeft","TopRight","BottomLeft","BottomRight"],Fxe=zK.length,PH=t=>typeof t=="string"?parseFloat(t):t,DH=t=>typeof t=="number"||Ft.test(t);function Nxe(t,e,i,n,r,s){r?(t.opacity=hn(0,i.opacity!==void 0?i.opacity:1,kxe(n)),t.opacityExit=hn(e.opacity!==void 0?e.opacity:1,0,zxe(n))):s&&(t.opacity=hn(e.opacity!==void 0?e.opacity:1,i.opacity!==void 0?i.opacity:1,n));for(let o=0;o<Fxe;o++){const a=`border${zK[o]}Radius`;let l=IH(e,a),c=IH(i,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||DH(l)===DH(c)?(t[a]=Math.max(hn(PH(l),PH(c),n),0),(Sc.test(c)||Sc.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||i.rotate)&&(t.rotate=hn(e.rotate||0,i.rotate||0,n))}function IH(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const kxe=UK(0,.5,tk),zxe=UK(.5,.95,Oa);function UK(t,e,i){return n=>n<t?0:n>e?1:i(s_(t,e,n))}function LH(t,e){t.min=e.min,t.max=e.max}function la(t,e){LH(t.x,e.x),LH(t.y,e.y)}function BH(t,e,i,n,r){return t-=e,t=vC(t,1/i,n),r!==void 0&&(t=vC(t,1/r,n)),t}function Uxe(t,e=0,i=1,n=.5,r,s=t,o=t){if(Sc.test(e)&&(e=parseFloat(e),e=hn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=hn(s.min,s.max,n);t===s&&(a-=e),t.min=BH(t.min,e,i,a,r),t.max=BH(t.max,e,i,a,r)}function RH(t,e,[i,n,r],s,o){Uxe(t,e[i],e[n],e[r],e.scale,s,o)}const Gxe=["x","scaleX","originX"],Vxe=["y","scaleY","originY"];function OH(t,e,i,n){RH(t.x,e,Gxe,i?i.x:void 0,n?n.x:void 0),RH(t.y,e,Vxe,i?i.y:void 0,n?n.y:void 0)}function FH(t){return t.translate===0&&t.scale===1}function GK(t){return FH(t.x)&&FH(t.y)}function BB(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function NH(t){return Wo(t.x)/Wo(t.y)}class Hxe{constructor(){this.members=[]}add(e){jN(this.members,e),e.scheduleRender()}remove(e){if(WN(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(e){const i=this.members.findIndex(r=>e===r);if(i===0)return!1;let n;for(let r=i;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,i){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,i&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:i,resumingFrom:n}=e;i.onExitComplete&&i.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function kH(t,e,i){let n="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(n=`translate3d(${r}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),i){const{rotate:l,rotateX:c,rotateY:h}=i;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),h&&(n+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(n+=`scale(${o}, ${a})`),n||"none"}const jxe=(t,e)=>t.depth-e.depth;class Wxe{constructor(){this.children=[],this.isDirty=!1}add(e){jN(this.children,e),this.isDirty=!0}remove(e){WN(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(jxe),this.isDirty=!1,this.children.forEach(e)}}function Xxe(t){window.MotionDebug&&window.MotionDebug.record(t)}const zH=["","X","Y","Z"],UH=1e3;let qxe=0;const kf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function VK({attachResizeListener:t,defaultParent:e,measureScroll:i,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(o,a={},l=e==null?void 0:e()){this.id=qxe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.potentialNodes=new Map,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{kf.totalNodes=kf.resolvedTargetDeltas=kf.recalculatedProjection=0,this.nodes.forEach(Jxe),this.nodes.forEach(e1e),this.nodes.forEach(t1e),this.nodes.forEach(Kxe),Xxe(kf)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.elementId=o,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0,o&&this.root.registerPotentialNode(o,this);for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Wxe)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new XN),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}registerPotentialNode(o,a){this.potentialNodes.set(o,a)}mount(o,a=!1){if(this.instance)return;this.isSVG=o instanceof SVGElement&&o.tagName!=="svg",this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.elementId&&this.root.potentialNodes.delete(this.elementId),a&&(c||l)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=TK(d,250),$x.hasAnimatedSinceResize&&($x.hasAnimatedSinceResize=!1,this.nodes.forEach(VH))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||h.getDefaultTransition()||o1e,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=h.getProps(),y=!this.targetLayout||!BB(this.targetLayout,p)||f,x=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,x);const b={...PK(m,"layout"),onPlay:g,onComplete:v};(h.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else!d&&this.animationProgress===0&&VH(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Bd.preRender(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(i1e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}didUpdate(){if(this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(GH);return}this.isUpdating&&(this.isUpdating=!1,this.potentialNodes.size&&(this.potentialNodes.forEach(a1e),this.potentialNodes.clear()),this.nodes.forEach($xe),this.nodes.forEach(Yxe),this.nodes.forEach(Qxe),this.clearAllSnapshots(),mD.update(),mD.preRender(),mD.render())}clearAllSnapshots(){this.nodes.forEach(Zxe),this.sharedNodes.forEach(n1e)}scheduleUpdateProjection(){Ls.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){Ls.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=qn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:n(this.instance),offset:i(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!GK(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||Nf(this.latestValues)||h)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),l1e(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return qn();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Uh(a.x,l.offset.x),Uh(a.y,l.offset.y)),a}removeElementScroll(o){const a=qn();la(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:h,options:u}=c;if(c!==this.root&&h&&u.layoutScroll){if(h.isRoot){la(a,o);const{scroll:d}=this.root;d&&(Uh(a.x,-d.offset.x),Uh(a.y,-d.offset.y))}Uh(a.x,h.offset.x),Uh(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=qn();la(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Jg(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Nf(h.latestValues)&&Jg(l,h.latestValues)}return Nf(this.latestValues)&&Jg(l,this.latestValues),l}removeTransform(o){const a=qn();la(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Nf(c.latestValues))continue;DB(c.latestValues)&&c.updateSnapshot();const h=qn(),u=c.measurePageBox();la(h,u),OH(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Nf(this.latestValues)&&OH(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}resolveTargetDelta(){var o;const a=this.getLead();if(this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty),!((!!this.resumingFrom||this!==a)&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:u}=this.options;if(!(!this.layout||!(h||u))){if(!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout?(this.relativeParent=d,this.relativeTarget=qn(),this.relativeTargetOrigin=qn(),n1(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),la(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=qn(),this.targetWithTransforms=qn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?hxe(this.target,this.relativeTarget,this.relativeParent.target):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):la(this.target,this.layout.layoutBox),OK(this.target,this.targetDelta)):la(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target?(this.relativeParent=d,this.relativeTarget=qn(),this.relativeTargetOrigin=qn(),n1(this.relativeTargetOrigin,this.target,d.target),la(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}kf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||DB(this.parent.latestValues)||RK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;la(this.layoutCorrected,this.layout.layoutBox),_xe(this.layoutCorrected,this.treeScale,this.path,l);const{target:d}=a;if(!d)return;this.projectionDelta||(this.projectionDelta=r1(),this.projectionDeltaWithTransform=r1());const f=this.treeScale.x,p=this.treeScale.y,m=this.projectionTransform;i1(this.projectionDelta,this.layoutCorrected,d,this.latestValues),this.projectionTransform=kH(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==f||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d)),kf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=r1();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=qn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,g=this.getStack(),v=!g||g.members.length<=1,y=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(s1e));this.animationProgress=0;let x;this.mixTargetDelta=b=>{const S=b/1e3;HH(u.x,o.x,S),HH(u.y,o.y,S),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(n1(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),r1e(this.relativeTarget,this.relativeTargetOrigin,d,S),x&&BB(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=qn()),la(x,this.relativeTarget)),m&&(this.animationValues=h,Nxe(h,c,this.latestValues,S,y,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Bd.update(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ls.update(()=>{$x.hasAnimatedSinceResize=!0,this.currentAnimation=Oxe(0,UH,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(UH),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&HK(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||qn();const u=Wo(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=Wo(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}la(a,l),Jg(a,h),i1(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Hxe),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let h=0;h<zH.length;h++){const u="rotate"+zH[h];l[u]&&(c[u]=l[u],o.setStaticValue(u,0))}o.render();for(const h in c)o.setStaticValue(h,c[h]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=yM(o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=yM(o.pointerEvents)||""),this.hasProjected&&!Nf(this.latestValues)&&(m.transform=h?h({},""):"none",this.hasProjected=!1),m}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=kH(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in uC){if(d[m]===void 0)continue;const{correct:g,applyTo:v}=uC[m],y=c.transform==="none"?d[m]:g(d[m],u);if(v){const x=v.length;for(let b=0;b<x;b++)c[v[b]]=y}else c[m]=y}return this.options.layoutId&&(c.pointerEvents=u===this?yM(o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(GH),this.root.sharedNodes.clear()}}}function Yxe(t){t.updateLayout()}function Qxe(t){var e;const i=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&i&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=t.layout,{animationType:s}=t.options,o=i.source!==t.layout.source;s==="size"?oc(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=Wo(d);d.min=n[u].min,d.max=d.min+f}):HK(s,i.layoutBox,n)&&oc(u=>{const d=o?i.measuredBox[u]:i.layoutBox[u],f=Wo(n[u]);d.max=d.min+f});const a=r1();i1(a,n,i.layoutBox);const l=r1();o?i1(l,t.applyTransform(r,!0),i.measuredBox):i1(l,n,i.layoutBox);const c=!GK(a);let h=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const p=qn();n1(p,i.layoutBox,d.layoutBox);const m=qn();n1(m,n,f.layoutBox),BB(p,m)||(h=!0),u.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:i,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function Jxe(t){kf.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Kxe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Zxe(t){t.clearSnapshot()}function GH(t){t.clearMeasurements()}function $xe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function VH(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0}function e1e(t){t.resolveTargetDelta()}function t1e(t){t.calcProjection()}function i1e(t){t.resetRotation()}function n1e(t){t.removeLeadSnapshot()}function HH(t,e,i){t.translate=hn(e.translate,0,i),t.scale=hn(e.scale,1,i),t.origin=e.origin,t.originPoint=e.originPoint}function jH(t,e,i,n){t.min=hn(e.min,i.min,n),t.max=hn(e.max,i.max,n)}function r1e(t,e,i,n){jH(t.x,e.x,i.x,n),jH(t.y,e.y,i.y,n)}function s1e(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const o1e={duration:.45,ease:[.4,0,.1,1]};function a1e(t,e){let i=t.root;for(let s=t.path.length-1;s>=0;s--)if(t.path[s].instance){i=t.path[s];break}const r=(i&&i!==t.root?i.instance:document).querySelector(`[data-projection-id="${e}"]`);r&&t.mount(r,!0)}function WH(t){t.min=Math.round(t.min),t.max=Math.round(t.max)}function l1e(t){WH(t.x),WH(t.y)}function HK(t,e,i){return t==="position"||t==="preserve-aspect"&&!TB(NH(e),NH(i),.2)}const c1e=VK({attachResizeListener:(t,e)=>Du(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),AD={current:void 0},jK=VK({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!AD.current){const t=new c1e(0,{});t.mount(window),t.setOptions({layoutScroll:!0}),AD.current=t}return AD.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),u1e={pan:{Feature:Txe},drag:{Feature:Exe,ProjectionNode:jK,MeasureLayout:kK}},h1e=new Set(["width","height","top","left","right","bottom","x","y"]),WK=t=>h1e.has(t),d1e=t=>Object.keys(t).some(WK),XH=t=>t===sm||t===Ft,qH=(t,e)=>parseFloat(t.split(", ")[e]),YH=(t,e)=>(i,{transform:n})=>{if(n==="none"||!n)return 0;const r=n.match(/^matrix3d\((.+)\)$/);if(r)return qH(r[1],e);{const s=n.match(/^matrix\((.+)\)$/);return s?qH(s[1],t):0}},f1e=new Set(["x","y","z"]),p1e=lT.filter(t=>!f1e.has(t));function m1e(t){const e=[];return p1e.forEach(i=>{const n=t.getValue(i);n!==void 0&&(e.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))}),e.length&&t.render(),e}const QH={width:({x:t},{paddingLeft:e="0",paddingRight:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),height:({y:t},{paddingTop:e="0",paddingBottom:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:YH(4,13),y:YH(5,14)},g1e=(t,e,i)=>{const n=e.measureViewportBox(),r=e.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),i.forEach(c=>{a[c]=QH[c](n,s)}),e.render();const l=e.measureViewportBox();return i.forEach(c=>{const h=e.getValue(c);h&&h.jump(a[c]),t[c]=QH[c](l,s)}),t},v1e=(t,e,i={},n={})=>{e={...e},n={...n};const r=Object.keys(e).filter(WK);let s=[],o=!1;const a=[];if(r.forEach(l=>{const c=t.getValue(l);if(!t.hasValue(l))return;let h=i[l],u=Uy(h);const d=e[l];let f;if(dC(d)){const p=d.length,m=d[0]===null?1:0;h=d[m],u=Uy(h);for(let g=m;g<p;g++)f?mC(Uy(d[g])===f):f=Uy(d[g])}else f=Uy(d);if(u!==f)if(XH(u)&&XH(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?e[l]=parseFloat(d):Array.isArray(d)&&f===Ft&&(e[l]=d.map(parseFloat))}else u!=null&&u.transform&&(f!=null&&f.transform)&&(h===0||d===0)?h===0?c.set(f.transform(h)):e[l]=u.transform(d):(o||(s=m1e(t),o=!0),a.push(l),n[l]=n[l]!==void 0?n[l]:e[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=g1e(e,t,a);return s.length&&s.forEach(([h,u])=>{t.getValue(h).set(u)}),t.render(),sT&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:e,transitionEnd:n}};function y1e(t,e,i,n){return d1e(e)?v1e(t,e,i,n):{target:e,transitionEnd:n}}const x1e=(t,e,i,n)=>{const r=Ixe(t,e,n);return e=r.target,n=r.transitionEnd,y1e(t,e,i,n)},RB={current:null},XK={current:!1};function _1e(){if(XK.current=!0,!!sT)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>RB.current=t.matches;t.addListener(e),e()}else RB.current=!1}function w1e(t,e,i){const{willChange:n}=e;for(const r in e){const s=e[r],o=i[r];if(po(s))t.addValue(r,s),pC(n)&&n.add(r);else if(po(o))t.addValue(r,$v(s,{owner:t})),pC(n)&&n.remove(r);else if(o!==s)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,$v(a!==void 0?a:s,{owner:t}))}}for(const r in i)e[r]===void 0&&t.removeValue(r);return e}const qK=Object.keys(i_),b1e=qK.length,JH=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],S1e=ON.length;class A1e{constructor({parent:e,props:i,presenceContext:n,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Ls.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=i.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=i,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=aT(i),this.isVariantNode=NJ(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(i,{});for(const u in h){const d=h[u];a[u]!==void 0&&po(d)&&(d.set(a[u],!1),pC(c)&&c.add(u))}}scrapeMotionValuesFromProps(e,i){return{}}mount(e){this.current=e,this.projection&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,n)=>this.bindToMotionValue(n,i)),XK.current||_1e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:RB.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Bd.update(this.notifyUpdate),Bd.render(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,i){const n=rm.has(e),r=i.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Ls.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=i.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...i},n,r,s,o){let a,l;for(let c=0;c<b1e;c++){const h=qK[c],{isEnabled:u,Feature:d,ProjectionNode:f,MeasureLayout:p}=i_[h];f&&(a=f),u(i)&&(!this.features[h]&&d&&(this.features[h]=new d(this)),p&&(l=p))}if(!this.projection&&a){this.projection=new a(s,this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:h,drag:u,dragConstraints:d,layoutScroll:f,layoutRoot:p}=i;this.projection.setOptions({layoutId:c,layout:h,alwaysMeasureLayout:!!u||d&&Yg(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof h=="string"?h:"both",initialPromotionConfig:o,layoutScroll:f,layoutRoot:p})}return l}updateFeatures(){for(const e in this.features){const i=this.features[e];i.isMounted?i.update(this.props,this.prevProps):(i.mount(),i.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):qn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,i){this.latestValues[e]=i}makeTargetAnimatable(e,i=!0){return this.makeTargetAnimatableFromInstance(e,this.props,i)}update(e,i){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let n=0;n<JH.length;n++){const r=JH[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=e["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=w1e(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const i={};for(let n=0;n<S1e;n++){const r=ON[n],s=this.props[r];(t_(s)||s===!1)&&(i[r]=s)}return i}addVariantChild(e){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(e),()=>i.variantChildren.delete(e)}addValue(e,i){i!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,i)),this.values.set(e,i),this.latestValues[e]=i.get()}removeValue(e){this.values.delete(e);const i=this.valueSubscriptions.get(e);i&&(i(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,i){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&i!==void 0&&(n=$v(i,{owner:this}),this.addValue(e,n)),n}readValue(e){return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,i){this.baseTarget[e]=i}getBaseTarget(e){var i;const{initial:n}=this.props,r=typeof n=="string"||typeof n=="object"?(i=HN(this.props,n))===null||i===void 0?void 0:i[e]:void 0;if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!po(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,i){return this.events[e]||(this.events[e]=new XN),this.events[e].add(i)}notify(e,...i){this.events[e]&&this.events[e].notify(...i)}}class YK extends A1e{sortInstanceNodePosition(e,i){return e.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(e,i){return e.style?e.style[i]:void 0}removeValueFromRenderState(e,{vars:i,style:n}){delete i[e],delete n[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:i,...n},{transformValues:r},s){let o=q0e(n,e||{},this);if(r&&(i&&(i=r(i)),n&&(n=r(n)),o&&(o=r(o))),s){W0e(this,n,o);const a=x1e(this,n,o,i);i=a.transitionEnd,n=a.target}return{transition:e,transitionEnd:i,...n}}}function M1e(t){return window.getComputedStyle(t)}class C1e extends YK{readValueFromInstance(e,i){if(rm.has(i)){const n=QN(i);return n&&n.default||0}else{const n=M1e(e),r=(HJ(i)?n.getPropertyValue(i):n[i])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:i}){return FK(e,i)}build(e,i,n,r){NN(e,i,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,i){return VN(e,i)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;po(e)&&(this.childSubscription=e.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}renderInstance(e,i,n,r){YJ(e,i,n,r)}}class E1e extends YK{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,i){return e[i]}readValueFromInstance(e,i){if(rm.has(i)){const n=QN(i);return n&&n.default||0}return i=QJ.has(i)?i:GN(i),e.getAttribute(i)}measureInstanceViewportBox(){return qn()}scrapeMotionValuesFromProps(e,i){return KJ(e,i)}build(e,i,n,r){zN(e,i,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,i,n,r){JJ(e,i,n,r)}mount(e){this.isSVGTag=UN(e.tagName),super.mount(e)}}const T1e=(t,e)=>FN(t)?new E1e(e,{enableHardwareAcceleration:!1}):new C1e(e,{enableHardwareAcceleration:!0}),P1e={layout:{ProjectionNode:jK,MeasureLayout:kK}},D1e={...axe,...x0e,...u1e,...P1e},Ga=Lve((t,e)=>o0e(t,e,D1e,T1e)),jr={paddingX:"sm:px-16 px-6",paddingY:"sm:py-16 py-6",padding:"sm:px-16 px-6 sm:py-16 py-10",heroHeadText:"font-black text-white lg:text-[76px] sm:text-[56px] xs:text-[48px] text-[40px] lg:leading-[98px] mt-2",heroSubText:"text-[#dfd9ff] font-medium lg:text-[30px] sm:text-[26px] xs:text-[20px] text-[16px] lg:leading-[40px]",sectionHeadText:"text-white font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionSubText:"sm:text-[18px] text-[14px] text-secondary uppercase tracking-wider"},I1e="/assets/myavatar-1631e632.jpg",L1e="/assets/myphoto-1e677fdb.jpg",B1e="/assets/transition_effect2-25ba2f84.png";function mu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QK(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}/*!
 * GSAP 3.12.2
 * https://greensock.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Vo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},e0={duration:.5,overwrite:!1,delay:0},rk,us,An,Da=1e8,Hi=1/Da,OB=Math.PI*2,R1e=OB/4,O1e=0,JK=Math.sqrt,F1e=Math.cos,N1e=Math.sin,Br=function(e){return typeof e=="string"},Tn=function(e){return typeof e=="function"},Yu=function(e){return typeof e=="number"},sk=function(e){return typeof e>"u"},Pc=function(e){return typeof e=="object"},oo=function(e){return e!==!1},ok=function(){return typeof window<"u"},LS=function(e){return Tn(e)||Br(e)},KK=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},hs=Array.isArray,FB=/(?:-?\.?\d|\.)+/gi,ZK=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Kg=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,MD=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,$K=/[+-]=-?[.\d]+/,eZ=/[^,'"\[\]\s]+/gi,k1e=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,cn,va,NB,ak,Xo={},yC={},tZ,iZ=function(e){return(yC=Hp(e,Xo))&&mo},lk=function(e,i){return console.warn("Invalid property",e,"set to",i,"Missing plugin? gsap.registerPlugin()")},xC=function(e,i){return!i&&console.warn(e)},nZ=function(e,i){return e&&(Xo[e]=i)&&yC&&(yC[e]=i)||Xo},o_=function(){return 0},z1e={suppressEvents:!0,isStart:!0,kill:!1},_M={suppressEvents:!0,kill:!1},U1e={suppressEvents:!0},ck={},vd=[],kB={},rZ,To={},CD={},KH=30,wM=[],uk="",hk=function(e){var i=e[0],n,r;if(Pc(i)||Tn(i)||(e=[e]),!(n=(i._gsap||{}).harness)){for(r=wM.length;r--&&!wM[r].targetTest(i););n=wM[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new TZ(e[r],n)))||e.splice(r,1);return e},Sp=function(e){return e._gsap||hk(Ia(e))[0]._gsap},sZ=function(e,i,n){return(n=e[i])&&Tn(n)?e[i]():sk(n)&&e.getAttribute&&e.getAttribute(i)||n},ao=function(e,i){return(e=e.split(",")).forEach(i)||e},On=function(e){return Math.round(e*1e5)/1e5||0},Vr=function(e){return Math.round(e*1e7)/1e7||0},vv=function(e,i){var n=i.charAt(0),r=parseFloat(i.substr(2));return e=parseFloat(e),n==="+"?e+r:n==="-"?e-r:n==="*"?e*r:e/r},G1e=function(e,i){for(var n=i.length,r=0;e.indexOf(i[r])<0&&++r<n;);return r<n},_C=function(){var e=vd.length,i=vd.slice(0),n,r;for(kB={},vd.length=0,n=0;n<e;n++)r=i[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},oZ=function(e,i,n,r){vd.length&&!us&&_C(),e.render(i,n,r||us&&i<0&&(e._initted||e._startAt)),vd.length&&!us&&_C()},aZ=function(e){var i=parseFloat(e);return(i||i===0)&&(e+"").match(eZ).length<2?i:Br(e)?e.trim():e},lZ=function(e){return e},Va=function(e,i){for(var n in i)n in e||(e[n]=i[n]);return e},V1e=function(e){return function(i,n){for(var r in n)r in i||r==="duration"&&e||r==="ease"||(i[r]=n[r])}},Hp=function(e,i){for(var n in i)e[n]=i[n];return e},ZH=function t(e,i){for(var n in i)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=Pc(i[n])?t(e[n]||(e[n]={}),i[n]):i[n]);return e},wC=function(e,i){var n={},r;for(r in e)r in i||(n[r]=e[r]);return n},s1=function(e){var i=e.parent||cn,n=e.keyframes?V1e(hs(e.keyframes)):Va;if(oo(e.inherit))for(;i;)n(e,i.vars.defaults),i=i.parent||i._dp;return e},H1e=function(e,i){for(var n=e.length,r=n===i.length;r&&n--&&e[n]===i[n];);return n<0},cZ=function(e,i,n,r,s){n===void 0&&(n="_first"),r===void 0&&(r="_last");var o=e[r],a;if(s)for(a=i[s];o&&o[s]>a;)o=o._prev;return o?(i._next=o._next,o._next=i):(i._next=e[n],e[n]=i),i._next?i._next._prev=i:e[r]=i,i._prev=o,i.parent=i._dp=e,i},dT=function(e,i,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var s=i._prev,o=i._next;s?s._next=o:e[n]===i&&(e[n]=o),o?o._prev=s:e[r]===i&&(e[r]=s),i._next=i._prev=i.parent=null},Od=function(e,i){e.parent&&(!i||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Ap=function(e,i){if(e&&(!i||i._end>e._dur||i._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},j1e=function(e){for(var i=e.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return e},zB=function(e,i,n,r){return e._startAt&&(us?e._startAt.revert(_M):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(i,!0,r))},W1e=function t(e){return!e||e._ts&&t(e.parent)},$H=function(e){return e._repeat?t0(e._tTime,e=e.duration()+e._rDelay)*e:0},t0=function(e,i){var n=Math.floor(e/=i);return e&&n===e?n-1:n},bC=function(e,i){return(e-i._start)*i._ts+(i._ts>=0?0:i._dirty?i.totalDuration():i._tDur)},fT=function(e){return e._end=Vr(e._start+(e._tDur/Math.abs(e._ts||e._rts||Hi)||0))},pT=function(e,i){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Vr(n._time-(e._ts>0?i/e._ts:((e._dirty?e.totalDuration():e._tDur)-i)/-e._ts)),fT(e),n._dirty||Ap(n,e)),e},uZ=function(e,i){var n;if((i._time||!i._dur&&i._initted||i._start<e._time&&(i._dur||!i.add))&&(n=bC(e.rawTime(),i),(!i._dur||dw(0,i.totalDuration(),n)-i._tTime>Hi)&&i.render(n,!0)),Ap(e,i)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Hi}},dc=function(e,i,n,r){return i.parent&&Od(i),i._start=Vr((Yu(n)?n:n||e!==cn?ma(e,n,i):e._time)+i._delay),i._end=Vr(i._start+(i.totalDuration()/Math.abs(i.timeScale())||0)),cZ(e,i,"_first","_last",e._sort?"_start":0),UB(i)||(e._recent=i),r||uZ(e,i),e._ts<0&&pT(e,e._tTime),e},hZ=function(e,i){return(Xo.ScrollTrigger||lk("scrollTrigger",i))&&Xo.ScrollTrigger.create(i,e)},dZ=function(e,i,n,r,s){if(fk(e,i,s),!e._initted)return 1;if(!n&&e._pt&&!us&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&rZ!==Io.frame)return vd.push(e),e._lazy=[s,r],1},X1e=function t(e){var i=e.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||t(i))},UB=function(e){var i=e.data;return i==="isFromStart"||i==="isStart"},q1e=function(e,i,n,r){var s=e.ratio,o=i<0||!i&&(!e._start&&X1e(e)&&!(!e._initted&&UB(e))||(e._ts<0||e._dp._ts<0)&&!UB(e))?0:1,a=e._rDelay,l=0,c,h,u;if(a&&e._repeat&&(l=dw(0,e._tDur,i),h=t0(l,a),e._yoyo&&h&1&&(o=1-o),h!==t0(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||us||r||e._zTime===Hi||!i&&e._zTime){if(!e._initted&&dZ(e,i,r,n,l))return;for(u=e._zTime,e._zTime=i||(n?Hi:0),n||(n=i&&!u),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=l,c=e._pt;c;)c.r(o,c.d),c=c._next;i<0&&zB(e,i,n,!0),e._onUpdate&&!n&&La(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&La(e,"onRepeat"),(i>=e._tDur||i<0)&&e.ratio===o&&(o&&Od(e,1),!n&&!us&&(La(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=i)},Y1e=function(e,i,n){var r;if(n>i)for(r=e._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>i)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<i)return r;r=r._prev}},i0=function(e,i,n,r){var s=e._repeat,o=Vr(i)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:Vr(o*(s+1)+e._rDelay*s):o,a>0&&!r&&pT(e,e._tTime=e._tDur*a),e.parent&&fT(e),n||Ap(e.parent,e),e},e6=function(e){return e instanceof Qs?Ap(e):i0(e,e._dur)},Q1e={_start:0,endTime:o_,totalDuration:o_},ma=function t(e,i,n){var r=e.labels,s=e._recent||Q1e,o=e.duration()>=Da?s.endTime(!1):e._dur,a,l,c;return Br(i)&&(isNaN(i)||i in r)?(l=i.charAt(0),c=i.substr(-1)==="%",a=i.indexOf("="),l==="<"||l===">"?(a>=0&&(i=i.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(i.substr(1))||0)*(c?(a<0?s:n).totalDuration()/100:1)):a<0?(i in r||(r[i]=o),r[i]):(l=parseFloat(i.charAt(a-1)+i.substr(a+1)),c&&n&&(l=l/100*(hs(n)?n[0]:n).totalDuration()),a>1?t(e,i.substr(0,a-1),n)+l:o+l)):i==null?o:+i},o1=function(e,i,n){var r=Yu(i[1]),s=(r?2:1)+(e<2?0:1),o=i[s],a,l;if(r&&(o.duration=i[1]),o.parent=n,e){for(a=o,l=n;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=oo(l.vars.inherit)&&l.parent;o.immediateRender=oo(a.immediateRender),e<2?o.runBackwards=1:o.startAt=i[s-1]}return new Yn(i[0],o,i[s+1])},Qd=function(e,i){return e||e===0?i(e):i},dw=function(e,i,n){return n<e?e:n>i?i:n},as=function(e,i){return!Br(e)||!(i=k1e.exec(e))?"":i[1]},J1e=function(e,i,n){return Qd(n,function(r){return dw(e,i,r)})},GB=[].slice,fZ=function(e,i){return e&&Pc(e)&&"length"in e&&(!i&&!e.length||e.length-1 in e&&Pc(e[0]))&&!e.nodeType&&e!==va},K1e=function(e,i,n){return n===void 0&&(n=[]),e.forEach(function(r){var s;return Br(r)&&!i||fZ(r,1)?(s=n).push.apply(s,Ia(r)):n.push(r)})||n},Ia=function(e,i,n){return An&&!i&&An.selector?An.selector(e):Br(e)&&!n&&(NB||!n0())?GB.call((i||ak).querySelectorAll(e),0):hs(e)?K1e(e,n):fZ(e)?GB.call(e,0):e?[e]:[]},VB=function(e){return e=Ia(e)[0]||xC("Invalid scope")||{},function(i){var n=e.current||e.nativeElement||e;return Ia(i,n.querySelectorAll?n:n===e?xC("Invalid scope")||ak.createElement("div"):e)}},pZ=function(e){return e.sort(function(){return .5-Math.random()})},mZ=function(e){if(Tn(e))return e;var i=Pc(e)?e:{each:e},n=Mp(i.ease),r=i.from||0,s=parseFloat(i.base)||0,o={},a=r>0&&r<1,l=isNaN(r)||a,c=i.axis,h=r,u=r;return Br(r)?h=u={center:.5,edges:.5,end:1}[r]||0:!a&&l&&(h=r[0],u=r[1]),function(d,f,p){var m=(p||i).length,g=o[m],v,y,x,b,S,A,E,M,T;if(!g){if(T=i.grid==="auto"?0:(i.grid||[1,Da])[1],!T){for(E=-Da;E<(E=p[T++].getBoundingClientRect().left)&&T<m;);T--}for(g=o[m]=[],v=l?Math.min(T,m)*h-.5:r%T,y=T===Da?0:l?m*u/T-.5:r/T|0,E=0,M=Da,A=0;A<m;A++)x=A%T-v,b=y-(A/T|0),g[A]=S=c?Math.abs(c==="y"?b:x):JK(x*x+b*b),S>E&&(E=S),S<M&&(M=S);r==="random"&&pZ(g),g.max=E-M,g.min=M,g.v=m=(parseFloat(i.amount)||parseFloat(i.each)*(T>m?m-1:c?c==="y"?m/T:T:Math.max(T,m/T))||0)*(r==="edges"?-1:1),g.b=m<0?s-m:s,g.u=as(i.amount||i.each)||0,n=n&&m<0?MZ(n):n}return m=(g[d]-g.min)/g.max||0,Vr(g.b+(n?n(m):m)*g.v)+g.u}},HB=function(e){var i=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Vr(Math.round(parseFloat(n)/e)*e*i);return(r-r%1)/i+(Yu(n)?0:as(n))}},gZ=function(e,i){var n=hs(e),r,s;return!n&&Pc(e)&&(r=n=e.radius||Da,e.values?(e=Ia(e.values),(s=!Yu(e[0]))&&(r*=r)):e=HB(e.increment)),Qd(i,n?Tn(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var a=parseFloat(s?o.x:o),l=parseFloat(s?o.y:0),c=Da,h=0,u=e.length,d,f;u--;)s?(d=e[u].x-a,f=e[u].y-l,d=d*d+f*f):d=Math.abs(e[u]-a),d<c&&(c=d,h=u);return h=!r||c<=r?e[h]:o,s||h===o||Yu(o)?h:h+as(o)}:HB(e))},vZ=function(e,i,n,r){return Qd(hs(e)?!i:n===!0?!!(n=0):!r,function(){return hs(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(i-e+n*.99))/n)*n*r)/r})},Z1e=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return function(r){return i.reduce(function(s,o){return o(s)},r)}},$1e=function(e,i){return function(n){return e(parseFloat(n))+(i||as(n))}},e_e=function(e,i,n){return xZ(e,i,0,1,n)},yZ=function(e,i,n){return Qd(n,function(r){return e[~~i(r)]})},t_e=function t(e,i,n){var r=i-e;return hs(e)?yZ(e,t(0,e.length),i):Qd(n,function(s){return(r+(s-e)%r)%r+e})},i_e=function t(e,i,n){var r=i-e,s=r*2;return hs(e)?yZ(e,t(0,e.length-1),i):Qd(n,function(o){return o=(s+(o-e)%s)%s||0,e+(o>r?s-o:o)})},a_=function(e){for(var i=0,n="",r,s,o,a;~(r=e.indexOf("random(",i));)o=e.indexOf(")",r),a=e.charAt(r+7)==="[",s=e.substr(r+7,o-r-7).match(a?eZ:FB),n+=e.substr(i,r-i)+vZ(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),i=o+1;return n+e.substr(i,e.length-i)},xZ=function(e,i,n,r,s){var o=i-e,a=r-n;return Qd(s,function(l){return n+((l-e)/o*a||0)})},n_e=function t(e,i,n,r){var s=isNaN(e+i)?0:function(f){return(1-f)*e+f*i};if(!s){var o=Br(e),a={},l,c,h,u,d;if(n===!0&&(r=1)&&(n=null),o)e={p:e},i={p:i};else if(hs(e)&&!hs(i)){for(h=[],u=e.length,d=u-2,c=1;c<u;c++)h.push(t(e[c-1],e[c]));u--,s=function(p){p*=u;var m=Math.min(d,~~p);return h[m](p-m)},n=i}else r||(e=Hp(hs(e)?[]:{},e));if(!h){for(l in i)dk.call(a,e,l,"get",i[l]);s=function(p){return gk(p,a)||(o?e.p:e)}}}return Qd(n,s)},t6=function(e,i,n){var r=e.labels,s=Da,o,a,l;for(o in r)a=r[o]-i,a<0==!!n&&a&&s>(a=Math.abs(a))&&(l=o,s=a);return l},La=function(e,i,n){var r=e.vars,s=r[i],o=An,a=e._ctx,l,c,h;if(s)return l=r[i+"Params"],c=r.callbackScope||e,n&&vd.length&&_C(),a&&(An=a),h=l?s.apply(c,l):s.call(c),An=o,h},Px=function(e){return Od(e),e.scrollTrigger&&e.scrollTrigger.kill(!!us),e.progress()<1&&La(e,"onInterrupt"),e},Zg,_Z=[],wZ=function(e){if(ok()&&e){e=!e.name&&e.default||e;var i=e.name,n=Tn(e),r=i&&!n&&e.init?function(){this._props=[]}:e,s={init:o_,render:gk,add:dk,kill:x_e,modifier:y_e,rawVars:0},o={targetTest:0,get:0,getSetter:mk,aliases:{},register:0};if(n0(),e!==r){if(To[i])return;Va(r,Va(wC(e,s),o)),Hp(r.prototype,Hp(s,wC(e,o))),To[r.prop=i]=r,e.targetTest&&(wM.push(r),ck[i]=1),i=(i==="css"?"CSS":i.charAt(0).toUpperCase()+i.substr(1))+"Plugin"}nZ(i,r),e.register&&e.register(mo,r,lo)}else e&&_Z.push(e)},Ui=255,Dx={aqua:[0,Ui,Ui],lime:[0,Ui,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ui],navy:[0,0,128],white:[Ui,Ui,Ui],olive:[128,128,0],yellow:[Ui,Ui,0],orange:[Ui,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ui,0,0],pink:[Ui,192,203],cyan:[0,Ui,Ui],transparent:[Ui,Ui,Ui,0]},ED=function(e,i,n){return e+=e<0?1:e>1?-1:0,(e*6<1?i+(n-i)*e*6:e<.5?n:e*3<2?i+(n-i)*(2/3-e)*6:i)*Ui+.5|0},bZ=function(e,i,n){var r=e?Yu(e)?[e>>16,e>>8&Ui,e&Ui]:0:Dx.black,s,o,a,l,c,h,u,d,f,p;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Dx[e])r=Dx[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&Ui,r&Ui,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&Ui,e&Ui]}else if(e.substr(0,3)==="hsl"){if(r=p=e.match(FB),!i)l=+r[0]%360/360,c=+r[1]/100,h=+r[2]/100,o=h<=.5?h*(c+1):h+c-h*c,s=h*2-o,r.length>3&&(r[3]*=1),r[0]=ED(l+1/3,s,o),r[1]=ED(l,s,o),r[2]=ED(l-1/3,s,o);else if(~e.indexOf("="))return r=e.match(ZK),n&&r.length<4&&(r[3]=1),r}else r=e.match(FB)||Dx.transparent;r=r.map(Number)}return i&&!p&&(s=r[0]/Ui,o=r[1]/Ui,a=r[2]/Ui,u=Math.max(s,o,a),d=Math.min(s,o,a),h=(u+d)/2,u===d?l=c=0:(f=u-d,c=h>.5?f/(2-u-d):f/(u+d),l=u===s?(o-a)/f+(o<a?6:0):u===o?(a-s)/f+2:(s-o)/f+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(h*100+.5)),n&&r.length<4&&(r[3]=1),r},SZ=function(e){var i=[],n=[],r=-1;return e.split(yd).forEach(function(s){var o=s.match(Kg)||[];i.push.apply(i,o),n.push(r+=o.length+1)}),i.c=n,i},i6=function(e,i,n){var r="",s=(e+r).match(yd),o=i?"hsla(":"rgba(",a=0,l,c,h,u;if(!s)return e;if(s=s.map(function(d){return(d=bZ(d,i,1))&&o+(i?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),n&&(h=SZ(e),l=n.c,l.join(r)!==h.c.join(r)))for(c=e.replace(yd,"1").split(Kg),u=c.length-1;a<u;a++)r+=c[a]+(~l.indexOf(a)?s.shift()||o+"0,0,0,0)":(h.length?h:s.length?s:n).shift());if(!c)for(c=e.split(yd),u=c.length-1;a<u;a++)r+=c[a]+s[a];return r+c[u]},yd=function(){var t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Dx)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),r_e=/hsl[a]?\(/,AZ=function(e){var i=e.join(" "),n;if(yd.lastIndex=0,yd.test(i))return n=r_e.test(i),e[1]=i6(e[1],n),e[0]=i6(e[0],n,SZ(e[1])),!0},l_,Io=function(){var t=Date.now,e=500,i=33,n=t(),r=n,s=1e3/240,o=s,a=[],l,c,h,u,d,f,p=function m(g){var v=t()-r,y=g===!0,x,b,S,A;if(v>e&&(n+=v-i),r+=v,S=r-n,x=S-o,(x>0||y)&&(A=++u.frame,d=S-u.time*1e3,u.time=S=S/1e3,o+=x+(x>=s?4:s-x),b=1),y||(l=c(m)),b)for(f=0;f<a.length;f++)a[f](S,d,A,g)};return u={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(g){return d/(1e3/(g||60))},wake:function(){tZ&&(!NB&&ok()&&(va=NB=window,ak=va.document||{},Xo.gsap=mo,(va.gsapVersions||(va.gsapVersions=[])).push(mo.version),iZ(yC||va.GreenSockGlobals||!va.gsap&&va||{}),h=va.requestAnimationFrame,_Z.forEach(wZ)),l&&u.sleep(),c=h||function(g){return setTimeout(g,o-u.time*1e3+1|0)},l_=1,p(2))},sleep:function(){(h?va.cancelAnimationFrame:clearTimeout)(l),l_=0,c=o_},lagSmoothing:function(g,v){e=g||1/0,i=Math.min(v||33,e)},fps:function(g){s=1e3/(g||240),o=u.time*1e3+s},add:function(g,v,y){var x=v?function(b,S,A,E){g(b,S,A,E),u.remove(x)}:g;return u.remove(g),a[y?"unshift":"push"](x),n0(),x},remove:function(g,v){~(v=a.indexOf(g))&&a.splice(v,1)&&f>=v&&f--},_listeners:a},u}(),n0=function(){return!l_&&Io.wake()},mi={},s_e=/^[\d.\-M][\d.\-,\s]/,o_e=/["']/g,a_e=function(e){for(var i={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,o=n.length,a,l,c;s<o;s++)l=n[s],a=s!==o-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),i[r]=isNaN(c)?c.replace(o_e,"").trim():+c,r=l.substr(a+1).trim();return i},l_e=function(e){var i=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",i);return e.substring(i,~r&&r<n?e.indexOf(")",n+1):n)},c_e=function(e){var i=(e+"").split("("),n=mi[i[0]];return n&&i.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[a_e(i[1])]:l_e(e).split(",").map(aZ)):mi._CE&&s_e.test(e)?mi._CE("",e):n},MZ=function(e){return function(i){return 1-e(1-i)}},CZ=function t(e,i){for(var n=e._first,r;n;)n instanceof Qs?t(n,i):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==i&&(n.timeline?t(n.timeline,i):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=i)),n=n._next},Mp=function(e,i){return e&&(Tn(e)?e:mi[e]||c_e(e))||i},om=function(e,i,n,r){n===void 0&&(n=function(l){return 1-i(1-l)}),r===void 0&&(r=function(l){return l<.5?i(l*2)/2:1-i((1-l)*2)/2});var s={easeIn:i,easeOut:n,easeInOut:r},o;return ao(e,function(a){mi[a]=Xo[a]=s,mi[o=a.toLowerCase()]=n;for(var l in s)mi[o+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=mi[a+"."+l]=s[l]}),s},EZ=function(e){return function(i){return i<.5?(1-e(1-i*2))/2:.5+e((i-.5)*2)/2}},TD=function t(e,i,n){var r=i>=1?i:1,s=(n||(e?.3:.45))/(i<1?i:1),o=s/OB*(Math.asin(1/r)||0),a=function(h){return h===1?1:r*Math.pow(2,-10*h)*N1e((h-o)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:EZ(a);return s=OB/s,l.config=function(c,h){return t(e,c,h)},l},PD=function t(e,i){i===void 0&&(i=1.70158);var n=function(o){return o?--o*o*((i+1)*o+i)+1:0},r=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:EZ(n);return r.config=function(s){return t(e,s)},r};ao("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var i=e<5?e+1:e;om(t+",Power"+(i-1),e?function(n){return Math.pow(n,i)}:function(n){return n},function(n){return 1-Math.pow(1-n,i)},function(n){return n<.5?Math.pow(n*2,i)/2:1-Math.pow((1-n)*2,i)/2})});mi.Linear.easeNone=mi.none=mi.Linear.easeIn;om("Elastic",TD("in"),TD("out"),TD());(function(t,e){var i=1/e,n=2*i,r=2.5*i,s=function(a){return a<i?t*a*a:a<n?t*Math.pow(a-1.5/e,2)+.75:a<r?t*(a-=2.25/e)*a+.9375:t*Math.pow(a-2.625/e,2)+.984375};om("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);om("Expo",function(t){return t?Math.pow(2,10*(t-1)):0});om("Circ",function(t){return-(JK(1-t*t)-1)});om("Sine",function(t){return t===1?1:-F1e(t*R1e)+1});om("Back",PD("in"),PD("out"),PD());mi.SteppedEase=mi.steps=Xo.SteppedEase={config:function(e,i){e===void 0&&(e=1);var n=1/e,r=e+(i?0:1),s=i?1:0,o=1-Hi;return function(a){return((r*dw(0,o,a)|0)+s)*n}}};e0.ease=mi["quad.out"];ao("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return uk+=t+","+t+"Params,"});var TZ=function(e,i){this.id=O1e++,e._gsap=this,this.target=e,this.harness=i,this.get=i?i.get:sZ,this.set=i?i.getSetter:mk},c_=function(){function t(i){this.vars=i,this._delay=+i.delay||0,(this._repeat=i.repeat===1/0?-2:i.repeat||0)&&(this._rDelay=i.repeatDelay||0,this._yoyo=!!i.yoyo||!!i.yoyoEase),this._ts=1,i0(this,+i.duration,1,1),this.data=i.data,An&&(this._ctx=An,An.data.push(this)),l_||Io.wake()}var e=t.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,i0(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(n0(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(pT(this,n),!s._dp||s.parent||uZ(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&dc(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Hi||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),oZ(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+$H(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+$H(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?t0(this._tTime,s)+1:1},e.timeScale=function(n){if(!arguments.length)return this._rts===-Hi?0:this._rts;if(this._rts===n)return this;var r=this.parent&&this._ts?bC(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Hi?0:this._rts,this.totalTime(dw(-Math.abs(this._delay),this._tDur,r),!0),fT(this),j1e(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(n0(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Hi&&(this._tTime-=Hi)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&dc(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(oo(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?bC(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=U1e);var r=us;return us=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),us=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,e6(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,e6(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(ma(this,n),oo(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,oo(r))},e.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Hi:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Hi,this},e.isActive=function(){var n=this.parent||this._dp,r=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Hi)},e.eventCallback=function(n,r,s){var o=this.vars;return arguments.length>1?(r?(o[n]=r,s&&(o[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=r)):delete o[n],this):o[n]},e.then=function(n){var r=this;return new Promise(function(s){var o=Tn(n)?n:lZ,a=function(){var c=r.then;r.then=null,Tn(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=c),s(o),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){Px(this)},t}();Va(c_.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Hi,_prom:0,_ps:!1,_rts:1});var Qs=function(t){QK(e,t);function e(n,r){var s;return n===void 0&&(n={}),s=t.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=oo(n.sortChildren),cn&&dc(n.parent||cn,mu(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&hZ(mu(s),n.scrollTrigger),s}var i=e.prototype;return i.to=function(r,s,o){return o1(0,arguments,this),this},i.from=function(r,s,o){return o1(1,arguments,this),this},i.fromTo=function(r,s,o,a){return o1(2,arguments,this),this},i.set=function(r,s,o){return s.duration=0,s.parent=this,s1(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Yn(r,s,ma(this,o),1),this},i.call=function(r,s,o){return dc(this,Yn.delayedCall(0,r,s),o)},i.staggerTo=function(r,s,o,a,l,c,h){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=c,o.onCompleteParams=h,o.parent=this,new Yn(r,o,ma(this,l)),this},i.staggerFrom=function(r,s,o,a,l,c,h){return o.runBackwards=1,s1(o).immediateRender=oo(o.immediateRender),this.staggerTo(r,s,o,a,l,c,h)},i.staggerFromTo=function(r,s,o,a,l,c,h,u){return a.startAt=o,s1(a).immediateRender=oo(a.immediateRender),this.staggerTo(r,s,a,l,c,h,u)},i.render=function(r,s,o){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=r<=0?0:Vr(r),u=this._zTime<0!=r<0&&(this._initted||!c),d,f,p,m,g,v,y,x,b,S,A,E;if(this!==cn&&h>l&&r>=0&&(h=l),h!==this._tTime||o||u){if(a!==this._time&&c&&(h+=this._time-a,r+=this._time-a),d=h,b=this._start,x=this._ts,v=!x,u&&(c||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(A=this._yoyo,g=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(g*100+r,s,o);if(d=Vr(h%g),h===l?(m=this._repeat,d=c):(m=~~(h/g),m&&m===h/g&&(d=c,m--),d>c&&(d=c)),S=t0(this._tTime,g),!a&&this._tTime&&S!==m&&this._tTime-S*g-this._dur<=0&&(S=m),A&&m&1&&(d=c-d,E=1),m!==S&&!this._lock){var M=A&&S&1,T=M===(A&&m&1);if(m<S&&(M=!M),a=M?0:h%c?c:h,this._lock=1,this.render(a||(E?0:Vr(m*g)),s,!c)._lock=0,this._tTime=h,!s&&this.parent&&La(this,"onRepeat"),this.vars.repeatRefresh&&!E&&(this.invalidate()._lock=1),a&&a!==this._time||v!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,T&&(this._lock=2,a=M?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!E&&this.invalidate()),this._lock=0,!this._ts&&!v)return this;CZ(this,E)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=Y1e(this,Vr(a),Vr(d)),y&&(h-=d-(d=y._start))),this._tTime=h,this._time=d,this._act=!x,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&!m&&(La(this,"onStart"),this._tTime!==h))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,s,o),d!==this._time||!this._ts&&!v){y=0,p&&(h+=this._zTime=-Hi);break}}f=p}else{f=this._last;for(var P=r<0?r:d;f;){if(p=f._prev,(f._act||P<=f._end)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(P-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(P-f._start)*f._ts,s,o||us&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!v){y=0,p&&(h+=this._zTime=P?-Hi:Hi);break}}f=p}}if(y&&!s&&(this.pause(),y.render(d>=a?0:-Hi)._zTime=d>=a?1:-1,this._ts))return this._start=b,fT(this),this.render(r,s,o);this._onUpdate&&!s&&La(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&a)&&(b===this._start||Math.abs(x)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&Od(this,1),!s&&!(r<0&&!a)&&(h||a||!l)&&(La(this,h===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(r,s){var o=this;if(Yu(s)||(s=ma(this,s,r)),!(r instanceof c_)){if(hs(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Br(r))return this.addLabel(r,s);if(Tn(r))r=Yn.delayedCall(0,r);else return this}return this!==r?dc(this,r,s):this},i.getChildren=function(r,s,o,a){r===void 0&&(r=!0),s===void 0&&(s=!0),o===void 0&&(o=!0),a===void 0&&(a=-Da);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof Yn?s&&l.push(c):(o&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,o)))),c=c._next;return l},i.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},i.remove=function(r){return Br(r)?this.removeLabel(r):Tn(r)?this.killTweensOf(r):(dT(this,r),r===this._recent&&(this._recent=this._last),Ap(this))},i.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Vr(Io.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),t.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},i.addLabel=function(r,s){return this.labels[r]=ma(this,s),this},i.removeLabel=function(r){return delete this.labels[r],this},i.addPause=function(r,s,o){var a=Yn.delayedCall(0,s||o_,o);return a.data="isPause",this._hasPause=1,dc(this,a,ma(this,r))},i.removePause=function(r){var s=this._first;for(r=ma(this,r);s;)s._start===r&&s.data==="isPause"&&Od(s),s=s._next},i.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),l=a.length;l--;)Jh!==a[l]&&a[l].kill(r,s);return this},i.getTweensOf=function(r,s){for(var o=[],a=Ia(r),l=this._first,c=Yu(s),h;l;)l instanceof Yn?G1e(l._targets,a)&&(c?(!Jh||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&o.push(l):(h=l.getTweensOf(a,s)).length&&o.push.apply(o,h),l=l._next;return o},i.tweenTo=function(r,s){s=s||{};var o=this,a=ma(o,r),l=s,c=l.startAt,h=l.onStart,u=l.onStartParams,d=l.immediateRender,f,p=Yn.to(o,Va({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale())||Hi,onStart:function(){if(o.pause(),!f){var g=s.duration||Math.abs((a-(c&&"time"in c?c.time:o._time))/o.timeScale());p._dur!==g&&i0(p,g,0,1).render(p._time,!0,!0),f=1}h&&h.apply(p,u||[])}},s));return d?p.render(0):p},i.tweenFromTo=function(r,s,o){return this.tweenTo(s,Va({startAt:{time:ma(this,r)}},o))},i.recent=function(){return this._recent},i.nextLabel=function(r){return r===void 0&&(r=this._time),t6(this,ma(this,r))},i.previousLabel=function(r){return r===void 0&&(r=this._time),t6(this,ma(this,r),1)},i.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Hi)},i.shiftChildren=function(r,s,o){o===void 0&&(o=0);for(var a=this._first,l=this.labels,c;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(c in l)l[c]>=o&&(l[c]+=r);return Ap(this)},i.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return t.prototype.invalidate.call(this,r)},i.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,o;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Ap(this)},i.totalDuration=function(r){var s=0,o=this,a=o._last,l=Da,c,h,u;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(u=o.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),h=a._start,h>l&&o._sort&&a._ts&&!o._lock?(o._lock=1,dc(o,a,h-a._delay,1)._lock=0):l=h,h<0&&a._ts&&(s-=h,(!u&&!o._dp||u&&u.smoothChildTiming)&&(o._start+=h/o._ts,o._time-=h,o._tTime-=h),o.shiftChildren(-h,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;i0(o,o===cn&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(cn._ts&&(oZ(cn,bC(r,cn)),rZ=Io.frame),Io.frame>=KH){KH+=Vo.autoSleep||120;var s=cn._first;if((!s||!s._ts)&&Vo.autoSleep&&Io._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Io.sleep()}}},e}(c_);Va(Qs.prototype,{_lock:0,_hasPause:0,_forcing:0});var u_e=function(e,i,n,r,s,o,a){var l=new lo(this._pt,e,i,0,1,RZ,null,s),c=0,h=0,u,d,f,p,m,g,v,y;for(l.b=n,l.e=r,n+="",r+="",(v=~r.indexOf("random("))&&(r=a_(r)),o&&(y=[n,r],o(y,e,i),n=y[0],r=y[1]),d=n.match(MD)||[];u=MD.exec(r);)p=u[0],m=r.substring(c,u.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),p!==d[h++]&&(g=parseFloat(d[h-1])||0,l._pt={_next:l._pt,p:m||h===1?m:",",s:g,c:p.charAt(1)==="="?vv(g,p)-g:parseFloat(p)-g,m:f&&f<4?Math.round:0},c=MD.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=a,($K.test(r)||v)&&(l.e=0),this._pt=l,l},dk=function(e,i,n,r,s,o,a,l,c,h){Tn(r)&&(r=r(s||0,e,o));var u=e[i],d=n!=="get"?n:Tn(u)?c?e[i.indexOf("set")||!Tn(e["get"+i.substr(3)])?i:"get"+i.substr(3)](c):e[i]():u,f=Tn(u)?c?m_e:LZ:pk,p;if(Br(r)&&(~r.indexOf("random(")&&(r=a_(r)),r.charAt(1)==="="&&(p=vv(d,r)+(as(d)||0),(p||p===0)&&(r=p))),!h||d!==r||jB)return!isNaN(d*r)&&r!==""?(p=new lo(this._pt,e,i,+d||0,r-(d||0),typeof u=="boolean"?v_e:BZ,0,f),c&&(p.fp=c),a&&p.modifier(a,this,e),this._pt=p):(!u&&!(i in e)&&lk(i,r),u_e.call(this,e,i,d,r,f,l||Vo.stringFilter,c))},h_e=function(e,i,n,r,s){if(Tn(e)&&(e=a1(e,s,i,n,r)),!Pc(e)||e.style&&e.nodeType||hs(e)||KK(e))return Br(e)?a1(e,s,i,n,r):e;var o={},a;for(a in e)o[a]=a1(e[a],s,i,n,r);return o},PZ=function(e,i,n,r,s,o){var a,l,c,h;if(To[e]&&(a=new To[e]).init(s,a.rawVars?i[e]:h_e(i[e],r,s,o,n),n,r,o)!==!1&&(n._pt=l=new lo(n._pt,s,e,0,1,a.render,a,0,a.priority),n!==Zg))for(c=n._ptLookup[n._targets.indexOf(s)],h=a._props.length;h--;)c[a._props[h]]=l;return a},Jh,jB,fk=function t(e,i,n){var r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,l=r.lazy,c=r.onUpdate,h=r.onUpdateParams,u=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,p=r.keyframes,m=r.autoRevert,g=e._dur,v=e._startAt,y=e._targets,x=e.parent,b=x&&x.data==="nested"?x.vars.targets:y,S=e._overwrite==="auto"&&!rk,A=e.timeline,E,M,T,P,I,k,R,F,V,Q,X,z,Y;if(A&&(!p||!s)&&(s="none"),e._ease=Mp(s,e0.ease),e._yEase=f?MZ(Mp(f===!0?s:f,e0.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!A&&!!r.runBackwards,!A||p&&!r.stagger){if(F=y[0]?Sp(y[0]).harness:0,z=F&&r[F.prop],E=wC(r,ck),v&&(v._zTime<0&&v.progress(1),i<0&&d&&a&&!m?v.render(-1,!0):v.revert(d&&g?_M:z1e),v._lazy=0),o){if(Od(e._startAt=Yn.set(y,Va({data:"isStart",overwrite:!1,parent:x,immediateRender:!0,lazy:!v&&oo(l),startAt:null,delay:0,onUpdate:c,onUpdateParams:h,callbackScope:u,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,i<0&&(us||!a&&!m)&&e._startAt.revert(_M),a&&g&&i<=0&&n<=0){i&&(e._zTime=i);return}}else if(d&&g&&!v){if(i&&(a=!1),T=Va({overwrite:!1,data:"isFromStart",lazy:a&&!v&&oo(l),immediateRender:a,stagger:0,parent:x},E),z&&(T[F.prop]=z),Od(e._startAt=Yn.set(y,T)),e._startAt._dp=0,e._startAt._sat=e,i<0&&(us?e._startAt.revert(_M):e._startAt.render(-1,!0)),e._zTime=i,!a)t(e._startAt,Hi,Hi);else if(!i)return}for(e._pt=e._ptCache=0,l=g&&oo(l)||l&&!g,M=0;M<y.length;M++){if(I=y[M],R=I._gsap||hk(y)[M]._gsap,e._ptLookup[M]=Q={},kB[R.id]&&vd.length&&_C(),X=b===y?M:b.indexOf(I),F&&(V=new F).init(I,z||E,e,X,b)!==!1&&(e._pt=P=new lo(e._pt,I,V.name,0,1,V.render,V,0,V.priority),V._props.forEach(function(j){Q[j]=P}),V.priority&&(k=1)),!F||z)for(T in E)To[T]&&(V=PZ(T,E,e,X,I,b))?V.priority&&(k=1):Q[T]=P=dk.call(e,I,T,"get",E[T],X,b,0,r.stringFilter);e._op&&e._op[M]&&e.kill(I,e._op[M]),S&&e._pt&&(Jh=e,cn.killTweensOf(I,Q,e.globalTime(i)),Y=!e.parent,Jh=0),e._pt&&l&&(kB[R.id]=1)}k&&OZ(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!Y,p&&i<=0&&A.render(Da,!0,!0)},d_e=function(e,i,n,r,s,o,a){var l=(e._pt&&e._ptCache||(e._ptCache={}))[i],c,h,u,d;if(!l)for(l=e._ptCache[i]=[],u=e._ptLookup,d=e._targets.length;d--;){if(c=u[d][i],c&&c.d&&c.d._pt)for(c=c.d._pt;c&&c.p!==i&&c.fp!==i;)c=c._next;if(!c)return jB=1,e.vars[i]="+=0",fk(e,a),jB=0,1;l.push(c)}for(d=l.length;d--;)h=l[d],c=h._pt||h,c.s=(r||r===0)&&!s?r:c.s+(r||0)+o*c.c,c.c=n-c.s,h.e&&(h.e=On(n)+as(h.e)),h.b&&(h.b=c.s+as(h.b))},f_e=function(e,i){var n=e[0]?Sp(e[0]).harness:0,r=n&&n.aliases,s,o,a,l;if(!r)return i;s=Hp({},i);for(o in r)if(o in s)for(l=r[o].split(","),a=l.length;a--;)s[l[a]]=s[o];return s},p_e=function(e,i,n,r){var s=i.ease||r||"power1.inOut",o,a;if(hs(i))a=n[e]||(n[e]=[]),i.forEach(function(l,c){return a.push({t:c/(i.length-1)*100,v:l,e:s})});else for(o in i)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:i[o],e:s})},a1=function(e,i,n,r,s){return Tn(e)?e.call(i,n,r,s):Br(e)&&~e.indexOf("random(")?a_(e):e},DZ=uk+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",IZ={};ao(DZ+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return IZ[t]=1});var Yn=function(t){QK(e,t);function e(n,r,s,o){var a;typeof r=="number"&&(s.duration=r,r=s,s=null),a=t.call(this,o?r:s1(r))||this;var l=a.vars,c=l.duration,h=l.delay,u=l.immediateRender,d=l.stagger,f=l.overwrite,p=l.keyframes,m=l.defaults,g=l.scrollTrigger,v=l.yoyoEase,y=r.parent||cn,x=(hs(n)||KK(n)?Yu(n[0]):"length"in r)?[n]:Ia(n),b,S,A,E,M,T,P,I;if(a._targets=x.length?hk(x):xC("GSAP target "+n+" not found. https://greensock.com",!Vo.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||LS(c)||LS(h)){if(r=a.vars,b=a.timeline=new Qs({data:"nested",defaults:m||{},targets:y&&y.data==="nested"?y.vars.targets:x}),b.kill(),b.parent=b._dp=mu(a),b._start=0,d||LS(c)||LS(h)){if(E=x.length,P=d&&mZ(d),Pc(d))for(M in d)~DZ.indexOf(M)&&(I||(I={}),I[M]=d[M]);for(S=0;S<E;S++)A=wC(r,IZ),A.stagger=0,v&&(A.yoyoEase=v),I&&Hp(A,I),T=x[S],A.duration=+a1(c,mu(a),S,T,x),A.delay=(+a1(h,mu(a),S,T,x)||0)-a._delay,!d&&E===1&&A.delay&&(a._delay=h=A.delay,a._start+=h,A.delay=0),b.to(T,A,P?P(S,T,x):0),b._ease=mi.none;b.duration()?c=h=0:a.timeline=0}else if(p){s1(Va(b.vars.defaults,{ease:"none"})),b._ease=Mp(p.ease||r.ease||"none");var k=0,R,F,V;if(hs(p))p.forEach(function(Q){return b.to(x,Q,">")}),b.duration();else{A={};for(M in p)M==="ease"||M==="easeEach"||p_e(M,p[M],A,p.easeEach);for(M in A)for(R=A[M].sort(function(Q,X){return Q.t-X.t}),k=0,S=0;S<R.length;S++)F=R[S],V={ease:F.e,duration:(F.t-(S?R[S-1].t:0))/100*c},V[M]=F.v,b.to(x,V,k),k+=V.duration;b.duration()<c&&b.to({},{duration:c-b.duration()})}}c||a.duration(c=b.duration())}else a.timeline=0;return f===!0&&!rk&&(Jh=mu(a),cn.killTweensOf(x),Jh=0),dc(y,mu(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(u||!c&&!p&&a._start===Vr(y._time)&&oo(u)&&W1e(mu(a))&&y.data!=="nested")&&(a._tTime=-Hi,a.render(Math.max(0,-h)||0)),g&&hZ(mu(a),g),a}var i=e.prototype;return i.render=function(r,s,o){var a=this._time,l=this._tDur,c=this._dur,h=r<0,u=r>l-Hi&&!h?l:r<Hi?0:r,d,f,p,m,g,v,y,x,b;if(!c)q1e(this,r,s,o);else if(u!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h){if(d=u,x=this.timeline,this._repeat){if(m=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(m*100+r,s,o);if(d=Vr(u%m),u===l?(p=this._repeat,d=c):(p=~~(u/m),p&&p===u/m&&(d=c,p--),d>c&&(d=c)),v=this._yoyo&&p&1,v&&(b=this._yEase,d=c-d),g=t0(this._tTime,m),d===a&&!o&&this._initted)return this._tTime=u,this;p!==g&&(x&&this._yEase&&CZ(x,v),this.vars.repeatRefresh&&!v&&!this._lock&&(this._lock=o=1,this.render(Vr(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(dZ(this,h?r:d,o,s,u))return this._tTime=0,this;if(a!==this._time)return this;if(c!==this._dur)return this.render(r,s,o)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=y=(b||this._ease)(d/c),this._from&&(this.ratio=y=1-y),d&&!a&&!s&&!p&&(La(this,"onStart"),this._tTime!==u))return this;for(f=this._pt;f;)f.r(y,f.d),f=f._next;x&&x.render(r<0?r:!d&&v?-Hi:x._dur*x._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(h&&zB(this,r,s,o),La(this,"onUpdate")),this._repeat&&p!==g&&this.vars.onRepeat&&!s&&this.parent&&La(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(h&&!this._onUpdate&&zB(this,r,!0,!0),(r||!c)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&Od(this,1),!s&&!(h&&!a)&&(u||a||v)&&(La(this,u===l?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom()))}return this},i.targets=function(){return this._targets},i.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),t.prototype.invalidate.call(this,r)},i.resetTo=function(r,s,o,a){l_||Io.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),c;return this._initted||fk(this,l),c=this._ease(l/this._dur),d_e(this,r,s,o,a,c,l)?this.resetTo(r,s,o,a):(pT(this,0),this.parent||cZ(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Px(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Jh&&Jh.vars.overwrite!==!0)._first||Px(this),this.parent&&o!==this.timeline.totalDuration()&&i0(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,l=r?Ia(r):a,c=this._ptLookup,h=this._pt,u,d,f,p,m,g,v;if((!s||s==="all")&&H1e(a,l))return s==="all"&&(this._pt=0),Px(this);for(u=this._op=this._op||[],s!=="all"&&(Br(s)&&(m={},ao(s,function(y){return m[y]=1}),s=m),s=f_e(a,s)),v=a.length;v--;)if(~l.indexOf(a[v])){d=c[v],s==="all"?(u[v]=s,p=d,f={}):(f=u[v]=u[v]||{},p=s);for(m in p)g=d&&d[m],g&&((!("kill"in g.d)||g.d.kill(m)===!0)&&dT(this,g,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&h&&Px(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return o1(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return o1(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return cn.killTweensOf(r,s,o)},e}(c_);Va(Yn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ao("staggerTo,staggerFrom,staggerFromTo",function(t){Yn[t]=function(){var e=new Qs,i=GB.call(arguments,0);return i.splice(t==="staggerFromTo"?5:4,0,0),e[t].apply(e,i)}});var pk=function(e,i,n){return e[i]=n},LZ=function(e,i,n){return e[i](n)},m_e=function(e,i,n,r){return e[i](r.fp,n)},g_e=function(e,i,n){return e.setAttribute(i,n)},mk=function(e,i){return Tn(e[i])?LZ:sk(e[i])&&e.setAttribute?g_e:pk},BZ=function(e,i){return i.set(i.t,i.p,Math.round((i.s+i.c*e)*1e6)/1e6,i)},v_e=function(e,i){return i.set(i.t,i.p,!!(i.s+i.c*e),i)},RZ=function(e,i){var n=i._pt,r="";if(!e&&i.b)r=i.b;else if(e===1&&i.e)r=i.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+r,n=n._next;r+=i.c}i.set(i.t,i.p,r,i)},gk=function(e,i){for(var n=i._pt;n;)n.r(e,n.d),n=n._next},y_e=function(e,i,n,r){for(var s=this._pt,o;s;)o=s._next,s.p===r&&s.modifier(e,i,n),s=o},x_e=function(e){for(var i=this._pt,n,r;i;)r=i._next,i.p===e&&!i.op||i.op===e?dT(this,i,"_pt"):i.dep||(n=1),i=r;return!n},__e=function(e,i,n,r){r.mSet(e,i,r.m.call(r.tween,n,r.mt),r)},OZ=function(e){for(var i=e._pt,n,r,s,o;i;){for(n=i._next,r=s;r&&r.pr>i.pr;)r=r._next;(i._prev=r?r._prev:o)?i._prev._next=i:s=i,(i._next=r)?r._prev=i:o=i,i=n}e._pt=s},lo=function(){function t(i,n,r,s,o,a,l,c,h){this.t=n,this.s=s,this.c=o,this.p=r,this.r=a||BZ,this.d=l||this,this.set=c||pk,this.pr=h||0,this._next=i,i&&(i._prev=this)}var e=t.prototype;return e.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=__e,this.m=n,this.mt=s,this.tween=r},t}();ao(uk+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return ck[t]=1});Xo.TweenMax=Xo.TweenLite=Yn;Xo.TimelineLite=Xo.TimelineMax=Qs;cn=new Qs({sortChildren:!1,defaults:e0,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Vo.stringFilter=AZ;var Cp=[],bM={},w_e=[],n6=0,b_e=0,DD=function(e){return(bM[e]||w_e).map(function(i){return i()})},WB=function(){var e=Date.now(),i=[];e-n6>2&&(DD("matchMediaInit"),Cp.forEach(function(n){var r=n.queries,s=n.conditions,o,a,l,c;for(a in r)o=va.matchMedia(r[a]).matches,o&&(l=1),o!==s[a]&&(s[a]=o,c=1);c&&(n.revert(),l&&i.push(n))}),DD("matchMediaRevert"),i.forEach(function(n){return n.onMatch(n)}),n6=e,DD("matchMedia"))},FZ=function(){function t(i,n){this.selector=n&&VB(n),this.data=[],this._r=[],this.isReverted=!1,this.id=b_e++,i&&this.add(i)}var e=t.prototype;return e.add=function(n,r,s){Tn(n)&&(s=r,r=n,n=Tn);var o=this,a=function(){var c=An,h=o.selector,u;return c&&c!==o&&c.data.push(o),s&&(o.selector=VB(s)),An=o,u=r.apply(o,arguments),Tn(u)&&o._r.push(u),An=c,o.selector=h,o.isReverted=!1,u};return o.last=a,n===Tn?a(o):n?o[n]=a:a},e.ignore=function(n){var r=An;An=null,n(this),An=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof t?n.push.apply(n,r.getTweens()):r instanceof Yn&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n){var o=this.getTweens();this.data.forEach(function(l){l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(c){return o.splice(o.indexOf(c),1)}))}),o.map(function(l){return{g:l.globalTime(0),t:l}}).sort(function(l,c){return c.g-l.g||-1/0}).forEach(function(l){return l.t.revert(n)}),this.data.forEach(function(l){return!(l instanceof Yn)&&l.revert&&l.revert(n)}),this._r.forEach(function(l){return l(n,s)}),this.isReverted=!0}else this.data.forEach(function(l){return l.kill&&l.kill()});if(this.clear(),r)for(var a=Cp.length;a--;)Cp[a].id===this.id&&Cp.splice(a,1)},e.revert=function(n){this.kill(n||{})},t}(),S_e=function(){function t(i){this.contexts=[],this.scope=i}var e=t.prototype;return e.add=function(n,r,s){Pc(n)||(n={matches:n});var o=new FZ(0,s||this.scope),a=o.conditions={},l,c,h;An&&!o.selector&&(o.selector=An.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=n;for(c in n)c==="all"?h=1:(l=va.matchMedia(n[c]),l&&(Cp.indexOf(o)<0&&Cp.push(o),(a[c]=l.matches)&&(h=1),l.addListener?l.addListener(WB):l.addEventListener("change",WB)));return h&&r(o),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},t}(),SC={registerPlugin:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach(function(r){return wZ(r)})},timeline:function(e){return new Qs(e)},getTweensOf:function(e,i){return cn.getTweensOf(e,i)},getProperty:function(e,i,n,r){Br(e)&&(e=Ia(e)[0]);var s=Sp(e||{}).get,o=n?lZ:aZ;return n==="native"&&(n=""),e&&(i?o((To[i]&&To[i].get||s)(e,i,n,r)):function(a,l,c){return o((To[a]&&To[a].get||s)(e,a,l,c))})},quickSetter:function(e,i,n){if(e=Ia(e),e.length>1){var r=e.map(function(h){return mo.quickSetter(h,i,n)}),s=r.length;return function(h){for(var u=s;u--;)r[u](h)}}e=e[0]||{};var o=To[i],a=Sp(e),l=a.harness&&(a.harness.aliases||{})[i]||i,c=o?function(h){var u=new o;Zg._pt=0,u.init(e,n?h+n:h,Zg,0,[e]),u.render(1,u),Zg._pt&&gk(1,Zg)}:a.set(e,l);return o?c:function(h){return c(e,l,n?h+n:h,a,1)}},quickTo:function(e,i,n){var r,s=mo.to(e,Hp((r={},r[i]="+=0.1",r.paused=!0,r),n||{})),o=function(l,c,h){return s.resetTo(i,l,c,h)};return o.tween=s,o},isTweening:function(e){return cn.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Mp(e.ease,e0.ease)),ZH(e0,e||{})},config:function(e){return ZH(Vo,e||{})},registerEffect:function(e){var i=e.name,n=e.effect,r=e.plugins,s=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!To[a]&&!Xo[a]&&xC(i+" effect requires "+a+" plugin.")}),CD[i]=function(a,l,c){return n(Ia(a),Va(l||{},s),c)},o&&(Qs.prototype[i]=function(a,l,c){return this.add(CD[i](a,Pc(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,i){mi[e]=Mp(i)},parseEase:function(e,i){return arguments.length?Mp(e,i):mi},getById:function(e){return cn.getById(e)},exportRoot:function(e,i){e===void 0&&(e={});var n=new Qs(e),r,s;for(n.smoothChildTiming=oo(e.smoothChildTiming),cn.remove(n),n._dp=0,n._time=n._tTime=cn._time,r=cn._first;r;)s=r._next,(i||!(!r._dur&&r instanceof Yn&&r.vars.onComplete===r._targets[0]))&&dc(n,r,r._start-r._delay),r=s;return dc(cn,n,0),n},context:function(e,i){return e?new FZ(e,i):An},matchMedia:function(e){return new S_e(e)},matchMediaRefresh:function(){return Cp.forEach(function(e){var i=e.conditions,n,r;for(r in i)i[r]&&(i[r]=!1,n=1);n&&e.revert()})||WB()},addEventListener:function(e,i){var n=bM[e]||(bM[e]=[]);~n.indexOf(i)||n.push(i)},removeEventListener:function(e,i){var n=bM[e],r=n&&n.indexOf(i);r>=0&&n.splice(r,1)},utils:{wrap:t_e,wrapYoyo:i_e,distribute:mZ,random:vZ,snap:gZ,normalize:e_e,getUnit:as,clamp:J1e,splitColor:bZ,toArray:Ia,selector:VB,mapRange:xZ,pipe:Z1e,unitize:$1e,interpolate:n_e,shuffle:pZ},install:iZ,effects:CD,ticker:Io,updateRoot:Qs.updateRoot,plugins:To,globalTimeline:cn,core:{PropTween:lo,globals:nZ,Tween:Yn,Timeline:Qs,Animation:c_,getCache:Sp,_removeLinkedListItem:dT,reverting:function(){return us},context:function(e){return e&&An&&(An.data.push(e),e._ctx=An),An},suppressOverwrites:function(e){return rk=e}}};ao("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return SC[t]=Yn[t]});Io.add(Qs.updateRoot);Zg=SC.to({},{duration:0});var A_e=function(e,i){for(var n=e._pt;n&&n.p!==i&&n.op!==i&&n.fp!==i;)n=n._next;return n},M_e=function(e,i){var n=e._targets,r,s,o;for(r in i)for(s=n.length;s--;)o=e._ptLookup[s][r],o&&(o=o.d)&&(o._pt&&(o=A_e(o,r)),o&&o.modifier&&o.modifier(i[r],e,n[s],r))},ID=function(e,i){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var l,c;if(Br(s)&&(l={},ao(s,function(h){return l[h]=1}),s=l),i){l={};for(c in s)l[c]=i(s[c]);s=l}M_e(a,s)}}}},mo=SC.registerPlugin({name:"attr",init:function(e,i,n,r,s){var o,a,l;this.tween=n;for(o in i)l=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(l||0)+"",i[o],r,s,0,0,o),a.op=o,a.b=l,this._props.push(o)},render:function(e,i){for(var n=i._pt;n;)us?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,i){for(var n=i.length;n--;)this.add(e,n,e[n]||0,i[n],0,0,0,0,0,1)}},ID("roundProps",HB),ID("modifiers"),ID("snap",gZ))||SC;Yn.version=Qs.version=mo.version="3.12.2";tZ=1;ok()&&n0();mi.Power0;mi.Power1;mi.Power2;mi.Power3;mi.Power4;mi.Linear;mi.Quad;mi.Cubic;mi.Quart;mi.Quint;mi.Strong;mi.Elastic;mi.Back;mi.SteppedEase;mi.Bounce;mi.Sine;mi.Expo;mi.Circ;/*!
 * CSSPlugin 3.12.2
 * https://greensock.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var r6,Kh,yv,vk,lp,s6,yk,C_e=function(){return typeof window<"u"},Qu={},zf=180/Math.PI,xv=Math.PI/180,Xm=Math.atan2,o6=1e8,xk=/([A-Z])/g,E_e=/(left|right|width|margin|padding|x)/i,T_e=/[\s,\(]\S/,gc={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},XB=function(e,i){return i.set(i.t,i.p,Math.round((i.s+i.c*e)*1e4)/1e4+i.u,i)},P_e=function(e,i){return i.set(i.t,i.p,e===1?i.e:Math.round((i.s+i.c*e)*1e4)/1e4+i.u,i)},D_e=function(e,i){return i.set(i.t,i.p,e?Math.round((i.s+i.c*e)*1e4)/1e4+i.u:i.b,i)},I_e=function(e,i){var n=i.s+i.c*e;i.set(i.t,i.p,~~(n+(n<0?-.5:.5))+i.u,i)},NZ=function(e,i){return i.set(i.t,i.p,e?i.e:i.b,i)},kZ=function(e,i){return i.set(i.t,i.p,e!==1?i.b:i.e,i)},L_e=function(e,i,n){return e.style[i]=n},B_e=function(e,i,n){return e.style.setProperty(i,n)},R_e=function(e,i,n){return e._gsap[i]=n},O_e=function(e,i,n){return e._gsap.scaleX=e._gsap.scaleY=n},F_e=function(e,i,n,r,s){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(s,o)},N_e=function(e,i,n,r,s){var o=e._gsap;o[i]=n,o.renderTransform(s,o)},dn="transform",Ml=dn+"Origin",k_e=function t(e,i){var n=this,r=this.target,s=r.style;if(e in Qu&&s){if(this.tfm=this.tfm||{},e!=="transform")e=gc[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=_u(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:_u(r,e);else return gc.transform.split(",").forEach(function(o){return t.call(n,o,i)});if(this.props.indexOf(dn)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Ml,i,"")),e=dn}(s||i)&&this.props.push(e,i,s[e])},zZ=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},z_e=function(){var e=this.props,i=this.target,n=i.style,r=i._gsap,s,o;for(s=0;s<e.length;s+=3)e[s+1]?i[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(xk,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),s=yk(),(!s||!s.isStart)&&!n[dn]&&(zZ(n),r.uncache=1)}},UZ=function(e,i){var n={target:e,props:[],revert:z_e,save:k_e};return e._gsap||mo.core.getCache(e),i&&i.split(",").forEach(function(r){return n.save(r)}),n},GZ,qB=function(e,i){var n=Kh.createElementNS?Kh.createElementNS((i||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Kh.createElement(e);return n.style?n:Kh.createElement(e)},Ac=function t(e,i,n){var r=getComputedStyle(e);return r[i]||r.getPropertyValue(i.replace(xk,"-$1").toLowerCase())||r.getPropertyValue(i)||!n&&t(e,r0(i)||i,1)||""},a6="O,Moz,ms,Ms,Webkit".split(","),r0=function(e,i,n){var r=i||lp,s=r.style,o=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(a6[o]+e in s););return o<0?null:(o===3?"ms":o>=0?a6[o]:"")+e},YB=function(){C_e()&&window.document&&(r6=window,Kh=r6.document,yv=Kh.documentElement,lp=qB("div")||{style:{}},qB("div"),dn=r0(dn),Ml=dn+"Origin",lp.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",GZ=!!r0("perspective"),yk=mo.core.reverting,vk=1)},LD=function t(e){var i=qB("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,s=this.style.cssText,o;if(yv.appendChild(i),i.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),yv.removeChild(i),this.style.cssText=s,o},l6=function(e,i){for(var n=i.length;n--;)if(e.hasAttribute(i[n]))return e.getAttribute(i[n])},VZ=function(e){var i;try{i=e.getBBox()}catch{i=LD.call(e,!0)}return i&&(i.width||i.height)||e.getBBox===LD||(i=LD.call(e,!0)),i&&!i.width&&!i.x&&!i.y?{x:+l6(e,["x","cx","x1"])||0,y:+l6(e,["y","cy","y1"])||0,width:0,height:0}:i},HZ=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&VZ(e))},u_=function(e,i){if(i){var n=e.style;i in Qu&&i!==Ml&&(i=dn),n.removeProperty?((i.substr(0,2)==="ms"||i.substr(0,6)==="webkit")&&(i="-"+i),n.removeProperty(i.replace(xk,"-$1").toLowerCase())):n.removeAttribute(i)}},Zh=function(e,i,n,r,s,o){var a=new lo(e._pt,i,n,0,1,o?kZ:NZ);return e._pt=a,a.b=r,a.e=s,e._props.push(n),a},c6={deg:1,rad:1,turn:1},U_e={grid:1,flex:1},Fd=function t(e,i,n,r){var s=parseFloat(n)||0,o=(n+"").trim().substr((s+"").length)||"px",a=lp.style,l=E_e.test(i),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),u=100,d=r==="px",f=r==="%",p,m,g,v;return r===o||!s||c6[r]||c6[o]?s:(o!=="px"&&!d&&(s=t(e,i,n,"px")),v=e.getCTM&&HZ(e),(f||o==="%")&&(Qu[i]||~i.indexOf("adius"))?(p=v?e.getBBox()[l?"width":"height"]:e[h],On(f?s/p*u:s/100*p)):(a[l?"width":"height"]=u+(d?o:r),m=~i.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,v&&(m=(e.ownerSVGElement||{}).parentNode),(!m||m===Kh||!m.appendChild)&&(m=Kh.body),g=m._gsap,g&&f&&g.width&&l&&g.time===Io.time&&!g.uncache?On(s/g.width*u):((f||o==="%")&&!U_e[Ac(m,"display")]&&(a.position=Ac(e,"position")),m===e&&(a.position="static"),m.appendChild(lp),p=lp[h],m.removeChild(lp),a.position="absolute",l&&f&&(g=Sp(m),g.time=Io.time,g.width=m[h]),On(d?p*s/u:p&&s?u/p*s:0))))},_u=function(e,i,n,r){var s;return vk||YB(),i in gc&&i!=="transform"&&(i=gc[i],~i.indexOf(",")&&(i=i.split(",")[0])),Qu[i]&&i!=="transform"?(s=d_(e,r),s=i!=="transformOrigin"?s[i]:s.svg?s.origin:MC(Ac(e,Ml))+" "+s.zOrigin+"px"):(s=e.style[i],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=AC[i]&&AC[i](e,i,n)||Ac(e,i)||sZ(e,i)||(i==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?Fd(e,i,s,n)+n:s},G_e=function(e,i,n,r){if(!n||n==="none"){var s=r0(i,e,1),o=s&&Ac(e,s,1);o&&o!==n?(i=s,n=o):i==="borderColor"&&(n=Ac(e,"borderTopColor"))}var a=new lo(this._pt,e.style,i,0,1,RZ),l=0,c=0,h,u,d,f,p,m,g,v,y,x,b,S;if(a.b=n,a.e=r,n+="",r+="",r==="auto"&&(e.style[i]=r,r=Ac(e,i)||r,e.style[i]=n),h=[n,r],AZ(h),n=h[0],r=h[1],d=n.match(Kg)||[],S=r.match(Kg)||[],S.length){for(;u=Kg.exec(r);)g=u[0],y=r.substring(l,u.index),p?p=(p+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(p=1),g!==(m=d[c++]||"")&&(f=parseFloat(m)||0,b=m.substr((f+"").length),g.charAt(1)==="="&&(g=vv(f,g)+b),v=parseFloat(g),x=g.substr((v+"").length),l=Kg.lastIndex-x.length,x||(x=x||Vo.units[i]||b,l===r.length&&(r+=x,a.e+=x)),b!==x&&(f=Fd(e,i,m,x)||0),a._pt={_next:a._pt,p:y||c===1?y:",",s:f,c:v-f,m:p&&p<4||i==="zIndex"?Math.round:0});a.c=l<r.length?r.substring(l,r.length):""}else a.r=i==="display"&&r==="none"?kZ:NZ;return $K.test(r)&&(a.e=0),this._pt=a,a},u6={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},V_e=function(e){var i=e.split(" "),n=i[0],r=i[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(e=n,n=r,r=e),i[0]=u6[n]||n,i[1]=u6[r]||r,i.join(" ")},H_e=function(e,i){if(i.tween&&i.tween._time===i.tween._dur){var n=i.t,r=n.style,s=i.u,o=n._gsap,a,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],Qu[a]&&(l=1,a=a==="transformOrigin"?Ml:dn),u_(n,a);l&&(u_(n,dn),o&&(o.svg&&n.removeAttribute("transform"),d_(n,1),o.uncache=1,zZ(r)))}},AC={clearProps:function(e,i,n,r,s){if(s.data!=="isFromStart"){var o=e._pt=new lo(e._pt,i,n,0,0,H_e);return o.u=r,o.pr=-10,o.tween=s,e._props.push(n),1}}},h_=[1,0,0,1,0,0],jZ={},WZ=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},h6=function(e){var i=Ac(e,dn);return WZ(i)?h_:i.substr(7).match(ZK).map(On)},_k=function(e,i){var n=e._gsap||Sp(e),r=e.style,s=h6(e),o,a,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?h_:s):(s===h_&&!e.offsetParent&&e!==yv&&!n.svg&&(l=r.display,r.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(c=1,a=e.nextElementSibling,yv.appendChild(e)),s=h6(e),l?r.display=l:u_(e,"display"),c&&(a?o.insertBefore(e,a):o?o.appendChild(e):yv.removeChild(e))),i&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},QB=function(e,i,n,r,s,o){var a=e._gsap,l=s||_k(e,!0),c=a.xOrigin||0,h=a.yOrigin||0,u=a.xOffset||0,d=a.yOffset||0,f=l[0],p=l[1],m=l[2],g=l[3],v=l[4],y=l[5],x=i.split(" "),b=parseFloat(x[0])||0,S=parseFloat(x[1])||0,A,E,M,T;n?l!==h_&&(E=f*g-p*m)&&(M=b*(g/E)+S*(-m/E)+(m*y-g*v)/E,T=b*(-p/E)+S*(f/E)-(f*y-p*v)/E,b=M,S=T):(A=VZ(e),b=A.x+(~x[0].indexOf("%")?b/100*A.width:b),S=A.y+(~(x[1]||x[0]).indexOf("%")?S/100*A.height:S)),r||r!==!1&&a.smooth?(v=b-c,y=S-h,a.xOffset=u+(v*f+y*m)-v,a.yOffset=d+(v*p+y*g)-y):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=S,a.smooth=!!r,a.origin=i,a.originIsAbsolute=!!n,e.style[Ml]="0px 0px",o&&(Zh(o,a,"xOrigin",c,b),Zh(o,a,"yOrigin",h,S),Zh(o,a,"xOffset",u,a.xOffset),Zh(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",b+" "+S)},d_=function(e,i){var n=e._gsap||new TZ(e);if("x"in n&&!i&&!n.uncache)return n;var r=e.style,s=n.scaleX<0,o="px",a="deg",l=getComputedStyle(e),c=Ac(e,Ml)||"0",h,u,d,f,p,m,g,v,y,x,b,S,A,E,M,T,P,I,k,R,F,V,Q,X,z,Y,j,J,H,Z,K,ne;return h=u=d=m=g=v=y=x=b=0,f=p=1,n.svg=!!(e.getCTM&&HZ(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[dn]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[dn]!=="none"?l[dn]:"")),r.scale=r.rotate=r.translate="none"),E=_k(e,n.svg),n.svg&&(n.uncache?(z=e.getBBox(),c=n.xOrigin-z.x+"px "+(n.yOrigin-z.y)+"px",X=""):X=!i&&e.getAttribute("data-svg-origin"),QB(e,X||c,!!X||n.originIsAbsolute,n.smooth!==!1,E)),S=n.xOrigin||0,A=n.yOrigin||0,E!==h_&&(I=E[0],k=E[1],R=E[2],F=E[3],h=V=E[4],u=Q=E[5],E.length===6?(f=Math.sqrt(I*I+k*k),p=Math.sqrt(F*F+R*R),m=I||k?Xm(k,I)*zf:0,y=R||F?Xm(R,F)*zf+m:0,y&&(p*=Math.abs(Math.cos(y*xv))),n.svg&&(h-=S-(S*I+A*R),u-=A-(S*k+A*F))):(ne=E[6],Z=E[7],j=E[8],J=E[9],H=E[10],K=E[11],h=E[12],u=E[13],d=E[14],M=Xm(ne,H),g=M*zf,M&&(T=Math.cos(-M),P=Math.sin(-M),X=V*T+j*P,z=Q*T+J*P,Y=ne*T+H*P,j=V*-P+j*T,J=Q*-P+J*T,H=ne*-P+H*T,K=Z*-P+K*T,V=X,Q=z,ne=Y),M=Xm(-R,H),v=M*zf,M&&(T=Math.cos(-M),P=Math.sin(-M),X=I*T-j*P,z=k*T-J*P,Y=R*T-H*P,K=F*P+K*T,I=X,k=z,R=Y),M=Xm(k,I),m=M*zf,M&&(T=Math.cos(M),P=Math.sin(M),X=I*T+k*P,z=V*T+Q*P,k=k*T-I*P,Q=Q*T-V*P,I=X,V=z),g&&Math.abs(g)+Math.abs(m)>359.9&&(g=m=0,v=180-v),f=On(Math.sqrt(I*I+k*k+R*R)),p=On(Math.sqrt(Q*Q+ne*ne)),M=Xm(V,Q),y=Math.abs(M)>2e-4?M*zf:0,b=K?1/(K<0?-K:K):0),n.svg&&(X=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!WZ(Ac(e,dn)),X&&e.setAttribute("transform",X))),Math.abs(y)>90&&Math.abs(y)<270&&(s?(f*=-1,y+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,y+=y<=0?180:-180)),i=i||n.uncache,n.x=h-((n.xPercent=h&&(!i&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=u-((n.yPercent=u&&(!i&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-u)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=On(f),n.scaleY=On(p),n.rotation=On(m)+a,n.rotationX=On(g)+a,n.rotationY=On(v)+a,n.skewX=y+a,n.skewY=x+a,n.transformPerspective=b+o,(n.zOrigin=parseFloat(c.split(" ")[2])||0)&&(r[Ml]=MC(c)),n.xOffset=n.yOffset=0,n.force3D=Vo.force3D,n.renderTransform=n.svg?W_e:GZ?XZ:j_e,n.uncache=0,n},MC=function(e){return(e=e.split(" "))[0]+" "+e[1]},BD=function(e,i,n){var r=as(i);return On(parseFloat(i)+parseFloat(Fd(e,"x",n+"px",r)))+r},j_e=function(e,i){i.z="0px",i.rotationY=i.rotationX="0deg",i.force3D=0,XZ(e,i)},bf="0deg",Vy="0px",Sf=") ",XZ=function(e,i){var n=i||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.z,c=n.rotation,h=n.rotationY,u=n.rotationX,d=n.skewX,f=n.skewY,p=n.scaleX,m=n.scaleY,g=n.transformPerspective,v=n.force3D,y=n.target,x=n.zOrigin,b="",S=v==="auto"&&e&&e!==1||v===!0;if(x&&(u!==bf||h!==bf)){var A=parseFloat(h)*xv,E=Math.sin(A),M=Math.cos(A),T;A=parseFloat(u)*xv,T=Math.cos(A),o=BD(y,o,E*T*-x),a=BD(y,a,-Math.sin(A)*-x),l=BD(y,l,M*T*-x+x)}g!==Vy&&(b+="perspective("+g+Sf),(r||s)&&(b+="translate("+r+"%, "+s+"%) "),(S||o!==Vy||a!==Vy||l!==Vy)&&(b+=l!==Vy||S?"translate3d("+o+", "+a+", "+l+") ":"translate("+o+", "+a+Sf),c!==bf&&(b+="rotate("+c+Sf),h!==bf&&(b+="rotateY("+h+Sf),u!==bf&&(b+="rotateX("+u+Sf),(d!==bf||f!==bf)&&(b+="skew("+d+", "+f+Sf),(p!==1||m!==1)&&(b+="scale("+p+", "+m+Sf),y.style[dn]=b||"translate(0, 0)"},W_e=function(e,i){var n=i||this,r=n.xPercent,s=n.yPercent,o=n.x,a=n.y,l=n.rotation,c=n.skewX,h=n.skewY,u=n.scaleX,d=n.scaleY,f=n.target,p=n.xOrigin,m=n.yOrigin,g=n.xOffset,v=n.yOffset,y=n.forceCSS,x=parseFloat(o),b=parseFloat(a),S,A,E,M,T;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=xv,c*=xv,S=Math.cos(l)*u,A=Math.sin(l)*u,E=Math.sin(l-c)*-d,M=Math.cos(l-c)*d,c&&(h*=xv,T=Math.tan(c-h),T=Math.sqrt(1+T*T),E*=T,M*=T,h&&(T=Math.tan(h),T=Math.sqrt(1+T*T),S*=T,A*=T)),S=On(S),A=On(A),E=On(E),M=On(M)):(S=u,M=d,A=E=0),(x&&!~(o+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(x=Fd(f,"x",o,"px"),b=Fd(f,"y",a,"px")),(p||m||g||v)&&(x=On(x+p-(p*S+m*E)+g),b=On(b+m-(p*A+m*M)+v)),(r||s)&&(T=f.getBBox(),x=On(x+r/100*T.width),b=On(b+s/100*T.height)),T="matrix("+S+","+A+","+E+","+M+","+x+","+b+")",f.setAttribute("transform",T),y&&(f.style[dn]=T)},X_e=function(e,i,n,r,s){var o=360,a=Br(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?zf:1),c=l-r,h=r+c+"deg",u,d;return a&&(u=s.split("_")[1],u==="short"&&(c%=o,c!==c%(o/2)&&(c+=c<0?o:-o)),u==="cw"&&c<0?c=(c+o*o6)%o-~~(c/o)*o:u==="ccw"&&c>0&&(c=(c-o*o6)%o-~~(c/o)*o)),e._pt=d=new lo(e._pt,i,n,r,c,P_e),d.e=h,d.u="deg",e._props.push(n),d},d6=function(e,i){for(var n in i)e[n]=i[n];return e},q_e=function(e,i,n){var r=d6({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,l,c,h,u,d,f,p;r.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),o[dn]=i,a=d_(n,1),u_(n,dn),n.setAttribute("transform",c)):(c=getComputedStyle(n)[dn],o[dn]=i,a=d_(n,1),o[dn]=c);for(l in Qu)c=r[l],h=a[l],c!==h&&s.indexOf(l)<0&&(f=as(c),p=as(h),u=f!==p?Fd(n,l,c,p):parseFloat(c),d=parseFloat(h),e._pt=new lo(e._pt,a,l,u,d-u,XB),e._pt.u=p||0,e._props.push(l));d6(a,r)};ao("padding,margin,Width,Radius",function(t,e){var i="Top",n="Right",r="Bottom",s="Left",o=(e<3?[i,n,r,s]:[i+s,i+n,r+n,r+s]).map(function(a){return e<2?t+a:"border"+a+t});AC[e>1?"border"+t:t]=function(a,l,c,h,u){var d,f;if(arguments.length<4)return d=o.map(function(p){return _u(a,p,c)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(h+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(l,f,u)}});var qZ={name:"css",register:YB,targetTest:function(e){return e.style&&e.nodeType},init:function(e,i,n,r,s){var o=this._props,a=e.style,l=n.vars.startAt,c,h,u,d,f,p,m,g,v,y,x,b,S,A,E,M;vk||YB(),this.styles=this.styles||UZ(e),M=this.styles.props,this.tween=n;for(m in i)if(m!=="autoRound"&&(h=i[m],!(To[m]&&PZ(m,i,n,r,e,s)))){if(f=typeof h,p=AC[m],f==="function"&&(h=h.call(n,r,e,s),f=typeof h),f==="string"&&~h.indexOf("random(")&&(h=a_(h)),p)p(this,e,m,h,n)&&(E=1);else if(m.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(m)+"").trim(),h+="",yd.lastIndex=0,yd.test(c)||(g=as(c),v=as(h)),v?g!==v&&(c=Fd(e,m,c,v)+v):g&&(h+=g),this.add(a,"setProperty",c,h,r,s,0,0,m),o.push(m),M.push(m,0,a[m]);else if(f!=="undefined"){if(l&&m in l?(c=typeof l[m]=="function"?l[m].call(n,r,e,s):l[m],Br(c)&&~c.indexOf("random(")&&(c=a_(c)),as(c+"")||(c+=Vo.units[m]||as(_u(e,m))||""),(c+"").charAt(1)==="="&&(c=_u(e,m))):c=_u(e,m),d=parseFloat(c),y=f==="string"&&h.charAt(1)==="="&&h.substr(0,2),y&&(h=h.substr(2)),u=parseFloat(h),m in gc&&(m==="autoAlpha"&&(d===1&&_u(e,"visibility")==="hidden"&&u&&(d=0),M.push("visibility",0,a.visibility),Zh(this,a,"visibility",d?"inherit":"hidden",u?"inherit":"hidden",!u)),m!=="scale"&&m!=="transform"&&(m=gc[m],~m.indexOf(",")&&(m=m.split(",")[0]))),x=m in Qu,x){if(this.styles.save(m),b||(S=e._gsap,S.renderTransform&&!i.parseTransform||d_(e,i.parseTransform),A=i.smoothOrigin!==!1&&S.smooth,b=this._pt=new lo(this._pt,a,dn,0,1,S.renderTransform,S,0,-1),b.dep=1),m==="scale")this._pt=new lo(this._pt,S,"scaleY",S.scaleY,(y?vv(S.scaleY,y+u):u)-S.scaleY||0,XB),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){M.push(Ml,0,a[Ml]),h=V_e(h),S.svg?QB(e,h,0,A,0,this):(v=parseFloat(h.split(" ")[2])||0,v!==S.zOrigin&&Zh(this,S,"zOrigin",S.zOrigin,v),Zh(this,a,m,MC(c),MC(h)));continue}else if(m==="svgOrigin"){QB(e,h,1,A,0,this);continue}else if(m in jZ){X_e(this,S,m,d,y?vv(d,y+h):h);continue}else if(m==="smoothOrigin"){Zh(this,S,"smooth",S.smooth,h);continue}else if(m==="force3D"){S[m]=h;continue}else if(m==="transform"){q_e(this,h,e);continue}}else m in a||(m=r0(m)||m);if(x||(u||u===0)&&(d||d===0)&&!T_e.test(h)&&m in a)g=(c+"").substr((d+"").length),u||(u=0),v=as(h)||(m in Vo.units?Vo.units[m]:g),g!==v&&(d=Fd(e,m,c,v)),this._pt=new lo(this._pt,x?S:a,m,d,(y?vv(d,y+u):u)-d,!x&&(v==="px"||m==="zIndex")&&i.autoRound!==!1?I_e:XB),this._pt.u=v||0,g!==v&&v!=="%"&&(this._pt.b=c,this._pt.r=D_e);else if(m in a)G_e.call(this,e,m,c,y?y+h:h);else if(m in e)this.add(e,m,c||e[m],y?y+h:h,r,s);else if(m!=="parseTransform"){lk(m,h);continue}x||(m in a?M.push(m,0,a[m]):M.push(m,1,c||e[m])),o.push(m)}}E&&OZ(this)},render:function(e,i){if(i.tween._time||!yk())for(var n=i._pt;n;)n.r(e,n.d),n=n._next;else i.styles.revert()},get:_u,aliases:gc,getSetter:function(e,i,n){var r=gc[i];return r&&r.indexOf(",")<0&&(i=r),i in Qu&&i!==Ml&&(e._gsap.x||_u(e,"x"))?n&&s6===n?i==="scale"?O_e:R_e:(s6=n||{})&&(i==="scale"?F_e:N_e):e.style&&!sk(e.style[i])?L_e:~i.indexOf("-")?B_e:mk(e,i)},core:{_removeProperty:u_,_getMatrix:_k}};mo.utils.checkPrefix=r0;mo.core.getStyleSaver=UZ;(function(t,e,i,n){var r=ao(t+","+e+","+i,function(s){Qu[s]=1});ao(e,function(s){Vo.units[s]="deg",jZ[s]=1}),gc[r[13]]=t+","+e,ao(n,function(s){var o=s.split(":");gc[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ao("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Vo.units[t]="px"});mo.registerPlugin(qZ);var JB=mo.registerPlugin(qZ)||mo;JB.core.Tween;function Y_e(t){function e(){for(var z=0;z<arguments.length;z++)if(arguments[z]!==void 0)return arguments[z]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var i=t.parent,n=t.displacementImage,r=t.image1,s=t.image2,o=e(t.imagesRatio,1),a=e(t.intensity1,t.intensity,1),l=e(t.intensity2,t.intensity,1),c=e(t.angle,Math.PI/4),h=e(t.angle1,c),u=e(t.angle2,3*-c),d=e(t.speedIn,t.speed,1.6),f=e(t.speedOut,t.speed,1.2),p=e(t.hover,!0),m=e(t.easing,"expo.out"),g=e(t.video,!1);if(i)if(r&&s&&n){var v=new Q1,y=new Ra(i.offsetWidth/-2,i.offsetWidth/2,i.offsetHeight/2,i.offsetHeight/-2,1,1e3);y.position.z=1;var x=new QE({antialias:!1,alpha:!0});x.setPixelRatio(2),x.setClearColor(16777215,0),x.setSize(i.offsetWidth,i.offsetHeight),i.appendChild(x.domElement);var b=function(){x.render(v,y)},S=new yN;S.crossOrigin="";var A,E,M=S.load(n,b);if(M.magFilter=M.minFilter=bi,g){(function z(){requestAnimationFrame(z),x.render(v,y)})(),(g=document.createElement("video")).autoplay=!0,g.loop=!0,g.muted=!0,g.src=r,g.load();var T=document.createElement("video");T.autoplay=!0,T.loop=!0,T.muted=!0,T.src=s,T.load();var P=new Ex(g),I=new Ex(T);P.magFilter=I.magFilter=bi,P.minFilter=I.minFilter=bi,T.addEventListener("loadeddata",function(){T.play(),(I=new Ex(T)).magFilter=bi,I.minFilter=bi,R.uniforms.texture2.value=I},!1),g.addEventListener("loadeddata",function(){g.play(),(P=new Ex(g)).magFilter=bi,P.minFilter=bi,R.uniforms.texture1.value=P},!1)}else P=S.load(r,b),I=S.load(s,b),P.magFilter=I.magFilter=bi,P.minFilter=I.minFilter=bi;var k=o;i.offsetHeight/i.offsetWidth<k?(A=1,E=i.offsetHeight/i.offsetWidth/k):(A=i.offsetWidth/i.offsetHeight*k,E=1);var R=new Pl({uniforms:{intensity1:{type:"f",value:a},intensity2:{type:"f",value:l},dispFactor:{type:"f",value:0},angle1:{type:"f",value:h},angle2:{type:"f",value:u},texture1:{type:"t",value:P},texture2:{type:"t",value:I},disp:{type:"t",value:M},res:{type:"vec4",value:new Ci(i.offsetWidth,i.offsetHeight,A,E)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,fragmentShader:`
varying vec2 vUv;

uniform float dispFactor;
uniform float dpr;
uniform sampler2D disp;

uniform sampler2D texture1;
uniform sampler2D texture2;
uniform float angle1;
uniform float angle2;
uniform float intensity1;
uniform float intensity2;
uniform vec4 res;
uniform vec2 parent;

mat2 getRotM(float angle) {
  float s = sin(angle);
  float c = cos(angle);
  return mat2(c, -s, s, c);
}

void main() {
  vec4 disp = texture2D(disp, vUv);
  vec2 dispVec = vec2(disp.r, disp.g);

  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;
  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);


  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;
  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);
  vec4 _texture1 = texture2D(texture1, distortedPosition1);
  vec4 _texture2 = texture2D(texture2, distortedPosition2);
  gl_FragColor = mix(_texture1, _texture2, dispFactor);
}
`,transparent:!0,opacity:1}),F=new $p(i.offsetWidth,i.offsetHeight,1),V=new cr(F,R);v.add(V),p&&(i.addEventListener("mouseenter",Q),i.addEventListener("touchstart",Q),i.addEventListener("mouseleave",X),i.addEventListener("touchend",X)),window.addEventListener("resize",function(z){i.offsetHeight/i.offsetWidth<k?(A=1,E=i.offsetHeight/i.offsetWidth/k):(A=i.offsetWidth/i.offsetHeight*k,E=1),V.material.uniforms.res.value=new Ci(i.offsetWidth,i.offsetHeight,A,E),x.setSize(i.offsetWidth,i.offsetHeight),b()}),this.next=Q,this.previous=X}else console.warn("One or more images are missing");else console.warn("Parent missing");function Q(){JB.to(R.uniforms.dispFactor,{duration:d,value:1,ease:m,onUpdate:b,onComplete:b})}function X(){JB.to(R.uniforms.dispFactor,{duration:f,value:0,ease:m,onUpdate:b,onComplete:b})}}const Q_e="modulepreload",J_e=function(t){return"/"+t},f6={},fw=function(e,i,n){if(!i||i.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=J_e(s),s in f6)return;f6[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Q_e,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var K_e=Object.create,wk=Object.defineProperty,Z_e=Object.getOwnPropertyDescriptor,$_e=Object.getOwnPropertyNames,ewe=Object.getPrototypeOf,twe=Object.prototype.hasOwnProperty,D0=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),iwe=(t,e)=>{for(var i in e)wk(t,i,{get:e[i],enumerable:!0})},nwe=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of $_e(e))!twe.call(t,r)&&r!==i&&wk(t,r,{get:()=>e[r],enumerable:!(n=Z_e(e,r))||n.enumerable});return t},I0=(t,e,i)=>(i=t!=null?K_e(ewe(t)):{},nwe(e||!t||!t.__esModule?wk(i,"default",{value:t,enumerable:!0}):i,t)),rwe=D0((t,e)=>{(function(i,n){typeof t=="object"?e.exports=n():typeof define=="function"&&define.amd?define(n):i.Alea=n()})(t,function(){return i.importState=function(r){var s=new i;return s.importState(r),s},i;function i(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var c=n();s=c(" "),o=c(" "),a=c(" ");for(var h=0;h<r.length;h++)s-=c(r[h]),s<0&&(s+=1),o-=c(r[h]),o<0&&(o+=1),a-=c(r[h]),a<0&&(a+=1);c=null;var u=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=r,u.exportState=function(){return[s,o,a,l]},u.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},u}(Array.prototype.slice.call(arguments))}function n(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),YZ=D0((t,e)=>{(function(i,n){typeof t=="object"&&typeof e<"u"?n(t):typeof define=="function"&&define.amd?define(["exports"],n):n((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(t,function(i){i.SVD=function(n,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!n)throw new TypeError("Matrix a is not defined");var l,c,h,u,d,f,p,m,g,v,y,x,b=n[0].length,S=n.length;if(S<b)throw new TypeError("Invalid matrix: m < n");for(var A=[],E=[],M=[],T=r==="f"?S:b,P=v=p=0;P<S;P++)E[P]=new Array(T).fill(0);for(P=0;P<b;P++)M[P]=new Array(b).fill(0);var I,k=new Array(b).fill(0);for(P=0;P<S;P++)for(l=0;l<b;l++)E[P][l]=n[P][l];for(P=0;P<b;P++){for(A[P]=p,g=0,h=P+1,l=P;l<S;l++)g+=Math.pow(E[l][P],2);if(g<a)p=0;else for(m=(f=E[P][P])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,E[P][P]=f-p,l=h;l<b;l++){for(g=0,c=P;c<S;c++)g+=E[c][P]*E[c][l];for(f=g/m,c=P;c<S;c++)E[c][l]=E[c][l]+f*E[c][P]}for(k[P]=p,g=0,l=h;l<b;l++)g+=Math.pow(E[P][l],2);if(g<a)p=0;else{for(m=(f=E[P][P+1])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,E[P][P+1]=f-p,l=h;l<b;l++)A[l]=E[P][l]/m;for(l=h;l<S;l++){for(g=0,c=h;c<b;c++)g+=E[l][c]*E[P][c];for(c=h;c<b;c++)E[l][c]=E[l][c]+g*A[c]}}v<(y=Math.abs(k[P])+Math.abs(A[P]))&&(v=y)}if(s)for(P=b-1;0<=P;P--){if(p!==0){for(m=E[P][P+1]*p,l=h;l<b;l++)M[l][P]=E[P][l]/m;for(l=h;l<b;l++){for(g=0,c=h;c<b;c++)g+=E[P][c]*M[c][l];for(c=h;c<b;c++)M[c][l]=M[c][l]+g*M[c][P]}}for(l=h;l<b;l++)M[P][l]=0,M[l][P]=0;M[P][P]=1,p=A[P],h=P}if(r){if(r==="f")for(P=b;P<S;P++){for(l=b;l<S;l++)E[P][l]=0;E[P][P]=1}for(P=b-1;0<=P;P--){for(h=P+1,p=k[P],l=h;l<T;l++)E[P][l]=0;if(p!==0){for(m=E[P][P]*p,l=h;l<T;l++){for(g=0,c=h;c<S;c++)g+=E[c][P]*E[c][l];for(f=g/m,c=P;c<S;c++)E[c][l]=E[c][l]+f*E[c][P]}for(l=P;l<S;l++)E[l][P]=E[l][P]/p}else for(l=P;l<S;l++)E[l][P]=0;E[P][P]=E[P][P]+1}}for(o*=v,c=b-1;0<=c;c--)for(var R=0;R<50;R++){for(I=!1,h=c;0<=h;h--){if(Math.abs(A[h])<=o){I=!0;break}if(Math.abs(k[h-1])<=o)break}if(!I){for(d=0,u=h-(g=1),P=h;P<c+1&&(f=g*A[P],A[P]=d*A[P],!(Math.abs(f)<=o));P++)if(p=k[P],k[P]=Math.sqrt(f*f+p*p),d=p/(m=k[P]),g=-f/m,r)for(l=0;l<S;l++)y=E[l][u],x=E[l][P],E[l][u]=y*d+x*g,E[l][P]=-y*g+x*d}if(x=k[c],h===c){if(x<0&&(k[c]=-x,s))for(l=0;l<b;l++)M[l][c]=-M[l][c];break}for(v=k[h],f=(((y=k[c-1])-x)*(y+x)+((p=A[c-1])-(m=A[c]))*(p+m))/(2*m*y),p=Math.sqrt(f*f+1),f=((v-x)*(v+x)+m*(y/(f<0?f-p:f+p)-m))/v,P=h+(g=d=1);P<c+1;P++){if(p=A[P],y=k[P],m=g*p,p*=d,x=Math.sqrt(f*f+m*m),f=v*(d=f/(A[P-1]=x))+p*(g=m/x),p=-v*g+p*d,m=y*g,y*=d,s)for(l=0;l<b;l++)v=M[l][P-1],x=M[l][P],M[l][P-1]=v*d+x*g,M[l][P]=-v*g+x*d;if(x=Math.sqrt(f*f+m*m),f=(d=f/(k[P-1]=x))*p+(g=m/x)*y,v=-g*p+d*y,r)for(l=0;l<S;l++)y=E[l][P-1],x=E[l][P],E[l][P-1]=y*d+x*g,E[l][P]=-y*g+x*d}A[h]=0,A[c]=f,k[c]=v}for(P=0;P<b;P++)k[P]<o&&(k[P]=0);return{u:E,q:k,v:M}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),swe=D0((t,e)=>{(function(i,n){typeof t=="object"&&typeof e<"u"?e.exports=n():typeof define=="function"&&define.amd?define(n):(i=i||self,i.TinyQueue=n())})(t,function(){var i=function(r,s){if(r===void 0&&(r=[]),s===void 0&&(s=n),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};i.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(r){for(var s=this,o=s.data,a=s.compare,l=o[r];r>0;){var c=r-1>>1,h=o[c];if(a(l,h)>=0)break;o[r]=h,r=c}o[r]=l},i.prototype._down=function(r){for(var s=this,o=s.data,a=s.compare,l=this.length>>1,c=o[r];r<l;){var h=(r<<1)+1,u=o[h],d=h+1;if(d<this.length&&a(o[d],u)<0&&(h=d,u=o[d]),a(u,c)>=0)break;o[r]=u,r=h}o[r]=c};function n(r,s){return r<s?-1:r>s?1:0}return i})}),owe=D0((t,e)=>{var i=swe();i.default&&(i=i.default),e.exports=n,e.exports.default=n;function n(c,h,u){h=h||1;for(var d,f,p,m,g=0;g<c[0].length;g++){var v=c[0][g];(!g||v[0]<d)&&(d=v[0]),(!g||v[1]<f)&&(f=v[1]),(!g||v[0]>p)&&(p=v[0]),(!g||v[1]>m)&&(m=v[1])}var y=p-d,x=m-f,b=Math.min(y,x),S=b/2;if(b===0){var A=[d,f];return A.distance=0,A}for(var E=new i(void 0,r),M=d;M<p;M+=b)for(var T=f;T<m;T+=b)E.push(new s(M+S,T+S,S,c));var P=a(c),I=new s(d+y/2,f+x/2,0,c);I.d>P.d&&(P=I);for(var k=E.length;E.length;){var R=E.pop();R.d>P.d&&(P=R,u&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,k)),!(R.max-P.d<=h)&&(S=R.h/2,E.push(new s(R.x-S,R.y-S,S,c)),E.push(new s(R.x+S,R.y-S,S,c)),E.push(new s(R.x-S,R.y+S,S,c)),E.push(new s(R.x+S,R.y+S,S,c)),k+=4)}u&&(console.log("num probes: "+k),console.log("best distance: "+P.d));var F=[P.x,P.y];return F.distance=P.d,F}function r(c,h){return h.max-c.max}function s(c,h,u,d){this.x=c,this.y=h,this.h=u,this.d=o(c,h,d),this.max=this.d+this.h*Math.SQRT2}function o(c,h,u){for(var d=!1,f=1/0,p=0;p<u.length;p++)for(var m=u[p],g=0,v=m.length,y=v-1;g<v;y=g++){var x=m[g],b=m[y];x[1]>h!=b[1]>h&&c<(b[0]-x[0])*(h-x[1])/(b[1]-x[1])+x[0]&&(d=!d),f=Math.min(f,l(c,h,x,b))}return f===0?0:(d?1:-1)*Math.sqrt(f)}function a(c){for(var h=0,u=0,d=0,f=c[0],p=0,m=f.length,g=m-1;p<m;g=p++){var v=f[p],y=f[g],x=v[0]*y[1]-y[0]*v[1];u+=(v[0]+y[0])*x,d+=(v[1]+y[1])*x,h+=x*3}return h===0?new s(f[0][0],f[0][1],0,c):new s(u/h,d/h,0,c)}function l(c,h,u,d){var f=u[0],p=u[1],m=d[0]-f,g=d[1]-p;if(m!==0||g!==0){var v=((c-f)*m+(h-p)*g)/(m*m+g*g);v>1?(f=d[0],p=d[1]):v>0&&(f+=m*v,p+=g*v)}return m=c-f,g=h-p,m*m+g*g}}),awe=D0(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var u=this||i;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var d=this||i;if(u=parseFloat(u),d.ctx||h(),typeof u<"u"&&u>=0&&u<=1){if(d._volume=u,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),m=0;m<p.length;m++){var g=d._howls[f]._soundById(p[m]);g&&g._node&&(g._node.volume=g._volume*u)}return d}return d._volume},mute:function(u){var d=this||i;d.ctx||h(),d._muted=u,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u?0:d._volume,i.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),m=0;m<p.length;m++){var g=d._howls[f]._soundById(p[m]);g&&g._node&&(g._node.muted=u?!0:g._muted)}return d},stop:function(){for(var u=this||i,d=0;d<u._howls.length;d++)u._howls[d].stop();return u},unload:function(){for(var u=this||i,d=u._howls.length-1;d>=0;d--)u._howls[d].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,h()),u},codecs:function(u){return(this||i)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||i;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var d=new Audio;d.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||i,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return u}if(!d||typeof d.canPlayType!="function")return u;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",m=p.match(/OPR\/([0-6].)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,v=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),x=v&&y&&parseInt(y[1],10)<15;return u._codecs={mp3:!!(!g&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||i;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var d=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var m=0;m<u._howls.length;m++)if(!u._howls[m]._webAudio)for(var g=u._howls[m]._getSoundIds(),v=0;v<g.length;v++){var y=u._howls[m]._soundById(g[v]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}u._autoResume();var x=u.ctx.createBufferSource();x.buffer=u._scratchBuffer,x.connect(u.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),x.onended=function(){x.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var b=0;b<u._howls.length;b++)u._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),u}},_obtainHtml5Audio:function(){var u=this||i;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var d=this||i;return u._unlocked&&d._html5AudioPool.push(u),d},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!i.usingWebAudio)){for(var d=0;d<u._howls.length;d++)if(u._howls[d]._webAudio){for(var f=0;f<u._howls[d]._sounds.length;f++)if(!u._howls[d]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!i.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var d=0;d<u._howls.length;d++)u._howls[d]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var i=new e,n=function(u){var d=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(u)};n.prototype={init:function(u){var d=this;return i.ctx||h(),d._autoplay=u.autoplay||!1,d._format=typeof u.format!="string"?u.format:[u.format],d._html5=u.html5||!1,d._muted=u.mute||!1,d._loop=u.loop||!1,d._pool=u.pool||5,d._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,d._rate=u.rate||1,d._sprite=u.sprite||{},d._src=typeof u.src!="string"?u.src:[u.src],d._volume=u.volume!==void 0?u.volume:1,d._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=u.onend?[{fn:u.onend}]:[],d._onfade=u.onfade?[{fn:u.onfade}]:[],d._onload=u.onload?[{fn:u.onload}]:[],d._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],d._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],d._onpause=u.onpause?[{fn:u.onpause}]:[],d._onplay=u.onplay?[{fn:u.onplay}]:[],d._onstop=u.onstop?[{fn:u.onstop}]:[],d._onmute=u.onmute?[{fn:u.onmute}]:[],d._onvolume=u.onvolume?[{fn:u.onvolume}]:[],d._onrate=u.onrate?[{fn:u.onrate}]:[],d._onseek=u.onseek?[{fn:u.onseek}]:[],d._onunlock=u.onunlock?[{fn:u.onunlock}]:[],d._onresume=[],d._webAudio=i.usingWebAudio&&!d._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var u=this,d=null;if(i.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,m;if(u._format&&u._format[f])p=u._format[f];else{if(m=u._src[f],typeof m!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(m),p||(p=/\.([^.]+)$/.exec(m.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&i.codecs(p)){d=u._src[f];break}}if(!d){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=d,u._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new r(u),u._webAudio&&o(u),u},play:function(u,d){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var m=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(m++,p=f._sounds[g]._id);m===1?u=null:p=null}}var v=p?f._soundById(p):f._inactiveSound();if(!v)return null;if(p&&!u&&(u=v._sprite||"__default"),f._state!=="loaded"){v._sprite=u,v._ended=!1;var y=v._id;return f._queue.push({event:"play",action:function(){f.play(y)}}),y}if(p&&!v._paused)return d||f._loadQueue("play"),v._id;f._webAudio&&i._autoResume();var x=Math.max(0,v._seek>0?v._seek:f._sprite[u][0]/1e3),b=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-x),S=b*1e3/Math.abs(v._rate),A=f._sprite[u][0]/1e3,E=(f._sprite[u][0]+f._sprite[u][1])/1e3;v._sprite=u,v._ended=!1;var M=function(){v._paused=!1,v._seek=x,v._start=A,v._stop=E,v._loop=!!(v._loop||f._sprite[u][2])};if(x>=E){f._ended(v);return}var T=v._node;if(f._webAudio){var P=function(){f._playLock=!1,M(),f._refreshBuffer(v);var F=v._muted||f._muted?0:v._volume;T.gain.setValueAtTime(F,i.ctx.currentTime),v._playStart=i.ctx.currentTime,typeof T.bufferSource.start>"u"?v._loop?T.bufferSource.noteGrainOn(0,x,86400):T.bufferSource.noteGrainOn(0,x,b):v._loop?T.bufferSource.start(0,x,86400):T.bufferSource.start(0,x,b),S!==1/0&&(f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),S)),d||setTimeout(function(){f._emit("play",v._id),f._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?P():(f._playLock=!0,f.once("resume",P),f._clearTimer(v._id))}else{var I=function(){T.currentTime=x,T.muted=v._muted||f._muted||i._muted||T.muted,T.volume=v._volume*i.volume(),T.playbackRate=v._rate;try{var F=T.play();if(F&&typeof Promise<"u"&&(F instanceof Promise||typeof F.then=="function")?(f._playLock=!0,M(),F.then(function(){f._playLock=!1,T._unlocked=!0,d?f._loadQueue():f._emit("play",v._id)}).catch(function(){f._playLock=!1,f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),v._ended=!0,v._paused=!0})):d||(f._playLock=!1,M(),f._emit("play",v._id)),T.playbackRate=v._rate,T.paused){f._emit("playerror",v._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||v._loop?f._endTimers[v._id]=setTimeout(f._ended.bind(f,v),S):(f._endTimers[v._id]=function(){f._ended(v),T.removeEventListener("ended",f._endTimers[v._id],!1)},T.addEventListener("ended",f._endTimers[v._id],!1))}catch(V){f._emit("playerror",v._id,V)}};T.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(T.src=f._src,T.load());var k=window&&window.ejecta||!T.readyState&&i._navigator.isCocoonJS;if(T.readyState>=3||k)I();else{f._playLock=!0,f._state="loading";var R=function(){f._state="loaded",I(),T.removeEventListener(i._canPlayEvent,R,!1)};T.addEventListener(i._canPlayEvent,R,!1),f._clearTimer(v._id)}}return v._id},pause:function(u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(u)}}),d;for(var f=d._getSoundIds(u),p=0;p<f.length;p++){d._clearTimer(f[p]);var m=d._soundById(f[p]);if(m&&!m._paused&&(m._seek=d.seek(f[p]),m._rateSeek=0,m._paused=!0,d._stopFade(f[p]),m._node))if(d._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||d._emit("pause",m?m._id:null)}return d},stop:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),m=0;m<p.length;m++){f._clearTimer(p[m]);var g=f._soundById(p[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(p[m]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),d||f._emit("stop",g._id))}return f},mute:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,d)}}),f;if(typeof d>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(d),m=0;m<p.length;m++){var g=f._soundById(p[m]);g&&(g._muted=u,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(u?0:g._volume,i.ctx.currentTime):g._node&&(g._node.muted=i._muted?!0:u),f._emit("mute",g._id))}return f},volume:function(){var u=this,d=arguments,f,p;if(d.length===0)return u._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var m=u._getSoundIds(),g=m.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var v;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,d)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)v=u._soundById(p[y]),v&&(v._volume=f,d[2]||u._stopFade(p[y]),u._webAudio&&v._node&&!v._muted?v._node.gain.setValueAtTime(f,i.ctx.currentTime):v._node&&!v._muted&&(v._node.volume=f*i.volume()),u._emit("volume",v._id))}else return v=p?u._soundById(p):u._sounds[0],v?v._volume:0;return u},fade:function(u,d,f,p){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(u,d,f,p)}}),m;u=Math.min(Math.max(0,parseFloat(u)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),m.volume(u,p);for(var g=m._getSoundIds(p),v=0;v<g.length;v++){var y=m._soundById(g[v]);if(y){if(p||m._stopFade(g[v]),m._webAudio&&!y._muted){var x=i.ctx.currentTime,b=x+f/1e3;y._volume=u,y._node.gain.setValueAtTime(u,x),y._node.gain.linearRampToValueAtTime(d,b)}m._startFadeInterval(y,u,d,f,g[v],typeof p>"u")}}return m},_startFadeInterval:function(u,d,f,p,m,g){var v=this,y=d,x=f-d,b=Math.abs(x/.01),S=Math.max(4,b>0?p/b:p),A=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var E=(Date.now()-A)/p;A=Date.now(),y+=x*E,y=Math.round(y*100)/100,x<0?y=Math.max(f,y):y=Math.min(f,y),v._webAudio?u._volume=y:v.volume(y,u._id,!0),g&&(v._volume=y),(f<d&&y<=f||f>d&&y>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,v.volume(f,u._id),v._emit("fade",u._id))},S)},_stopFade:function(u){var d=this,f=d._soundById(u);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,u),f._fadeTo=null,d._emit("fade",u)),d},loop:function(){var u=this,d=arguments,f,p,m;if(d.length===0)return u._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],u._loop=f;else return m=u._soundById(parseInt(d[0],10)),m?m._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var g=u._getSoundIds(p),v=0;v<g.length;v++)m=u._soundById(g[v]),m&&(m._loop=f,u._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=f,f&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,u.playing(g[v])&&(u.pause(g[v],!0),u.play(g[v],!0)))));return u},rate:function(){var u=this,d=arguments,f,p;if(d.length===0)p=u._sounds[0]._id;else if(d.length===1){var m=u._getSoundIds(),g=m.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var v;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,d)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)if(v=u._soundById(p[y]),v){u.playing(p[y])&&(v._rateSeek=u.seek(p[y]),v._playStart=u._webAudio?i.ctx.currentTime:v._playStart),v._rate=f,u._webAudio&&v._node&&v._node.bufferSource?v._node.bufferSource.playbackRate.setValueAtTime(f,i.ctx.currentTime):v._node&&(v._node.playbackRate=f);var x=u.seek(p[y]),b=(u._sprite[v._sprite][0]+u._sprite[v._sprite][1])/1e3-x,S=b*1e3/Math.abs(v._rate);(u._endTimers[p[y]]||!v._paused)&&(u._clearTimer(p[y]),u._endTimers[p[y]]=setTimeout(u._ended.bind(u,v),S)),u._emit("rate",v._id)}}else return v=u._soundById(p),v?v._rate:u._rate;return u},seek:function(){var u=this,d=arguments,f,p;if(d.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(d.length===1){var m=u._getSoundIds(),g=m.indexOf(d[0]);g>=0?p=parseInt(d[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,d)}}),u;var v=u._soundById(p);if(v)if(typeof f=="number"&&f>=0){var y=u.playing(p);y&&u.pause(p,!0),v._seek=f,v._ended=!1,u._clearTimer(p),!u._webAudio&&v._node&&!isNaN(v._node.duration)&&(v._node.currentTime=f);var x=function(){y&&u.play(p,!0),u._emit("seek",p)};if(y&&!u._webAudio){var b=function(){u._playLock?setTimeout(b,0):x()};setTimeout(b,0)}else x()}else if(u._webAudio){var S=u.playing(p)?i.ctx.currentTime-v._playStart:0,A=v._rateSeek?v._rateSeek-v._seek:0;return v._seek+(A+S*Math.abs(v._rate))}else return v._node.currentTime;return u},playing:function(u){var d=this;if(typeof u=="number"){var f=d._soundById(u);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(u){var d=this,f=d._duration,p=d._soundById(u);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,d=u._sounds,f=0;f<d.length;f++)d[f]._paused||u.stop(d[f]._id),u._webAudio||(u._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(i._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),i._releaseHtml5Audio(d[f]._node)),delete d[f]._node,u._clearTimer(d[f]._id);var p=i._howls.indexOf(u);p>=0&&i._howls.splice(p,1);var m=!0;for(f=0;f<i._howls.length;f++)if(i._howls[f]._src===u._src||u._src.indexOf(i._howls[f]._src)>=0){m=!1;break}return s&&m&&delete s[u._src],i.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,d,f,p){var m=this,g=m["_on"+u];return typeof d=="function"&&g.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),m},off:function(u,d,f){var p=this,m=p["_on"+u],g=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(g=0;g<m.length;g++){var v=f===m[g].id;if(d===m[g].fn&&v||!d&&v){m.splice(g,1);break}}else if(u)p["_on"+u]=[];else{var y=Object.keys(p);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(p[y[g]])&&(p[y[g]]=[])}return p},once:function(u,d,f){var p=this;return p.on(u,d,f,1),p},_emit:function(u,d,f){for(var p=this,m=p["_on"+u],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===d||u==="load")&&(setTimeout((function(v){v.call(this,d,f)}).bind(p,m[g].fn),0),m[g].once&&p.off(u,m[g].fn,m[g].id));return p._loadQueue(u),p},_loadQueue:function(u){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===u&&(d._queue.shift(),d._loadQueue()),u||f.action()}return d},_ended:function(u){var d=this,f=u._sprite;if(!d._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(d._ended.bind(d,u),100),d;var p=!!(u._loop||d._sprite[f][2]);if(d._emit("end",u._id),!d._webAudio&&p&&d.stop(u._id,!0).play(u._id),d._webAudio&&p){d._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=i.ctx.currentTime;var m=(u._stop-u._start)*1e3/Math.abs(u._rate);d._endTimers[u._id]=setTimeout(d._ended.bind(d,u),m)}return d._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,d._clearTimer(u._id),d._cleanBuffer(u._node),i._autoSuspend()),!d._webAudio&&!p&&d.stop(u._id,!0),d},_clearTimer:function(u){var d=this;if(d._endTimers[u]){if(typeof d._endTimers[u]!="function")clearTimeout(d._endTimers[u]);else{var f=d._soundById(u);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[u],!1)}delete d._endTimers[u]}return d},_soundById:function(u){for(var d=this,f=0;f<d._sounds.length;f++)if(u===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var d=0;d<u._sounds.length;d++)if(u._sounds[d]._ended)return u._sounds[d].reset();return new r(u)},_drain:function(){var u=this,d=u._pool,f=0,p=0;if(!(u._sounds.length<d)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=d)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var d=this;if(typeof u>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var d=this;return u._node.bufferSource=i.ctx.createBufferSource(),u._node.bufferSource.buffer=s[d._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,i.ctx.currentTime),d},_cleanBuffer:function(u){var d=this,f=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=i._scratchBuffer}catch{}return u.bufferSource=null,d},_clearSound:function(u){var d=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);d||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(u){this._parent=u,this.init()};r.prototype={init:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,d._sounds.push(u),u.create(),u},create:function(){var u=this,d=u._parent,f=i._muted||u._muted||u._parent._muted?0:u._volume;return d._webAudio?(u._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),u._node.gain.setValueAtTime(f,i.ctx.currentTime),u._node.paused=!0,u._node.connect(i.masterGain)):i.noAudio||(u._node=i._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(i._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=d._src,u._node.preload=d._preload===!0?"auto":d._preload,u._node.volume=f*i.volume(),u._node.load()),u},reset:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++i._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,d=u._parent;d._duration=Math.ceil(u._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),u._node.removeEventListener(i._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,d=u._parent;d._duration===1/0&&(d._duration=Math.ceil(u._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},o=function(u){var d=u._src;if(s[d]){u._duration=s[d].duration,c(u);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),m=0;m<f.length;++m)p[m]=f.charCodeAt(m);l(p.buffer,u)}else{var g=new XMLHttpRequest;g.open(u._xhr.method,d,!0),g.withCredentials=u._xhr.withCredentials,g.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(v){g.setRequestHeader(v,u._xhr.headers[v])}),g.onload=function(){var v=(g.status+"")[0];if(v!=="0"&&v!=="2"&&v!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,u)},g.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[d],u.load())},a(g)}},a=function(u){try{u.send()}catch{u.onerror()}},l=function(u,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(m){m&&d._sounds.length>0?(s[d._src]=m,c(d,m)):f()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(u).then(p).catch(f):i.ctx.decodeAudioData(u,p,f)},c=function(u,d){d&&!u._duration&&(u._duration=d.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},h=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),d=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(u&&f&&f<9){var p=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!p&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:i,Howl:n}}),typeof t<"u"&&(t.Howler=i,t.Howl=n),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=i,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=i,window.Howl=n,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(i);return n},HowlerGlobal.prototype.pos=function(i,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof i=="number")s._pos=[i,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(i,n,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(n=typeof n!="number"?c[1]:n,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,o=typeof o!="number"?c[4]:o,a=typeof a!="number"?c[5]:a,typeof i=="number")l._orientation=[i,n,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(i,n,r,s,o,a);else return c;return l},Howl.prototype.init=function(i){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],i.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(i,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof i=="number")r._stereo=i,r._pos=[i,0,0];else return r._stereo;for(var o=r._getSoundIds(n),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof i=="number")l._stereo=i,l._pos=[i,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(i,0,0):l._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(i,n,r,s)}}),o;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof i=="number")o._pos=[i,n,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._pos=[i,n,r],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(i,n,r)),o._emit("pos",c._id);else return c._pos}return o},Howl.prototype.orientation=function(i,n,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(i,n,r,s)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof i=="number")o._orientation=[i,n,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof i=="number")c._orientation=[i,n,r],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(i,n,r)),o._emit("orientation",c._id);else return c._orientation}return o},Howl.prototype.pannerAttr=function(){var i=this,n=arguments,r,s,o;if(!i._webAudio)return i;if(n.length===0)return i._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),i._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:i._panningModel});else return o=i._soundById(parseInt(n[0],10)),o?o._pannerAttr:i._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var a=i._getSoundIds(s),l=0;l<a.length;l++)if(o=i._soundById(a[l]),o){var c=o._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var h=o._panner;h?(h.coneInnerAngle=c.coneInnerAngle,h.coneOuterAngle=c.coneOuterAngle,h.coneOuterGain=c.coneOuterGain,h.distanceModel=c.distanceModel,h.maxDistance=c.maxDistance,h.refDistance=c.refDistance,h.rolloffFactor=c.rolloffFactor,h.panningModel=c.panningModel):(o._pos||(o._pos=i._pos||[0,0,-.5]),e(o,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,i.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),i.call(this)}}(Sound.prototype.reset);var e=function(i,n){n=n||"spatial",n==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}}()}),lwe=D0((t,e)=>{e.exports=function(i,n){for(var r=i.split("."),s=n.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),L0="149",ca={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},cwe=0,p6=1,uwe=2,bk=1,hwe=2,Ix=3,Il=0,Tr=1,Ro=2,$n=0,_v=1,m6=2,g6=3,v6=4,dwe=5,Cg=100,fwe=101,pwe=102,y6=103,x6=104,mwe=200,gwe=201,vwe=202,ywe=203,QZ=204,JZ=205,xwe=206,_we=207,wwe=208,bwe=209,Swe=210,Awe=0,Mwe=1,Cwe=2,KB=3,Ewe=4,Twe=5,Pwe=6,Dwe=7,KZ=0,Iwe=1,Lwe=2,ku=0,Bwe=1,Rwe=2,Owe=3,Fwe=4,Nwe=5,ZZ=300,jp=301,Wp=302,ZB=303,$B=304,pw=306,Iu=1e3,kn=1001,eR=1002,ji=1003,_6=1004,RD=1005,Zt=1006,kwe=1007,s0=1008,fs=1009,zwe=1010,Uwe=1011,$Z=1012,Gwe=1013,$h=1014,Oo=1015,o0=1016,Vwe=1017,Hwe=1018,Ep=1020,jwe=1021,Ea=1023,Wwe=1024,Xwe=1025,Tp=1026,Xp=1027,qwe=1028,Ywe=1029,e$=1030,Qwe=1031,Jwe=1033,OD=33776,FD=33777,ND=33778,kD=33779,w6=35840,b6=35841,S6=35842,A6=35843,Kwe=36196,M6=37492,C6=37496,E6=37808,T6=37809,P6=37810,D6=37811,I6=37812,L6=37813,B6=37814,R6=37815,O6=37816,F6=37817,N6=37818,k6=37819,z6=37820,U6=37821,zD=36492,Zwe=36283,G6=36284,V6=36285,H6=36286,t$=2200,i$=2201,Sk=2202,CC=2300,EC=2301,UD=2302,$g=2400,ev=2401,TC=2402,Ak=2500,$we=2501,Dc=3e3,Vt=3001,th=3200,n$=3201,ebe=0,tbe=1,ac="srgb",PC="srgb-linear",GD=7680,ibe=519,tR=35044,j6="300 es",iR=1035,qr=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let i=this._listeners[t];if(i!==void 0){let n=i.indexOf(e);n!==-1&&i.splice(n,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let e=this._listeners[t.type];if(e!==void 0){t.target=this;let i=e.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,t);t.target=null}}},ns=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],W6=1234567,l1=Math.PI/180,f_=180/Math.PI;function Fa(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ns[t&255]+ns[t>>8&255]+ns[t>>16&255]+ns[t>>24&255]+"-"+ns[e&255]+ns[e>>8&255]+"-"+ns[e>>16&15|64]+ns[e>>24&255]+"-"+ns[i&63|128]+ns[i>>8&255]+"-"+ns[i>>16&255]+ns[i>>24&255]+ns[n&255]+ns[n>>8&255]+ns[n>>16&255]+ns[n>>24&255]).toLowerCase()}function ar(t,e,i){return Math.max(e,Math.min(i,t))}function Mk(t,e){return(t%e+e)%e}function nbe(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)}function rbe(t,e,i){return t!==e?(i-t)/(e-t):0}function c1(t,e,i){return(1-i)*t+i*e}function sbe(t,e,i,n){return c1(t,e,1-Math.exp(-i*n))}function obe(t,e=1){return e-Math.abs(Mk(t,e*2)-e)}function abe(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function lbe(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function cbe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function ube(t,e){return t+Math.random()*(e-t)}function hbe(t){return t*(.5-Math.random())}function dbe(t){t!==void 0&&(W6=t);let e=W6+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function fbe(t){return t*l1}function pbe(t){return t*f_}function nR(t){return(t&t-1)===0&&t!==0}function r$(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function DC(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function mbe(t,e,i,n,r){let s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((e+n)/2),h=o((e+n)/2),u=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Lu(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Vi(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var ri=Object.freeze({__proto__:null,DEG2RAD:l1,RAD2DEG:f_,ceilPowerOfTwo:r$,clamp:ar,damp:sbe,degToRad:fbe,denormalize:Lu,euclideanModulo:Mk,floorPowerOfTwo:DC,generateUUID:Fa,inverseLerp:rbe,isPowerOfTwo:nR,lerp:c1,mapLinear:nbe,normalize:Vi,pingpong:obe,radToDeg:pbe,randFloat:ube,randFloatSpread:hbe,randInt:cbe,seededRandom:dbe,setQuaternionFromProperEuler:mbe,smootherstep:lbe,smoothstep:abe}),ge=class{constructor(t=0,e=0){ge.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*i-s*n+t.x,this.y=r*n+s*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Pr=class{constructor(){Pr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,i,n,r,s,o,a,l){let c=this.elements;return c[0]=t,c[1]=n,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=i,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],f=i[8],p=n[0],m=n[3],g=n[6],v=n[1],y=n[4],x=n[7],b=n[2],S=n[5],A=n[8];return r[0]=s*p+o*v+a*b,r[3]=s*m+o*y+a*S,r[6]=s*g+o*x+a*A,r[1]=l*p+c*v+h*b,r[4]=l*m+c*y+h*S,r[7]=l*g+c*x+h*A,r[2]=u*p+d*v+f*b,r[5]=u*m+d*y+f*S,r[8]=u*g+d*x+f*A,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-i*r*c+i*o*a+n*r*l-n*s*a}invert(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=c*s-o*l,u=o*a-c*r,d=l*r-s*a,f=e*h+i*u+n*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return t[0]=h*p,t[1]=(n*l-c*i)*p,t[2]=(o*i-n*s)*p,t[3]=u*p,t[4]=(c*e-n*a)*p,t[5]=(n*r-o*e)*p,t[6]=d*p,t[7]=(i*a-l*e)*p,t[8]=(s*e-i*r)*p,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,r,s,o){let a=Math.cos(r),l=Math.sin(r);return this.set(i*a,i*l,-i*(a*s+l*o)+s+t,-n*l,n*a,-n*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(VD.makeScale(t,e)),this}rotate(t){return this.premultiply(VD.makeRotation(-t)),this}translate(t,e){return this.premultiply(VD.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,i=t.elements;for(let n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}},VD=new Pr;function s$(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}var gbe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function BS(t,e){return new gbe[t](e)}function IC(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Pp(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function SM(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var HD={[ac]:{[PC]:Pp},[PC]:{[ac]:SM}},ys={legacyMode:!0,get workingColorSpace(){return PC},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(HD[e]&&HD[e][i]!==void 0){let n=HD[e][i];return t.r=n(t.r),t.g=n(t.g),t.b=n(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},o$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ir={r:0,g:0,b:0},tl={h:0,s:0,l:0},RS={h:0,s:0,l:0};function jD(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}function OS(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var Tt=class{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,i===void 0&&n===void 0?this.set(e):this.setRGB(e,i,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=ac){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ys.toWorkingColorSpace(this,i),this}setRGB(e,i,n,r=ys.workingColorSpace){return this.r=e,this.g=i,this.b=n,ys.toWorkingColorSpace(this,r),this}setHSL(e,i,n,r=ys.workingColorSpace){if(e=Mk(e,1),i=ar(i,0,1),n=ar(n,0,1),i===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;this.r=jD(o,s,e+1/3),this.g=jD(o,s,e),this.b=jD(o,s,e-1/3)}return ys.toWorkingColorSpace(this,r),this}setStyle(e,i=ac){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,ys.toWorkingColorSpace(this,i),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,ys.toWorkingColorSpace(this,i),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return n(s[4]),this.setHSL(l,c,h,i)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,ys.toWorkingColorSpace(this,i),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,ys.toWorkingColorSpace(this,i),this}return e&&e.length>0?this.setColorName(e,i):this}setColorName(e,i=ac){let n=o$[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pp(e.r),this.g=Pp(e.g),this.b=Pp(e.b),this}copyLinearToSRGB(e){return this.r=SM(e.r),this.g=SM(e.g),this.b=SM(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ac){return ys.fromWorkingColorSpace(OS(this,ir),e),ar(ir.r*255,0,255)<<16^ar(ir.g*255,0,255)<<8^ar(ir.b*255,0,255)<<0}getHexString(e=ac){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=ys.workingColorSpace){ys.fromWorkingColorSpace(OS(this,ir),i);let n=ir.r,r=ir.g,s=ir.b,o=Math.max(n,r,s),a=Math.min(n,r,s),l,c,h=(a+o)/2;if(a===o)l=0,c=0;else{let u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case n:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-n)/u+2;break;case s:l=(n-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,i=ys.workingColorSpace){return ys.fromWorkingColorSpace(OS(this,ir),i),e.r=ir.r,e.g=ir.g,e.b=ir.b,e}getStyle(e=ac){return ys.fromWorkingColorSpace(OS(this,ir),e),e!==ac?`color(${e} ${ir.r} ${ir.g} ${ir.b})`:`rgb(${ir.r*255|0},${ir.g*255|0},${ir.b*255|0})`}offsetHSL(e,i,n){return this.getHSL(tl),tl.h+=e,tl.s+=i,tl.l+=n,this.setHSL(tl.h,tl.s,tl.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(tl),e.getHSL(RS);let n=c1(tl.h,RS.h,i),r=c1(tl.s,RS.s,i),s=c1(tl.l,RS.l,i);return this.setHSL(n,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Tt.NAMES=o$;var qm,a$=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{qm===void 0&&(qm=IC("canvas")),qm.width=t.width,qm.height=t.height;let i=qm.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=qm}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=IC("canvas");e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);let n=i.getImageData(0,0,t.width,t.height),r=n.data;for(let s=0;s<r.length;s++)r[s]=Pp(r[s]/255)*255;return i.putImageData(n,0,0),e}else if(t.data){let e=t.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(Pp(e[i]/255)*255):e[i]=Pp(e[i]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},l$=class{constructor(t=null){this.isSource=!0,this.uuid=Fa(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let s=0,o=n.length;s<o;s++)n[s].isDataTexture?r.push(WD(n[s].image)):r.push(WD(n[s]))}else r=WD(n);i.url=r}return e||(t.images[this.uuid]=i),i}};function WD(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?a$.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var vbe=0,ur=class extends qr{constructor(t=ur.DEFAULT_IMAGE,e=ur.DEFAULT_MAPPING,i=kn,n=kn,r=Zt,s=s0,o=Ea,a=fs,l=ur.DEFAULT_ANISOTROPY,c=Dc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:vbe++}),this.uuid=Fa(),this.name="",this.source=new l$(t),this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new ge(0,0),this.repeat=new ge(1,1),this.center=new ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==ZZ)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Iu:t.x=t.x-Math.floor(t.x);break;case kn:t.x=t.x<0?0:1;break;case eR:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Iu:t.y=t.y-Math.floor(t.y);break;case kn:t.y=t.y<0?0:1;break;case eR:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};ur.DEFAULT_IMAGE=null;ur.DEFAULT_MAPPING=ZZ;ur.DEFAULT_ANISOTROPY=1;var Ht=class{constructor(t=0,e=0,i=0,n=1){Ht.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,i=this.y,n=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*e+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*e+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*e+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,r,s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-f)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+f)<.1&&Math.abs(o+h+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let g=(o+1)/2,v=(h+1)/2,y=(p+1)/2,x=(a+c)/4,b=(l+d)/4,S=(u+f)/4;return g>v&&g>y?g<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(g),n=x/i,r=b/i):v>y?v<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(v),i=x/n,r=S/n):y<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(y),i=b/r,n=S/r),this.set(i,n,r,e),this}let m=Math.sqrt((f-u)*(f-u)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(m)<.001&&(m=1),this.x=(f-u)/m,this.y=(l-d)/m,this.z=(c-a)/m,this.w=Math.acos((o+h+p-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Li=class extends qr{constructor(t=1,e=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Ht(0,0,t,e),this.scissorTest=!1,this.viewport=new Ht(0,0,t,e);let n={width:t,height:e,depth:1};this.texture=new ur(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Zt,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,e,i=1){(this.width!==t||this.height!==e||this.depth!==i)&&(this.width=t,this.height=e,this.depth=i,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let e=Object.assign({},t.texture.image);return this.texture.source=new l$(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},c$=class extends ur{constructor(t=null,e=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=ji,this.minFilter=ji,this.wrapR=kn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ybe=class extends ur{constructor(t=null,e=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:n},this.magFilter=ji,this.minFilter=ji,this.wrapR=kn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},xbe=class extends Li{constructor(t=1,e=1,i=1,n={}){super(t,e,n),this.isWebGLMultipleRenderTargets=!0;let r=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=t,this.texture[n].image.height=e,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,i=t.texture.length;e<i;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}},qt=class{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,r,s,o){let a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(o===0){t[e+0]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h;return}if(o===1){t[e+0]=u,t[e+1]=d,t[e+2]=f,t[e+3]=p;return}if(h!==p||a!==u||l!==d||c!==f){let m=1-o,g=a*u+l*d+c*f+h*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let b=Math.sqrt(y),S=Math.atan2(b,g*v);m=Math.sin(m*S)/b,o=Math.sin(o*S)/b}let x=o*v;if(a=a*m+u*x,l=l*m+d*x,c=c*m+f*x,h=h*m+p*x,m===1-o){let b=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=b,l*=b,c*=b,h*=b}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,r,s){let o=i[n],a=i[n+1],l=i[n+2],c=i[n+3],h=r[s],u=r[s+1],d=r[s+2],f=r[s+3];return t[e]=o*f+c*h+a*d-l*u,t[e+1]=a*f+c*u+l*h-o*d,t[e+2]=l*f+c*d+o*u-a*h,t[e+3]=c*f-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){let i=t._x,n=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(r/2),u=a(i/2),d=a(n/2),f=a(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,i=e[0],n=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=i+o+h;if(u>0){let d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-a)*d,this._y=(r-l)*d,this._z=(s-n)*d}else if(i>o&&i>h){let d=2*Math.sqrt(1+i-o-h);this._w=(c-a)/d,this._x=.25*d,this._y=(n+s)/d,this._z=(r+l)/d}else if(o>h){let d=2*Math.sqrt(1+o-i-h);this._w=(r-l)/d,this._x=(n+s)/d,this._y=.25*d,this._z=(a+c)/d}else{let d=2*Math.sqrt(1+h-i-o);this._w=(s-n)/d,this._x=(r+l)/d,this._y=(a+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(ar(this.dot(t),-1,1)))}rotateTowards(t,e){let i=this.angleTo(t);if(i===0)return this;let n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let i=t._x,n=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=i*c+s*o+n*l-r*a,this._y=n*c+s*a+r*o-i*l,this._z=r*c+s*l+i*a-n*o,this._w=s*c-i*o-n*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let i=this._x,n=this._y,r=this._z,s=this._w,o=s*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*i+e*this._x,this._y=d*n+e*this._y,this._z=d*r+e*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=s*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){let t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(r),i*Math.cos(r),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},O=class{constructor(t=0,e=0,i=0){O.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return i===void 0&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(X6.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(X6.setFromAxisAngle(t,e))}applyMatrix3(t){let e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let e=this.x,i=this.y,n=this.z,r=t.elements,s=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(t){let e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*n-o*i,c=a*i+o*e-r*n,h=a*n+r*i-s*e,u=-r*e-s*i-o*n;return this.x=l*a+u*-r+c*-o-h*-s,this.y=c*a+u*-s+h*-r-l*-o,this.z=h*a+u*-o+l*-s-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){let i=t.x,n=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this}projectOnVector(t){let e=t.lengthSq();if(e===0)return this.set(0,0,0);let i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return XD.copy(this).projectOnVector(t),this.sub(XD)}reflect(t){return this.sub(XD.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;let i=this.dot(t)/e;return Math.acos(ar(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){let n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){let e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},XD=new O,X6=new qt,Gn=class{constructor(t=new O(1/0,1/0,1/0),e=new O(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){let c=t[a],h=t[a+1],u=t[a+2];c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){let c=t.getX(a),h=t.getY(a),u=t.getZ(a);c<e&&(e=c),h<i&&(i=h),u<n&&(n=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=Af.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let i=t.geometry;if(i!==void 0)if(e&&i.attributes!=null&&i.attributes.position!==void 0){let r=i.attributes.position;for(let s=0,o=r.count;s<o;s++)Af.fromBufferAttribute(r,s).applyMatrix4(t.matrixWorld),this.expandByPoint(Af)}else i.boundingBox===null&&i.computeBoundingBox(),qD.copy(i.boundingBox),qD.applyMatrix4(t.matrixWorld),this.union(qD);let n=t.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Af),Af.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Hy),FS.subVectors(this.max,Hy),Ym.subVectors(t.a,Hy),Qm.subVectors(t.b,Hy),Jm.subVectors(t.c,Hy),xh.subVectors(Qm,Ym),_h.subVectors(Jm,Qm),Mf.subVectors(Ym,Jm);let e=[0,-xh.z,xh.y,0,-_h.z,_h.y,0,-Mf.z,Mf.y,xh.z,0,-xh.x,_h.z,0,-_h.x,Mf.z,0,-Mf.x,-xh.y,xh.x,0,-_h.y,_h.x,0,-Mf.y,Mf.x,0];return!YD(e,Ym,Qm,Jm,FS)||(e=[1,0,0,0,1,0,0,0,1],!YD(e,Ym,Qm,Jm,FS))?!1:(NS.crossVectors(xh,_h),e=[NS.x,NS.y,NS.z],YD(e,Ym,Qm,Jm,FS))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Af.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Af).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:($c[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),$c[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),$c[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),$c[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),$c[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),$c[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),$c[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),$c[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints($c),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},$c=[new O,new O,new O,new O,new O,new O,new O,new O],Af=new O,qD=new Gn,Ym=new O,Qm=new O,Jm=new O,xh=new O,_h=new O,Mf=new O,Hy=new O,FS=new O,NS=new O,Cf=new O;function YD(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){Cf.fromArray(t,s);let a=r.x*Math.abs(Cf.x)+r.y*Math.abs(Cf.y)+r.z*Math.abs(Cf.z),l=e.dot(Cf),c=i.dot(Cf),h=n.dot(Cf);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}var _be=new Gn,jy=new O,QD=new O,qo=class{constructor(t=new O,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let i=this.center;e!==void 0?i.copy(e):_be.setFromPoints(t).getCenter(i);let n=0;for(let r=0,s=t.length;r<s;r++)n=Math.max(n,i.distanceToSquared(t[r]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;jy.subVectors(t,this.center);let e=jy.lengthSq();if(e>this.radius*this.radius){let i=Math.sqrt(e),n=(i-this.radius)*.5;this.center.addScaledVector(jy,n/i),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(QD.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(jy.copy(t.center).add(QD)),this.expandByPoint(jy.copy(t.center).sub(QD))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},eu=new O,JD=new O,kS=new O,wh=new O,KD=new O,zS=new O,ZD=new O,B0=class{constructor(t=new O,e=new O(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,eu)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=eu.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(eu.copy(this.direction).multiplyScalar(e).add(this.origin),eu.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){JD.copy(t).add(e).multiplyScalar(.5),kS.copy(e).sub(t).normalize(),wh.copy(this.origin).sub(JD);let r=t.distanceTo(e)*.5,s=-this.direction.dot(kS),o=wh.dot(this.direction),a=-wh.dot(kS),l=wh.lengthSq(),c=Math.abs(1-s*s),h,u,d,f;if(c>0)if(h=s*a-o,u=s*o-a,f=r*c,h>=0)if(u>=-f)if(u<=f){let p=1/c;h*=p,u*=p,d=h*(h+s*u+2*o)+u*(s*h+u+2*a)+l}else u=r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u=-r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-f?(h=Math.max(0,-(-s*r+o)),u=h>0?-r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l):u<=f?(h=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+l):(h=Math.max(0,-(s*r+o)),u=h>0?r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),n&&n.copy(kS).multiplyScalar(u).add(JD),d}intersectSphere(t,e){eu.subVectors(t.center,this.origin);let i=eu.dot(this.direction),n=eu.dot(eu)-i*i,r=t.radius*t.radius;if(n>r)return null;let s=Math.sqrt(r-n),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){let i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,s,o,a,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,s=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,s=(t.min.y-u.y)*c),i>s||r>n||((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),h>=0?(o=(t.min.z-u.z)*h,a=(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,a=(t.min.z-u.z)*h),i>a||o>n)||((o>i||i!==i)&&(i=o),(a<n||n!==n)&&(n=a),n<0)?null:this.at(i>=0?i:n,e)}intersectsBox(t){return this.intersectBox(t,eu)!==null}intersectTriangle(t,e,i,n,r){KD.subVectors(e,t),zS.subVectors(i,t),ZD.crossVectors(KD,zS);let s=this.direction.dot(ZD),o;if(s>0){if(n)return null;o=1}else if(s<0)o=-1,s=-s;else return null;wh.subVectors(this.origin,t);let a=o*this.direction.dot(zS.crossVectors(wh,zS));if(a<0)return null;let l=o*this.direction.dot(KD.cross(wh));if(l<0||a+l>s)return null;let c=-o*wh.dot(ZD);return c<0?null:this.at(c/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Qe=class{constructor(){Qe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m){let g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qe().fromArray(this.elements)}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){let e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){let e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){let e=this.elements,i=t.elements,n=1/Km.setFromMatrixColumn(t,0).length(),r=1/Km.setFromMatrixColumn(t,1).length(),s=1/Km.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){let e=this.elements,i=t.x,n=t.y,r=t.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if(t.order==="XYZ"){let u=s*c,d=s*h,f=o*c,p=o*h;e[0]=a*c,e[4]=-a*h,e[8]=l,e[1]=d+f*l,e[5]=u-p*l,e[9]=-o*a,e[2]=p-u*l,e[6]=f+d*l,e[10]=s*a}else if(t.order==="YXZ"){let u=a*c,d=a*h,f=l*c,p=l*h;e[0]=u+p*o,e[4]=f*o-d,e[8]=s*l,e[1]=s*h,e[5]=s*c,e[9]=-o,e[2]=d*o-f,e[6]=p+u*o,e[10]=s*a}else if(t.order==="ZXY"){let u=a*c,d=a*h,f=l*c,p=l*h;e[0]=u-p*o,e[4]=-s*h,e[8]=f+d*o,e[1]=d+f*o,e[5]=s*c,e[9]=p-u*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if(t.order==="ZYX"){let u=s*c,d=s*h,f=o*c,p=o*h;e[0]=a*c,e[4]=f*l-d,e[8]=u*l+p,e[1]=a*h,e[5]=p*l+u,e[9]=d*l-f,e[2]=-l,e[6]=o*a,e[10]=s*a}else if(t.order==="YZX"){let u=s*a,d=s*l,f=o*a,p=o*l;e[0]=a*c,e[4]=p-u*h,e[8]=f*h+d,e[1]=h,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=d*h+f,e[10]=u-p*h}else if(t.order==="XZY"){let u=s*a,d=s*l,f=o*a,p=o*l;e[0]=a*c,e[4]=-h,e[8]=l*c,e[1]=u*h+p,e[5]=s*c,e[9]=d*h-f,e[2]=f*h-d,e[6]=o*c,e[10]=p*h+u}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(wbe,t,bbe)}lookAt(t,e,i){let n=this.elements;return Ao.subVectors(t,e),Ao.lengthSq()===0&&(Ao.z=1),Ao.normalize(),bh.crossVectors(i,Ao),bh.lengthSq()===0&&(Math.abs(i.z)===1?Ao.x+=1e-4:Ao.z+=1e-4,Ao.normalize(),bh.crossVectors(i,Ao)),bh.normalize(),US.crossVectors(Ao,bh),n[0]=bh.x,n[4]=US.x,n[8]=Ao.x,n[1]=bh.y,n[5]=US.y,n[9]=Ao.y,n[2]=bh.z,n[6]=US.z,n[10]=Ao.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],b=i[15],S=n[0],A=n[4],E=n[8],M=n[12],T=n[1],P=n[5],I=n[9],k=n[13],R=n[2],F=n[6],V=n[10],Q=n[14],X=n[3],z=n[7],Y=n[11],j=n[15];return r[0]=s*S+o*T+a*R+l*X,r[4]=s*A+o*P+a*F+l*z,r[8]=s*E+o*I+a*V+l*Y,r[12]=s*M+o*k+a*Q+l*j,r[1]=c*S+h*T+u*R+d*X,r[5]=c*A+h*P+u*F+d*z,r[9]=c*E+h*I+u*V+d*Y,r[13]=c*M+h*k+u*Q+d*j,r[2]=f*S+p*T+m*R+g*X,r[6]=f*A+p*P+m*F+g*z,r[10]=f*E+p*I+m*V+g*Y,r[14]=f*M+p*k+m*Q+g*j,r[3]=v*S+y*T+x*R+b*X,r[7]=v*A+y*P+x*F+b*z,r[11]=v*E+y*I+x*V+b*Y,r[15]=v*M+y*k+x*Q+b*j,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14],f=t[3],p=t[7],m=t[11],g=t[15];return f*(+r*a*h-n*l*h-r*o*u+i*l*u+n*o*d-i*a*d)+p*(+e*a*d-e*l*u+r*s*u-n*s*d+n*l*c-r*a*c)+m*(+e*l*h-e*o*d-r*s*h+i*s*d+r*o*c-i*l*c)+g*(-n*o*c-e*a*h+e*o*u+n*s*h-i*s*u+i*a*c)}transpose(){let t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){let t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=h*m*l-p*u*l+p*a*d-o*m*d-h*a*g+o*u*g,y=f*u*l-c*m*l-f*a*d+s*m*d+c*a*g-s*u*g,x=c*p*l-f*h*l+f*o*d-s*p*d-c*o*g+s*h*g,b=f*h*a-c*p*a-f*o*u+s*p*u+c*o*m-s*h*m,S=e*v+i*y+n*x+r*b;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let A=1/S;return t[0]=v*A,t[1]=(p*u*r-h*m*r-p*n*d+i*m*d+h*n*g-i*u*g)*A,t[2]=(o*m*r-p*a*r+p*n*l-i*m*l-o*n*g+i*a*g)*A,t[3]=(h*a*r-o*u*r-h*n*l+i*u*l+o*n*d-i*a*d)*A,t[4]=y*A,t[5]=(c*m*r-f*u*r+f*n*d-e*m*d-c*n*g+e*u*g)*A,t[6]=(f*a*r-s*m*r-f*n*l+e*m*l+s*n*g-e*a*g)*A,t[7]=(s*u*r-c*a*r+c*n*l-e*u*l-s*n*d+e*a*d)*A,t[8]=x*A,t[9]=(f*h*r-c*p*r-f*i*d+e*p*d+c*i*g-e*h*g)*A,t[10]=(s*p*r-f*o*r+f*i*l-e*p*l-s*i*g+e*o*g)*A,t[11]=(c*o*r-s*h*r-c*i*l+e*h*l+s*i*d-e*o*d)*A,t[12]=b*A,t[13]=(c*p*n-f*h*n+f*i*u-e*p*u-c*i*m+e*h*m)*A,t[14]=(f*o*n-s*p*n-f*i*a+e*p*a+s*i*m-e*o*m)*A,t[15]=(s*h*n-c*o*n+c*i*a-e*h*a-s*i*u+e*o*u)*A,this}scale(t){let e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){let t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){let e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){let i=Math.cos(e),n=Math.sin(e),r=1-i,s=t.x,o=t.y,a=t.z,l=r*s,c=r*o;return this.set(l*s+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*s,0,l*a-n*o,c*a+n*s,r*a*a+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,r,s){return this.set(1,i,r,0,t,1,s,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){let n=this.elements,r=e._x,s=e._y,o=e._z,a=e._w,l=r+r,c=s+s,h=o+o,u=r*l,d=r*c,f=r*h,p=s*c,m=s*h,g=o*h,v=a*l,y=a*c,x=a*h,b=i.x,S=i.y,A=i.z;return n[0]=(1-(p+g))*b,n[1]=(d+x)*b,n[2]=(f-y)*b,n[3]=0,n[4]=(d-x)*S,n[5]=(1-(u+g))*S,n[6]=(m+v)*S,n[7]=0,n[8]=(f+y)*A,n[9]=(m-v)*A,n[10]=(1-(u+p))*A,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){let n=this.elements,r=Km.set(n[0],n[1],n[2]).length(),s=Km.set(n[4],n[5],n[6]).length(),o=Km.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],il.copy(this);let a=1/r,l=1/s,c=1/o;return il.elements[0]*=a,il.elements[1]*=a,il.elements[2]*=a,il.elements[4]*=l,il.elements[5]*=l,il.elements[6]*=l,il.elements[8]*=c,il.elements[9]*=c,il.elements[10]*=c,e.setFromRotationMatrix(il),i.x=r,i.y=s,i.z=o,this}makePerspective(t,e,i,n,r,s){let o=this.elements,a=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,i,n,r,s){let o=this.elements,a=1/(e-t),l=1/(i-n),c=1/(s-r),h=(e+t)*a,u=(i+n)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let e=this.elements,i=t.elements;for(let n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},Km=new O,il=new Qe,wbe=new O(0,0,0),bbe=new O(1,1,1),bh=new O,US=new O,Ao=new O,q6=new Qe,Y6=new qt,Er=class{constructor(t=0,e=0,i=0,n=Er.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){let n=t.elements,r=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(ar(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ar(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(ar(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-ar(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(ar(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-ar(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return q6.makeRotationFromQuaternion(t),this.setFromRotationMatrix(q6,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Y6.setFromEuler(this),this.setFromQuaternion(Y6,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Er.DEFAULT_ORDER="XYZ";var Ck=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},Sbe=0,Q6=new O,Zm=new qt,tu=new Qe,GS=new O,Wy=new O,Abe=new O,Mbe=new qt,J6=new O(1,0,0),K6=new O(0,1,0),Z6=new O(0,0,1),Cbe={type:"added"},$6={type:"removed"},Ri=class extends qr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Sbe++}),this.uuid=Fa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ri.DEFAULT_UP.clone();let t=new O,e=new Er,i=new qt,n=new O(1,1,1);function r(){i.setFromEuler(e,!1)}function s(){e.setFromQuaternion(i,void 0,!1)}e._onChange(r),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Qe},normalMatrix:{value:new Pr}}),this.matrix=new Qe,this.matrixWorld=new Qe,this.matrixAutoUpdate=Ri.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Ri.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Ck,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Zm.setFromAxisAngle(t,e),this.quaternion.multiply(Zm),this}rotateOnWorldAxis(t,e){return Zm.setFromAxisAngle(t,e),this.quaternion.premultiply(Zm),this}rotateX(t){return this.rotateOnAxis(J6,t)}rotateY(t){return this.rotateOnAxis(K6,t)}rotateZ(t){return this.rotateOnAxis(Z6,t)}translateOnAxis(t,e){return Q6.copy(t).applyQuaternion(this.quaternion),this.position.add(Q6.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(J6,t)}translateY(t){return this.translateOnAxis(K6,t)}translateZ(t){return this.translateOnAxis(Z6,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(tu.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?GS.copy(t):GS.set(t,e,i);let n=this.parent;this.updateWorldMatrix(!0,!1),Wy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?tu.lookAt(Wy,GS,this.up):tu.lookAt(GS,Wy,this.up),this.quaternion.setFromRotationMatrix(tu),n&&(tu.extractRotation(n.matrixWorld),Zm.setFromRotationMatrix(tu),this.quaternion.premultiply(Zm.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Cbe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent($6)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent($6)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),tu.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),tu.multiply(t.parent.matrixWorld)),t.applyMatrix4(tu),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){let r=this.children[i].getObjectByProperty(t,e);if(r!==void 0)return r}}getObjectsByProperty(t,e){let i=[];this[t]===e&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){let s=this.children[n].getObjectsByProperty(t,e);s.length>0&&(i=i.concat(s))}return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wy,t,Abe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wy,Mbe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){let e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let i=0,n=e.length;i<n;i++){let r=e[i];(r.matrixWorldAutoUpdate===!0||t===!0)&&r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){let i=this.parent;if(t===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let n=this.children;for(let r=0,s=n.length;r<s;r++){let o=n[r];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){let e=t===void 0||typeof t=="string",i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(t)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let a=o.shapes;if(Array.isArray(a))for(let l=0,c=a.length;l<c;l++){let h=a[l];r(t.shapes,h)}else r(t.shapes,a)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let a=0,l=this.material.length;a<l;a++)o.push(r(t.materials,this.material[a]));n.material=o}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){let a=this.animations[o];n.animations.push(r(t.animations,a))}}if(e){let o=s(t.geometries),a=s(t.materials),l=s(t.textures),c=s(t.images),h=s(t.shapes),u=s(t.skeletons),d=s(t.animations),f=s(t.nodes);o.length>0&&(i.geometries=o),a.length>0&&(i.materials=a),l.length>0&&(i.textures=l),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),u.length>0&&(i.skeletons=u),d.length>0&&(i.animations=d),f.length>0&&(i.nodes=f)}return i.object=n,i;function s(o){let a=[];for(let l in o){let c=o[l];delete c.metadata,a.push(c)}return a}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let i=0;i<t.children.length;i++){let n=t.children[i];this.add(n.clone())}return this}};Ri.DEFAULT_UP=new O(0,1,0);Ri.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ri.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var nl=new O,iu=new O,$D=new O,nu=new O,$m=new O,eg=new O,ej=new O,e3=new O,t3=new O,i3=new O,ls=class{constructor(t=new O,e=new O,i=new O){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),nl.subVectors(t,e),n.cross(nl);let r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(t,e,i,n,r){nl.subVectors(n,e),iu.subVectors(i,e),$D.subVectors(t,e);let s=nl.dot(nl),o=nl.dot(iu),a=nl.dot($D),l=iu.dot(iu),c=iu.dot($D),h=s*l-o*o;if(h===0)return r.set(-2,-1,-1);let u=1/h,d=(l*a-o*c)*u,f=(s*c-o*a)*u;return r.set(1-d-f,f,d)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,nu),nu.x>=0&&nu.y>=0&&nu.x+nu.y<=1}static getUV(t,e,i,n,r,s,o,a){return this.getBarycoord(t,e,i,n,nu),a.set(0,0),a.addScaledVector(r,nu.x),a.addScaledVector(s,nu.y),a.addScaledVector(o,nu.z),a}static isFrontFacing(t,e,i,n){return nl.subVectors(i,e),iu.subVectors(t,e),nl.cross(iu).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return nl.subVectors(this.c,this.b),iu.subVectors(this.a,this.b),nl.cross(iu).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ls.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ls.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return ls.getUV(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return ls.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ls.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let i=this.a,n=this.b,r=this.c,s,o;$m.subVectors(n,i),eg.subVectors(r,i),e3.subVectors(t,i);let a=$m.dot(e3),l=eg.dot(e3);if(a<=0&&l<=0)return e.copy(i);t3.subVectors(t,n);let c=$m.dot(t3),h=eg.dot(t3);if(c>=0&&h<=c)return e.copy(n);let u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(i).addScaledVector($m,s);i3.subVectors(t,r);let d=$m.dot(i3),f=eg.dot(i3);if(f>=0&&d<=f)return e.copy(r);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(i).addScaledVector(eg,o);let m=c*f-d*h;if(m<=0&&h-c>=0&&d-f>=0)return ej.subVectors(r,n),o=(h-c)/(h-c+(d-f)),e.copy(n).addScaledVector(ej,o);let g=1/(m+p+u);return s=p*g,o=u*g,e.copy(i).addScaledVector($m,s).addScaledVector(eg,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},Ebe=0,mw=class extends qr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ebe++}),this.uuid=Fa(),this.name="",this.type="Material",this.blending=_v,this.side=Il,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=QZ,this.blendDst=JZ,this.blendEquation=Cg,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=KB,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ibe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=GD,this.stencilZFail=GD,this.stencilZPass=GD,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let i=t[e];if(i===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}let n=this[e];if(n===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==_v&&(i.blending=this.blending),this.side!==Il&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(r){let s=[];for(let o in r){let a=r[o];delete a.metadata,s.push(a)}return s}if(e){let r=n(t.textures),s=n(t.images);r.length>0&&(i.textures=r),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,i=null;if(e!==null){let n=e.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},gw=class extends mw{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Tt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=KZ,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},Wn=new O,VS=new ge,Ot=class{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=i,this.usage=tR,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)VS.fromBufferAttribute(this,e),VS.applyMatrix3(t),this.setXY(e,VS.x,VS.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)Wn.fromBufferAttribute(this,e),Wn.applyMatrix3(t),this.setXYZ(e,Wn.x,Wn.y,Wn.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)Wn.fromBufferAttribute(this,e),Wn.applyMatrix4(t),this.setXYZ(e,Wn.x,Wn.y,Wn.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Wn.fromBufferAttribute(this,e),Wn.applyNormalMatrix(t),this.setXYZ(e,Wn.x,Wn.y,Wn.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Wn.fromBufferAttribute(this,e),Wn.transformDirection(t),this.setXYZ(e,Wn.x,Wn.y,Wn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Lu(e,this.array)),e}setX(t,e){return this.normalized&&(e=Vi(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Lu(e,this.array)),e}setY(t,e){return this.normalized&&(e=Vi(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Lu(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Vi(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Lu(e,this.array)),e}setW(t,e){return this.normalized&&(e=Vi(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array),n=Vi(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t*=this.itemSize,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==tR&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},u$=class extends Ot{constructor(t,e,i){super(new Uint16Array(t),e,i)}},wv=class extends Ot{constructor(t,e,i){super(new Uint32Array(t),e,i)}},gt=class extends Ot{constructor(t,e,i){super(new Float32Array(t),e,i)}},Tbe=0,ua=new Qe,n3=new Ri,tg=new O,Mo=new Gn,Xy=new Gn,Sr=new O,Rt=class extends qr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Tbe++}),this.uuid=Fa(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(s$(t)?wv:u$)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let r=new Pr().getNormalMatrix(t);i.applyNormalMatrix(r),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return ua.makeRotationFromQuaternion(t),this.applyMatrix4(ua),this}rotateX(t){return ua.makeRotationX(t),this.applyMatrix4(ua),this}rotateY(t){return ua.makeRotationY(t),this.applyMatrix4(ua),this}rotateZ(t){return ua.makeRotationZ(t),this.applyMatrix4(ua),this}translate(t,e,i){return ua.makeTranslation(t,e,i),this.applyMatrix4(ua),this}scale(t,e,i){return ua.makeScale(t,e,i),this.applyMatrix4(ua),this}lookAt(t){return n3.lookAt(t),n3.updateMatrix(),this.applyMatrix4(n3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tg).negate(),this.translate(tg.x,tg.y,tg.z),this}setFromPoints(t){let e=[];for(let i=0,n=t.length;i<n;i++){let r=t[i];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new gt(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gn);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new O(-1/0,-1/0,-1/0),new O(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let i=0,n=e.length;i<n;i++){let r=e[i];Mo.setFromBufferAttribute(r),this.morphTargetsRelative?(Sr.addVectors(this.boundingBox.min,Mo.min),this.boundingBox.expandByPoint(Sr),Sr.addVectors(this.boundingBox.max,Mo.max),this.boundingBox.expandByPoint(Sr)):(this.boundingBox.expandByPoint(Mo.min),this.boundingBox.expandByPoint(Mo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new qo);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new O,1/0);return}if(t){let i=this.boundingSphere.center;if(Mo.setFromBufferAttribute(t),e)for(let r=0,s=e.length;r<s;r++){let o=e[r];Xy.setFromBufferAttribute(o),this.morphTargetsRelative?(Sr.addVectors(Mo.min,Xy.min),Mo.expandByPoint(Sr),Sr.addVectors(Mo.max,Xy.max),Mo.expandByPoint(Sr)):(Mo.expandByPoint(Xy.min),Mo.expandByPoint(Xy.max))}Mo.getCenter(i);let n=0;for(let r=0,s=t.count;r<s;r++)Sr.fromBufferAttribute(t,r),n=Math.max(n,i.distanceToSquared(Sr));if(e)for(let r=0,s=e.length;r<s;r++){let o=e[r],a=this.morphTargetsRelative;for(let l=0,c=o.count;l<c;l++)Sr.fromBufferAttribute(o,l),a&&(tg.fromBufferAttribute(t,l),Sr.add(tg)),n=Math.max(n,i.distanceToSquared(Sr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.array,n=e.position.array,r=e.normal.array,s=e.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ot(new Float32Array(4*o),4));let a=this.getAttribute("tangent").array,l=[],c=[];for(let T=0;T<o;T++)l[T]=new O,c[T]=new O;let h=new O,u=new O,d=new O,f=new ge,p=new ge,m=new ge,g=new O,v=new O;function y(T,P,I){h.fromArray(n,T*3),u.fromArray(n,P*3),d.fromArray(n,I*3),f.fromArray(s,T*2),p.fromArray(s,P*2),m.fromArray(s,I*2),u.sub(h),d.sub(h),p.sub(f),m.sub(f);let k=1/(p.x*m.y-m.x*p.y);!isFinite(k)||(g.copy(u).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(k),v.copy(d).multiplyScalar(p.x).addScaledVector(u,-m.x).multiplyScalar(k),l[T].add(g),l[P].add(g),l[I].add(g),c[T].add(v),c[P].add(v),c[I].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:i.length}]);for(let T=0,P=x.length;T<P;++T){let I=x[T],k=I.start,R=I.count;for(let F=k,V=k+R;F<V;F+=3)y(i[F+0],i[F+1],i[F+2])}let b=new O,S=new O,A=new O,E=new O;function M(T){A.fromArray(r,T*3),E.copy(A);let P=l[T];b.copy(P),b.sub(A.multiplyScalar(A.dot(P))).normalize(),S.crossVectors(E,P);let I=S.dot(c[T])<0?-1:1;a[T*4]=b.x,a[T*4+1]=b.y,a[T*4+2]=b.z,a[T*4+3]=I}for(let T=0,P=x.length;T<P;++T){let I=x[T],k=I.start,R=I.count;for(let F=k,V=k+R;F<V;F+=3)M(i[F+0]),M(i[F+1]),M(i[F+2])}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(e!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ot(new Float32Array(e.count*3),3),this.setAttribute("normal",i);else for(let u=0,d=i.count;u<d;u++)i.setXYZ(u,0,0,0);let n=new O,r=new O,s=new O,o=new O,a=new O,l=new O,c=new O,h=new O;if(t)for(let u=0,d=t.count;u<d;u+=3){let f=t.getX(u+0),p=t.getX(u+1),m=t.getX(u+2);n.fromBufferAttribute(e,f),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,m),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),o.fromBufferAttribute(i,f),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,m),o.add(c),a.add(c),l.add(c),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let u=0,d=e.count;u<d;u+=3)n.fromBufferAttribute(e,u+0),r.fromBufferAttribute(e,u+1),s.fromBufferAttribute(e,u+2),c.subVectors(s,r),h.subVectors(n,r),c.cross(h),i.setXYZ(u+0,c.x,c.y,c.z),i.setXYZ(u+1,c.x,c.y,c.z),i.setXYZ(u+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Sr.fromBufferAttribute(t,e),Sr.normalize(),t.setXYZ(e,Sr.x,Sr.y,Sr.z)}toNonIndexed(){function t(o,a){let l=o.array,c=o.itemSize,h=o.normalized,u=new l.constructor(a.length*c),d=0,f=0;for(let p=0,m=a.length;p<m;p++){o.isInterleavedBufferAttribute?d=a[p]*o.data.stride+o.offset:d=a[p]*c;for(let g=0;g<c;g++)u[f++]=l[d++]}return new Ot(u,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new Rt,i=this.index.array,n=this.attributes;for(let o in n){let a=n[o],l=t(a,i);e.setAttribute(o,l)}let r=this.morphAttributes;for(let o in r){let a=[],l=r[o];for(let c=0,h=l.length;c<h;c++){let u=l[c],d=t(u,i);a.push(d)}e.morphAttributes[o]=a}e.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let o=0,a=s.length;o<a;o++){let l=s[o];e.addGroup(l.start,l.count,l.materialIndex)}return e}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let a=this.parameters;for(let l in a)a[l]!==void 0&&(t[l]=a[l]);return t}t.data={attributes:{}};let e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let i=this.attributes;for(let a in i){let l=i[a];t.data.attributes[a]=l.toJSON(t.data)}let n={},r=!1;for(let a in this.morphAttributes){let l=this.morphAttributes[a],c=[];for(let h=0,u=l.length;h<u;h++){let d=l[h];c.push(d.toJSON(t.data))}c.length>0&&(n[a]=c,r=!0)}r&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));let o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone(e));let n=t.attributes;for(let l in n){let c=n[l];this.setAttribute(l,c.clone(e))}let r=t.morphAttributes;for(let l in r){let c=[],h=r[l];for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone(e));this.morphAttributes[l]=c}this.morphTargetsRelative=t.morphTargetsRelative;let s=t.groups;for(let l=0,c=s.length;l<c;l++){let h=s[l];this.addGroup(h.start,h.count,h.materialIndex)}let o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());let a=t.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},tj=new Qe,ig=new B0,r3=new qo,qy=new O,Yy=new O,Qy=new O,s3=new O,HS=new O,jS=new ge,WS=new ge,XS=new ge,o3=new O,qS=new O,$s=class extends Ri{constructor(t=new Rt,e=new gw){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}getVertexPosition(t,e){let i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;e.fromBufferAttribute(n,t);let o=this.morphTargetInfluences;if(r&&o){HS.set(0,0,0);for(let a=0,l=r.length;a<l;a++){let c=o[a],h=r[a];c!==0&&(s3.fromBufferAttribute(h,t),s?HS.addScaledVector(s3,c):HS.addScaledVector(s3.sub(e),c))}e.add(HS)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){let i=this.geometry,n=this.material,r=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),r3.copy(i.boundingSphere),r3.applyMatrix4(r),t.ray.intersectsSphere(r3)===!1)||(tj.copy(r).invert(),ig.copy(t.ray).applyMatrix4(tj),i.boundingBox!==null&&ig.intersectsBox(i.boundingBox)===!1))return;let s,o=i.index,a=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv2,h=i.groups,u=i.drawRange;if(o!==null)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],m=n[p.materialIndex],g=Math.max(p.start,u.start),v=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,x=v;y<x;y+=3){let b=o.getX(y),S=o.getX(y+1),A=o.getX(y+2);s=YS(this,m,t,ig,l,c,b,S,A),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=d,m=f;p<m;p+=3){let g=o.getX(p),v=o.getX(p+1),y=o.getX(p+2);s=YS(this,n,t,ig,l,c,g,v,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(n))for(let d=0,f=h.length;d<f;d++){let p=h[d],m=n[p.materialIndex],g=Math.max(p.start,u.start),v=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,x=v;y<x;y+=3){let b=y,S=y+1,A=y+2;s=YS(this,m,t,ig,l,c,b,S,A),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=d,m=f;p<m;p+=3){let g=p,v=p+1,y=p+2;s=YS(this,n,t,ig,l,c,g,v,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}}};function Pbe(t,e,i,n,r,s,o,a){let l;if(e.side===Tr?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Il,a),l===null)return null;qS.copy(a),qS.applyMatrix4(t.matrixWorld);let c=i.ray.origin.distanceTo(qS);return c<i.near||c>i.far?null:{distance:c,point:qS.clone(),object:t}}function YS(t,e,i,n,r,s,o,a,l){t.getVertexPosition(o,qy),t.getVertexPosition(a,Yy),t.getVertexPosition(l,Qy);let c=Pbe(t,e,i,n,qy,Yy,Qy,o3);if(c){r&&(jS.fromBufferAttribute(r,o),WS.fromBufferAttribute(r,a),XS.fromBufferAttribute(r,l),c.uv=ls.getUV(o3,qy,Yy,Qy,jS,WS,XS,new ge)),s&&(jS.fromBufferAttribute(s,o),WS.fromBufferAttribute(s,a),XS.fromBufferAttribute(s,l),c.uv2=ls.getUV(o3,qy,Yy,Qy,jS,WS,XS,new ge));let h={a:o,b:a,c:l,normal:new O,materialIndex:0};ls.getNormal(qy,Yy,Qy,h.normal),c.face=h}return c}var Ic=class extends Rt{constructor(t=1,e=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};let o=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);let a=[],l=[],c=[],h=[],u=0,d=0;f("z","y","x",-1,-1,i,e,t,s,r,0),f("z","y","x",1,-1,i,e,-t,s,r,1),f("x","z","y",1,1,t,i,e,n,s,2),f("x","z","y",1,-1,t,i,-e,n,s,3),f("x","y","z",1,-1,t,e,i,n,r,4),f("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(a),this.setAttribute("position",new gt(l,3)),this.setAttribute("normal",new gt(c,3)),this.setAttribute("uv",new gt(h,2));function f(p,m,g,v,y,x,b,S,A,E,M){let T=x/A,P=b/E,I=x/2,k=b/2,R=S/2,F=A+1,V=E+1,Q=0,X=0,z=new O;for(let Y=0;Y<V;Y++){let j=Y*P-k;for(let J=0;J<F;J++){let H=J*T-I;z[p]=H*v,z[m]=j*y,z[g]=R,l.push(z.x,z.y,z.z),z[p]=0,z[m]=0,z[g]=S>0?1:-1,c.push(z.x,z.y,z.z),h.push(J/A),h.push(1-Y/E),Q+=1}}for(let Y=0;Y<E;Y++)for(let j=0;j<A;j++){let J=u+j+F*Y,H=u+j+F*(Y+1),Z=u+(j+1)+F*(Y+1),K=u+(j+1)+F*Y;a.push(J,H,K),a.push(H,Z,K),X+=6}o.addGroup(d,X,M),d+=X,u+=Q}}static fromJSON(t){return new Ic(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function a0(t){let e={};for(let i in t){e[i]={};for(let n in t[i]){let r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function Ss(t){let e={};for(let i=0;i<t.length;i++){let n=a0(t[i]);for(let r in n)e[r]=n[r]}return e}function Dbe(t){let e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function h$(t){return t.getRenderTarget()===null&&t.outputEncoding===Vt?ac:PC}var R0={clone:a0,merge:Ss},Ibe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Lbe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Wi=class extends mw{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Ibe,this.fragmentShader=Lbe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=a0(t.uniforms),this.uniformsGroups=Dbe(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let n in this.uniforms){let r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}},O0=class extends Ri{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qe,this.projectionMatrix=new Qe,this.projectionMatrixInverse=new Qe}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},os=class extends O0{constructor(t=50,e=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=f_*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(l1*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return f_*2*Math.atan(Math.tan(l1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,n,r,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(l1*.5*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;r+=s.offsetX*n/a,e-=s.offsetY*i/l,n*=s.width/a,i*=s.height/l}let o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},ng=-90,rg=1,Bbe=class extends Ri{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i;let n=new os(ng,rg,t,e);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let r=new os(ng,rg,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new os(ng,rg,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new os(ng,rg,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new os(ng,rg,t,e);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new os(ng,rg,t,e);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(t,e){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[n,r,s,o,a,l]=this.children,c=t.getRenderTarget(),h=t.toneMapping,u=t.xr.enabled;t.toneMapping=ku,t.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,n),t.setRenderTarget(i,1),t.render(e,r),t.setRenderTarget(i,2),t.render(e,s),t.setRenderTarget(i,3),t.render(e,o),t.setRenderTarget(i,4),t.render(e,a),i.texture.generateMipmaps=d,t.setRenderTarget(i,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=h,t.xr.enabled=u,i.texture.needsPMREMUpdate=!0}},Ek=class extends ur{constructor(t,e,i,n,r,s,o,a,l,c){t=t!==void 0?t:[],e=e!==void 0?e:jp,super(t,e,i,n,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},Rbe=class extends Li{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let i={width:t,height:t,depth:1},n=[i,i,i,i,i,i];this.texture=new Ek(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:Zt}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Ic(5,5,5),r=new Wi({name:"CubemapFromEquirect",uniforms:a0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Tr,blending:$n});r.uniforms.tEquirect.value=e;let s=new $s(n,r),o=e.minFilter;return e.minFilter===s0&&(e.minFilter=Zt),new Bbe(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,i,n){let r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,i,n);t.setRenderTarget(r)}},a3=new O,Obe=new O,Fbe=new Pr,Do=class{constructor(t=new O(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){let n=a3.subVectors(i,e).cross(Obe.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let i=t.delta(a3),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:e.copy(i).multiplyScalar(r).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let i=e||Fbe.getNormalMatrix(t),n=this.coplanarPoint(a3).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},sg=new qo,QS=new O,Tk=class{constructor(t=new Do,e=new Do,i=new Do,n=new Do,r=new Do,s=new Do){this.planes=[t,e,i,n,r,s]}set(t,e,i,n,r,s){let o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this}copy(t){let e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){let e=this.planes,i=t.elements,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],f=i[10],p=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,h-a,p-u,y-m).normalize(),e[1].setComponents(o+n,h+a,p+u,y+m).normalize(),e[2].setComponents(o+r,h+l,p+d,y+g).normalize(),e[3].setComponents(o-r,h-l,p-d,y-g).normalize(),e[4].setComponents(o-s,h-c,p-f,y-v).normalize(),e[5].setComponents(o+s,h+c,p+f,y+v).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),sg.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(sg)}intersectsSprite(t){return sg.center.set(0,0,0),sg.radius=.7071067811865476,sg.applyMatrix4(t.matrixWorld),this.intersectsSphere(sg)}intersectsSphere(t){let e=this.planes,i=t.center,n=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(t){let e=this.planes;for(let i=0;i<6;i++){let n=e[i];if(QS.x=n.normal.x>0?t.max.x:t.min.x,QS.y=n.normal.y>0?t.max.y:t.min.y,QS.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(QS)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function d$(){let t=null,e=!1,i=null,n=null;function r(s,o){i(s,o),n=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function Nbe(t,e){let i=e.isWebGL2,n=new WeakMap;function r(c,h){let u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){let d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(i?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=n.get(c);h&&(t.deleteBuffer(h.buffer),n.delete(c))}function l(c,h){if(c.isGLBufferAttribute){let d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=n.get(c);u===void 0?n.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}var mT=class extends Rt{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};let r=t/2,s=e/2,o=Math.floor(i),a=Math.floor(n),l=o+1,c=a+1,h=t/o,u=e/a,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){let v=g*u-s;for(let y=0;y<l;y++){let x=y*h-r;f.push(x,-v,0),p.push(0,0,1),m.push(y/o),m.push(1-g/a)}}for(let g=0;g<a;g++)for(let v=0;v<o;v++){let y=v+l*g,x=v+l*(g+1),b=v+1+l*(g+1),S=v+1+l*g;d.push(y,x,S),d.push(x,b,S)}this.setIndex(d),this.setAttribute("position",new gt(f,3)),this.setAttribute("normal",new gt(p,3)),this.setAttribute("uv",new gt(m,2))}static fromJSON(t){return new mT(t.width,t.height,t.widthSegments,t.heightSegments)}},kbe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,zbe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Ube=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Gbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Vbe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Hbe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,jbe="vec3 transformed = vec3( position );",Wbe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Xbe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,qbe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Ybe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Qbe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Jbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Kbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Zbe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,$be=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,eSe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,tSe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,iSe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,nSe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,rSe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,sSe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,oSe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,aSe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,lSe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,cSe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,uSe="gl_FragColor = linearToOutputTexel( gl_FragColor );",hSe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,dSe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,fSe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,pSe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,mSe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,gSe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vSe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ySe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,xSe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,_Se=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,wSe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,bSe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,SSe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ASe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,MSe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,CSe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,ESe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,TSe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,PSe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,DSe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ISe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,LSe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,BSe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,RSe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,OSe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,FSe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,NSe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,kSe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,zSe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,USe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,GSe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,VSe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,HSe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,jSe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,WSe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,XSe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,qSe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,YSe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,QSe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,JSe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,KSe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,ZSe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,$Se=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eAe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,tAe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,iAe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,nAe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,rAe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,sAe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,oAe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,aAe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,lAe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,cAe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,uAe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,hAe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dAe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,fAe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,pAe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,mAe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,gAe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,vAe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,yAe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,xAe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_Ae=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,wAe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,bAe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,SAe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,AAe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,MAe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,CAe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,EAe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,TAe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,PAe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,DAe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,IAe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,LAe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,BAe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,RAe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,OAe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,FAe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,NAe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,kAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,zAe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,UAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,GAe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,VAe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,HAe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,jAe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,WAe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,XAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,qAe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,YAe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,QAe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,JAe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,KAe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZAe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$Ae=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eMe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,tMe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iMe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,nMe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,rMe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sMe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oMe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,aMe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lMe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cMe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uMe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,hMe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dMe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fMe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,pMe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,mMe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Xt={alphamap_fragment:kbe,alphamap_pars_fragment:zbe,alphatest_fragment:Ube,alphatest_pars_fragment:Gbe,aomap_fragment:Vbe,aomap_pars_fragment:Hbe,begin_vertex:jbe,beginnormal_vertex:Wbe,bsdfs:Xbe,iridescence_fragment:qbe,bumpmap_pars_fragment:Ybe,clipping_planes_fragment:Qbe,clipping_planes_pars_fragment:Jbe,clipping_planes_pars_vertex:Kbe,clipping_planes_vertex:Zbe,color_fragment:$be,color_pars_fragment:eSe,color_pars_vertex:tSe,color_vertex:iSe,common:nSe,cube_uv_reflection_fragment:rSe,defaultnormal_vertex:sSe,displacementmap_pars_vertex:oSe,displacementmap_vertex:aSe,emissivemap_fragment:lSe,emissivemap_pars_fragment:cSe,encodings_fragment:uSe,encodings_pars_fragment:hSe,envmap_fragment:dSe,envmap_common_pars_fragment:fSe,envmap_pars_fragment:pSe,envmap_pars_vertex:mSe,envmap_physical_pars_fragment:ESe,envmap_vertex:gSe,fog_vertex:vSe,fog_pars_vertex:ySe,fog_fragment:xSe,fog_pars_fragment:_Se,gradientmap_pars_fragment:wSe,lightmap_fragment:bSe,lightmap_pars_fragment:SSe,lights_lambert_fragment:ASe,lights_lambert_pars_fragment:MSe,lights_pars_begin:CSe,lights_toon_fragment:TSe,lights_toon_pars_fragment:PSe,lights_phong_fragment:DSe,lights_phong_pars_fragment:ISe,lights_physical_fragment:LSe,lights_physical_pars_fragment:BSe,lights_fragment_begin:RSe,lights_fragment_maps:OSe,lights_fragment_end:FSe,logdepthbuf_fragment:NSe,logdepthbuf_pars_fragment:kSe,logdepthbuf_pars_vertex:zSe,logdepthbuf_vertex:USe,map_fragment:GSe,map_pars_fragment:VSe,map_particle_fragment:HSe,map_particle_pars_fragment:jSe,metalnessmap_fragment:WSe,metalnessmap_pars_fragment:XSe,morphcolor_vertex:qSe,morphnormal_vertex:YSe,morphtarget_pars_vertex:QSe,morphtarget_vertex:JSe,normal_fragment_begin:KSe,normal_fragment_maps:ZSe,normal_pars_fragment:$Se,normal_pars_vertex:eAe,normal_vertex:tAe,normalmap_pars_fragment:iAe,clearcoat_normal_fragment_begin:nAe,clearcoat_normal_fragment_maps:rAe,clearcoat_pars_fragment:sAe,iridescence_pars_fragment:oAe,output_fragment:aAe,packing:lAe,premultiplied_alpha_fragment:cAe,project_vertex:uAe,dithering_fragment:hAe,dithering_pars_fragment:dAe,roughnessmap_fragment:fAe,roughnessmap_pars_fragment:pAe,shadowmap_pars_fragment:mAe,shadowmap_pars_vertex:gAe,shadowmap_vertex:vAe,shadowmask_pars_fragment:yAe,skinbase_vertex:xAe,skinning_pars_vertex:_Ae,skinning_vertex:wAe,skinnormal_vertex:bAe,specularmap_fragment:SAe,specularmap_pars_fragment:AAe,tonemapping_fragment:MAe,tonemapping_pars_fragment:CAe,transmission_fragment:EAe,transmission_pars_fragment:TAe,uv_pars_fragment:PAe,uv_pars_vertex:DAe,uv_vertex:IAe,uv2_pars_fragment:LAe,uv2_pars_vertex:BAe,uv2_vertex:RAe,worldpos_vertex:OAe,background_vert:FAe,background_frag:NAe,backgroundCube_vert:kAe,backgroundCube_frag:zAe,cube_vert:UAe,cube_frag:GAe,depth_vert:VAe,depth_frag:HAe,distanceRGBA_vert:jAe,distanceRGBA_frag:WAe,equirect_vert:XAe,equirect_frag:qAe,linedashed_vert:YAe,linedashed_frag:QAe,meshbasic_vert:JAe,meshbasic_frag:KAe,meshlambert_vert:ZAe,meshlambert_frag:$Ae,meshmatcap_vert:eMe,meshmatcap_frag:tMe,meshnormal_vert:iMe,meshnormal_frag:nMe,meshphong_vert:rMe,meshphong_frag:sMe,meshphysical_vert:oMe,meshphysical_frag:aMe,meshtoon_vert:lMe,meshtoon_frag:cMe,points_vert:uMe,points_frag:hMe,shadow_vert:dMe,shadow_frag:fMe,sprite_vert:pMe,sprite_frag:mMe},it={common:{diffuse:{value:new Tt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Pr},uv2Transform:{value:new Pr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pr}},sprite:{diffuse:{value:new Tt(16777215)},opacity:{value:1},center:{value:new ge(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pr}}},lc={basic:{uniforms:Ss([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.fog]),vertexShader:Xt.meshbasic_vert,fragmentShader:Xt.meshbasic_frag},lambert:{uniforms:Ss([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new Tt(0)}}]),vertexShader:Xt.meshlambert_vert,fragmentShader:Xt.meshlambert_frag},phong:{uniforms:Ss([it.common,it.specularmap,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.fog,it.lights,{emissive:{value:new Tt(0)},specular:{value:new Tt(1118481)},shininess:{value:30}}]),vertexShader:Xt.meshphong_vert,fragmentShader:Xt.meshphong_frag},standard:{uniforms:Ss([it.common,it.envmap,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.roughnessmap,it.metalnessmap,it.fog,it.lights,{emissive:{value:new Tt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag},toon:{uniforms:Ss([it.common,it.aomap,it.lightmap,it.emissivemap,it.bumpmap,it.normalmap,it.displacementmap,it.gradientmap,it.fog,it.lights,{emissive:{value:new Tt(0)}}]),vertexShader:Xt.meshtoon_vert,fragmentShader:Xt.meshtoon_frag},matcap:{uniforms:Ss([it.common,it.bumpmap,it.normalmap,it.displacementmap,it.fog,{matcap:{value:null}}]),vertexShader:Xt.meshmatcap_vert,fragmentShader:Xt.meshmatcap_frag},points:{uniforms:Ss([it.points,it.fog]),vertexShader:Xt.points_vert,fragmentShader:Xt.points_frag},dashed:{uniforms:Ss([it.common,it.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xt.linedashed_vert,fragmentShader:Xt.linedashed_frag},depth:{uniforms:Ss([it.common,it.displacementmap]),vertexShader:Xt.depth_vert,fragmentShader:Xt.depth_frag},normal:{uniforms:Ss([it.common,it.bumpmap,it.normalmap,it.displacementmap,{opacity:{value:1}}]),vertexShader:Xt.meshnormal_vert,fragmentShader:Xt.meshnormal_frag},sprite:{uniforms:Ss([it.sprite,it.fog]),vertexShader:Xt.sprite_vert,fragmentShader:Xt.sprite_frag},background:{uniforms:{uvTransform:{value:new Pr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Xt.background_vert,fragmentShader:Xt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Xt.backgroundCube_vert,fragmentShader:Xt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Xt.cube_vert,fragmentShader:Xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xt.equirect_vert,fragmentShader:Xt.equirect_frag},distanceRGBA:{uniforms:Ss([it.common,it.displacementmap,{referencePosition:{value:new O},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xt.distanceRGBA_vert,fragmentShader:Xt.distanceRGBA_frag},shadow:{uniforms:Ss([it.lights,it.fog,{color:{value:new Tt(0)},opacity:{value:1}}]),vertexShader:Xt.shadow_vert,fragmentShader:Xt.shadow_frag}};lc.physical={uniforms:Ss([lc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ge(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Tt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Tt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Tt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag};var JS={r:0,b:0,g:0};function gMe(t,e,i,n,r,s,o){let a=new Tt(0),l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,v){let y=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?i:e).get(x));let b=t.xr,S=b.getSession&&b.getSession();S&&S.environmentBlendMode==="additive"&&(x=null),x===null?m(a,l):x&&x.isColor&&(m(x,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),x&&(x.isCubeTexture||x.mapping===pw)?(h===void 0&&(h=new $s(new Ic(1,1,1),new Wi({name:"BackgroundCubeMaterial",uniforms:a0(lc.backgroundCube.uniforms),vertexShader:lc.backgroundCube.vertexShader,fragmentShader:lc.backgroundCube.fragmentShader,side:Tr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(A,E,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=x,h.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,h.material.toneMapped=x.encoding!==Vt,(u!==x||d!==x.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new $s(new mT(2,2),new Wi({name:"BackgroundMaterial",uniforms:a0(lc.background.uniforms),vertexShader:lc.background.vertexShader,fragmentShader:lc.background.fragmentShader,side:Il,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==Vt,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(u!==x||d!==x.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=x,d=x.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(JS,h$(t)),n.buffers.color.setClear(JS.r,JS.g,JS.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(g,v=1){a.set(g),l=v,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(a,l)},render:p}}function vMe(t,e,i,n){let r=t.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=g(null),c=l,h=!1;function u(F,V,Q,X,z){let Y=!1;if(o){let j=m(X,Q,V);c!==j&&(c=j,f(c.object)),Y=v(F,X,Q,z),Y&&y(F,X,Q,z)}else{let j=V.wireframe===!0;(c.geometry!==X.id||c.program!==Q.id||c.wireframe!==j)&&(c.geometry=X.id,c.program=Q.id,c.wireframe=j,Y=!0)}z!==null&&i.update(z,34963),(Y||h)&&(h=!1,M(F,V,Q,X),z!==null&&t.bindBuffer(34963,i.get(z).buffer))}function d(){return n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(F){return n.isWebGL2?t.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return n.isWebGL2?t.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function m(F,V,Q){let X=Q.wireframe===!0,z=a[F.id];z===void 0&&(z={},a[F.id]=z);let Y=z[V.id];Y===void 0&&(Y={},z[V.id]=Y);let j=Y[X];return j===void 0&&(j=g(d()),Y[X]=j),j}function g(F){let V=[],Q=[],X=[];for(let z=0;z<r;z++)V[z]=0,Q[z]=0,X[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:Q,attributeDivisors:X,object:F,attributes:{},index:null}}function v(F,V,Q,X){let z=c.attributes,Y=V.attributes,j=0,J=Q.getAttributes();for(let H in J)if(J[H].location>=0){let Z=z[H],K=Y[H];if(K===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(K=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(K=F.instanceColor)),Z===void 0||Z.attribute!==K||K&&Z.data!==K.data)return!0;j++}return c.attributesNum!==j||c.index!==X}function y(F,V,Q,X){let z={},Y=V.attributes,j=0,J=Q.getAttributes();for(let H in J)if(J[H].location>=0){let Z=Y[H];Z===void 0&&(H==="instanceMatrix"&&F.instanceMatrix&&(Z=F.instanceMatrix),H==="instanceColor"&&F.instanceColor&&(Z=F.instanceColor));let K={};K.attribute=Z,Z&&Z.data&&(K.data=Z.data),z[H]=K,j++}c.attributes=z,c.attributesNum=j,c.index=X}function x(){let F=c.newAttributes;for(let V=0,Q=F.length;V<Q;V++)F[V]=0}function b(F){S(F,0)}function S(F,V){let Q=c.newAttributes,X=c.enabledAttributes,z=c.attributeDivisors;Q[F]=1,X[F]===0&&(t.enableVertexAttribArray(F),X[F]=1),z[F]!==V&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,V),z[F]=V)}function A(){let F=c.newAttributes,V=c.enabledAttributes;for(let Q=0,X=V.length;Q<X;Q++)V[Q]!==F[Q]&&(t.disableVertexAttribArray(Q),V[Q]=0)}function E(F,V,Q,X,z,Y){n.isWebGL2===!0&&(Q===5124||Q===5125)?t.vertexAttribIPointer(F,V,Q,z,Y):t.vertexAttribPointer(F,V,Q,X,z,Y)}function M(F,V,Q,X){if(n.isWebGL2===!1&&(F.isInstancedMesh||X.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();let z=X.attributes,Y=Q.getAttributes(),j=V.defaultAttributeValues;for(let J in Y){let H=Y[J];if(H.location>=0){let Z=z[J];if(Z===void 0&&(J==="instanceMatrix"&&F.instanceMatrix&&(Z=F.instanceMatrix),J==="instanceColor"&&F.instanceColor&&(Z=F.instanceColor)),Z!==void 0){let K=Z.normalized,ne=Z.itemSize,W=i.get(Z);if(W===void 0)continue;let ve=W.buffer,de=W.type,pe=W.bytesPerElement;if(Z.isInterleavedBufferAttribute){let ce=Z.data,ye=ce.stride,ae=Z.offset;if(ce.isInstancedInterleavedBuffer){for(let le=0;le<H.locationSize;le++)S(H.location+le,ce.meshPerAttribute);F.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=ce.meshPerAttribute*ce.count)}else for(let le=0;le<H.locationSize;le++)b(H.location+le);t.bindBuffer(34962,ve);for(let le=0;le<H.locationSize;le++)E(H.location+le,ne/H.locationSize,de,K,ye*pe,(ae+ne/H.locationSize*le)*pe)}else{if(Z.isInstancedBufferAttribute){for(let ce=0;ce<H.locationSize;ce++)S(H.location+ce,Z.meshPerAttribute);F.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Z.meshPerAttribute*Z.count)}else for(let ce=0;ce<H.locationSize;ce++)b(H.location+ce);t.bindBuffer(34962,ve);for(let ce=0;ce<H.locationSize;ce++)E(H.location+ce,ne/H.locationSize,de,K,ne*pe,ne/H.locationSize*ce*pe)}}else if(j!==void 0){let K=j[J];if(K!==void 0)switch(K.length){case 2:t.vertexAttrib2fv(H.location,K);break;case 3:t.vertexAttrib3fv(H.location,K);break;case 4:t.vertexAttrib4fv(H.location,K);break;default:t.vertexAttrib1fv(H.location,K)}}}}A()}function T(){k();for(let F in a){let V=a[F];for(let Q in V){let X=V[Q];for(let z in X)p(X[z].object),delete X[z];delete V[Q]}delete a[F]}}function P(F){if(a[F.id]===void 0)return;let V=a[F.id];for(let Q in V){let X=V[Q];for(let z in X)p(X[z].object),delete X[z];delete V[Q]}delete a[F.id]}function I(F){for(let V in a){let Q=a[V];if(Q[F.id]===void 0)continue;let X=Q[F.id];for(let z in X)p(X[z].object),delete X[z];delete Q[F.id]}}function k(){R(),h=!0,c!==l&&(c=l,f(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:k,resetDefaultState:R,dispose:T,releaseStatesOfGeometry:P,releaseStatesOfProgram:I,initAttributes:x,enableAttribute:b,disableUnusedAttributes:A}}function yMe(t,e,i,n){let r=n.isWebGL2,s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),i.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function xMe(t,e,i){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,a=i.precision!==void 0?i.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||e.has("WEBGL_draw_buffers"),h=i.logarithmicDepthBuffer===!0,u=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),m=t.getParameter(34921),g=t.getParameter(36347),v=t.getParameter(36348),y=t.getParameter(36349),x=d>0,b=o||e.has("OES_texture_float"),S=x&&b,A=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:A}}function _Me(t){let e=this,i=null,n=0,r=!1,s=!1,o=new Do,a=new Pr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){let f=u.length!==0||d||n!==0||r;return r=d,n=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){i=h(u,d,0)},this.setState=function(u,d,f){let p=u.clippingPlanes,m=u.clipIntersection,g=u.clipShadows,v=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{let y=s?0:n,x=y*4,b=v.clippingState||null;l.value=b,b=h(p,d,x,f);for(let S=0;S!==x;++S)b[S]=i[S];v.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(u,d,f,p){let m=u!==null?u.length:0,g=null;if(m!==0){if(g=l.value,p!==!0||g===null){let v=f+m*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let x=0,b=f;x!==m;++x,b+=4)o.copy(u[x]).applyMatrix4(y,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function wMe(t){let e=new WeakMap;function i(o,a){return a===ZB?o.mapping=jp:a===$B&&(o.mapping=Wp),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===ZB||a===$B)if(e.has(o)){let l=e.get(o).texture;return i(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new Rbe(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var Pk=class extends O0{constructor(t=-1,e=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,i,n,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,s=i+t,o=n+e,a=n-e;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,o-=c*this.view.offsetY,a=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},tv=4,ij=[.125,.215,.35,.446,.526,.582],Xf=20,l3=new Pk,nj=new Tt,c3=null,Uf=(1+Math.sqrt(5))/2,og=1/Uf,rj=[new O(1,1,1),new O(-1,1,1),new O(1,1,-1),new O(-1,1,-1),new O(0,Uf,og),new O(0,Uf,-og),new O(og,0,Uf),new O(-og,0,Uf),new O(Uf,og,0),new O(-Uf,og,0)],sj=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,n=100){c3=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,i,n,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=aj(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(c3),t.scissorTest=!1,KS(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===jp||t.mapping===Wp?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),c3=this._renderer.getRenderTarget();let i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:Zt,minFilter:Zt,generateMipmaps:!1,type:o0,format:Ea,encoding:Dc,depthBuffer:!1},n=oj(t,e,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=oj(t,e,i);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=bMe(r)),this._blurMaterial=SMe(r,t,e)}return n}_compileMaterial(t){let e=new $s(this._lodPlanes[0],t);this._renderer.compile(e,l3)}_sceneToCubeUV(t,e,i,n){let r=new os(90,1,e,i),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(nj),a.toneMapping=ku,a.autoClear=!1;let h=new gw({name:"PMREM.Background",side:Tr,depthWrite:!1,depthTest:!1}),u=new $s(new Ic,h),d=!1,f=t.background;f?f.isColor&&(h.color.copy(f),t.background=null,d=!0):(h.color.copy(nj),d=!0);for(let p=0;p<6;p++){let m=p%3;m===0?(r.up.set(0,s[p],0),r.lookAt(o[p],0,0)):m===1?(r.up.set(0,0,s[p]),r.lookAt(0,o[p],0)):(r.up.set(0,s[p],0),r.lookAt(0,0,o[p]));let g=this._cubeSize;KS(n,m*g,p>2?g:0,g,g),a.setRenderTarget(n),d&&a.render(u,r),a.render(t,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=f}_textureToCubeUV(t,e){let i=this._renderer,n=t.mapping===jp||t.mapping===Wp;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=lj()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=aj());let r=n?this._cubemapMaterial:this._equirectMaterial,s=new $s(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=t;let a=this._cubeSize;KS(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(s,l3)}_applyPMREM(t){let e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),s=rj[(n-1)%rj.length];this._blur(t,n-1,n,r,s)}e.autoClear=i}_blur(t,e,i,n,r){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,i,n,"latitudinal",r),this._halfBlur(s,t,i,i,n,"longitudinal",r)}_halfBlur(t,e,i,n,r,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new $s(this._lodPlanes[n],l),u=l.uniforms,d=this._sizeLods[i]-1,f=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*Xf-1),p=r/f,m=isFinite(r)?1+Math.floor(c*p):Xf;m>Xf&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Xf}`);let g=[],v=0;for(let A=0;A<Xf;++A){let E=A/p,M=Math.exp(-E*E/2);g.push(M),A===0?v+=M:A<m&&(v+=2*M)}for(let A=0;A<g.length;A++)g[A]=g[A]/v;u.envMap.value=t.texture,u.samples.value=m,u.weights.value=g,u.latitudinal.value=s==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-i;let x=this._sizeLods[n],b=3*x*(n>y-tv?n-y+tv:0),S=4*(this._cubeSize-x);KS(e,b,S,3*x,2*x),a.setRenderTarget(e),a.render(h,l3)}};function bMe(t){let e=[],i=[],n=[],r=t,s=t-tv+1+ij.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);i.push(a);let l=1/a;o>t-tv?l=ij[o-t+tv-1]:o===0&&(l=0),n.push(l);let c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,m=3,g=2,v=1,y=new Float32Array(m*p*f),x=new Float32Array(g*p*f),b=new Float32Array(v*p*f);for(let A=0;A<f;A++){let E=A%3*2/3-1,M=A>2?0:-1,T=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];y.set(T,m*p*A),x.set(d,g*p*A);let P=[A,A,A,A,A,A];b.set(P,v*p*A)}let S=new Rt;S.setAttribute("position",new Ot(y,m)),S.setAttribute("uv",new Ot(x,g)),S.setAttribute("faceIndex",new Ot(b,v)),e.push(S),r>tv&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function oj(t,e,i){let n=new Li(t,e,i);return n.texture.mapping=pw,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function KS(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function SMe(t,e,i){let n=new Float32Array(Xf),r=new O(0,1,0);return new Wi({name:"SphericalGaussianBlur",defines:{n:Xf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$n,depthTest:!1,depthWrite:!1})}function aj(){return new Wi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$n,depthTest:!1,depthWrite:!1})}function lj(){return new Wi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Dk(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$n,depthTest:!1,depthWrite:!1})}function Dk(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function AMe(t){let e=new WeakMap,i=null;function n(a){if(a&&a.isTexture){let l=a.mapping,c=l===ZB||l===$B,h=l===jp||l===Wp;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return i===null&&(i=new sj(t)),u=c?i.fromEquirectangular(a,u):i.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{let u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){i===null&&(i=new sj(t));let d=c?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function MMe(t){let e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){let r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function CMe(t,e,i,n){let r={},s=new WeakMap;function o(u){let d=u.target;d.index!==null&&e.remove(d.index);for(let p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(u){let d=u.attributes;for(let p in d)e.update(d[p],34962);let f=u.morphAttributes;for(let p in f){let m=f[p];for(let g=0,v=m.length;g<v;g++)e.update(m[g],34962)}}function c(u){let d=[],f=u.index,p=u.attributes.position,m=0;if(f!==null){let y=f.array;m=f.version;for(let x=0,b=y.length;x<b;x+=3){let S=y[x+0],A=y[x+1],E=y[x+2];d.push(S,A,A,E,E,S)}}else{let y=p.array;m=p.version;for(let x=0,b=y.length/3-1;x<b;x+=3){let S=x+0,A=x+1,E=x+2;d.push(S,A,A,E,E,S)}}let g=new(s$(d)?wv:u$)(d,1);g.version=m;let v=s.get(u);v&&e.remove(v),s.set(u,g)}function h(u){let d=s.get(u);if(d){let f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function EMe(t,e,i,n){let r=n.isWebGL2,s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),i.update(f,s,1)}function u(d,f,p){if(p===0)return;let m,g;if(r)m=t,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,f,a,d*l,p),i.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function TMe(t){let e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function PMe(t,e){return t[0]-e[0]}function DMe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function IMe(t,e,i){let n={},r=new Float32Array(8),s=new WeakMap,o=new Ht,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){let f=c.morphTargetInfluences;if(e.isWebGL2===!0){let p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,m=p!==void 0?p.length:0,g=s.get(h);if(g===void 0||g.count!==m){let x=function(){F.dispose(),s.delete(h),h.removeEventListener("dispose",x)};g!==void 0&&g.texture.dispose();let b=h.morphAttributes.position!==void 0,S=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,E=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],T=h.morphAttributes.color||[],P=0;b===!0&&(P=1),S===!0&&(P=2),A===!0&&(P=3);let I=h.attributes.position.count*P,k=1;I>e.maxTextureSize&&(k=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);let R=new Float32Array(I*k*4*m),F=new c$(R,I,k,m);F.type=Oo,F.needsUpdate=!0;let V=P*4;for(let Q=0;Q<m;Q++){let X=E[Q],z=M[Q],Y=T[Q],j=I*k*4*Q;for(let J=0;J<X.count;J++){let H=J*V;b===!0&&(o.fromBufferAttribute(X,J),R[j+H+0]=o.x,R[j+H+1]=o.y,R[j+H+2]=o.z,R[j+H+3]=0),S===!0&&(o.fromBufferAttribute(z,J),R[j+H+4]=o.x,R[j+H+5]=o.y,R[j+H+6]=o.z,R[j+H+7]=0),A===!0&&(o.fromBufferAttribute(Y,J),R[j+H+8]=o.x,R[j+H+9]=o.y,R[j+H+10]=o.z,R[j+H+11]=Y.itemSize===4?o.w:1)}}g={count:m,texture:F,size:new ge(I,k)},s.set(h,g),h.addEventListener("dispose",x)}let v=0;for(let x=0;x<f.length;x++)v+=f[x];let y=h.morphTargetsRelative?1:1-v;d.getUniforms().setValue(t,"morphTargetBaseInfluence",y),d.getUniforms().setValue(t,"morphTargetInfluences",f),d.getUniforms().setValue(t,"morphTargetsTexture",g.texture,i),d.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{let p=f===void 0?0:f.length,m=n[h.id];if(m===void 0||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];n[h.id]=m}for(let b=0;b<p;b++){let S=m[b];S[0]=b,S[1]=f[b]}m.sort(DMe);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(PMe);let g=h.morphAttributes.position,v=h.morphAttributes.normal,y=0;for(let b=0;b<8;b++){let S=a[b],A=S[0],E=S[1];A!==Number.MAX_SAFE_INTEGER&&E?(g&&h.getAttribute("morphTarget"+b)!==g[A]&&h.setAttribute("morphTarget"+b,g[A]),v&&h.getAttribute("morphNormal"+b)!==v[A]&&h.setAttribute("morphNormal"+b,v[A]),r[b]=E,y+=E):(g&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),v&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}let x=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",x),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function LMe(t,e,i,n){let r=new WeakMap;function s(l){let c=n.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}var f$=new ur,p$=new c$,m$=new ybe,g$=new Ek,cj=[],uj=[],hj=new Float32Array(16),dj=new Float32Array(9),fj=new Float32Array(4);function F0(t,e,i){let n=t[0];if(n<=0||n>0)return t;let r=e*i,s=cj[r];if(s===void 0&&(s=new Float32Array(r),cj[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function pr(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function mr(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function gT(t,e){let i=uj[e];i===void 0&&(i=new Int32Array(e),uj[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function BMe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function RMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(pr(i,e))return;t.uniform2fv(this.addr,e),mr(i,e)}}function OMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(pr(i,e))return;t.uniform3fv(this.addr,e),mr(i,e)}}function FMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(pr(i,e))return;t.uniform4fv(this.addr,e),mr(i,e)}}function NMe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(pr(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),mr(i,e)}else{if(pr(i,n))return;fj.set(n),t.uniformMatrix2fv(this.addr,!1,fj),mr(i,n)}}function kMe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(pr(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),mr(i,e)}else{if(pr(i,n))return;dj.set(n),t.uniformMatrix3fv(this.addr,!1,dj),mr(i,n)}}function zMe(t,e){let i=this.cache,n=e.elements;if(n===void 0){if(pr(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),mr(i,e)}else{if(pr(i,n))return;hj.set(n),t.uniformMatrix4fv(this.addr,!1,hj),mr(i,n)}}function UMe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function GMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(pr(i,e))return;t.uniform2iv(this.addr,e),mr(i,e)}}function VMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(pr(i,e))return;t.uniform3iv(this.addr,e),mr(i,e)}}function HMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(pr(i,e))return;t.uniform4iv(this.addr,e),mr(i,e)}}function jMe(t,e){let i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function WMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(pr(i,e))return;t.uniform2uiv(this.addr,e),mr(i,e)}}function XMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(pr(i,e))return;t.uniform3uiv(this.addr,e),mr(i,e)}}function qMe(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(pr(i,e))return;t.uniform4uiv(this.addr,e),mr(i,e)}}function YMe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||f$,r)}function QMe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||m$,r)}function JMe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||g$,r)}function KMe(t,e,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||p$,r)}function ZMe(t){switch(t){case 5126:return BMe;case 35664:return RMe;case 35665:return OMe;case 35666:return FMe;case 35674:return NMe;case 35675:return kMe;case 35676:return zMe;case 5124:case 35670:return UMe;case 35667:case 35671:return GMe;case 35668:case 35672:return VMe;case 35669:case 35673:return HMe;case 5125:return jMe;case 36294:return WMe;case 36295:return XMe;case 36296:return qMe;case 35678:case 36198:case 36298:case 36306:case 35682:return YMe;case 35679:case 36299:case 36307:return QMe;case 35680:case 36300:case 36308:case 36293:return JMe;case 36289:case 36303:case 36311:case 36292:return KMe}}function $Me(t,e){t.uniform1fv(this.addr,e)}function eCe(t,e){let i=F0(e,this.size,2);t.uniform2fv(this.addr,i)}function tCe(t,e){let i=F0(e,this.size,3);t.uniform3fv(this.addr,i)}function iCe(t,e){let i=F0(e,this.size,4);t.uniform4fv(this.addr,i)}function nCe(t,e){let i=F0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function rCe(t,e){let i=F0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function sCe(t,e){let i=F0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function oCe(t,e){t.uniform1iv(this.addr,e)}function aCe(t,e){t.uniform2iv(this.addr,e)}function lCe(t,e){t.uniform3iv(this.addr,e)}function cCe(t,e){t.uniform4iv(this.addr,e)}function uCe(t,e){t.uniform1uiv(this.addr,e)}function hCe(t,e){t.uniform2uiv(this.addr,e)}function dCe(t,e){t.uniform3uiv(this.addr,e)}function fCe(t,e){t.uniform4uiv(this.addr,e)}function pCe(t,e,i){let n=this.cache,r=e.length,s=gT(i,r);pr(n,s)||(t.uniform1iv(this.addr,s),mr(n,s));for(let o=0;o!==r;++o)i.setTexture2D(e[o]||f$,s[o])}function mCe(t,e,i){let n=this.cache,r=e.length,s=gT(i,r);pr(n,s)||(t.uniform1iv(this.addr,s),mr(n,s));for(let o=0;o!==r;++o)i.setTexture3D(e[o]||m$,s[o])}function gCe(t,e,i){let n=this.cache,r=e.length,s=gT(i,r);pr(n,s)||(t.uniform1iv(this.addr,s),mr(n,s));for(let o=0;o!==r;++o)i.setTextureCube(e[o]||g$,s[o])}function vCe(t,e,i){let n=this.cache,r=e.length,s=gT(i,r);pr(n,s)||(t.uniform1iv(this.addr,s),mr(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(e[o]||p$,s[o])}function yCe(t){switch(t){case 5126:return $Me;case 35664:return eCe;case 35665:return tCe;case 35666:return iCe;case 35674:return nCe;case 35675:return rCe;case 35676:return sCe;case 5124:case 35670:return oCe;case 35667:case 35671:return aCe;case 35668:case 35672:return lCe;case 35669:case 35673:return cCe;case 5125:return uCe;case 36294:return hCe;case 36295:return dCe;case 36296:return fCe;case 35678:case 36198:case 36298:case 36306:case 35682:return pCe;case 35679:case 36299:case 36307:return mCe;case 35680:case 36300:case 36308:case 36293:return gCe;case 36289:case 36303:case 36311:case 36292:return vCe}}var xCe=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=ZMe(e.type)}},_Ce=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=yCe(e.type)}},wCe=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){let n=this.seq;for(let r=0,s=n.length;r!==s;++r){let o=n[r];o.setValue(t,e[o.id],i)}}},u3=/(\w+)(\])?(\[|\.)?/g;function pj(t,e){t.seq.push(e),t.map[e.id]=e}function bCe(t,e,i){let n=t.name,r=n.length;for(u3.lastIndex=0;;){let s=u3.exec(n),o=u3.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){pj(i,c===void 0?new xCe(a,t,e):new _Ce(a,t,e));break}else{let h=i.map[a];h===void 0&&(h=new wCe(a),pj(i,h)),i=h}}}var AM=class{constructor(t,e){this.seq=[],this.map={};let i=t.getProgramParameter(e,35718);for(let n=0;n<i;++n){let r=t.getActiveUniform(e,n),s=t.getUniformLocation(e,r.name);bCe(r,s,this)}}setValue(t,e,i,n){let r=this.map[e];r!==void 0&&r.setValue(t,i,n)}setOptional(t,e,i){let n=e[i];n!==void 0&&this.setValue(t,i,n)}static upload(t,e,i,n){for(let r=0,s=e.length;r!==s;++r){let o=e[r],a=i[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,n)}}static seqWithValue(t,e){let i=[];for(let n=0,r=t.length;n!==r;++n){let s=t[n];s.id in e&&i.push(s)}return i}};function mj(t,e,i){let n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}var SCe=0;function ACe(t,e){let i=t.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function MCe(t){switch(t){case Dc:return["Linear","( value )"];case Vt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function gj(t,e,i){let n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+ACe(t.getShaderSource(e),o)}else return r}function CCe(t,e){let i=MCe(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function ECe(t,e){let i;switch(e){case Bwe:i="Linear";break;case Rwe:i="Reinhard";break;case Owe:i="OptimizedCineon";break;case Fwe:i="ACESFilmic";break;case Nwe:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function TCe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Lx).join(`
`)}function PCe(t){let e=[];for(let i in t){let n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function DCe(t,e){let i={},n=t.getProgramParameter(e,35721);for(let r=0;r<n;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function Lx(t){return t!==""}function vj(t,e){let i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yj(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var ICe=/^[ \t]*#include +<([\w\d./]+)>/gm;function rR(t){return t.replace(ICe,LCe)}function LCe(t,e){let i=Xt[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return rR(i)}var BCe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xj(t){return t.replace(BCe,RCe)}function RCe(t,e,i,n){let r="";for(let s=parseInt(e);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function _j(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function OCe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===bk?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===hwe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ix&&(e="SHADOWMAP_TYPE_VSM"),e}function FCe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case jp:case Wp:e="ENVMAP_TYPE_CUBE";break;case pw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function NCe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Wp:e="ENVMAP_MODE_REFRACTION";break}return e}function kCe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case KZ:e="ENVMAP_BLENDING_MULTIPLY";break;case Iwe:e="ENVMAP_BLENDING_MIX";break;case Lwe:e="ENVMAP_BLENDING_ADD";break}return e}function zCe(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function UCe(t,e,i,n){let r=t.getContext(),s=i.defines,o=i.vertexShader,a=i.fragmentShader,l=OCe(i),c=FCe(i),h=NCe(i),u=kCe(i),d=zCe(i),f=i.isWebGL2?"":TCe(i),p=PCe(s),m=r.createProgram(),g,v,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(g=[p].filter(Lx).join(`
`),g.length>0&&(g+=`
`),v=[f,p].filter(Lx).join(`
`),v.length>0&&(v+=`
`)):(g=[_j(i),"#define SHADER_NAME "+i.shaderName,p,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Lx).join(`
`),v=[f,_j(i),"#define SHADER_NAME "+i.shaderName,p,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ku?"#define TONE_MAPPING":"",i.toneMapping!==ku?Xt.tonemapping_pars_fragment:"",i.toneMapping!==ku?ECe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Xt.encodings_pars_fragment,CCe("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Lx).join(`
`)),o=rR(o),o=vj(o,i),o=yj(o,i),a=rR(a),a=vj(a,i),a=yj(a,i),o=xj(o),a=xj(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",i.glslVersion===j6?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===j6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let x=y+g+o,b=y+v+a,S=mj(r,35633,x),A=mj(r,35632,b);if(r.attachShader(m,S),r.attachShader(m,A),i.index0AttributeName!==void 0?r.bindAttribLocation(m,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){let T=r.getProgramInfoLog(m).trim(),P=r.getShaderInfoLog(S).trim(),I=r.getShaderInfoLog(A).trim(),k=!0,R=!0;if(r.getProgramParameter(m,35714)===!1){k=!1;let F=gj(r,S,"vertex"),V=gj(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+`

Program Info Log: `+T+`
`+F+`
`+V)}else T!==""?console.warn("THREE.WebGLProgram: Program Info Log:",T):(P===""||I==="")&&(R=!1);R&&(this.diagnostics={runnable:k,programLog:T,vertexShader:{log:P,prefix:g},fragmentShader:{log:I,prefix:v}})}r.deleteShader(S),r.deleteShader(A);let E;this.getUniforms=function(){return E===void 0&&(E=new AM(r,m)),E};let M;return this.getAttributes=function(){return M===void 0&&(M=DCe(r,m)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=i.shaderName,this.id=SCe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=A,this}var GCe=0,VCe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,i=t.fragmentShader,n=this._getShaderStage(e),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(t);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let i of e)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,i=e.get(t);return i===void 0&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){let e=this.shaderCache,i=e.get(t);return i===void 0&&(i=new HCe(t),e.set(t,i)),i}},HCe=class{constructor(t){this.id=GCe++,this.code=t,this.usedTimes=0}};function jCe(t,e,i,n,r,s,o){let a=new Ck,l=new VCe,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(M,T,P,I,k){let R=I.fog,F=k.geometry,V=M.isMeshStandardMaterial?I.environment:null,Q=(M.isMeshStandardMaterial?i:e).get(M.envMap||V),X=Q&&Q.mapping===pw?Q.image.height:null,z=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));let Y=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,j=Y!==void 0?Y.length:0,J=0;F.morphAttributes.position!==void 0&&(J=1),F.morphAttributes.normal!==void 0&&(J=2),F.morphAttributes.color!==void 0&&(J=3);let H,Z,K,ne;if(z){let ce=lc[z];H=ce.vertexShader,Z=ce.fragmentShader}else H=M.vertexShader,Z=M.fragmentShader,l.update(M),K=l.getVertexShaderID(M),ne=l.getFragmentShaderID(M);let W=t.getRenderTarget(),ve=M.alphaTest>0,de=M.clearcoat>0,pe=M.iridescence>0;return{isWebGL2:h,shaderID:z,shaderName:M.type,vertexShader:H,fragmentShader:Z,defines:M.defines,customVertexShaderID:K,customFragmentShaderID:ne,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:d,outputEncoding:W===null?t.outputEncoding:W.isXRRenderTarget===!0?W.texture.encoding:Dc,map:!!M.map,matcap:!!M.matcap,envMap:!!Q,envMapMode:Q&&Q.mapping,envMapCubeUVHeight:X,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===tbe,tangentSpaceNormalMap:M.normalMapType===ebe,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===Vt,clearcoat:de,clearcoatMap:de&&!!M.clearcoatMap,clearcoatRoughnessMap:de&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:de&&!!M.clearcoatNormalMap,iridescence:pe,iridescenceMap:pe&&!!M.iridescenceMap,iridescenceThicknessMap:pe&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===_v,alphaMap:!!M.alphaMap,alphaTest:ve,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!F.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!R,useFog:M.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:u,skinning:k.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:j,morphTextureStride:J,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:ku,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Ro,flipSided:M.side===Tr,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){let T=[];if(M.shaderID?T.push(M.shaderID):(T.push(M.customVertexShaderID),T.push(M.customFragmentShaderID)),M.defines!==void 0)for(let P in M.defines)T.push(P),T.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(v(T,M),y(T,M),T.push(t.outputEncoding)),T.push(M.customProgramCacheKey),T.join()}function v(M,T){M.push(T.precision),M.push(T.outputEncoding),M.push(T.envMapMode),M.push(T.envMapCubeUVHeight),M.push(T.combine),M.push(T.vertexUvs),M.push(T.fogExp2),M.push(T.sizeAttenuation),M.push(T.morphTargetsCount),M.push(T.morphAttributeCount),M.push(T.numDirLights),M.push(T.numPointLights),M.push(T.numSpotLights),M.push(T.numSpotLightMaps),M.push(T.numHemiLights),M.push(T.numRectAreaLights),M.push(T.numDirLightShadows),M.push(T.numPointLightShadows),M.push(T.numSpotLightShadows),M.push(T.numSpotLightShadowsWithMaps),M.push(T.shadowMapType),M.push(T.toneMapping),M.push(T.numClippingPlanes),M.push(T.numClipIntersection),M.push(T.depthPacking)}function y(M,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.map&&a.enable(4),T.matcap&&a.enable(5),T.envMap&&a.enable(6),T.lightMap&&a.enable(7),T.aoMap&&a.enable(8),T.emissiveMap&&a.enable(9),T.bumpMap&&a.enable(10),T.normalMap&&a.enable(11),T.objectSpaceNormalMap&&a.enable(12),T.tangentSpaceNormalMap&&a.enable(13),T.clearcoat&&a.enable(14),T.clearcoatMap&&a.enable(15),T.clearcoatRoughnessMap&&a.enable(16),T.clearcoatNormalMap&&a.enable(17),T.iridescence&&a.enable(18),T.iridescenceMap&&a.enable(19),T.iridescenceThicknessMap&&a.enable(20),T.displacementMap&&a.enable(21),T.specularMap&&a.enable(22),T.roughnessMap&&a.enable(23),T.metalnessMap&&a.enable(24),T.gradientMap&&a.enable(25),T.alphaMap&&a.enable(26),T.alphaTest&&a.enable(27),T.vertexColors&&a.enable(28),T.vertexAlphas&&a.enable(29),T.vertexUvs&&a.enable(30),T.vertexTangents&&a.enable(31),T.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.physicallyCorrectLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.specularIntensityMap&&a.enable(15),T.specularColorMap&&a.enable(16),T.transmission&&a.enable(17),T.transmissionMap&&a.enable(18),T.thicknessMap&&a.enable(19),T.sheen&&a.enable(20),T.sheenColorMap&&a.enable(21),T.sheenRoughnessMap&&a.enable(22),T.decodeVideoTexture&&a.enable(23),T.opaque&&a.enable(24),M.push(a.mask)}function x(M){let T=p[M.type],P;if(T){let I=lc[T];P=R0.clone(I.uniforms)}else P=M.uniforms;return P}function b(M,T){let P;for(let I=0,k=c.length;I<k;I++){let R=c[I];if(R.cacheKey===T){P=R,++P.usedTimes;break}}return P===void 0&&(P=new UCe(t,T,M,s),c.push(P)),P}function S(M){if(--M.usedTimes===0){let T=c.indexOf(M);c[T]=c[c.length-1],c.pop(),M.destroy()}}function A(M){l.remove(M)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:b,releaseProgram:S,releaseShaderCache:A,programs:c,dispose:E}}function WCe(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function n(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function XCe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function wj(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function bj(){let t=[],e=0,i=[],n=[],r=[];function s(){e=0,i.length=0,n.length=0,r.length=0}function o(u,d,f,p,m,g){let v=t[e];return v===void 0?(v={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:m,group:g},t[e]=v):(v.id=u.id,v.object=u,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=u.renderOrder,v.z=m,v.group=g),e++,v}function a(u,d,f,p,m,g){let v=o(u,d,f,p,m,g);f.transmission>0?n.push(v):f.transparent===!0?r.push(v):i.push(v)}function l(u,d,f,p,m,g){let v=o(u,d,f,p,m,g);f.transmission>0?n.unshift(v):f.transparent===!0?r.unshift(v):i.unshift(v)}function c(u,d){i.length>1&&i.sort(u||XCe),n.length>1&&n.sort(d||wj),r.length>1&&r.sort(d||wj)}function h(){for(let u=e,d=t.length;u<d;u++){let f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function qCe(){let t=new WeakMap;function e(n,r){let s=t.get(n),o;return s===void 0?(o=new bj,t.set(n,[o])):r>=s.length?(o=new bj,s.push(o)):o=s[r],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function YCe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new O,color:new Tt};break;case"SpotLight":i={position:new O,direction:new O,color:new Tt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new O,color:new Tt,distance:0,decay:0};break;case"HemisphereLight":i={direction:new O,skyColor:new Tt,groundColor:new Tt};break;case"RectAreaLight":i={color:new Tt,position:new O,halfWidth:new O,halfHeight:new O};break}return t[e.id]=i,i}}}function QCe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}var JCe=0;function KCe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function ZCe(t,e){let i=new YCe,n=QCe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new O);let s=new O,o=new Qe,a=new Qe;function l(h,u){let d=0,f=0,p=0;for(let I=0;I<9;I++)r.probe[I].set(0,0,0);let m=0,g=0,v=0,y=0,x=0,b=0,S=0,A=0,E=0,M=0;h.sort(KCe);let T=u!==!0?Math.PI:1;for(let I=0,k=h.length;I<k;I++){let R=h[I],F=R.color,V=R.intensity,Q=R.distance,X=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)d+=F.r*V*T,f+=F.g*V*T,p+=F.b*V*T;else if(R.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(R.sh.coefficients[z],V);else if(R.isDirectionalLight){let z=i.get(R);if(z.color.copy(R.color).multiplyScalar(R.intensity*T),R.castShadow){let Y=R.shadow,j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,r.directionalShadow[m]=j,r.directionalShadowMap[m]=X,r.directionalShadowMatrix[m]=R.shadow.matrix,b++}r.directional[m]=z,m++}else if(R.isSpotLight){let z=i.get(R);z.position.setFromMatrixPosition(R.matrixWorld),z.color.copy(F).multiplyScalar(V*T),z.distance=Q,z.coneCos=Math.cos(R.angle),z.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),z.decay=R.decay,r.spot[v]=z;let Y=R.shadow;if(R.map&&(r.spotLightMap[E]=R.map,E++,Y.updateMatrices(R),R.castShadow&&M++),r.spotLightMatrix[v]=Y.matrix,R.castShadow){let j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,r.spotShadow[v]=j,r.spotShadowMap[v]=X,A++}v++}else if(R.isRectAreaLight){let z=i.get(R);z.color.copy(F).multiplyScalar(V),z.halfWidth.set(R.width*.5,0,0),z.halfHeight.set(0,R.height*.5,0),r.rectArea[y]=z,y++}else if(R.isPointLight){let z=i.get(R);if(z.color.copy(R.color).multiplyScalar(R.intensity*T),z.distance=R.distance,z.decay=R.decay,R.castShadow){let Y=R.shadow,j=n.get(R);j.shadowBias=Y.bias,j.shadowNormalBias=Y.normalBias,j.shadowRadius=Y.radius,j.shadowMapSize=Y.mapSize,j.shadowCameraNear=Y.camera.near,j.shadowCameraFar=Y.camera.far,r.pointShadow[g]=j,r.pointShadowMap[g]=X,r.pointShadowMatrix[g]=R.shadow.matrix,S++}r.point[g]=z,g++}else if(R.isHemisphereLight){let z=i.get(R);z.skyColor.copy(R.color).multiplyScalar(V*T),z.groundColor.copy(R.groundColor).multiplyScalar(V*T),r.hemi[x]=z,x++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=it.LTC_FLOAT_1,r.rectAreaLTC2=it.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=it.LTC_HALF_1,r.rectAreaLTC2=it.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;let P=r.hash;(P.directionalLength!==m||P.pointLength!==g||P.spotLength!==v||P.rectAreaLength!==y||P.hemiLength!==x||P.numDirectionalShadows!==b||P.numPointShadows!==S||P.numSpotShadows!==A||P.numSpotMaps!==E)&&(r.directional.length=m,r.spot.length=v,r.rectArea.length=y,r.point.length=g,r.hemi.length=x,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=S,r.pointShadowMap.length=S,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=S,r.spotLightMatrix.length=A+E-M,r.spotLightMap.length=E,r.numSpotLightShadowsWithMaps=M,P.directionalLength=m,P.pointLength=g,P.spotLength=v,P.rectAreaLength=y,P.hemiLength=x,P.numDirectionalShadows=b,P.numPointShadows=S,P.numSpotShadows=A,P.numSpotMaps=E,r.version=JCe++)}function c(h,u){let d=0,f=0,p=0,m=0,g=0,v=u.matrixWorldInverse;for(let y=0,x=h.length;y<x;y++){let b=h[y];if(b.isDirectionalLight){let S=r.directional[d];S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),d++}else if(b.isSpotLight){let S=r.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(s),S.direction.transformDirection(v),p++}else if(b.isRectAreaLight){let S=r.rectArea[m];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(a),S.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){let S=r.point[f];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){let S=r.hemi[g];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:r}}function Sj(t,e){let i=new ZCe(t,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(h){n.push(h)}function a(h){r.push(h)}function l(h){i.setup(n,h)}function c(h){i.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function $Ce(t,e){let i=new WeakMap;function n(s,o=0){let a=i.get(s),l;return a===void 0?(l=new Sj(t,e),i.set(s,[l])):o>=a.length?(l=new Sj(t,e),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}var v$=class extends mw{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=th,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},eEe=class extends mw{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new O,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},tEe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,iEe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function nEe(t,e,i){let n=new Tk,r=new ge,s=new ge,o=new Ht,a=new v$({depthPacking:n$}),l=new eEe,c={},h=i.maxTextureSize,u={[Il]:Tr,[Tr]:Il,[Ro]:Ro},d=new Wi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ge},radius:{value:4}},vertexShader:tEe,fragmentShader:iEe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new Rt;p.setAttribute("position",new Ot(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new $s(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bk,this.render=function(b,S,A){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;let E=t.getRenderTarget(),M=t.getActiveCubeFace(),T=t.getActiveMipmapLevel(),P=t.state;P.setBlending($n),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let I=0,k=b.length;I<k;I++){let R=b[I],F=R.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",R,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);let V=F.getFrameExtents();if(r.multiply(V),s.copy(F.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/V.x),r.x=s.x*V.x,F.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/V.y),r.y=s.y*V.y,F.mapSize.y=s.y)),F.map===null){let X=this.type!==Ix?{minFilter:ji,magFilter:ji}:{};F.map=new Li(r.x,r.y,X),F.map.texture.name=R.name+".shadowMap",F.camera.updateProjectionMatrix()}t.setRenderTarget(F.map),t.clear();let Q=F.getViewportCount();for(let X=0;X<Q;X++){let z=F.getViewport(X);o.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),P.viewport(o),F.updateMatrices(R,X),n=F.getFrustum(),x(S,A,F.camera,R,this.type)}F.isPointLightShadow!==!0&&this.type===Ix&&v(F,A),F.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(E,M,T)};function v(b,S){let A=e.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Li(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(S,null,A,d,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(S,null,A,f,m,null)}function y(b,S,A,E,M,T){let P=null,I=A.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(I!==void 0)P=I;else if(P=A.isPointLight===!0?l:a,t.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){let k=P.uuid,R=S.uuid,F=c[k];F===void 0&&(F={},c[k]=F);let V=F[R];V===void 0&&(V=P.clone(),F[R]=V),P=V}return P.visible=S.visible,P.wireframe=S.wireframe,T===Ix?P.side=S.shadowSide!==null?S.shadowSide:S.side:P.side=S.shadowSide!==null?S.shadowSide:u[S.side],P.alphaMap=S.alphaMap,P.alphaTest=S.alphaTest,P.map=S.map,P.clipShadows=S.clipShadows,P.clippingPlanes=S.clippingPlanes,P.clipIntersection=S.clipIntersection,P.displacementMap=S.displacementMap,P.displacementScale=S.displacementScale,P.displacementBias=S.displacementBias,P.wireframeLinewidth=S.wireframeLinewidth,P.linewidth=S.linewidth,A.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(A.matrixWorld),P.nearDistance=E,P.farDistance=M),P}function x(b,S,A,E,M){if(b.visible===!1)return;if(b.layers.test(S.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&M===Ix)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let P=e.update(b),I=b.material;if(Array.isArray(I)){let k=P.groups;for(let R=0,F=k.length;R<F;R++){let V=k[R],Q=I[V.materialIndex];if(Q&&Q.visible){let X=y(b,Q,E,A.near,A.far,M);t.renderBufferDirect(A,null,P,X,b,V)}}}else if(I.visible){let k=y(b,I,E,A.near,A.far,M);t.renderBufferDirect(A,null,P,k,b,null)}}let T=b.children;for(let P=0,I=T.length;P<I;P++)x(T[P],S,A,E,M)}}function rEe(t,e,i){let n=i.isWebGL2;function r(){let q=!1,oe=new Ht,xe=null,Fe=new Ht(0,0,0,0);return{setMask:function(Xe){xe!==Xe&&!q&&(t.colorMask(Xe,Xe,Xe,Xe),xe=Xe)},setLocked:function(Xe){q=Xe},setClear:function(Xe,pt,ti,ui,vr){vr===!0&&(Xe*=ui,pt*=ui,ti*=ui),oe.set(Xe,pt,ti,ui),Fe.equals(oe)===!1&&(t.clearColor(Xe,pt,ti,ui),Fe.copy(oe))},reset:function(){q=!1,xe=null,Fe.set(-1,0,0,0)}}}function s(){let q=!1,oe=null,xe=null,Fe=null;return{setTest:function(Xe){Xe?ve(2929):de(2929)},setMask:function(Xe){oe!==Xe&&!q&&(t.depthMask(Xe),oe=Xe)},setFunc:function(Xe){if(xe!==Xe){switch(Xe){case Awe:t.depthFunc(512);break;case Mwe:t.depthFunc(519);break;case Cwe:t.depthFunc(513);break;case KB:t.depthFunc(515);break;case Ewe:t.depthFunc(514);break;case Twe:t.depthFunc(518);break;case Pwe:t.depthFunc(516);break;case Dwe:t.depthFunc(517);break;default:t.depthFunc(515)}xe=Xe}},setLocked:function(Xe){q=Xe},setClear:function(Xe){Fe!==Xe&&(t.clearDepth(Xe),Fe=Xe)},reset:function(){q=!1,oe=null,xe=null,Fe=null}}}function o(){let q=!1,oe=null,xe=null,Fe=null,Xe=null,pt=null,ti=null,ui=null,vr=null;return{setTest:function(Pt){q||(Pt?ve(2960):de(2960))},setMask:function(Pt){oe!==Pt&&!q&&(t.stencilMask(Pt),oe=Pt)},setFunc:function(Pt,gn,ki){(xe!==Pt||Fe!==gn||Xe!==ki)&&(t.stencilFunc(Pt,gn,ki),xe=Pt,Fe=gn,Xe=ki)},setOp:function(Pt,gn,ki){(pt!==Pt||ti!==gn||ui!==ki)&&(t.stencilOp(Pt,gn,ki),pt=Pt,ti=gn,ui=ki)},setLocked:function(Pt){q=Pt},setClear:function(Pt){vr!==Pt&&(t.clearStencil(Pt),vr=Pt)},reset:function(){q=!1,oe=null,xe=null,Fe=null,Xe=null,pt=null,ti=null,ui=null,vr=null}}}let a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap,d={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,I=null,k=null,R=null,F=null,V=t.getParameter(35661),Q=!1,X=0,z=t.getParameter(7938);z.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(z)[1]),Q=X>=1):z.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),Q=X>=2);let Y=null,j={},J=t.getParameter(3088),H=t.getParameter(2978),Z=new Ht().fromArray(J),K=new Ht().fromArray(H);function ne(q,oe,xe){let Fe=new Uint8Array(4),Xe=t.createTexture();t.bindTexture(q,Xe),t.texParameteri(q,10241,9728),t.texParameteri(q,10240,9728);for(let pt=0;pt<xe;pt++)t.texImage2D(oe+pt,0,6408,1,1,0,6408,5121,Fe);return Xe}let W={};W[3553]=ne(3553,3553,1),W[34067]=ne(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ve(2929),l.setFunc(KB),Be(!1),Ue(p6),ve(2884),Ee($n);function ve(q){d[q]!==!0&&(t.enable(q),d[q]=!0)}function de(q){d[q]!==!1&&(t.disable(q),d[q]=!1)}function pe(q,oe){return f[q]!==oe?(t.bindFramebuffer(q,oe),f[q]=oe,n&&(q===36009&&(f[36160]=oe),q===36160&&(f[36009]=oe)),!0):!1}function ce(q,oe){let xe=m,Fe=!1;if(q)if(xe=p.get(oe),xe===void 0&&(xe=[],p.set(oe,xe)),q.isWebGLMultipleRenderTargets){let Xe=q.texture;if(xe.length!==Xe.length||xe[0]!==36064){for(let pt=0,ti=Xe.length;pt<ti;pt++)xe[pt]=36064+pt;xe.length=Xe.length,Fe=!0}}else xe[0]!==36064&&(xe[0]=36064,Fe=!0);else xe[0]!==1029&&(xe[0]=1029,Fe=!0);Fe&&(i.isWebGL2?t.drawBuffers(xe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(xe))}function ye(q){return g!==q?(t.useProgram(q),g=q,!0):!1}let ae={[Cg]:32774,[fwe]:32778,[pwe]:32779};if(n)ae[y6]=32775,ae[x6]=32776;else{let q=e.get("EXT_blend_minmax");q!==null&&(ae[y6]=q.MIN_EXT,ae[x6]=q.MAX_EXT)}let le={[mwe]:0,[gwe]:1,[vwe]:768,[QZ]:770,[Swe]:776,[wwe]:774,[xwe]:772,[ywe]:769,[JZ]:771,[bwe]:775,[_we]:773};function Ee(q,oe,xe,Fe,Xe,pt,ti,ui){if(q===$n){v===!0&&(de(3042),v=!1);return}if(v===!1&&(ve(3042),v=!0),q!==dwe){if(q!==y||ui!==T){if((x!==Cg||A!==Cg)&&(t.blendEquation(32774),x=Cg,A=Cg),ui)switch(q){case _v:t.blendFuncSeparate(1,771,1,771);break;case m6:t.blendFunc(1,1);break;case g6:t.blendFuncSeparate(0,769,0,1);break;case v6:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case _v:t.blendFuncSeparate(770,771,1,771);break;case m6:t.blendFunc(770,1);break;case g6:t.blendFuncSeparate(0,769,0,1);break;case v6:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}b=null,S=null,E=null,M=null,y=q,T=ui}return}Xe=Xe||oe,pt=pt||xe,ti=ti||Fe,(oe!==x||Xe!==A)&&(t.blendEquationSeparate(ae[oe],ae[Xe]),x=oe,A=Xe),(xe!==b||Fe!==S||pt!==E||ti!==M)&&(t.blendFuncSeparate(le[xe],le[Fe],le[pt],le[ti]),b=xe,S=Fe,E=pt,M=ti),y=q,T=!1}function Te(q,oe){q.side===Ro?de(2884):ve(2884);let xe=q.side===Tr;oe&&(xe=!xe),Be(xe),q.blending===_v&&q.transparent===!1?Ee($n):Ee(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);let Fe=q.stencilWrite;c.setTest(Fe),Fe&&(c.setMask(q.stencilWriteMask),c.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),c.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),Pe(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?ve(32926):de(32926)}function Be(q){P!==q&&(q?t.frontFace(2304):t.frontFace(2305),P=q)}function Ue(q){q!==cwe?(ve(2884),q!==I&&(q===p6?t.cullFace(1029):q===uwe?t.cullFace(1028):t.cullFace(1032))):de(2884),I=q}function Ie(q){q!==k&&(Q&&t.lineWidth(q),k=q)}function Pe(q,oe,xe){q?(ve(32823),(R!==oe||F!==xe)&&(t.polygonOffset(oe,xe),R=oe,F=xe)):de(32823)}function Je(q){q?ve(3089):de(3089)}function Ke(q){q===void 0&&(q=33984+V-1),Y!==q&&(t.activeTexture(q),Y=q)}function U(q,oe,xe){xe===void 0&&(Y===null?xe=33984+V-1:xe=Y);let Fe=j[xe];Fe===void 0&&(Fe={type:void 0,texture:void 0},j[xe]=Fe),(Fe.type!==q||Fe.texture!==oe)&&(Y!==xe&&(t.activeTexture(xe),Y=xe),t.bindTexture(q,oe||W[q]),Fe.type=q,Fe.texture=oe)}function L(){let q=j[Y];q!==void 0&&q.type!==void 0&&(t.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function _e(){try{t.compressedTexImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function we(){try{t.texSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Me(){try{t.texSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function We(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Le(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ue(){try{t.texStorage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Ge(){try{t.texStorage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function re(){try{t.texImage2D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function be(){try{t.texImage3D.apply(t,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Re(q){Z.equals(q)===!1&&(t.scissor(q.x,q.y,q.z,q.w),Z.copy(q))}function Ne(q){K.equals(q)===!1&&(t.viewport(q.x,q.y,q.z,q.w),K.copy(q))}function tt(q,oe){let xe=u.get(oe);xe===void 0&&(xe=new WeakMap,u.set(oe,xe));let Fe=xe.get(q);Fe===void 0&&(Fe=t.getUniformBlockIndex(oe,q.name),xe.set(q,Fe))}function xt(q,oe){let xe=u.get(oe).get(q);h.get(oe)!==xe&&(t.uniformBlockBinding(oe,xe,q.__bindingPointIndex),h.set(oe,xe))}function kt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),n===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},Y=null,j={},f={},p=new WeakMap,m=[],g=null,v=!1,y=null,x=null,b=null,S=null,A=null,E=null,M=null,T=!1,P=null,I=null,k=null,R=null,F=null,Z.set(0,0,t.canvas.width,t.canvas.height),K.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:ve,disable:de,bindFramebuffer:pe,drawBuffers:ce,useProgram:ye,setBlending:Ee,setMaterial:Te,setFlipSided:Be,setCullFace:Ue,setLineWidth:Ie,setPolygonOffset:Pe,setScissorTest:Je,activeTexture:Ke,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:_e,texImage2D:re,texImage3D:be,updateUBOMapping:tt,uniformBlockBinding:xt,texStorage2D:ue,texStorage3D:Ge,texSubImage2D:we,texSubImage3D:Me,compressedTexSubImage2D:We,compressedTexSubImage3D:Le,scissor:Re,viewport:Ne,reset:kt}}function sEe(t,e,i,n,r,s,o){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return v?new OffscreenCanvas(U,L):IC("canvas")}function x(U,L,te,_e){let we=1;if((U.width>_e||U.height>_e)&&(we=_e/Math.max(U.width,U.height)),we<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){let Me=L?DC:Math.floor,We=Me(we*U.width),Le=Me(we*U.height);m===void 0&&(m=y(We,Le));let ue=te?y(We,Le):m;return ue.width=We,ue.height=Le,ue.getContext("2d").drawImage(U,0,0,We,Le),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+We+"x"+Le+")."),ue}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function b(U){return nR(U.width)&&nR(U.height)}function S(U){return a?!1:U.wrapS!==kn||U.wrapT!==kn||U.minFilter!==ji&&U.minFilter!==Zt}function A(U,L){return U.generateMipmaps&&L&&U.minFilter!==ji&&U.minFilter!==Zt}function E(U){t.generateMipmap(U)}function M(U,L,te,_e,we=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Me=L;return L===6403&&(te===5126&&(Me=33326),te===5131&&(Me=33325),te===5121&&(Me=33321)),L===33319&&(te===5126&&(Me=33328),te===5131&&(Me=33327),te===5121&&(Me=33323)),L===6408&&(te===5126&&(Me=34836),te===5131&&(Me=34842),te===5121&&(Me=_e===Vt&&we===!1?35907:32856),te===32819&&(Me=32854),te===32820&&(Me=32855)),(Me===33325||Me===33326||Me===33327||Me===33328||Me===34842||Me===34836)&&e.get("EXT_color_buffer_float"),Me}function T(U,L,te){return A(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==ji&&U.minFilter!==Zt?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===ji||U===_6||U===RD?9728:9729}function I(U){let L=U.target;L.removeEventListener("dispose",I),R(L),L.isVideoTexture&&p.delete(L)}function k(U){let L=U.target;L.removeEventListener("dispose",k),V(L)}function R(U){let L=n.get(U);if(L.__webglInit===void 0)return;let te=U.source,_e=g.get(te);if(_e){let we=_e[L.__cacheKey];we.usedTimes--,we.usedTimes===0&&F(U),Object.keys(_e).length===0&&g.delete(te)}n.remove(U)}function F(U){let L=n.get(U);t.deleteTexture(L.__webglTexture);let te=U.source,_e=g.get(te);delete _e[L.__cacheKey],o.memory.textures--}function V(U){let L=U.texture,te=n.get(U),_e=n.get(L);if(_e.__webglTexture!==void 0&&(t.deleteTexture(_e.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let we=0;we<6;we++)t.deleteFramebuffer(te.__webglFramebuffer[we]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[we]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let we=0;we<te.__webglColorRenderbuffer.length;we++)te.__webglColorRenderbuffer[we]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[we]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let we=0,Me=L.length;we<Me;we++){let We=n.get(L[we]);We.__webglTexture&&(t.deleteTexture(We.__webglTexture),o.memory.textures--),n.remove(L[we])}n.remove(L),n.remove(U)}let Q=0;function X(){Q=0}function z(){let U=Q;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Q+=1,U}function Y(U){let L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.encoding),L.join()}function j(U,L){let te=n.get(U);if(U.isVideoTexture&&Je(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){let _e=U.image;if(_e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(te,U,L);return}}i.bindTexture(3553,te.__webglTexture,33984+L)}function J(U,L){let te=n.get(U);if(U.version>0&&te.__version!==U.version){de(te,U,L);return}i.bindTexture(35866,te.__webglTexture,33984+L)}function H(U,L){let te=n.get(U);if(U.version>0&&te.__version!==U.version){de(te,U,L);return}i.bindTexture(32879,te.__webglTexture,33984+L)}function Z(U,L){let te=n.get(U);if(U.version>0&&te.__version!==U.version){pe(te,U,L);return}i.bindTexture(34067,te.__webglTexture,33984+L)}let K={[Iu]:10497,[kn]:33071,[eR]:33648},ne={[ji]:9728,[_6]:9984,[RD]:9986,[Zt]:9729,[kwe]:9985,[s0]:9987};function W(U,L,te){if(te?(t.texParameteri(U,10242,K[L.wrapS]),t.texParameteri(U,10243,K[L.wrapT]),(U===32879||U===35866)&&t.texParameteri(U,32882,K[L.wrapR]),t.texParameteri(U,10240,ne[L.magFilter]),t.texParameteri(U,10241,ne[L.minFilter])):(t.texParameteri(U,10242,33071),t.texParameteri(U,10243,33071),(U===32879||U===35866)&&t.texParameteri(U,32882,33071),(L.wrapS!==kn||L.wrapT!==kn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,10240,P(L.magFilter)),t.texParameteri(U,10241,P(L.minFilter)),L.minFilter!==ji&&L.minFilter!==Zt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let _e=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===ji||L.minFilter!==RD&&L.minFilter!==s0||L.type===Oo&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===o0&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||n.get(L).__currentAnisotropy)&&(t.texParameterf(U,_e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),n.get(L).__currentAnisotropy=L.anisotropy)}}function ve(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",I));let _e=L.source,we=g.get(_e);we===void 0&&(we={},g.set(_e,we));let Me=Y(L);if(Me!==U.__cacheKey){we[Me]===void 0&&(we[Me]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),we[Me].usedTimes++;let We=we[U.__cacheKey];We!==void 0&&(we[U.__cacheKey].usedTimes--,We.usedTimes===0&&F(L)),U.__cacheKey=Me,U.__webglTexture=we[Me].texture}return te}function de(U,L,te){let _e=3553;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(_e=35866),L.isData3DTexture&&(_e=32879);let we=ve(U,L),Me=L.source;i.bindTexture(_e,U.__webglTexture,33984+te);let We=n.get(Me);if(Me.version!==We.__version||we===!0){i.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let Le=S(L)&&b(L.image)===!1,ue=x(L.image,Le,!1,h);ue=Ke(L,ue);let Ge=b(ue)||a,re=s.convert(L.format,L.encoding),be=s.convert(L.type),Re=M(L.internalFormat,re,be,L.encoding,L.isVideoTexture);W(_e,L,Ge);let Ne,tt=L.mipmaps,xt=a&&L.isVideoTexture!==!0,kt=We.__version===void 0||we===!0,q=T(L,ue,Ge);if(L.isDepthTexture)Re=6402,a?L.type===Oo?Re=36012:L.type===$h?Re=33190:L.type===Ep?Re=35056:Re=33189:L.type===Oo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===Tp&&Re===6402&&L.type!==$Z&&L.type!==$h&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=$h,be=s.convert(L.type)),L.format===Xp&&Re===6402&&(Re=34041,L.type!==Ep&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=Ep,be=s.convert(L.type))),kt&&(xt?i.texStorage2D(3553,1,Re,ue.width,ue.height):i.texImage2D(3553,0,Re,ue.width,ue.height,0,re,be,null));else if(L.isDataTexture)if(tt.length>0&&Ge){xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,be,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,re,be,Ne.data);L.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,q,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,ue.width,ue.height,re,be,ue.data)):i.texImage2D(3553,0,Re,ue.width,ue.height,0,re,be,ue.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){xt&&kt&&i.texStorage3D(35866,q,Re,tt[0].width,tt[0].height,ue.depth);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],L.format!==Ea?re!==null?xt?i.compressedTexSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,re,Ne.data,0,0):i.compressedTexImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,Ne.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage3D(35866,oe,0,0,0,Ne.width,Ne.height,ue.depth,re,be,Ne.data):i.texImage3D(35866,oe,Re,Ne.width,Ne.height,ue.depth,0,re,be,Ne.data)}else{xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],L.format!==Ea?re!==null?xt?i.compressedTexSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,Ne.data):i.compressedTexImage2D(3553,oe,Re,Ne.width,Ne.height,0,Ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?i.texSubImage2D(3553,oe,0,0,Ne.width,Ne.height,re,be,Ne.data):i.texImage2D(3553,oe,Re,Ne.width,Ne.height,0,re,be,Ne.data)}else if(L.isDataArrayTexture)xt?(kt&&i.texStorage3D(35866,q,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(35866,0,0,0,0,ue.width,ue.height,ue.depth,re,be,ue.data)):i.texImage3D(35866,0,Re,ue.width,ue.height,ue.depth,0,re,be,ue.data);else if(L.isData3DTexture)xt?(kt&&i.texStorage3D(32879,q,Re,ue.width,ue.height,ue.depth),i.texSubImage3D(32879,0,0,0,0,ue.width,ue.height,ue.depth,re,be,ue.data)):i.texImage3D(32879,0,Re,ue.width,ue.height,ue.depth,0,re,be,ue.data);else if(L.isFramebufferTexture){if(kt)if(xt)i.texStorage2D(3553,q,Re,ue.width,ue.height);else{let oe=ue.width,xe=ue.height;for(let Fe=0;Fe<q;Fe++)i.texImage2D(3553,Fe,Re,oe,xe,0,re,be,null),oe>>=1,xe>>=1}}else if(tt.length>0&&Ge){xt&&kt&&i.texStorage2D(3553,q,Re,tt[0].width,tt[0].height);for(let oe=0,xe=tt.length;oe<xe;oe++)Ne=tt[oe],xt?i.texSubImage2D(3553,oe,0,0,re,be,Ne):i.texImage2D(3553,oe,Re,re,be,Ne);L.generateMipmaps=!1}else xt?(kt&&i.texStorage2D(3553,q,Re,ue.width,ue.height),i.texSubImage2D(3553,0,0,0,re,be,ue)):i.texImage2D(3553,0,Re,re,be,ue);A(L,Ge)&&E(_e),We.__version=Me.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function pe(U,L,te){if(L.image.length!==6)return;let _e=ve(U,L),we=L.source;i.bindTexture(34067,U.__webglTexture,33984+te);let Me=n.get(we);if(we.version!==Me.__version||_e===!0){i.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let We=L.isCompressedTexture||L.image[0].isCompressedTexture,Le=L.image[0]&&L.image[0].isDataTexture,ue=[];for(let oe=0;oe<6;oe++)!We&&!Le?ue[oe]=x(L.image[oe],!1,!0,c):ue[oe]=Le?L.image[oe].image:L.image[oe],ue[oe]=Ke(L,ue[oe]);let Ge=ue[0],re=b(Ge)||a,be=s.convert(L.format,L.encoding),Re=s.convert(L.type),Ne=M(L.internalFormat,be,Re,L.encoding),tt=a&&L.isVideoTexture!==!0,xt=Me.__version===void 0||_e===!0,kt=T(L,Ge,re);W(34067,L,re);let q;if(We){tt&&xt&&i.texStorage2D(34067,kt,Ne,Ge.width,Ge.height);for(let oe=0;oe<6;oe++){q=ue[oe].mipmaps;for(let xe=0;xe<q.length;xe++){let Fe=q[xe];L.format!==Ea?be!==null?tt?i.compressedTexSubImage2D(34069+oe,xe,0,0,Fe.width,Fe.height,be,Fe.data):i.compressedTexImage2D(34069+oe,xe,Ne,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):tt?i.texSubImage2D(34069+oe,xe,0,0,Fe.width,Fe.height,be,Re,Fe.data):i.texImage2D(34069+oe,xe,Ne,Fe.width,Fe.height,0,be,Re,Fe.data)}}}else{q=L.mipmaps,tt&&xt&&(q.length>0&&kt++,i.texStorage2D(34067,kt,Ne,ue[0].width,ue[0].height));for(let oe=0;oe<6;oe++)if(Le){tt?i.texSubImage2D(34069+oe,0,0,0,ue[oe].width,ue[oe].height,be,Re,ue[oe].data):i.texImage2D(34069+oe,0,Ne,ue[oe].width,ue[oe].height,0,be,Re,ue[oe].data);for(let xe=0;xe<q.length;xe++){let Fe=q[xe].image[oe].image;tt?i.texSubImage2D(34069+oe,xe+1,0,0,Fe.width,Fe.height,be,Re,Fe.data):i.texImage2D(34069+oe,xe+1,Ne,Fe.width,Fe.height,0,be,Re,Fe.data)}}else{tt?i.texSubImage2D(34069+oe,0,0,0,be,Re,ue[oe]):i.texImage2D(34069+oe,0,Ne,be,Re,ue[oe]);for(let xe=0;xe<q.length;xe++){let Fe=q[xe];tt?i.texSubImage2D(34069+oe,xe+1,0,0,be,Re,Fe.image[oe]):i.texImage2D(34069+oe,xe+1,Ne,be,Re,Fe.image[oe])}}}A(L,re)&&E(34067),Me.__version=we.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ce(U,L,te,_e,we){let Me=s.convert(te.format,te.encoding),We=s.convert(te.type),Le=M(te.internalFormat,Me,We,te.encoding);n.get(L).__hasExternalTextures||(we===32879||we===35866?i.texImage3D(we,0,Le,L.width,L.height,L.depth,0,Me,We,null):i.texImage2D(we,0,Le,L.width,L.height,0,Me,We,null)),i.bindFramebuffer(36160,U),Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,_e,we,n.get(te).__webglTexture,0,Ie(L)):(we===3553||we>=34069&&we<=34074)&&t.framebufferTexture2D(36160,_e,we,n.get(te).__webglTexture,0),i.bindFramebuffer(36160,null)}function ye(U,L,te){if(t.bindRenderbuffer(36161,U),L.depthBuffer&&!L.stencilBuffer){let _e=33189;if(te||Pe(L)){let we=L.depthTexture;we&&we.isDepthTexture&&(we.type===Oo?_e=36012:we.type===$h&&(_e=33190));let Me=Ie(L);Pe(L)?d.renderbufferStorageMultisampleEXT(36161,Me,_e,L.width,L.height):t.renderbufferStorageMultisample(36161,Me,_e,L.width,L.height)}else t.renderbufferStorage(36161,_e,L.width,L.height);t.framebufferRenderbuffer(36160,36096,36161,U)}else if(L.depthBuffer&&L.stencilBuffer){let _e=Ie(L);te&&Pe(L)===!1?t.renderbufferStorageMultisample(36161,_e,35056,L.width,L.height):Pe(L)?d.renderbufferStorageMultisampleEXT(36161,_e,35056,L.width,L.height):t.renderbufferStorage(36161,34041,L.width,L.height),t.framebufferRenderbuffer(36160,33306,36161,U)}else{let _e=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let we=0;we<_e.length;we++){let Me=_e[we],We=s.convert(Me.format,Me.encoding),Le=s.convert(Me.type),ue=M(Me.internalFormat,We,Le,Me.encoding),Ge=Ie(L);te&&Pe(L)===!1?t.renderbufferStorageMultisample(36161,Ge,ue,L.width,L.height):Pe(L)?d.renderbufferStorageMultisampleEXT(36161,Ge,ue,L.width,L.height):t.renderbufferStorage(36161,ue,L.width,L.height)}}t.bindRenderbuffer(36161,null)}function ae(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),j(L.depthTexture,0);let te=n.get(L.depthTexture).__webglTexture,_e=Ie(L);if(L.depthTexture.format===Tp)Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,te,0,_e):t.framebufferTexture2D(36160,36096,3553,te,0);else if(L.depthTexture.format===Xp)Pe(L)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,te,0,_e):t.framebufferTexture2D(36160,33306,3553,te,0);else throw new Error("Unknown depthTexture format")}function le(U){let L=n.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ae(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let _e=0;_e<6;_e++)i.bindFramebuffer(36160,L.__webglFramebuffer[_e]),L.__webglDepthbuffer[_e]=t.createRenderbuffer(),ye(L.__webglDepthbuffer[_e],U,!1)}else i.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),ye(L.__webglDepthbuffer,U,!1);i.bindFramebuffer(36160,null)}function Ee(U,L,te){let _e=n.get(U);L!==void 0&&ce(_e.__webglFramebuffer,U,U.texture,36064,3553),te!==void 0&&le(U)}function Te(U){let L=U.texture,te=n.get(U),_e=n.get(L);U.addEventListener("dispose",k),U.isWebGLMultipleRenderTargets!==!0&&(_e.__webglTexture===void 0&&(_e.__webglTexture=t.createTexture()),_e.__version=L.version,o.memory.textures++);let we=U.isWebGLCubeRenderTarget===!0,Me=U.isWebGLMultipleRenderTargets===!0,We=b(U)||a;if(we){te.__webglFramebuffer=[];for(let Le=0;Le<6;Le++)te.__webglFramebuffer[Le]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Me)if(r.drawBuffers){let Le=U.texture;for(let ue=0,Ge=Le.length;ue<Ge;ue++){let re=n.get(Le[ue]);re.__webglTexture===void 0&&(re.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Pe(U)===!1){let Le=Me?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,te.__webglMultisampledFramebuffer);for(let ue=0;ue<Le.length;ue++){let Ge=Le[ue];te.__webglColorRenderbuffer[ue]=t.createRenderbuffer(),t.bindRenderbuffer(36161,te.__webglColorRenderbuffer[ue]);let re=s.convert(Ge.format,Ge.encoding),be=s.convert(Ge.type),Re=M(Ge.internalFormat,re,be,Ge.encoding,U.isXRRenderTarget===!0),Ne=Ie(U);t.renderbufferStorageMultisample(36161,Ne,Re,U.width,U.height),t.framebufferRenderbuffer(36160,36064+ue,36161,te.__webglColorRenderbuffer[ue])}t.bindRenderbuffer(36161,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),ye(te.__webglDepthRenderbuffer,U,!0)),i.bindFramebuffer(36160,null)}}if(we){i.bindTexture(34067,_e.__webglTexture),W(34067,L,We);for(let Le=0;Le<6;Le++)ce(te.__webglFramebuffer[Le],U,L,36064,34069+Le);A(L,We)&&E(34067),i.unbindTexture()}else if(Me){let Le=U.texture;for(let ue=0,Ge=Le.length;ue<Ge;ue++){let re=Le[ue],be=n.get(re);i.bindTexture(3553,be.__webglTexture),W(3553,re,We),ce(te.__webglFramebuffer,U,re,36064+ue,3553),A(re,We)&&E(3553)}i.unbindTexture()}else{let Le=3553;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Le=U.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(Le,_e.__webglTexture),W(Le,L,We),ce(te.__webglFramebuffer,U,L,36064,Le),A(L,We)&&E(Le),i.unbindTexture()}U.depthBuffer&&le(U)}function Be(U){let L=b(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let _e=0,we=te.length;_e<we;_e++){let Me=te[_e];if(A(Me,L)){let We=U.isWebGLCubeRenderTarget?34067:3553,Le=n.get(Me).__webglTexture;i.bindTexture(We,Le),E(We),i.unbindTexture()}}}function Ue(U){if(a&&U.samples>0&&Pe(U)===!1){let L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,_e=U.height,we=16384,Me=[],We=U.stencilBuffer?33306:36096,Le=n.get(U),ue=U.isWebGLMultipleRenderTargets===!0;if(ue)for(let Ge=0;Ge<L.length;Ge++)i.bindFramebuffer(36160,Le.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ge,36161,null),i.bindFramebuffer(36160,Le.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ge,3553,null,0);i.bindFramebuffer(36008,Le.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,Le.__webglFramebuffer);for(let Ge=0;Ge<L.length;Ge++){Me.push(36064+Ge),U.depthBuffer&&Me.push(We);let re=Le.__ignoreDepthValues!==void 0?Le.__ignoreDepthValues:!1;if(re===!1&&(U.depthBuffer&&(we|=256),U.stencilBuffer&&(we|=1024)),ue&&t.framebufferRenderbuffer(36008,36064,36161,Le.__webglColorRenderbuffer[Ge]),re===!0&&(t.invalidateFramebuffer(36008,[We]),t.invalidateFramebuffer(36009,[We])),ue){let be=n.get(L[Ge]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,be,0)}t.blitFramebuffer(0,0,te,_e,0,0,te,_e,we,9728),f&&t.invalidateFramebuffer(36008,Me)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ue)for(let Ge=0;Ge<L.length;Ge++){i.bindFramebuffer(36160,Le.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ge,36161,Le.__webglColorRenderbuffer[Ge]);let re=n.get(L[Ge]).__webglTexture;i.bindFramebuffer(36160,Le.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ge,3553,re,0)}i.bindFramebuffer(36009,Le.__webglMultisampledFramebuffer)}}function Ie(U){return Math.min(u,U.samples)}function Pe(U){let L=n.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Je(U){let L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ke(U,L){let te=U.encoding,_e=U.format,we=U.type;return U.isCompressedTexture===!0||U.isVideoTexture===!0||U.format===iR||te!==Dc&&(te===Vt?a===!1?e.has("EXT_sRGB")===!0&&_e===Ea?(U.format=iR,U.minFilter=Zt,U.generateMipmaps=!1):L=a$.sRGBToLinear(L):(_e!==Ea||we!==fs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",te)),L}this.allocateTextureUnit=z,this.resetTextureUnits=X,this.setTexture2D=j,this.setTexture2DArray=J,this.setTexture3D=H,this.setTextureCube=Z,this.rebindTextures=Ee,this.setupRenderTarget=Te,this.updateRenderTargetMipmap=Be,this.updateMultisampleRenderTarget=Ue,this.setupDepthRenderbuffer=le,this.setupFrameBufferTexture=ce,this.useMultisampledRTT=Pe}function oEe(t,e,i){let n=i.isWebGL2;function r(s,o=null){let a;if(s===fs)return 5121;if(s===Vwe)return 32819;if(s===Hwe)return 32820;if(s===zwe)return 5120;if(s===Uwe)return 5122;if(s===$Z)return 5123;if(s===Gwe)return 5124;if(s===$h)return 5125;if(s===Oo)return 5126;if(s===o0)return n?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===jwe)return 6406;if(s===Ea)return 6408;if(s===Wwe)return 6409;if(s===Xwe)return 6410;if(s===Tp)return 6402;if(s===Xp)return 34041;if(s===iR)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===qwe)return 6403;if(s===Ywe)return 36244;if(s===e$)return 33319;if(s===Qwe)return 33320;if(s===Jwe)return 36249;if(s===OD||s===FD||s===ND||s===kD)if(o===Vt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===OD)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===FD)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===ND)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===kD)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===OD)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===FD)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===ND)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===kD)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===w6||s===b6||s===S6||s===A6)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===w6)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===b6)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===S6)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===A6)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Kwe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===M6||s===C6)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===M6)return o===Vt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===C6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===E6||s===T6||s===P6||s===D6||s===I6||s===L6||s===B6||s===R6||s===O6||s===F6||s===N6||s===k6||s===z6||s===U6)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===E6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===T6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===P6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===D6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===I6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===L6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===B6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===R6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===O6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===F6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===N6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===k6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===z6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===U6)return o===Vt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===zD)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===zD)return o===Vt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===Zwe||s===G6||s===V6||s===H6)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===zD)return a.COMPRESSED_RED_RGTC1_EXT;if(s===G6)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===V6)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===H6)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Ep?n?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}var aEe=class extends os{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}},iv=class extends Ri{constructor(){super(),this.isGroup=!0,this.type="Group"}},lEe={type:"move"},h3=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new iv,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new iv,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new O,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new O),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new iv,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new O,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new O),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,i){let n=null,r=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(l&&t.hand){s=!0;for(let p of t.hand.values()){let m=e.getJointPose(p,i),g=this._getHandJoint(l,p);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let c=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],u=c.position.distanceTo(h.position),d=.02,f=.005;l.inputState.pinching&&u>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&u<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else a!==null&&t.gripSpace&&(r=e.getPose(t.gripSpace,i),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(n=e.getPose(t.targetRaySpace,i),n===null&&r!==null&&(n=r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(lEe)))}return o!==null&&(o.visible=n!==null),a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let i=new iv;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}},l0=class extends ur{constructor(t,e,i,n,r,s,o,a,l,c){if(c=c!==void 0?c:Tp,c!==Tp&&c!==Xp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===Tp&&(i=$h),i===void 0&&c===Xp&&(i=Ep),super(null,n,r,s,o,a,c,i,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=o!==void 0?o:ji,this.minFilter=a!==void 0?a:ji,this.flipY=!1,this.generateMipmaps=!1}},cEe=class extends qr{constructor(t,e){super();let i=this,n=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,h=null,u=null,d=null,f=null,p=e.getContextAttributes(),m=null,g=null,v=[],y=[],x=new Set,b=new Map,S=new os;S.layers.enable(1),S.viewport=new Ht;let A=new os;A.layers.enable(2),A.viewport=new Ht;let E=[S,A],M=new aEe;M.layers.enable(1),M.layers.enable(2);let T=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let H=v[J];return H===void 0&&(H=new h3,v[J]=H),H.getTargetRaySpace()},this.getControllerGrip=function(J){let H=v[J];return H===void 0&&(H=new h3,v[J]=H),H.getGripSpace()},this.getHand=function(J){let H=v[J];return H===void 0&&(H=new h3,v[J]=H),H.getHandSpace()};function I(J){let H=y.indexOf(J.inputSource);if(H===-1)return;let Z=v[H];Z!==void 0&&Z.dispatchEvent({type:J.type,data:J.inputSource})}function k(){n.removeEventListener("select",I),n.removeEventListener("selectstart",I),n.removeEventListener("selectend",I),n.removeEventListener("squeeze",I),n.removeEventListener("squeezestart",I),n.removeEventListener("squeezeend",I),n.removeEventListener("end",k),n.removeEventListener("inputsourceschange",R);for(let J=0;J<v.length;J++){let H=y[J];H!==null&&(y[J]=null,v[J].disconnect(H))}T=null,P=null,t.setRenderTarget(m),d=null,u=null,h=null,n=null,g=null,j.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){r=J,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){o=J,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(J){l=J},this.getBaseLayer=function(){return u!==null?u:d},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(J){if(n=J,n!==null){if(m=t.getRenderTarget(),n.addEventListener("select",I),n.addEventListener("selectstart",I),n.addEventListener("selectend",I),n.addEventListener("squeeze",I),n.addEventListener("squeezestart",I),n.addEventListener("squeezeend",I),n.addEventListener("end",k),n.addEventListener("inputsourceschange",R),p.xrCompatible!==!0&&await e.makeXRCompatible(),n.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let H={antialias:n.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(n,e,H),n.updateRenderState({baseLayer:d}),g=new Li(d.framebufferWidth,d.framebufferHeight,{format:Ea,type:fs,encoding:t.outputEncoding,stencilBuffer:p.stencil})}else{let H=null,Z=null,K=null;p.depth&&(K=p.stencil?35056:33190,H=p.stencil?Xp:Tp,Z=p.stencil?Ep:$h);let ne={colorFormat:32856,depthFormat:K,scaleFactor:r};h=new XRWebGLBinding(n,e),u=h.createProjectionLayer(ne),n.updateRenderState({layers:[u]}),g=new Li(u.textureWidth,u.textureHeight,{format:Ea,type:fs,depthTexture:new l0(u.textureWidth,u.textureHeight,Z,void 0,void 0,void 0,void 0,void 0,void 0,H),stencilBuffer:p.stencil,encoding:t.outputEncoding,samples:p.antialias?4:0});let W=t.properties.get(g);W.__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await n.requestReferenceSpace(o),j.setContext(n),j.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function R(J){for(let H=0;H<J.removed.length;H++){let Z=J.removed[H],K=y.indexOf(Z);K>=0&&(y[K]=null,v[K].disconnect(Z))}for(let H=0;H<J.added.length;H++){let Z=J.added[H],K=y.indexOf(Z);if(K===-1){for(let W=0;W<v.length;W++)if(W>=y.length){y.push(Z),K=W;break}else if(y[W]===null){y[W]=Z,K=W;break}if(K===-1)break}let ne=v[K];ne&&ne.connect(Z)}}let F=new O,V=new O;function Q(J,H,Z){F.setFromMatrixPosition(H.matrixWorld),V.setFromMatrixPosition(Z.matrixWorld);let K=F.distanceTo(V),ne=H.projectionMatrix.elements,W=Z.projectionMatrix.elements,ve=ne[14]/(ne[10]-1),de=ne[14]/(ne[10]+1),pe=(ne[9]+1)/ne[5],ce=(ne[9]-1)/ne[5],ye=(ne[8]-1)/ne[0],ae=(W[8]+1)/W[0],le=ve*ye,Ee=ve*ae,Te=K/(-ye+ae),Be=Te*-ye;H.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(Be),J.translateZ(Te),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();let Ue=ve+Te,Ie=de+Te,Pe=le-Be,Je=Ee+(K-Be),Ke=pe*de/Ie*Ue,U=ce*de/Ie*Ue;J.projectionMatrix.makePerspective(Pe,Je,Ke,U,Ue,Ie)}function X(J,H){H===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(H.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(n===null)return;M.near=A.near=S.near=J.near,M.far=A.far=S.far=J.far,(T!==M.near||P!==M.far)&&(n.updateRenderState({depthNear:M.near,depthFar:M.far}),T=M.near,P=M.far);let H=J.parent,Z=M.cameras;X(M,H);for(let ne=0;ne<Z.length;ne++)X(Z[ne],H);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),J.matrix.copy(M.matrix),J.matrix.decompose(J.position,J.quaternion,J.scale);let K=J.children;for(let ne=0,W=K.length;ne<W;ne++)K[ne].updateMatrixWorld(!0);Z.length===2?Q(M,S,A):M.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(!(u===null&&d===null))return a},this.setFoveation=function(J){a=J,u!==null&&(u.fixedFoveation=J),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=J)},this.getPlanes=function(){return x};let z=null;function Y(J,H){if(c=H.getViewerPose(l||s),f=H,c!==null){let Z=c.views;d!==null&&(t.setRenderTargetFramebuffer(g,d.framebuffer),t.setRenderTarget(g));let K=!1;Z.length!==M.cameras.length&&(M.cameras.length=0,K=!0);for(let ne=0;ne<Z.length;ne++){let W=Z[ne],ve=null;if(d!==null)ve=d.getViewport(W);else{let pe=h.getViewSubImage(u,W);ve=pe.viewport,ne===0&&(t.setRenderTargetTextures(g,pe.colorTexture,u.ignoreDepthValues?void 0:pe.depthStencilTexture),t.setRenderTarget(g))}let de=E[ne];de===void 0&&(de=new os,de.layers.enable(ne),de.viewport=new Ht,E[ne]=de),de.matrix.fromArray(W.transform.matrix),de.projectionMatrix.fromArray(W.projectionMatrix),de.viewport.set(ve.x,ve.y,ve.width,ve.height),ne===0&&M.matrix.copy(de.matrix),K===!0&&M.cameras.push(de)}}for(let Z=0;Z<v.length;Z++){let K=y[Z],ne=v[Z];K!==null&&ne!==void 0&&ne.update(K,H,l||s)}if(z&&z(J,H),H.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:H.detectedPlanes});let Z=null;for(let K of x)H.detectedPlanes.has(K)||(Z===null&&(Z=[]),Z.push(K));if(Z!==null)for(let K of Z)x.delete(K),b.delete(K),i.dispatchEvent({type:"planeremoved",data:K});for(let K of H.detectedPlanes)if(!x.has(K))x.add(K),b.set(K,H.lastChangedTime),i.dispatchEvent({type:"planeadded",data:K});else{let ne=b.get(K);K.lastChangedTime>ne&&(b.set(K,K.lastChangedTime),i.dispatchEvent({type:"planechanged",data:K}))}}f=null}let j=new d$;j.setAnimationLoop(Y),this.setAnimationLoop=function(J){z=J},this.dispose=function(){}}};function uEe(t,e){function i(m,g){g.color.getRGB(m.fogColor.value,h$(t)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function n(m,g,v,y,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),h(m,g)):g.isMeshPhongMaterial?(r(m,g),c(m,g)):g.isMeshStandardMaterial?(r(m,g),u(m,g),g.isMeshPhysicalMaterial&&d(m,g,x)):g.isMeshMatcapMaterial?(r(m,g),f(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),p(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&o(m,g)):g.isPointsMaterial?a(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===Tr&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===Tr&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=e.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let b=t.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function a(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function h(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function u(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===Tr&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function hEe(t,e,i,n){let r={},s={},o=[],a=i.isWebGL2?t.getParameter(35375):0;function l(y,x){let b=x.program;n.uniformBlockBinding(y,b)}function c(y,x){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",g));let S=x.program;n.updateUBOMapping(y,S);let A=e.render.frame;s[y.id]!==A&&(d(y),s[y.id]=A)}function h(y){let x=u();y.__bindingPointIndex=x;let b=t.createBuffer(),S=y.__size,A=y.usage;return t.bindBuffer(35345,b),t.bufferData(35345,S,A),t.bindBuffer(35345,null),t.bindBufferBase(35345,x,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let x=r[y.id],b=y.uniforms,S=y.__cache;t.bindBuffer(35345,x);for(let A=0,E=b.length;A<E;A++){let M=b[A];if(f(M,A,S)===!0){let T=M.__offset,P=Array.isArray(M.value)?M.value:[M.value],I=0;for(let k=0;k<P.length;k++){let R=P[k],F=m(R);typeof R=="number"?(M.__data[0]=R,t.bufferSubData(35345,T+I,M.__data)):R.isMatrix3?(M.__data[0]=R.elements[0],M.__data[1]=R.elements[1],M.__data[2]=R.elements[2],M.__data[3]=R.elements[0],M.__data[4]=R.elements[3],M.__data[5]=R.elements[4],M.__data[6]=R.elements[5],M.__data[7]=R.elements[0],M.__data[8]=R.elements[6],M.__data[9]=R.elements[7],M.__data[10]=R.elements[8],M.__data[11]=R.elements[0]):(R.toArray(M.__data,I),I+=F.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,T,M.__data)}}t.bindBuffer(35345,null)}function f(y,x,b){let S=y.value;if(b[x]===void 0){if(typeof S=="number")b[x]=S;else{let A=Array.isArray(S)?S:[S],E=[];for(let M=0;M<A.length;M++)E.push(A[M].clone());b[x]=E}return!0}else if(typeof S=="number"){if(b[x]!==S)return b[x]=S,!0}else{let A=Array.isArray(b[x])?b[x]:[b[x]],E=Array.isArray(S)?S:[S];for(let M=0;M<A.length;M++){let T=A[M];if(T.equals(E[M])===!1)return T.copy(E[M]),!0}}return!1}function p(y){let x=y.uniforms,b=0,S=16,A=0;for(let E=0,M=x.length;E<M;E++){let T=x[E],P={boundary:0,storage:0},I=Array.isArray(T.value)?T.value:[T.value];for(let k=0,R=I.length;k<R;k++){let F=I[k],V=m(F);P.boundary+=V.boundary,P.storage+=V.storage}if(T.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),T.__offset=b,E>0){A=b%S;let k=S-A;A!==0&&k-P.boundary<0&&(b+=S-A,T.__offset=b)}b+=P.storage}return A=b%S,A>0&&(b+=S-A),y.__size=b,y.__cache={},this}function m(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function g(y){let x=y.target;x.removeEventListener("dispose",g);let b=o.indexOf(x.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function v(){for(let y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:v}}function dEe(){let t=IC("canvas");return t.style.display="block",t}function y$(t={}){this.isWebGLRenderer=!0;let e=t.canvas!==void 0?t.canvas:dEe(),i=t.context!==void 0?t.context:null,n=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",c=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,h;i!==null?h=i.getContextAttributes().alpha:h=t.alpha!==void 0?t.alpha:!1;let u=null,d=null,f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Dc,this.physicallyCorrectLights=!1,this.toneMapping=ku,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,x=null,b=-1,S=null,A=new Ht,E=new Ht,M=null,T=e.width,P=e.height,I=1,k=null,R=null,F=new Ht(0,0,T,P),V=new Ht(0,0,T,P),Q=!1,X=new Tk,z=!1,Y=!1,j=null,J=new Qe,H=new ge,Z=new O,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ne(){return x===null?I:1}let W=i;function ve(N,ee){for(let he=0;he<N.length;he++){let $=N[he],fe=e.getContext($,ee);if(fe!==null)return fe}return null}try{let N={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${L0}`),e.addEventListener("webglcontextlost",Re,!1),e.addEventListener("webglcontextrestored",Ne,!1),e.addEventListener("webglcontextcreationerror",tt,!1),W===null){let ee=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&ee.shift(),W=ve(ee,N),W===null)throw ve(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}W.getShaderPrecisionFormat===void 0&&(W.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(N){throw console.error("THREE.WebGLRenderer: "+N.message),N}let de,pe,ce,ye,ae,le,Ee,Te,Be,Ue,Ie,Pe,Je,Ke,U,L,te,_e,we,Me,We,Le,ue,Ge;function re(){de=new MMe(W),pe=new xMe(W,de,t),de.init(pe),Le=new oEe(W,de,pe),ce=new rEe(W,de,pe),ye=new TMe,ae=new WCe,le=new sEe(W,de,ce,ae,pe,Le,ye),Ee=new wMe(m),Te=new AMe(m),Be=new Nbe(W,pe),ue=new vMe(W,de,Be,pe),Ue=new CMe(W,Be,ye,ue),Ie=new LMe(W,Ue,Be,ye),we=new IMe(W,pe,le),L=new _Me(ae),Pe=new jCe(m,Ee,Te,de,pe,ue,L),Je=new uEe(m,ae),Ke=new qCe,U=new $Ce(de,pe),_e=new gMe(m,Ee,Te,ce,Ie,h,o),te=new nEe(m,Ie,pe),Ge=new hEe(W,ye,pe,ce),Me=new yMe(W,de,ye,pe),We=new EMe(W,de,ye,pe),ye.programs=Pe.programs,m.capabilities=pe,m.extensions=de,m.properties=ae,m.renderLists=Ke,m.shadowMap=te,m.state=ce,m.info=ye}re();let be=new cEe(m,W);this.xr=be,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){let N=de.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){let N=de.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(N){N!==void 0&&(I=N,this.setSize(T,P,!1))},this.getSize=function(N){return N.set(T,P)},this.setSize=function(N,ee,he){if(be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}T=N,P=ee,e.width=Math.floor(N*I),e.height=Math.floor(ee*I),he!==!1&&(e.style.width=N+"px",e.style.height=ee+"px"),this.setViewport(0,0,N,ee)},this.getDrawingBufferSize=function(N){return N.set(T*I,P*I).floor()},this.setDrawingBufferSize=function(N,ee,he){T=N,P=ee,I=he,e.width=Math.floor(N*he),e.height=Math.floor(ee*he),this.setViewport(0,0,N,ee)},this.getCurrentViewport=function(N){return N.copy(A)},this.getViewport=function(N){return N.copy(F)},this.setViewport=function(N,ee,he,$){N.isVector4?F.set(N.x,N.y,N.z,N.w):F.set(N,ee,he,$),ce.viewport(A.copy(F).multiplyScalar(I).floor())},this.getScissor=function(N){return N.copy(V)},this.setScissor=function(N,ee,he,$){N.isVector4?V.set(N.x,N.y,N.z,N.w):V.set(N,ee,he,$),ce.scissor(E.copy(V).multiplyScalar(I).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(N){ce.setScissorTest(Q=N)},this.setOpaqueSort=function(N){k=N},this.setTransparentSort=function(N){R=N},this.getClearColor=function(N){return N.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor.apply(_e,arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha.apply(_e,arguments)},this.clear=function(N=!0,ee=!0,he=!0){let $=0;N&&($|=16384),ee&&($|=256),he&&($|=1024),W.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Re,!1),e.removeEventListener("webglcontextrestored",Ne,!1),e.removeEventListener("webglcontextcreationerror",tt,!1),Ke.dispose(),U.dispose(),ae.dispose(),Ee.dispose(),Te.dispose(),Ie.dispose(),ue.dispose(),Ge.dispose(),Pe.dispose(),be.dispose(),be.removeEventListener("sessionstart",Fe),be.removeEventListener("sessionend",Xe),j&&(j.dispose(),j=null),pt.stop()};function Re(N){N.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ne(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let N=ye.autoReset,ee=te.enabled,he=te.autoUpdate,$=te.needsUpdate,fe=te.type;re(),ye.autoReset=N,te.enabled=ee,te.autoUpdate=he,te.needsUpdate=$,te.type=fe}function tt(N){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function xt(N){let ee=N.target;ee.removeEventListener("dispose",xt),kt(ee)}function kt(N){q(N),ae.remove(N)}function q(N){let ee=ae.get(N).programs;ee!==void 0&&(ee.forEach(function(he){Pe.releaseProgram(he)}),N.isShaderMaterial&&Pe.releaseShaderCache(N))}this.renderBufferDirect=function(N,ee,he,$,fe,je){ee===null&&(ee=K);let $e=fe.isMesh&&fe.matrixWorld.determinant()<0,rt=Q0(N,ee,he,$,fe);ce.setMaterial($,$e);let ot=he.index,_t=1;$.wireframe===!0&&(ot=Ue.getWireframeAttribute(he),_t=2);let mt=he.drawRange,dt=he.attributes.position,si=mt.start*_t,Ti=(mt.start+mt.count)*_t;je!==null&&(si=Math.max(si,je.start*_t),Ti=Math.min(Ti,(je.start+je.count)*_t)),ot!==null?(si=Math.max(si,0),Ti=Math.min(Ti,ot.count)):dt!=null&&(si=Math.max(si,0),Ti=Math.min(Ti,dt.count));let Pn=Ti-si;if(Pn<0||Pn===1/0)return;ue.setup(fe,$,rt,he,ot);let Or,Ut=Me;if(ot!==null&&(Or=Be.get(ot),Ut=We,Ut.setIndex(Or)),fe.isMesh)$.wireframe===!0?(ce.setLineWidth($.wireframeLinewidth*ne()),Ut.setMode(1)):Ut.setMode(4);else if(fe.isLine){let at=$.linewidth;at===void 0&&(at=1),ce.setLineWidth(at*ne()),fe.isLineSegments?Ut.setMode(1):fe.isLineLoop?Ut.setMode(2):Ut.setMode(3)}else fe.isPoints?Ut.setMode(0):fe.isSprite&&Ut.setMode(4);if(fe.isInstancedMesh)Ut.renderInstances(si,Pn,fe.count);else if(he.isInstancedBufferGeometry){let at=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,Xa=Math.min(he.instanceCount,at);Ut.renderInstances(si,Pn,Xa)}else Ut.render(si,Pn)},this.compile=function(N,ee){function he($,fe,je){$.transparent===!0&&$.side===Ro&&$.forceSinglePass===!1?($.side=Tr,$.needsUpdate=!0,ki($,fe,je),$.side=Il,$.needsUpdate=!0,ki($,fe,je),$.side=Ro):ki($,fe,je)}d=U.get(N),d.init(),p.push(d),N.traverseVisible(function($){$.isLight&&$.layers.test(ee.layers)&&(d.pushLight($),$.castShadow&&d.pushShadow($))}),d.setupLights(m.physicallyCorrectLights),N.traverse(function($){let fe=$.material;if(fe)if(Array.isArray(fe))for(let je=0;je<fe.length;je++){let $e=fe[je];he($e,N,$)}else he(fe,N,$)}),p.pop(),d=null};let oe=null;function xe(N){oe&&oe(N)}function Fe(){pt.stop()}function Xe(){pt.start()}let pt=new d$;pt.setAnimationLoop(xe),typeof self<"u"&&pt.setContext(self),this.setAnimationLoop=function(N){oe=N,be.setAnimationLoop(N),N===null?pt.stop():pt.start()},be.addEventListener("sessionstart",Fe),be.addEventListener("sessionend",Xe),this.render=function(N,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),ee.parent===null&&ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),be.enabled===!0&&be.isPresenting===!0&&(be.cameraAutoUpdate===!0&&be.updateCamera(ee),ee=be.getCamera()),N.isScene===!0&&N.onBeforeRender(m,N,ee,x),d=U.get(N,p.length),d.init(),p.push(d),J.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),X.setFromProjectionMatrix(J),Y=this.localClippingEnabled,z=L.init(this.clippingPlanes,Y),u=Ke.get(N,f.length),u.init(),f.push(u),ti(N,ee,0,m.sortObjects),u.finish(),m.sortObjects===!0&&u.sort(k,R),z===!0&&L.beginShadows();let he=d.state.shadowsArray;if(te.render(he,N,ee),z===!0&&L.endShadows(),this.info.autoReset===!0&&this.info.reset(),_e.render(u,N),d.setupLights(m.physicallyCorrectLights),ee.isArrayCamera){let $=ee.cameras;for(let fe=0,je=$.length;fe<je;fe++){let $e=$[fe];ui(u,N,$e,$e.viewport)}}else ui(u,N,ee);x!==null&&(le.updateMultisampleRenderTarget(x),le.updateRenderTargetMipmap(x)),N.isScene===!0&&N.onAfterRender(m,N,ee),ue.resetDefaultState(),b=-1,S=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function ti(N,ee,he,$){if(N.visible===!1)return;if(N.layers.test(ee.layers)){if(N.isGroup)he=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(ee);else if(N.isLight)d.pushLight(N),N.castShadow&&d.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||X.intersectsSprite(N)){$&&Z.setFromMatrixPosition(N.matrixWorld).applyMatrix4(J);let je=Ie.update(N),$e=N.material;$e.visible&&u.push(N,je,$e,he,Z.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(N.isSkinnedMesh&&N.skeleton.frame!==ye.render.frame&&(N.skeleton.update(),N.skeleton.frame=ye.render.frame),!N.frustumCulled||X.intersectsObject(N))){$&&Z.setFromMatrixPosition(N.matrixWorld).applyMatrix4(J);let je=Ie.update(N),$e=N.material;if(Array.isArray($e)){let rt=je.groups;for(let ot=0,_t=rt.length;ot<_t;ot++){let mt=rt[ot],dt=$e[mt.materialIndex];dt&&dt.visible&&u.push(N,je,dt,he,Z.z,mt)}}else $e.visible&&u.push(N,je,$e,he,Z.z,null)}}let fe=N.children;for(let je=0,$e=fe.length;je<$e;je++)ti(fe[je],ee,he,$)}function ui(N,ee,he,$){let fe=N.opaque,je=N.transmissive,$e=N.transparent;d.setupLightsView(he),z===!0&&L.setGlobalState(m.clippingPlanes,he),je.length>0&&vr(fe,ee,he),$&&ce.viewport(A.copy($)),fe.length>0&&Pt(fe,ee,he),je.length>0&&Pt(je,ee,he),$e.length>0&&Pt($e,ee,he),ce.buffers.depth.setTest(!0),ce.buffers.depth.setMask(!0),ce.buffers.color.setMask(!0),ce.setPolygonOffset(!1)}function vr(N,ee,he){let $=pe.isWebGL2;j===null&&(j=new Li(1,1,{generateMipmaps:!0,type:de.has("EXT_color_buffer_half_float")?o0:fs,minFilter:s0,samples:$&&s===!0?4:0})),m.getDrawingBufferSize(H),$?j.setSize(H.x,H.y):j.setSize(DC(H.x),DC(H.y));let fe=m.getRenderTarget();m.setRenderTarget(j),m.clear();let je=m.toneMapping;m.toneMapping=ku,Pt(N,ee,he),m.toneMapping=je,le.updateMultisampleRenderTarget(j),le.updateRenderTargetMipmap(j),m.setRenderTarget(fe)}function Pt(N,ee,he){let $=ee.isScene===!0?ee.overrideMaterial:null;for(let fe=0,je=N.length;fe<je;fe++){let $e=N[fe],rt=$e.object,ot=$e.geometry,_t=$===null?$e.material:$,mt=$e.group;rt.layers.test(he.layers)&&gn(rt,ee,he,ot,_t,mt)}}function gn(N,ee,he,$,fe,je){N.onBeforeRender(m,ee,he,$,fe,je),N.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),fe.onBeforeRender(m,ee,he,$,N,je),fe.transparent===!0&&fe.side===Ro&&fe.forceSinglePass===!1?(fe.side=Tr,fe.needsUpdate=!0,m.renderBufferDirect(he,ee,$,fe,N,je),fe.side=Il,fe.needsUpdate=!0,m.renderBufferDirect(he,ee,$,fe,N,je),fe.side=Ro):m.renderBufferDirect(he,ee,$,fe,N,je),N.onAfterRender(m,ee,he,$,fe,je)}function ki(N,ee,he){ee.isScene!==!0&&(ee=K);let $=ae.get(N),fe=d.state.lights,je=d.state.shadowsArray,$e=fe.state.version,rt=Pe.getParameters(N,fe.state,je,ee,he),ot=Pe.getProgramCacheKey(rt),_t=$.programs;$.environment=N.isMeshStandardMaterial?ee.environment:null,$.fog=ee.fog,$.envMap=(N.isMeshStandardMaterial?Te:Ee).get(N.envMap||$.environment),_t===void 0&&(N.addEventListener("dispose",xt),_t=new Map,$.programs=_t);let mt=_t.get(ot);if(mt!==void 0){if($.currentProgram===mt&&$.lightsStateVersion===$e)return $d(N,rt),mt}else rt.uniforms=Pe.getUniforms(N),N.onBuild(he,rt,m),N.onBeforeCompile(rt,m),mt=Pe.acquireProgram(rt,ot),_t.set(ot,mt),$.uniforms=rt.uniforms;let dt=$.uniforms;(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(dt.clippingPlanes=L.uniform),$d(N,rt),$.needsLights=ef(N),$.lightsStateVersion=$e,$.needsLights&&(dt.ambientLightColor.value=fe.state.ambient,dt.lightProbe.value=fe.state.probe,dt.directionalLights.value=fe.state.directional,dt.directionalLightShadows.value=fe.state.directionalShadow,dt.spotLights.value=fe.state.spot,dt.spotLightShadows.value=fe.state.spotShadow,dt.rectAreaLights.value=fe.state.rectArea,dt.ltc_1.value=fe.state.rectAreaLTC1,dt.ltc_2.value=fe.state.rectAreaLTC2,dt.pointLights.value=fe.state.point,dt.pointLightShadows.value=fe.state.pointShadow,dt.hemisphereLights.value=fe.state.hemi,dt.directionalShadowMap.value=fe.state.directionalShadowMap,dt.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,dt.spotShadowMap.value=fe.state.spotShadowMap,dt.spotLightMatrix.value=fe.state.spotLightMatrix,dt.spotLightMap.value=fe.state.spotLightMap,dt.pointShadowMap.value=fe.state.pointShadowMap,dt.pointShadowMatrix.value=fe.state.pointShadowMatrix);let si=mt.getUniforms(),Ti=AM.seqWithValue(si.seq,dt);return $.currentProgram=mt,$.uniformsList=Ti,mt}function $d(N,ee){let he=ae.get(N);he.outputEncoding=ee.outputEncoding,he.instancing=ee.instancing,he.skinning=ee.skinning,he.morphTargets=ee.morphTargets,he.morphNormals=ee.morphNormals,he.morphColors=ee.morphColors,he.morphTargetsCount=ee.morphTargetsCount,he.numClippingPlanes=ee.numClippingPlanes,he.numIntersection=ee.numClipIntersection,he.vertexAlphas=ee.vertexAlphas,he.vertexTangents=ee.vertexTangents,he.toneMapping=ee.toneMapping}function Q0(N,ee,he,$,fe){ee.isScene!==!0&&(ee=K),le.resetTextureUnits();let je=ee.fog,$e=$.isMeshStandardMaterial?ee.environment:null,rt=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:Dc,ot=($.isMeshStandardMaterial?Te:Ee).get($.envMap||$e),_t=$.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,mt=!!$.normalMap&&!!he.attributes.tangent,dt=!!he.morphAttributes.position,si=!!he.morphAttributes.normal,Ti=!!he.morphAttributes.color,Pn=$.toneMapped?m.toneMapping:ku,Or=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Ut=Or!==void 0?Or.length:0,at=ae.get($),Xa=d.state.lights;if(z===!0&&(Y===!0||N!==S)){let Wt=N===S&&$.id===b;L.setState($,N,Wt)}let Xi=!1;$.version===at.__version?(at.needsLights&&at.lightsStateVersion!==Xa.state.version||at.outputEncoding!==rt||fe.isInstancedMesh&&at.instancing===!1||!fe.isInstancedMesh&&at.instancing===!0||fe.isSkinnedMesh&&at.skinning===!1||!fe.isSkinnedMesh&&at.skinning===!0||at.envMap!==ot||$.fog===!0&&at.fog!==je||at.numClippingPlanes!==void 0&&(at.numClippingPlanes!==L.numPlanes||at.numIntersection!==L.numIntersection)||at.vertexAlphas!==_t||at.vertexTangents!==mt||at.morphTargets!==dt||at.morphNormals!==si||at.morphColors!==Ti||at.toneMapping!==Pn||pe.isWebGL2===!0&&at.morphTargetsCount!==Ut)&&(Xi=!0):(Xi=!0,at.__version=$.version);let Fr=at.currentProgram;Xi===!0&&(Fr=ki($,ee,fe));let Uc=!1,yr=!1,Yr=!1,bt=Fr.getUniforms(),Kt=at.uniforms;if(ce.useProgram(Fr.program)&&(Uc=!0,yr=!0,Yr=!0),$.id!==b&&(b=$.id,yr=!0),Uc||S!==N){if(bt.setValue(W,"projectionMatrix",N.projectionMatrix),pe.logarithmicDepthBuffer&&bt.setValue(W,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),S!==N&&(S=N,yr=!0,Yr=!0),$.isShaderMaterial||$.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshStandardMaterial||$.envMap){let Wt=bt.map.cameraPosition;Wt!==void 0&&Wt.setValue(W,Z.setFromMatrixPosition(N.matrixWorld))}($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&bt.setValue(W,"isOrthographic",N.isOrthographicCamera===!0),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial||$.isShadowMaterial||fe.isSkinnedMesh)&&bt.setValue(W,"viewMatrix",N.matrixWorldInverse)}if(fe.isSkinnedMesh){bt.setOptional(W,fe,"bindMatrix"),bt.setOptional(W,fe,"bindMatrixInverse");let Wt=fe.skeleton;Wt&&(pe.floatVertexTextures?(Wt.boneTexture===null&&Wt.computeBoneTexture(),bt.setValue(W,"boneTexture",Wt.boneTexture,le),bt.setValue(W,"boneTextureSize",Wt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let Qr=he.morphAttributes;if((Qr.position!==void 0||Qr.normal!==void 0||Qr.color!==void 0&&pe.isWebGL2===!0)&&we.update(fe,he,$,Fr),(yr||at.receiveShadow!==fe.receiveShadow)&&(at.receiveShadow=fe.receiveShadow,bt.setValue(W,"receiveShadow",fe.receiveShadow)),$.isMeshGouraudMaterial&&$.envMap!==null&&(Kt.envMap.value=ot,Kt.flipEnvMap.value=ot.isCubeTexture&&ot.isRenderTargetTexture===!1?-1:1),yr&&(bt.setValue(W,"toneMappingExposure",m.toneMappingExposure),at.needsLights&&dm(Kt,Yr),je&&$.fog===!0&&Je.refreshFogUniforms(Kt,je),Je.refreshMaterialUniforms(Kt,$,I,P,j),AM.upload(W,at.uniformsList,Kt,le)),$.isShaderMaterial&&$.uniformsNeedUpdate===!0&&(AM.upload(W,at.uniformsList,Kt,le),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&bt.setValue(W,"center",fe.center),bt.setValue(W,"modelViewMatrix",fe.modelViewMatrix),bt.setValue(W,"normalMatrix",fe.normalMatrix),bt.setValue(W,"modelMatrix",fe.matrixWorld),fe.previousModelViewMatrix&&bt.setValue(W,"previousModelViewMatrix",fe.previousModelViewMatrix),N.previousProjectionMatrix&&bt.setValue(W,"previousProjectionMatrix",N.previousProjectionMatrix),$.isShaderMaterial||$.isRawShaderMaterial){let Wt=$.uniformsGroups;for(let vn=0,qa=Wt.length;vn<qa;vn++)if(pe.isWebGL2){let Ko=Wt[vn];Ge.update(Ko,Fr),Ge.bind(Ko,Fr)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Fr}function dm(N,ee){N.ambientLightColor.needsUpdate=ee,N.lightProbe.needsUpdate=ee,N.directionalLights.needsUpdate=ee,N.directionalLightShadows.needsUpdate=ee,N.pointLights.needsUpdate=ee,N.pointLightShadows.needsUpdate=ee,N.spotLights.needsUpdate=ee,N.spotLightShadows.needsUpdate=ee,N.rectAreaLights.needsUpdate=ee,N.hemisphereLights.needsUpdate=ee}function ef(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(N,ee,he){ae.get(N.texture).__webglTexture=ee,ae.get(N.depthTexture).__webglTexture=he;let $=ae.get(N);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=he===void 0,$.__autoAllocateDepthBuffer||de.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(N,ee){let he=ae.get(N);he.__webglFramebuffer=ee,he.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(N,ee=0,he=0){x=N,v=ee,y=he;let $=!0,fe=null,je=!1,$e=!1;if(N){let rt=ae.get(N);rt.__useDefaultFramebuffer!==void 0?(ce.bindFramebuffer(36160,null),$=!1):rt.__webglFramebuffer===void 0?le.setupRenderTarget(N):rt.__hasExternalTextures&&le.rebindTextures(N,ae.get(N.texture).__webglTexture,ae.get(N.depthTexture).__webglTexture);let ot=N.texture;(ot.isData3DTexture||ot.isDataArrayTexture||ot.isCompressedArrayTexture)&&($e=!0);let _t=ae.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(fe=_t[ee],je=!0):pe.isWebGL2&&N.samples>0&&le.useMultisampledRTT(N)===!1?fe=ae.get(N).__webglMultisampledFramebuffer:fe=_t,A.copy(N.viewport),E.copy(N.scissor),M=N.scissorTest}else A.copy(F).multiplyScalar(I).floor(),E.copy(V).multiplyScalar(I).floor(),M=Q;if(ce.bindFramebuffer(36160,fe)&&pe.drawBuffers&&$&&ce.drawBuffers(N,fe),ce.viewport(A),ce.scissor(E),ce.setScissorTest(M),je){let rt=ae.get(N.texture);W.framebufferTexture2D(36160,36064,34069+ee,rt.__webglTexture,he)}else if($e){let rt=ae.get(N.texture),ot=ee||0;W.framebufferTextureLayer(36160,36064,rt.__webglTexture,he||0,ot)}b=-1},this.readRenderTargetPixels=function(N,ee,he,$,fe,je,$e){if(!(N&&N.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let rt=ae.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&$e!==void 0&&(rt=rt[$e]),rt){ce.bindFramebuffer(36160,rt);try{let ot=N.texture,_t=ot.format,mt=ot.type;if(_t!==Ea&&Le.convert(_t)!==W.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let dt=mt===o0&&(de.has("EXT_color_buffer_half_float")||pe.isWebGL2&&de.has("EXT_color_buffer_float"));if(mt!==fs&&Le.convert(mt)!==W.getParameter(35738)&&!(mt===Oo&&(pe.isWebGL2||de.has("OES_texture_float")||de.has("WEBGL_color_buffer_float")))&&!dt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=N.width-$&&he>=0&&he<=N.height-fe&&W.readPixels(ee,he,$,fe,Le.convert(_t),Le.convert(mt),je)}finally{let ot=x!==null?ae.get(x).__webglFramebuffer:null;ce.bindFramebuffer(36160,ot)}}},this.copyFramebufferToTexture=function(N,ee,he=0){let $=Math.pow(2,-he),fe=Math.floor(ee.image.width*$),je=Math.floor(ee.image.height*$);le.setTexture2D(ee,0),W.copyTexSubImage2D(3553,he,0,0,N.x,N.y,fe,je),ce.unbindTexture()},this.copyTextureToTexture=function(N,ee,he,$=0){let fe=ee.image.width,je=ee.image.height,$e=Le.convert(he.format),rt=Le.convert(he.type);le.setTexture2D(he,0),W.pixelStorei(37440,he.flipY),W.pixelStorei(37441,he.premultiplyAlpha),W.pixelStorei(3317,he.unpackAlignment),ee.isDataTexture?W.texSubImage2D(3553,$,N.x,N.y,fe,je,$e,rt,ee.image.data):ee.isCompressedTexture?W.compressedTexSubImage2D(3553,$,N.x,N.y,ee.mipmaps[0].width,ee.mipmaps[0].height,$e,ee.mipmaps[0].data):W.texSubImage2D(3553,$,N.x,N.y,$e,rt,ee.image),$===0&&he.generateMipmaps&&W.generateMipmap(3553),ce.unbindTexture()},this.copyTextureToTexture3D=function(N,ee,he,$,fe=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let je=N.max.x-N.min.x+1,$e=N.max.y-N.min.y+1,rt=N.max.z-N.min.z+1,ot=Le.convert($.format),_t=Le.convert($.type),mt;if($.isData3DTexture)le.setTexture3D($,0),mt=32879;else if($.isDataArrayTexture)le.setTexture2DArray($,0),mt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(37440,$.flipY),W.pixelStorei(37441,$.premultiplyAlpha),W.pixelStorei(3317,$.unpackAlignment);let dt=W.getParameter(3314),si=W.getParameter(32878),Ti=W.getParameter(3316),Pn=W.getParameter(3315),Or=W.getParameter(32877),Ut=he.isCompressedTexture?he.mipmaps[0]:he.image;W.pixelStorei(3314,Ut.width),W.pixelStorei(32878,Ut.height),W.pixelStorei(3316,N.min.x),W.pixelStorei(3315,N.min.y),W.pixelStorei(32877,N.min.z),he.isDataTexture||he.isData3DTexture?W.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,_t,Ut.data):he.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),W.compressedTexSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,Ut.data)):W.texSubImage3D(mt,fe,ee.x,ee.y,ee.z,je,$e,rt,ot,_t,Ut),W.pixelStorei(3314,dt),W.pixelStorei(32878,si),W.pixelStorei(3316,Ti),W.pixelStorei(3315,Pn),W.pixelStorei(32877,Or),fe===0&&$.generateMipmaps&&W.generateMipmap(mt),ce.unbindTexture()},this.initTexture=function(N){N.isCubeTexture?le.setTextureCube(N,0):N.isData3DTexture?le.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?le.setTexture2DArray(N,0):le.setTexture2D(N,0),ce.unbindTexture()},this.resetState=function(){v=0,y=0,x=null,ce.reset(),ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var fEe=class extends y${};fEe.prototype.isWebGL1Renderer=!0;var x$=class{constructor(t,e=1,i=1e3){this.isFog=!0,this.name="",this.color=new Tt(t),this.near=e,this.far=i}clone(){return new x$(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},xd=class extends Ri{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}},pEe=class{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=tR,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Fa()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,i){t*=this.stride,i*=e.stride;for(let n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fa()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fa()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},xs=new O,sR=class{constructor(t,e,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,i=this.data.count;e<i;e++)xs.fromBufferAttribute(this,e),xs.applyMatrix4(t),this.setXYZ(e,xs.x,xs.y,xs.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)xs.fromBufferAttribute(this,e),xs.applyNormalMatrix(t),this.setXYZ(e,xs.x,xs.y,xs.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)xs.fromBufferAttribute(this,e),xs.transformDirection(t),this.setXYZ(e,xs.x,xs.y,xs.z);return this}setX(t,e){return this.normalized&&(e=Vi(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=Vi(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=Vi(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=Vi(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Lu(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Lu(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Lu(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Lu(e,this.array)),e}setXY(t,e,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this}setXYZ(t,e,i,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array),n=Vi(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=Vi(e,this.array),i=Vi(i,this.array),n=Vi(n,this.array),r=Vi(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[n+r])}return new Ot(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new sR(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},_$=class extends Ri{constructor(){super(),this.isBone=!0,this.type="Bone"}},LC=class extends ur{constructor(t=null,e=1,i=1,n,r,s,o,a,l=ji,c=ji,h,u){super(null,s,o,a,l,c,n,r,h,u),this.isDataTexture=!0,this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Aj=new Qe,mEe=new Qe,Ik=class{constructor(t=[],e=[]){this.uuid=Fa(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),e.length===0)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Qe)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){let i=new Qe;this.bones[t]&&i.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&i.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,s=t.length;r<s;r++){let o=t[r]?t[r].matrixWorld:mEe;Aj.multiplyMatrices(o,e[r]),Aj.toArray(i,r*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new Ik(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=r$(t),t=Math.max(t,4);let e=new Float32Array(t*t*4);e.set(this.boneMatrices);let i=new LC(e,t,t,Ea,Oo);return i.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=i,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,i=this.bones.length;e<i;e++){let n=this.bones[e];if(n.name===t)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let i=0,n=t.bones.length;i<n;i++){let r=t.bones[i],s=e[r];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),s=new _$),this.bones.push(s),this.boneInverses.push(new Qe().fromArray(t.boneInverses[i]))}return this.init(),this}toJSON(){let t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;let e=this.bones,i=this.boneInverses;for(let n=0,r=e.length;n<r;n++){let s=e[n];t.bones.push(s.uuid);let o=i[n];t.boneInverses.push(o.toArray())}return t}},gEe=class extends Ot{constructor(t,e,i,n=1){super(t,e,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},Jd=class extends mw{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Tt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},Mj=new O,Cj=new O,Ej=new Qe,d3=new B0,ZS=new qo,BC=class extends Ri{constructor(t=new Rt,e=new Jd){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[0];for(let n=1,r=e.count;n<r;n++)Mj.fromBufferAttribute(e,n-1),Cj.fromBufferAttribute(e,n),i[n]=i[n-1],i[n]+=Mj.distanceTo(Cj);t.setAttribute("lineDistance",new gt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let i=this.geometry,n=this.matrixWorld,r=t.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ZS.copy(i.boundingSphere),ZS.applyMatrix4(n),ZS.radius+=r,t.ray.intersectsSphere(ZS)===!1)return;Ej.copy(n).invert(),d3.copy(t.ray).applyMatrix4(Ej);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new O,c=new O,h=new O,u=new O,d=this.isLineSegments?2:1,f=i.index,p=i.attributes.position;if(f!==null){let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){let x=f.getX(v),b=f.getX(v+1);if(l.fromBufferAttribute(p,x),c.fromBufferAttribute(p,b),d3.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let S=t.ray.origin.distanceTo(u);S<t.near||S>t.far||e.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){if(l.fromBufferAttribute(p,v),c.fromBufferAttribute(p,v+1),d3.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let x=t.ray.origin.distanceTo(u);x<t.near||x>t.far||e.push({distance:x,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}},Tj=new O,Pj=new O,vw=class extends BC{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[];for(let n=0,r=e.count;n<r;n+=2)Tj.fromBufferAttribute(e,n),Pj.fromBufferAttribute(e,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+Tj.distanceTo(Pj);t.setAttribute("lineDistance",new gt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},vEe=class extends ur{constructor(t,e,i,n,r,s,o,a,l){super(t,e,i,n,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Zt,this.magFilter=r!==void 0?r:Zt,this.generateMipmaps=!1;let c=this;function h(){c.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},Nc=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],i,n=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)i=this.getPoint(s/t),r+=i.distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let i=this.getLengths(),n=0,r=i.length,s;e?s=e:s=t*i[r-1];let o=0,a=r-1,l;for(;o<=a;)if(n=Math.floor(o+(a-o)/2),l=i[n]-s,l<0)o=n+1;else if(l>0)a=n-1;else{a=n;break}if(n=a,i[n]===s)return n/(r-1);let c=i[n],h=i[n+1]-c,u=(s-c)/h;return(n+u)/(r-1)}getTangent(t,e){let i=t-1e-4,n=t+1e-4;i<0&&(i=0),n>1&&(n=1);let r=this.getPoint(i),s=this.getPoint(n),o=e||(r.isVector2?new ge:new O);return o.copy(s).sub(r).normalize(),o}getTangentAt(t,e){let i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e){let i=new O,n=[],r=[],s=[],o=new O,a=new Qe;for(let d=0;d<=t;d++){let f=d/t;n[d]=this.getTangentAt(f,new O)}r[0]=new O,s[0]=new O;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),h=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(n[d-1],n[d]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(ar(n[d-1].dot(n[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,f))}s[d].crossVectors(n[d],r[d])}if(e===!0){let d=Math.acos(ar(r[0].dot(r[t]),-1,1));d/=t,n[0].dot(o.crossVectors(r[0],r[t]))>0&&(d=-d);for(let f=1;f<=t;f++)r[f].applyMatrix4(a.makeRotationAxis(n[f],d*f)),s[f].crossVectors(n[f],r[f])}return{tangents:n,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},vT=class extends Nc{constructor(t=0,e=0,i=1,n=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){let i=e||new ge,n=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(s?r=0:r=n),this.aClockwise===!0&&!s&&(r===n?r=-n:r=r-n);let o=this.aStartAngle+t*r,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=a-this.aX,d=l-this.aY;a=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},yEe=class extends vT{constructor(t,e,i,n,r,s){super(t,e,i,i,n,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function Lk(){let t=0,e=0,i=0,n=0;function r(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){let o=s*s,a=o*s;return t+e*s+i*o+n*a}}}var $S=new O,f3=new Lk,p3=new Lk,m3=new Lk,xEe=class extends Nc{constructor(t=[],e=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}getPoint(t,e=new O){let i=e,n=this.points,r=n.length,s=(r-(this.closed?0:1))*t,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let l,c;this.closed||o>0?l=n[(o-1)%r]:($S.subVectors(n[0],n[1]).add(n[0]),l=$S);let h=n[o%r],u=n[(o+1)%r];if(this.closed||o+2<r?c=n[(o+2)%r]:($S.subVectors(n[r-1],n[r-2]).add(n[r-1]),c=$S),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(u),d),m=Math.pow(u.distanceToSquared(c),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),f3.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,f,p,m),p3.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,f,p,m),m3.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,f,p,m)}else this.curveType==="catmullrom"&&(f3.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),p3.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),m3.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return i.set(f3.calc(a),p3.calc(a),m3.calc(a)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(new O().fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function Dj(t,e,i,n,r){let s=(n-e)*.5,o=(r-i)*.5,a=t*t,l=t*a;return(2*i-2*n+s+o)*l+(-3*i+3*n-2*s-o)*a+s*t+i}function _Ee(t,e){let i=1-t;return i*i*e}function wEe(t,e){return 2*(1-t)*t*e}function bEe(t,e){return t*t*e}function u1(t,e,i,n){return _Ee(t,e)+wEe(t,i)+bEe(t,n)}function SEe(t,e){let i=1-t;return i*i*i*e}function AEe(t,e){let i=1-t;return 3*i*i*t*e}function MEe(t,e){return 3*(1-t)*t*t*e}function CEe(t,e){return t*t*t*e}function h1(t,e,i,n,r){return SEe(t,e)+AEe(t,i)+MEe(t,n)+CEe(t,r)}var gl=class extends Nc{constructor(e=new ge,i=new ge,n=new ge,r=new ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=n,this.v3=r}getPoint(e,i=new ge){let n=i,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(h1(e,r.x,s.x,o.x,a.x),h1(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},MM=class extends Nc{constructor(t=new O,e=new O,i=new O,n=new O){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new O){let i=e,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(h1(t,n.x,r.x,s.x,o.x),h1(t,n.y,r.y,s.y,o.y),h1(t,n.z,r.z,s.z,o.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Cl=class extends Nc{constructor(e=new ge,i=new ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new ge){let n=i;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i){let n=i||new ge;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},w$=class extends Nc{constructor(t=new O,e=new O){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new O){let i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Nd=class extends Nc{constructor(t=new ge,e=new ge,i=new ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new ge){let i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(u1(t,n.x,r.x,s.x),u1(t,n.y,r.y,s.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},EEe=class extends Nc{constructor(t=new O,e=new O,i=new O){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new O){let i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(u1(t,n.x,r.x,s.x),u1(t,n.y,r.y,s.y),u1(t,n.z,r.z,s.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Bk=class extends Nc{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new ge){let i=e,n=this.points,r=(n.length-1)*t,s=Math.floor(r),o=r-s,a=n[s===0?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return i.set(Dj(o,a.x,l.x,c.x,h.x),Dj(o,a.y,l.y,c.y,h.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(n.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let n=t.points[e];this.points.push(new ge().fromArray(n))}return this}},TEe=Object.freeze({__proto__:null,ArcCurve:yEe,CatmullRomCurve3:xEe,CubicBezierCurve:gl,CubicBezierCurve3:MM,EllipseCurve:vT,LineCurve:Cl,LineCurve3:w$,QuadraticBezierCurve:Nd,QuadraticBezierCurve3:EEe,SplineCurve:Bk}),b$=class extends Nc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Cl(e,t))}getPoint(t,e){let i=t*this.getLength(),n=this.getCurveLengths(),r=0;for(;r<n.length;){if(n[r]>=i){let s=n[r]-i,o=this.curves[r],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,e)}r++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],i;for(let n=0,r=this.curves;n<r.length;n++){let s=r[n],o=s.isEllipseCurve?t*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let l=0;l<a.length;l++){let c=a[l];i&&i.equals(c)||(e.push(c),i=c)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){let n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let n=t.curves[e];this.curves.push(new TEe[n.type]().fromJSON(n))}return this}},RC=class extends b${constructor(t){super(),this.type="Path",this.currentPoint=new ge,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let i=new Cl(this.currentPoint.clone(),new ge(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,n){let r=new Nd(this.currentPoint.clone(),new ge(t,e),new ge(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(t,e,i,n,r,s){let o=new gl(this.currentPoint.clone(),new ge(t,e),new ge(i,n),new ge(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),i=new Bk(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,n,r,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,i,n,r,s),this}absarc(t,e,i,n,r,s){return this.absellipse(t,e,i,i,n,r,s),this}ellipse(t,e,i,n,r,s,o,a){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,i,n,r,s,o,a),this}absellipse(t,e,i,n,r,s,o,a){let l=new vT(t,e,i,n,r,s,o,a);if(this.curves.length>0){let h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},S$=class extends Rt{constructor(t=[new ge(0,-.5),new ge(.5,0),new ge(0,.5)],e=12,i=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e),n=ar(n,0,Math.PI*2);let r=[],s=[],o=[],a=[],l=[],c=1/e,h=new O,u=new ge,d=new O,f=new O,p=new O,m=0,g=0;for(let v=0;v<=t.length-1;v++)switch(v){case 0:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(p.x,p.y,p.z);break;default:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=e;v++){let y=i+v*c*n,x=Math.sin(y),b=Math.cos(y);for(let S=0;S<=t.length-1;S++){h.x=t[S].x*x,h.y=t[S].y,h.z=t[S].x*b,s.push(h.x,h.y,h.z),u.x=v/e,u.y=S/(t.length-1),o.push(u.x,u.y);let A=a[3*S+0]*x,E=a[3*S+1],M=a[3*S+0]*b;l.push(A,E,M)}}for(let v=0;v<e;v++)for(let y=0;y<t.length-1;y++){let x=y+v*t.length,b=x,S=x+t.length,A=x+t.length+1,E=x+1;r.push(b,S,E),r.push(A,E,S)}this.setIndex(r),this.setAttribute("position",new gt(s,3)),this.setAttribute("uv",new gt(o,2)),this.setAttribute("normal",new gt(l,3))}static fromJSON(t){return new S$(t.points,t.segments,t.phiStart,t.phiLength)}},Rk=class extends Rt{constructor(t=1,e=1,i=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};let l=this;n=Math.floor(n),r=Math.floor(r);let c=[],h=[],u=[],d=[],f=0,p=[],m=i/2,g=0;v(),s===!1&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new gt(h,3)),this.setAttribute("normal",new gt(u,3)),this.setAttribute("uv",new gt(d,2));function v(){let x=new O,b=new O,S=0,A=(e-t)/i;for(let E=0;E<=r;E++){let M=[],T=E/r,P=T*(e-t)+t;for(let I=0;I<=n;I++){let k=I/n,R=k*a+o,F=Math.sin(R),V=Math.cos(R);b.x=P*F,b.y=-T*i+m,b.z=P*V,h.push(b.x,b.y,b.z),x.set(F,A,V).normalize(),u.push(x.x,x.y,x.z),d.push(k,1-T),M.push(f++)}p.push(M)}for(let E=0;E<n;E++)for(let M=0;M<r;M++){let T=p[M][E],P=p[M+1][E],I=p[M+1][E+1],k=p[M][E+1];c.push(T,P,k),c.push(P,I,k),S+=6}l.addGroup(g,S,0),g+=S}function y(x){let b=f,S=new ge,A=new O,E=0,M=x===!0?t:e,T=x===!0?1:-1;for(let I=1;I<=n;I++)h.push(0,m*T,0),u.push(0,T,0),d.push(.5,.5),f++;let P=f;for(let I=0;I<=n;I++){let k=I/n*a+o,R=Math.cos(k),F=Math.sin(k);A.x=M*F,A.y=m*T,A.z=M*R,h.push(A.x,A.y,A.z),u.push(0,T,0),S.x=R*.5+.5,S.y=F*.5*T+.5,d.push(S.x,S.y),f++}for(let I=0;I<n;I++){let k=b+I,R=P+I;x===!0?c.push(R,R+1,k):c.push(R+1,R,k),E+=3}l.addGroup(g,E,x===!0?1:2),g+=E}}static fromJSON(t){return new Rk(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},A$=class extends Rk{constructor(t=1,e=1,i=32,n=1,r=!1,s=0,o=Math.PI*2){super(0,t,e,i,n,r,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(t){return new A$(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},Ok=class extends Rt{constructor(t=[],e=[],i=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n};let r=[],s=[];o(n),l(i),c(),this.setAttribute("position",new gt(r,3)),this.setAttribute("normal",new gt(r.slice(),3)),this.setAttribute("uv",new gt(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function o(v){let y=new O,x=new O,b=new O;for(let S=0;S<e.length;S+=3)d(e[S+0],y),d(e[S+1],x),d(e[S+2],b),a(y,x,b,v)}function a(v,y,x,b){let S=b+1,A=[];for(let E=0;E<=S;E++){A[E]=[];let M=v.clone().lerp(x,E/S),T=y.clone().lerp(x,E/S),P=S-E;for(let I=0;I<=P;I++)I===0&&E===S?A[E][I]=M:A[E][I]=M.clone().lerp(T,I/P)}for(let E=0;E<S;E++)for(let M=0;M<2*(S-E)-1;M++){let T=Math.floor(M/2);M%2===0?(u(A[E][T+1]),u(A[E+1][T]),u(A[E][T])):(u(A[E][T+1]),u(A[E+1][T+1]),u(A[E+1][T]))}}function l(v){let y=new O;for(let x=0;x<r.length;x+=3)y.x=r[x+0],y.y=r[x+1],y.z=r[x+2],y.normalize().multiplyScalar(v),r[x+0]=y.x,r[x+1]=y.y,r[x+2]=y.z}function c(){let v=new O;for(let y=0;y<r.length;y+=3){v.x=r[y+0],v.y=r[y+1],v.z=r[y+2];let x=m(v)/2/Math.PI+.5,b=g(v)/Math.PI+.5;s.push(x,1-b)}f(),h()}function h(){for(let v=0;v<s.length;v+=6){let y=s[v+0],x=s[v+2],b=s[v+4],S=Math.max(y,x,b),A=Math.min(y,x,b);S>.9&&A<.1&&(y<.2&&(s[v+0]+=1),x<.2&&(s[v+2]+=1),b<.2&&(s[v+4]+=1))}}function u(v){r.push(v.x,v.y,v.z)}function d(v,y){let x=v*3;y.x=t[x+0],y.y=t[x+1],y.z=t[x+2]}function f(){let v=new O,y=new O,x=new O,b=new O,S=new ge,A=new ge,E=new ge;for(let M=0,T=0;M<r.length;M+=9,T+=6){v.set(r[M+0],r[M+1],r[M+2]),y.set(r[M+3],r[M+4],r[M+5]),x.set(r[M+6],r[M+7],r[M+8]),S.set(s[T+0],s[T+1]),A.set(s[T+2],s[T+3]),E.set(s[T+4],s[T+5]),b.copy(v).add(y).add(x).divideScalar(3);let P=m(b);p(S,T+0,v,P),p(A,T+2,y,P),p(E,T+4,x,P)}}function p(v,y,x,b){b<0&&v.x===1&&(s[y]=v.x-1),x.x===0&&x.z===0&&(s[y]=b/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(t){return new Ok(t.vertices,t.indices,t.radius,t.details)}},M$=class extends Ok{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new M$(t.radius,t.detail)}},OC=class extends RC{constructor(t){super(t),this.uuid=Fa(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){let n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let n=t.holes[e];this.holes.push(new RC().fromJSON(n))}return this}},PEe={triangulate:function(t,e,i=2){let n=e&&e.length,r=n?e[0]*i:t.length,s=C$(t,0,r,i,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(n&&(s=REe(t,e,s,i)),t.length>80*i){a=c=t[0],l=h=t[1];for(let p=i;p<r;p+=i)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return p_(s,o,i,a,l,f,0),o}};function C$(t,e,i,n,r){let s,o;if(r===WEe(t,e,i,n)>0)for(s=e;s<i;s+=n)o=Ij(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=Ij(s,t[s],t[s+1],o);return o&&yT(o,o.next)&&(g_(o),o=o.next),o}function qp(t,e){if(!t)return t;e||(e=t);let i=t,n;do if(n=!1,!i.steiner&&(yT(i,i.next)||fn(i.prev,i,i.next)===0)){if(g_(i),i=e=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==e);return e}function p_(t,e,i,n,r,s,o){if(!t)return;!o&&s&&zEe(t,n,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?IEe(t,n,r,s):DEe(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(c.i/i|0),g_(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=LEe(qp(t),e,i),p_(t,e,i,n,r,s,2)):o===2&&BEe(t,e,i,n,r,s):p_(qp(t),e,i,n,r,s,1);break}}}function DEe(t){let e=t.prev,i=t,n=t.next;if(fn(e,i,n)>=0)return!1;let r=e.x,s=i.x,o=n.x,a=e.y,l=i.y,c=n.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=n.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&nv(r,a,s,l,o,c,p.x,p.y)&&fn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function IEe(t,e,i,n){let r=t.prev,s=t,o=t.next;if(fn(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,m=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,v=oR(f,p,e,i,n),y=oR(m,g,e,i,n),x=t.prevZ,b=t.nextZ;for(;x&&x.z>=v&&b&&b.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&nv(a,h,l,u,c,d,x.x,x.y)&&fn(x.prev,x,x.next)>=0||(x=x.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&nv(a,h,l,u,c,d,b.x,b.y)&&fn(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&nv(a,h,l,u,c,d,x.x,x.y)&&fn(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&nv(a,h,l,u,c,d,b.x,b.y)&&fn(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function LEe(t,e,i){let n=t;do{let r=n.prev,s=n.next.next;!yT(r,s)&&E$(r,n,n.next,s)&&m_(r,s)&&m_(s,r)&&(e.push(r.i/i|0),e.push(n.i/i|0),e.push(s.i/i|0),g_(n),g_(n.next),n=t=s),n=n.next}while(n!==t);return qp(n)}function BEe(t,e,i,n,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&VEe(o,a)){let l=T$(o,a);o=qp(o,o.next),l=qp(l,l.next),p_(o,e,i,n,r,s,0),p_(l,e,i,n,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function REe(t,e,i,n){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*n,l=s<o-1?e[s+1]*n:t.length,c=C$(t,a,l,n,!1),c===c.next&&(c.steiner=!0),r.push(GEe(c));for(r.sort(OEe),s=0;s<r.length;s++)i=FEe(r[s],i);return i}function OEe(t,e){return t.x-e.x}function FEe(t,e){let i=NEe(t,e);if(!i)return e;let n=T$(i,t);return qp(n,n.next),qp(i,i.next)}function NEe(t,e){let i=e,n=-1/0,r,s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){let d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==e);if(!r)return null;let a=r,l=r.x,c=r.y,h=1/0,u;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&nv(o<c?s:n,o,l,c,o<c?n:s,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(s-i.x),m_(i,t)&&(u<h||u===h&&(i.x>r.x||i.x===r.x&&kEe(r,i)))&&(r=i,h=u)),i=i.next;while(i!==a);return r}function kEe(t,e){return fn(t.prev,t,e.prev)<0&&fn(e.next,t,t.next)<0}function zEe(t,e,i,n){let r=t;do r.z===0&&(r.z=oR(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,UEe(r)}function UEe(t){let e,i,n,r,s,o,a,l,c=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<c&&(a++,n=n.nextZ,!!n);e++);for(l=c;a>0||l>0&&n;)a!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(o>1);return t}function oR(t,e,i,n,r){return t=(t-i)*r|0,e=(e-n)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function GEe(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function nv(t,e,i,n,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(n-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(r-o)*(n-a)}function VEe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!HEe(t,e)&&(m_(t,e)&&m_(e,t)&&jEe(t,e)&&(fn(t.prev,t,e.prev)||fn(t,e.prev,e))||yT(t,e)&&fn(t.prev,t,t.next)>0&&fn(e.prev,e,e.next)>0)}function fn(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function yT(t,e){return t.x===e.x&&t.y===e.y}function E$(t,e,i,n){let r=tA(fn(t,e,i)),s=tA(fn(t,e,n)),o=tA(fn(i,n,t)),a=tA(fn(i,n,e));return!!(r!==s&&o!==a||r===0&&eA(t,i,e)||s===0&&eA(t,n,e)||o===0&&eA(i,t,n)||a===0&&eA(i,e,n))}function eA(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function tA(t){return t>0?1:t<0?-1:0}function HEe(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&E$(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function m_(t,e){return fn(t.prev,t,t.next)<0?fn(t,e,t.next)>=0&&fn(t,t.prev,e)>=0:fn(t,e,t.prev)<0||fn(t,t.next,e)<0}function jEe(t,e){let i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function T$(t,e){let i=new aR(t.i,t.x,t.y),n=new aR(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Ij(t,e,i,n){let r=new aR(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function g_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function aR(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function WEe(t,e,i,n){let r=0;for(let s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}var P$=class{static area(t){let e=t.length,i=0;for(let n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return i*.5}static isClockWise(t){return P$.area(t)<0}static triangulateShape(t,e){let i=[],n=[],r=[];Lj(t),Bj(i,t);let s=t.length;e.forEach(Lj);for(let a=0;a<e.length;a++)n.push(s),s+=e[a].length,Bj(i,e[a]);let o=PEe.triangulate(i,n);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function Lj(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Bj(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}var D$=class extends Ok{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,r,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new D$(t.radius,t.detail)}},Fk=class extends Rt{constructor(t=1,e=32,i=16,n=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));let a=Math.min(s+o,Math.PI),l=0,c=[],h=new O,u=new O,d=[],f=[],p=[],m=[];for(let g=0;g<=i;g++){let v=[],y=g/i,x=0;g==0&&s==0?x=.5/e:g==i&&a==Math.PI&&(x=-.5/e);for(let b=0;b<=e;b++){let S=b/e;h.x=-t*Math.cos(n+S*r)*Math.sin(s+y*o),h.y=t*Math.cos(s+y*o),h.z=t*Math.sin(n+S*r)*Math.sin(s+y*o),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),m.push(S+x,1-y),v.push(l++)}c.push(v)}for(let g=0;g<i;g++)for(let v=0;v<e;v++){let y=c[g][v+1],x=c[g][v],b=c[g+1][v],S=c[g+1][v+1];(g!==0||s>0)&&d.push(y,x,S),(g!==i-1||a<Math.PI)&&d.push(x,b,S)}this.setIndex(d),this.setAttribute("position",new gt(f,3)),this.setAttribute("normal",new gt(p,3)),this.setAttribute("uv",new gt(m,2))}static fromJSON(t){return new Fk(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},I$=class extends Rt{constructor(t=1,e=.4,i=64,n=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:s},i=Math.floor(i),n=Math.floor(n);let o=[],a=[],l=[],c=[],h=new O,u=new O,d=new O,f=new O,p=new O,m=new O,g=new O;for(let y=0;y<=i;++y){let x=y/i*r*Math.PI*2;v(x,r,s,t,d),v(x+.01,r,s,t,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let b=0;b<=n;++b){let S=b/n*Math.PI*2,A=-e*Math.cos(S),E=e*Math.sin(S);h.x=d.x+(A*g.x+E*p.x),h.y=d.y+(A*g.y+E*p.y),h.z=d.z+(A*g.z+E*p.z),a.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/i),c.push(b/n)}}for(let y=1;y<=i;y++)for(let x=1;x<=n;x++){let b=(n+1)*(y-1)+(x-1),S=(n+1)*y+(x-1),A=(n+1)*y+x,E=(n+1)*(y-1)+x;o.push(b,S,E),o.push(S,A,E)}this.setIndex(o),this.setAttribute("position",new gt(a,3)),this.setAttribute("normal",new gt(l,3)),this.setAttribute("uv",new gt(c,2));function v(y,x,b,S,A){let E=Math.cos(y),M=Math.sin(y),T=b/x*y,P=Math.cos(T);A.x=S*(2+P)*.5*E,A.y=S*(2+P)*M*.5,A.z=S*Math.sin(T)*.5}}static fromJSON(t){return new I$(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}};function Sh(t,e,i){return L$(t)?new t.constructor(t.subarray(e,i!==void 0?i:t.length)):t.slice(e,i)}function iA(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function L$(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function XEe(t){function e(r,s){return t[r]-t[s]}let i=t.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(e),n}function Rj(t,e,i){let n=t.length,r=new t.constructor(n);for(let s=0,o=0;o!==n;++s){let a=i[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function B$(t,e,i,n){let r=1,s=t[0];for(;s!==void 0&&s[n]===void 0;)s=t[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),i.push(o)),s=t[r++];while(s!==void 0)}var xT=class{constructor(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];e:{t:{let s;i:{n:if(!(t<n)){for(let o=i+2;;){if(n===void 0){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(r=n,n=e[++i],t<n)break t}s=e.length;break i}if(!(t>=r)){let o=e[1];t<o&&(i=2,r=o);for(let a=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(n=r,r=e[--i-1],t>=r)break t}s=i,i=0;break i}break e}for(;i<s;){let o=i+s>>>1;t<e[o]?s=o:i=o+1}if(n=e[i],r=e[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n;for(let s=0;s!==n;++s)e[s]=i[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},qEe=class extends xT{constructor(t,e,i,n){super(t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$g,endingEnd:$g}}intervalChanged_(t,e,i){let n=this.parameterPositions,r=t-2,s=t+1,o=n[r],a=n[s];if(o===void 0)switch(this.getSettings_().endingStart){case ev:r=t,o=2*e-i;break;case TC:r=n.length-2,o=e+n[r]-n[r+1];break;default:r=t,o=i}if(a===void 0)switch(this.getSettings_().endingEnd){case ev:s=t,a=2*i-e;break;case TC:s=1,a=i+n[1]-n[0];break;default:s=t-1,a=e}let l=(i-e)*.5,c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-i),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,f=(i-e)/(n-e),p=f*f,m=p*f,g=-u*m+2*u*p-u*f,v=(1+u)*m+(-1.5-2*u)*p+(-.5+u)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,x=d*m-d*p;for(let b=0;b!==o;++b)r[b]=g*s[c+b]+v*s[l+b]+y*s[a+b]+x*s[h+b];return r}},R$=class extends xT{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(i-e)/(n-e),h=1-c;for(let u=0;u!==o;++u)r[u]=s[l+u]*h+s[a+u]*c;return r}},YEe=class extends xT{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t){return this.copySampleValue_(t-1)}},kc=class{constructor(t,e,i,n){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=iA(e,this.TimeBufferType),this.values=iA(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){let e=t.constructor,i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:iA(t.times,Array),values:iA(t.values,Array)};let n=t.getInterpolation();n!==t.DefaultInterpolation&&(i.interpolation=n)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new YEe(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new R$(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new qEe(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case CC:e=this.InterpolantFactoryMethodDiscrete;break;case EC:e=this.InterpolantFactoryMethodLinear;break;case UD:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return CC;case this.InterpolantFactoryMethodLinear:return EC;case this.InterpolantFactoryMethodSmooth:return UD}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this}scale(t){if(t!==1){let e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this}trim(t,e){let i=this.times,n=i.length,r=0,s=n-1;for(;r!==n&&i[r]<t;)++r;for(;s!==-1&&i[s]>e;)--s;if(++s,r!==0||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);let o=this.getValueSize();this.times=Sh(i,r,s),this.values=Sh(this.values,r*o,s*o)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let i=this.times,n=this.values,r=i.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==r;o++){let a=i[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(s!==null&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),t=!1;break}s=a}if(n!==void 0&&L$(n))for(let o=0,a=n.length;o!==a;++o){let l=n[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}return t}optimize(){let t=Sh(this.times),e=Sh(this.values),i=this.getValueSize(),n=this.getInterpolation()===UD,r=t.length-1,s=1;for(let o=1;o<r;++o){let a=!1,l=t[o],c=t[o+1];if(l!==c&&(o!==1||l!==t[0]))if(n)a=!0;else{let h=o*i,u=h-i,d=h+i;for(let f=0;f!==i;++f){let p=e[h+f];if(p!==e[u+f]||p!==e[d+f]){a=!0;break}}}if(a){if(o!==s){t[s]=t[o];let h=o*i,u=s*i;for(let d=0;d!==i;++d)e[u+d]=e[h+d]}++s}}if(r>0){t[s]=t[r];for(let o=r*i,a=s*i,l=0;l!==i;++l)e[a+l]=e[o+l];++s}return s!==t.length?(this.times=Sh(t,0,s),this.values=Sh(e,0,s*i)):(this.times=t,this.values=e),this}clone(){let t=Sh(this.times,0),e=Sh(this.values,0),i=this.constructor,n=new i(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}};kc.prototype.TimeBufferType=Float32Array;kc.prototype.ValueBufferType=Float32Array;kc.prototype.DefaultInterpolation=EC;var N0=class extends kc{};N0.prototype.ValueTypeName="bool";N0.prototype.ValueBufferType=Array;N0.prototype.DefaultInterpolation=CC;N0.prototype.InterpolantFactoryMethodLinear=void 0;N0.prototype.InterpolantFactoryMethodSmooth=void 0;var O$=class extends kc{};O$.prototype.ValueTypeName="color";var FC=class extends kc{};FC.prototype.ValueTypeName="number";var QEe=class extends xT{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){let r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(i-e)/(n-e),l=t*o;for(let c=l+o;l!==c;l+=4)qt.slerpFlat(r,0,s,l-o,s,l,a);return r}},yw=class extends kc{InterpolantFactoryMethodLinear(t){return new QEe(this.times,this.values,this.getValueSize(),t)}};yw.prototype.ValueTypeName="quaternion";yw.prototype.DefaultInterpolation=EC;yw.prototype.InterpolantFactoryMethodSmooth=void 0;var k0=class extends kc{};k0.prototype.ValueTypeName="string";k0.prototype.ValueBufferType=Array;k0.prototype.DefaultInterpolation=CC;k0.prototype.InterpolantFactoryMethodLinear=void 0;k0.prototype.InterpolantFactoryMethodSmooth=void 0;var NC=class extends kc{};NC.prototype.ValueTypeName="vector";var lR=class{constructor(t,e=-1,i,n=Ak){this.name=t,this.tracks=i,this.duration=e,this.blendMode=n,this.uuid=Fa(),this.duration<0&&this.resetDuration()}static parse(t){let e=[],i=t.tracks,n=1/(t.fps||1);for(let s=0,o=i.length;s!==o;++s)e.push(KEe(i[s]).scale(n));let r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){let e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,s=i.length;r!==s;++r)e.push(kc.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(t,e,i,n){let r=e.length,s=[];for(let o=0;o<r;o++){let a=[],l=[];a.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);let c=XEe(a);a=Rj(a,1,c),l=Rj(l,1,c),!n&&a[0]===0&&(a.push(r),l.push(l[0])),s.push(new FC(".morphTargetInfluences["+e[o].name+"]",a,l).scale(1/i))}return new this(t,-1,s)}static findByName(t,e){let i=t;if(!Array.isArray(t)){let n=t;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===e)return i[n];return null}static CreateClipsFromMorphTargetSequences(t,e,i){let n={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){let l=t[o],c=l.name.match(r);if(c&&c.length>1){let h=c[1],u=n[h];u||(n[h]=u=[]),u.push(l)}}let s=[];for(let o in n)s.push(this.CreateFromMorphTargetSequence(o,n[o],e,i));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(c,h,u,d,f){if(u.length!==0){let p=[],m=[];B$(u,p,m,d),p.length!==0&&f.push(new c(h,p,m))}},n=[],r=t.name||"default",s=t.fps||30,o=t.blendMode,a=t.length||-1,l=t.hierarchy||[];for(let c=0;c<l.length;c++){let h=l[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let u={},d;for(d=0;d<h.length;d++)if(h[d].morphTargets)for(let f=0;f<h[d].morphTargets.length;f++)u[h[d].morphTargets[f]]=-1;for(let f in u){let p=[],m=[];for(let g=0;g!==h[d].morphTargets.length;++g){let v=h[d];p.push(v.time),m.push(v.morphTarget===f?1:0)}n.push(new FC(".morphTargetInfluence["+f+"]",p,m))}a=u.length*s}else{let u=".bones["+e[c].name+"]";i(NC,u+".position",h,"pos",n),i(yw,u+".quaternion",h,"rot",n),i(NC,u+".scale",h,"scl",n)}}return n.length===0?null:new this(r,a,n,o)}resetDuration(){let t=this.tracks,e=0;for(let i=0,n=t.length;i!==n;++i){let r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function JEe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return FC;case"vector":case"vector2":case"vector3":case"vector4":return NC;case"color":return O$;case"quaternion":return yw;case"bool":case"boolean":return N0;case"string":return k0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function KEe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=JEe(t.type);if(t.times===void 0){let i=[],n=[];B$(t.keys,i,n,"value"),t.times=i,t.values=n}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var Oj={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},F$=class{constructor(t,e,i){let n=this,r=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(c){o++,r===!1&&n.onStart!==void 0&&n.onStart(c,s,o),r=!0},this.itemEnd=function(c){s++,n.onProgress!==void 0&&n.onProgress(c,s,o),s===o&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return a?a(c):c},this.setURLModifier=function(c){return a=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){let h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(let h=0,u=l.length;h<u;h+=2){let d=l[h],f=l[h+1];if(d.global&&(d.lastIndex=0),d.test(c))return f}return null}}},ZEe=new F$,Nk=class{constructor(t){this.manager=t!==void 0?t:ZEe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let i=this;return new Promise(function(n,r){i.load(t,n,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},ru={},$Ee=class extends Error{constructor(t,e){super(t),this.response=e}},cR=class extends Nk{constructor(t){super(t)}load(t,e,i,n){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let r=Oj.get(t);if(r!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(ru[t]!==void 0){ru[t].push({onLoad:e,onProgress:i,onError:n});return}ru[t]=[],ru[t].push({onLoad:e,onProgress:i,onError:n});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=ru[t],h=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=u?parseInt(u):0,f=d!==0,p=0,m=new ReadableStream({start(g){v();function v(){h.read().then(({done:y,value:x})=>{if(y)g.close();else{p+=x.byteLength;let b=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let S=0,A=c.length;S<A;S++){let E=c[S];E.onProgress&&E.onProgress(b)}g.enqueue(x),v()}})}}});return new Response(m)}else throw new $Ee(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),h=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(h);return l.arrayBuffer().then(d=>u.decode(d))}}}).then(l=>{Oj.add(t,l);let c=ru[t];delete ru[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=ru[t];if(c===void 0)throw this.manager.itemError(t),l;delete ru[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onError&&d.onError(l)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},xw=class extends Ri{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Tt(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},eTe=class extends xw{constructor(t,e,i){super(t,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Tt(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}},g3=new Qe,Fj=new O,Nj=new O,kk=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ge(512,512),this.map=null,this.mapPass=null,this.matrix=new Qe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Tk,this._frameExtents=new ge(1,1),this._viewportCount=1,this._viewports=[new Ht(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,i=this.matrix;Fj.setFromMatrixPosition(t.matrixWorld),e.position.copy(Fj),Nj.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Nj),e.updateMatrixWorld(),g3.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(g3)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},tTe=class extends kk{constructor(){super(new os(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){let e=this.camera,i=f_*2*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(i!==e.fov||n!==e.aspect||r!==e.far)&&(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}},iTe=class extends xw{constructor(t,e,i=0,n=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new tTe}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},kj=new Qe,Jy=new O,v3=new O,nTe=class extends kk{constructor(){super(new os(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ge(4,2),this._viewportCount=6,this._viewports=[new Ht(2,1,1,1),new Ht(0,1,1,1),new Ht(3,1,1,1),new Ht(1,1,1,1),new Ht(3,0,1,1),new Ht(1,0,1,1)],this._cubeDirections=[new O(1,0,0),new O(-1,0,0),new O(0,0,1),new O(0,0,-1),new O(0,1,0),new O(0,-1,0)],this._cubeUps=[new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,1,0),new O(0,0,1),new O(0,0,-1)]}updateMatrices(t,e=0){let i=this.camera,n=this.matrix,r=t.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),Jy.setFromMatrixPosition(t.matrixWorld),i.position.copy(Jy),v3.copy(i.position),v3.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(v3),i.updateMatrixWorld(),n.makeTranslation(-Jy.x,-Jy.y,-Jy.z),kj.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kj)}},rTe=class extends xw{constructor(t,e,i=0,n=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new nTe}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}},sTe=class extends kk{constructor(){super(new Pk(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},oTe=class extends xw{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ri.DEFAULT_UP),this.updateMatrix(),this.target=new Ri,this.shadow=new sTe}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},aTe=class extends Rt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){let t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}},N$=class extends Nk{constructor(t){super(t)}load(t,e,i,n){let r=this,s=new cR(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){n?n(a):console.error(a),r.manager.itemError(t)}},i,n)}parse(t){let e={},i={};function n(u,d){if(e[d]!==void 0)return e[d];let f=u.interleavedBuffers[d],p=r(u,f.buffer),m=BS(f.type,p),g=new pEe(m,f.stride);return g.uuid=f.uuid,e[d]=g,g}function r(u,d){if(i[d]!==void 0)return i[d];let f=u.arrayBuffers[d],p=new Uint32Array(f).buffer;return i[d]=p,p}let s=t.isInstancedBufferGeometry?new aTe:new Rt,o=t.data.index;if(o!==void 0){let u=BS(o.type,o.array);s.setIndex(new Ot(u,1))}let a=t.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let p=n(t.data,d.data);f=new sR(p,d.itemSize,d.offset,d.normalized)}else{let p=BS(d.type,d.array),m=d.isInstancedBufferAttribute?gEe:Ot;f=new m(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(u,f)}let l=t.data.morphAttributes;if(l)for(let u in l){let d=l[u],f=[];for(let p=0,m=d.length;p<m;p++){let g=d[p],v;if(g.isInterleavedBufferAttribute){let y=n(t.data,g.data);v=new sR(y,g.itemSize,g.offset,g.normalized)}else{let y=BS(g.type,g.array);v=new Ot(y,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),f.push(v)}s.morphAttributes[u]=f}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=t.data.groups||t.data.drawcalls||t.data.offsets;if(c!==void 0)for(let u=0,d=c.length;u!==d;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let h=t.data.boundingSphere;if(h!==void 0){let u=new O;h.center!==void 0&&u.fromArray(h.center),s.boundingSphere=new qo(u,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}},lTe=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=zj(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=zj();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function zj(){return(typeof performance>"u"?Date:performance).now()}var cTe=class{constructor(t,e,i){this.binding=t,this.valueSize=i;let n,r,s;switch(e){case"quaternion":n=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:n=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){let i=this.buffer,n=this.valueSize,r=t*n+n,s=this.cumulativeWeight;if(s===0){for(let o=0;o!==n;++o)i[r+o]=i[o];s=e}else{s+=e;let o=e/s;this._mixBufferRegion(i,r,0,o,n)}this.cumulativeWeight=s}accumulateAdditive(t){let e=this.buffer,i=this.valueSize,n=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){let e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let a=e*this._origIndex;this._mixBufferRegion(i,n,a,1-r,e)}s>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(i[a]!==i[a+e]){o.setValue(i,n);break}}saveOriginalState(){let t=this.binding,e=this.buffer,i=this.valueSize,n=i*this._origIndex;t.getValue(e,n);for(let r=i,s=n;r!==s;++r)e[r]=e[n+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){let t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]}_select(t,e,i,n,r){if(n>=.5)for(let s=0;s!==r;++s)t[e+s]=t[i+s]}_slerp(t,e,i,n){qt.slerpFlat(t,e,t,e,t,i,n)}_slerpAdditive(t,e,i,n,r){let s=this._workIndex*r;qt.multiplyQuaternionsFlat(t,s,t,e,t,i),qt.slerpFlat(t,e,t,e,t,s,n)}_lerp(t,e,i,n,r){let s=1-n;for(let o=0;o!==r;++o){let a=e+o;t[a]=t[a]*s+t[i+o]*n}}_lerpAdditive(t,e,i,n,r){for(let s=0;s!==r;++s){let o=e+s;t[o]=t[o]+t[i+s]*n}}},zk="\\[\\]\\.:\\/",uTe=new RegExp("["+zk+"]","g"),Uk="[^"+zk+"]",hTe="[^"+zk.replace("\\.","")+"]",dTe=/((?:WC+[\/:])*)/.source.replace("WC",Uk),fTe=/(WCOD+)?/.source.replace("WCOD",hTe),pTe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Uk),mTe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Uk),gTe=new RegExp("^"+dTe+fTe+pTe+mTe+"$"),vTe=["material","materials","bones","map"],yTe=class{constructor(t,e,i){let n=i||Fi.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(t,e)}setValue(t,e){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},Fi=class{constructor(t,e,i){this.path=e,this.parsedPath=i||Fi.parseTrackName(e),this.node=Fi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new Fi.Composite(t,e,i):new Fi(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(uTe,"")}static parseTrackName(t){let e=gTe.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let r=i.nodeName.substring(n+1);vTe.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){let i=t.skeleton.getBoneByName(e);if(i!==void 0)return i}if(t.children){let i=function(r){for(let s=0;s<r.length;s++){let o=r[s];if(o.name===e||o.uuid===e)return o;let a=i(o.children);if(a)return a}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=Fi.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let l=e.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let c=0;c<t.length;c++)if(t[c].name===l){l=c;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(l!==void 0){if(t[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[l]}}let s=t[n];if(s===void 0){let l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(r!==void 0){if(n==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[r]!==void 0&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Fi.Composite=yTe;Fi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Fi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Fi.prototype.GetterByBindingType=[Fi.prototype._getValue_direct,Fi.prototype._getValue_array,Fi.prototype._getValue_arrayElement,Fi.prototype._getValue_toArray];Fi.prototype.SetterByBindingTypeAndVersioning=[[Fi.prototype._setValue_direct,Fi.prototype._setValue_direct_setNeedsUpdate,Fi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fi.prototype._setValue_array,Fi.prototype._setValue_array_setNeedsUpdate,Fi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fi.prototype._setValue_arrayElement,Fi.prototype._setValue_arrayElement_setNeedsUpdate,Fi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fi.prototype._setValue_fromArray,Fi.prototype._setValue_fromArray_setNeedsUpdate,Fi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var xTe=class{constructor(t,e,i=null,n=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=n;let r=e.tracks,s=r.length,o=new Array(s),a={endingStart:$g,endingEnd:$g};for(let l=0;l!==s;++l){let c=r[l].createInterpolant(null);o[l]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=i$,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){let n=this._clip.duration,r=t._clip.duration,s=r/n,o=n/r;t.warp(1,s,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){let t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){let n=this._mixer,r=n.time,s=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);let a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+i,l[0]=t/s,l[1]=e/s,this}stopWarping(){let t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,n){if(!this.enabled){this._updateWeight(t);return}let r=this._startTime;if(r!==null){let a=(t-r)*i;a<0||i===0?e=0:(this._startTime=null,e=i*a)}e*=this._updateTimeScale(t);let s=this._updateTime(e),o=this._updateWeight(t);if(o>0){let a=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case $we:for(let c=0,h=a.length;c!==h;++c)a[c].evaluate(s),l[c].accumulateAdditive(o);break;case Ak:default:for(let c=0,h=a.length;c!==h;++c)a[c].evaluate(s),l[c].accumulate(n,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;let i=this._weightInterpolant;if(i!==null){let n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){let e=this._clip.duration,i=this.loop,n=this.time+t,r=this._loopCount,s=i===Sk;if(t===0)return r===-1?n:s&&(r&1)===1?e-n:n;if(i===t$){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=e)n=e;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(r===-1&&(t>=0?(r=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),n>=e||n<0){let o=Math.floor(n/e);n-=e*o,r+=Math.abs(o);let a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(a===1){let l=t<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(s&&(r&1)===1)return e-n}return n}_setEndings(t,e,i){let n=this._interpolantSettings;i?(n.endingStart=ev,n.endingEnd=ev):(t?n.endingStart=this.zeroSlopeAtStart?ev:$g:n.endingStart=TC,e?n.endingEnd=this.zeroSlopeAtEnd?ev:$g:n.endingEnd=TC)}_scheduleFading(t,e,i){let n=this._mixer,r=n.time,s=this._weightInterpolant;s===null&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);let o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=e,o[1]=r+t,a[1]=i,this}},_Te=new Float32Array(1),wTe=class extends qr{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){let i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,s=t._propertyBindings,o=t._interpolants,a=i.uuid,l=this._bindingsByRootAndName,c=l[a];c===void 0&&(c={},l[a]=c);for(let h=0;h!==r;++h){let u=n[h],d=u.name,f=c[d];if(f!==void 0)++f.referenceCount,s[h]=f;else{if(f=s[h],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,a,d));continue}let p=e&&e._propertyBindings[h].binding.parsedPath;f=new cTe(Fi.create(i,d,p),u.ValueTypeName,u.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,a,d),s[h]=f}o[h].resultBuffer=f.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){let i=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,i)}let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){let e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,i){let n=this._actions,r=this._actionsByClip,s=r[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{let o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),s.actionByRoot[i]=t}_removeInactiveAction(t){let e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;let r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;let h=o.actionByRoot,u=(t._localRoot||this._root).uuid;delete h[u],a.length===0&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){let e=t._propertyBindings;for(let i=0,n=e.length;i!==n;++i){let r=e[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(t){let e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackAction(t){let e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_addInactiveBinding(t,e,i){let n=this._bindingsByRootAndName,r=this._bindings,s=n[e];s===void 0&&(s={},n[e]=s),s[i]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){let e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,s=this._bindingsByRootAndName,o=s[n],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[r],Object.keys(o).length===0&&delete s[n]}_lendBinding(t){let e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackBinding(t){let e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_lendControlInterpolant(){let t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return i===void 0&&(i=new R$(new Float32Array(2),new Float32Array(2),1,_Te),i.__cacheIndex=e,t[e]=i),i}_takeBackControlInterpolant(t){let e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r}clipAction(t,e,i){let n=e||this._root,r=n.uuid,s=typeof t=="string"?lR.findByName(n,t):t,o=s!==null?s.uuid:t,a=this._actionsByClip[o],l=null;if(i===void 0&&(s!==null?i=s.blendMode:i=Ak),a!==void 0){let h=a.actionByRoot[r];if(h!==void 0&&h.blendMode===i)return h;l=a.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new xTe(this,s,e,i);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(t,e){let i=e||this._root,n=i.uuid,r=typeof t=="string"?lR.findByName(i,t):t,s=r?r.uuid:t,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[n]||null}stopAllAction(){let t=this._actions,e=this._nActiveActions;for(let i=e-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;let e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==i;++l)e[l]._update(n,t,r,s);let o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){let e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(r!==void 0){let s=r.knownActions;for(let o=0,a=s.length;o!==a;++o){let l=s[o];this._deactivateAction(l);let c=l._cacheIndex,h=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=c,e[c]=h,e.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}}uncacheRoot(t){let e=t.uuid,i=this._actionsByClip;for(let s in i){let o=i[s].actionByRoot,a=o[e];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}let n=this._bindingsByRootAndName,r=n[e];if(r!==void 0)for(let s in r){let o=r[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(t,e){let i=this.existingAction(t,e);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},qe=class{constructor(t){this.value=t}clone(){return new qe(this.value.clone===void 0?this.value:this.value.clone())}},k$=class{constructor(t,e,i=0,n=1/0){this.ray=new B0(t,e),this.near=i,this.far=n,this.camera=null,this.layers=new Ck,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,i=[]){return uR(t,this,i,e),i.sort(Uj),i}intersectObjects(t,e=!0,i=[]){for(let n=0,r=t.length;n<r;n++)uR(t[n],this,i,e);return i.sort(Uj),i}};function Uj(t,e){return t.distance-e.distance}function uR(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),n===!0){let r=t.children;for(let s=0,o=r.length;s<o;s++)uR(r[s],e,i,!0)}}var Gj=class{constructor(t=1,e=0,i=0){return this.radius=t,this.phi=e,this.theta=i,this}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(ar(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},Vj=new ge,bTe=class{constructor(t=new ge(1/0,1/0),e=new ge(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=Vj.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Vj.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Hj=new O,nA=new O,Na=class{constructor(t=new O,e=new O){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Hj.subVectors(t,this.start),nA.subVectors(this.end,this.start);let i=nA.dot(nA),n=nA.dot(Hj)/i;return e&&(n=ar(n,0,1)),n}closestPointToPoint(t,e,i){let n=this.closestPointToPointParameter(t,e);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},jj=new O,STe=class extends Ri{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";let i=new Rt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,c=o/a*Math.PI*2;n.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new gt(n,3));let r=new Jd({fog:!1,toneMapped:!1});this.cone=new vw(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),jj.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(jj),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},ATe=class extends $s{constructor(t,e,i){let n=new Fk(e,4,2),r=new gw({wireframe:!0,fog:!1,toneMapped:!1});super(n,r),this.light=t,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Wj=new O,rA=new O,Xj=new O,MTe=class extends Ri{constructor(t,e,i){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",e===void 0&&(e=1);let n=new Rt;n.setAttribute("position",new gt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));let r=new Jd({fog:!1,toneMapped:!1});this.lightPlane=new BC(n,r),this.add(this.lightPlane),n=new Rt,n.setAttribute("position",new gt([0,0,0,0,0,1],3)),this.targetLine=new BC(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Wj.setFromMatrixPosition(this.light.matrixWorld),rA.setFromMatrixPosition(this.light.target.matrixWorld),Xj.subVectors(rA,Wj),this.lightPlane.lookAt(rA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rA),this.targetLine.scale.z=Xj.length()}},sA=new O,_n=new O0,kC=class extends vw{constructor(t){let e=new Rt,i=new Jd({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){a(f),a(p)}function a(f){n.push(0,0,0),r.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(n.length/3-1)}e.setAttribute("position",new gt(n,3)),e.setAttribute("color",new gt(r,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Tt(16755200),c=new Tt(16711680),h=new Tt(43775),u=new Tt(16777215),d=new Tt(3355443);this.setColors(l,c,h,u,d)}setColors(t,e,i,n,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let t=this.geometry,e=this.pointMap,i=1,n=1;_n.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ln("c",e,t,_n,0,0,-1),Ln("t",e,t,_n,0,0,1),Ln("n1",e,t,_n,-i,-n,-1),Ln("n2",e,t,_n,i,-n,-1),Ln("n3",e,t,_n,-i,n,-1),Ln("n4",e,t,_n,i,n,-1),Ln("f1",e,t,_n,-i,-n,1),Ln("f2",e,t,_n,i,-n,1),Ln("f3",e,t,_n,-i,n,1),Ln("f4",e,t,_n,i,n,1),Ln("u1",e,t,_n,i*.7,n*1.1,-1),Ln("u2",e,t,_n,-i*.7,n*1.1,-1),Ln("u3",e,t,_n,0,n*2,-1),Ln("cf1",e,t,_n,-i,0,1),Ln("cf2",e,t,_n,i,0,1),Ln("cf3",e,t,_n,0,-n,1),Ln("cf4",e,t,_n,0,n,1),Ln("cn1",e,t,_n,-i,0,-1),Ln("cn2",e,t,_n,i,0,-1),Ln("cn3",e,t,_n,0,-n,-1),Ln("cn4",e,t,_n,0,n,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ln(t,e,i,n,r,s,o){sA.set(r,s,o).unproject(n);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],sA.x,sA.y,sA.z)}}var zC=class extends vw{constructor(t,e=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Rt;r.setIndex(new Ot(i,1)),r.setAttribute("position",new gt(n,3)),super(r,new Jd({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},CTe=class extends vw{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Rt;n.setAttribute("position",new gt(e,3)),n.setAttribute("color",new gt(i,3));let r=new Jd({vertexColors:!0,toneMapped:!1});super(n,r),this.type="AxesHelper"}setColors(t,e,i){let n=new Tt,r=this.geometry.attributes.color.array;return n.set(t),n.toArray(r,0),n.toArray(r,3),n.set(e),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:L0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=L0);var Ky=".",Gk=Symbol("target"),z$=Symbol("unsubscribe");function hR(t){return t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap||ArrayBuffer.isView(t)}function ETe(t){return(typeof t=="object"?t===null:typeof t!="function")||t instanceof RegExp}var fc=Array.isArray;function Vk(t){return typeof t=="symbol"}var TTe={after:(t,e)=>fc(t)?t.slice(e.length):e===""?t:t.slice(e.length+1),concat:(t,e)=>fc(t)?(t=[...t],e&&t.push(e),t):e&&e.toString!==void 0?(t!==""&&(t+=Ky),Vk(e)?t+e.toString():t+e):t,initial:t=>{if(fc(t))return t.slice(0,-1);if(t==="")return t;let e=t.lastIndexOf(Ky);return e===-1?"":t.slice(0,e)},last:t=>{if(fc(t))return t[t.length-1]||"";if(t==="")return t;let e=t.lastIndexOf(Ky);return e===-1?t:t.slice(e+1)},walk:(t,e)=>{if(fc(t))for(let i of t)e(i);else if(t!==""){let i=0,n=t.indexOf(Ky);if(n===-1)e(t);else for(;i<t.length;)n===-1&&(n=t.length),e(t.slice(i,n)),i=n+1,n=t.indexOf(Ky,i)}},get(t,e){return this.walk(e,i=>{t&&(t=t[i])}),t}},wa=TTe;function PTe(t){return typeof t=="object"&&typeof t.next=="function"}function DTe(t,e,i,n,r){let s=t.next;if(e.name==="entries")t.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=r(o.value[0],e,o.value[0],n),o.value[1]=r(o.value[1],e,o.value[0],n)),o};else if(e.name==="values"){let o=i[Gk].keys();t.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,e,o.next().value,n)),a}}else t.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,e,o.value,n)),o};return t}function qj(t,e,i){return t.isUnsubscribed||e.ignoreSymbols&&Vk(i)||e.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(i)}var ITe=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){let e=this._getDescriptorCache(),i=e.get(t);return i===void 0&&(i={},e.set(t,i)),i}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);let i=this._getProperties(t),n=i[e];return n===void 0&&(n=Reflect.getOwnPropertyDescriptor(t,e),i[e]=n),n}getProxy(t,e,i,n){if(this.isUnsubscribed)return t;let r=t[n],s=r||t;this._pathCache.set(s,e);let o=this._proxyCache.get(s);return o===void 0&&(o=r===void 0?new Proxy(t,i):t,this._proxyCache.set(s,o)),o}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return!Object.is(t,wa.get(e,this.getPath(t)))}defineProperty(t,e,i){return Reflect.defineProperty(t,e,i)?(this.isUnsubscribed||(this._getProperties(t)[e]=i),!0):!1}setProperty(t,e,i,n,r){if(!this._equals(r,i)||!(e in t)){let s=this._getOwnPropertyDescriptor(t,e);return s!==void 0&&"set"in s?Reflect.set(t,e,i,n):Reflect.set(t,e,i)}return!0}deleteProperty(t,e,i){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(t);n&&(delete n[e],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(t,e,i){let n=this._getOwnPropertyDescriptor(e,i);return t!==void 0&&n!==void 0&&Object.is(t.value,n.value)&&(t.writable||!1)===(n.writable||!1)&&(t.enumerable||!1)===(n.enumerable||!1)&&(t.configurable||!1)===(n.configurable||!1)&&t.get===n.get&&t.set===n.set}isGetInvariant(t,e){let i=this._getOwnPropertyDescriptor(t,e);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function dR(t){return toString.call(t)==="[object Object]"}function oA(){return!0}function ag(t,e){return t.length!==e.length||t.some((i,n)=>e[n]!==i)}var U$=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),LTe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),G$={push:oA,pop:oA,shift:oA,unshift:oA,copyWithin:ag,reverse:ag,sort:ag,splice:ag,flat:ag,fill:ag},BTe=new Set([...U$,...LTe,...Object.keys(G$)]);function aA(t,e){if(t.size!==e.size)return!0;for(let i of t)if(!e.has(i))return!0;return!1}var V$=["keys","values","entries"],H$=new Set(["has","toString"]),j$={add:aA,clear:aA,delete:aA,forEach:aA},RTe=new Set([...H$,...Object.keys(j$),...V$]);function lA(t,e){if(t.size!==e.size)return!0;let i;for(let[n,r]of t)if(i=e.get(n),i!==r||i===void 0&&!e.has(n))return!0;return!1}var OTe=new Set([...H$,"get"]),W$={set:lA,clear:lA,delete:lA,forEach:lA},FTe=new Set([...OTe,...Object.keys(W$),...V$]),kd=class{constructor(t,e,i,n){this._path=e,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=e===void 0?t:this._shallowClone(t)}static isHandledMethod(t){return U$.has(t)}_shallowClone(t){let e=t;if(dR(t))e={...t};else if(fc(t))e=[...t];else if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set([...t].map(i=>this._shallowClone(i)));else if(t instanceof Map){e=new Map;for(let[i,n]of t.entries())e.set(i,this._shallowClone(n))}return this._clonedCache.add(e),e}preferredThisArg(t,e,i,n){return t?(fc(n)?this._onIsChanged=G$[e]:n instanceof Set?this._onIsChanged=j$[e]:n instanceof Map&&(this._onIsChanged=W$[e]),n):i}update(t,e,i){let n=wa.after(t,this._path);if(e!=="length"){let r=this.clone;wa.walk(n,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:n,property:e,previous:i}),r&&r[e]&&(r[e]=i)}this._isChanged=!0}undo(t){let e;for(let i=this._changes.length-1;i!==-1;i--)e=this._changes[i],wa.get(t,e.path)[e.property]=e.previous}isChanged(t){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,t)}},Yj=class extends kd{static isHandledMethod(t){return BTe.has(t)}},NTe=class extends kd{undo(t){t.setTime(this.clone.getTime())}isChanged(t,e){return!e(this.clone.valueOf(),t.valueOf())}},Qj=class extends kd{static isHandledMethod(t){return RTe.has(t)}undo(t){for(let e of this.clone)t.add(e);for(let e of t)this.clone.has(e)||t.delete(e)}},Jj=class extends kd{static isHandledMethod(t){return FTe.has(t)}undo(t){for(let[e,i]of this.clone.entries())t.set(e,i);for(let e of t.keys())this.clone.has(e)||t.delete(e)}},kTe=class extends kd{constructor(t,e,i,n){super(void 0,e,i,n),this._arg1=i[0],this._weakValue=t.has(this._arg1)}isChanged(t){return this._weakValue!==t.has(this._arg1)}undo(t){this._weakValue&&!t.has(this._arg1)?t.add(this._arg1):t.delete(this._arg1)}},zTe=class extends kd{constructor(t,e,i,n){super(void 0,e,i,n),this._weakKey=i[0],this._weakHas=t.has(this._weakKey),this._weakValue=t.get(this._weakKey)}isChanged(t){return this._weakValue!==t.get(this._weakKey)}undo(t){let e=t.has(this._weakKey);this._weakHas&&!e?t.set(this._weakKey,this._weakValue):!this._weakHas&&e?t.delete(this._weakKey):this._weakValue!==t.get(this._weakKey)&&t.set(this._weakKey,this._weakValue)}},Eg=class{constructor(t){this._stack=[],this._hasOnValidate=t}static isHandledType(t){return dR(t)||fc(t)||hR(t)}static isHandledMethod(t,e){return dR(t)?kd.isHandledMethod(e):fc(t)?Yj.isHandledMethod(e):t instanceof Set?Qj.isHandledMethod(e):t instanceof Map?Jj.isHandledMethod(e):hR(t)}get isCloning(){return this._stack.length>0}start(t,e,i){let n=kd;fc(t)?n=Yj:t instanceof Date?n=NTe:t instanceof Set?n=Qj:t instanceof Map?n=Jj:t instanceof WeakSet?n=kTe:t instanceof WeakMap&&(n=zTe),this._stack.push(new n(t,e,i,this._hasOnValidate))}update(t,e,i){this._stack[this._stack.length-1].update(t,e,i)}preferredThisArg(t,e,i){let{name:n}=t,r=Eg.isHandledMethod(i,n);return this._stack[this._stack.length-1].preferredThisArg(r,n,e,i)}isChanged(t,e,i){return this._stack[this._stack.length-1].isChanged(t,e,i)}undo(t){this._previousClone!==void 0&&this._previousClone.undo(t)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},UTe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},Hk=(t,e,i={})=>{i={...UTe,...i};let n=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:o,details:a}=i,l=new ITe(r),c=typeof i.onValidate=="function",h=new Eg(c),u=(y,x,b,S,A)=>!c||h.isCloning||i.onValidate(wa.concat(l.getPath(y),x),b,S,A)===!0,d=(y,x,b,S)=>{!qj(l,i,x)&&!(o&&l.isDetached(y,t))&&f(l.getPath(y),x,b,S)},f=(y,x,b,S,A)=>{h.isCloning?h.update(y,x,S):e(wa.concat(y,x),b,S,A)},p=y=>y&&(y[n]||y),m=(y,x,b,S)=>ETe(y)||b==="constructor"||s&&!Eg.isHandledMethod(x,b)||qj(l,i,b)||l.isGetInvariant(x,b)||o&&l.isDetached(x,t)?y:(S===void 0&&(S=l.getPath(x)),l.getProxy(y,wa.concat(S,b),g,n)),g={get(y,x,b){if(Vk(x)){if(x===n||x===Gk)return y;if(x===z$&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let S=hR(y)?Reflect.get(y,x):Reflect.get(y,x,b);return m(S,y,x)},set(y,x,b,S){b=p(b);let A=y[n]||y,E=A[x];if(r(E,b)&&x in y)return!0;let M=u(y,x,b,E);return M&&l.setProperty(A,x,b,S,E)?(d(y,x,y[x],E),!0):!M},defineProperty(y,x,b){if(!l.isSameDescriptor(b,y,x)){let S=y[x];u(y,x,b.value,S)&&l.defineProperty(y,x,b,S)&&d(y,x,b.value,S)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let b=Reflect.get(y,x),S=u(y,x,void 0,b);return S&&l.deleteProperty(y,x,b)?(d(y,x,void 0,b),!0):!S},apply(y,x,b){let S=x[n]||x;if(l.isUnsubscribed)return Reflect.apply(y,S,b);if((a===!1||a!==!0&&!a.includes(y.name))&&Eg.isHandledType(S)){let A=wa.initial(l.getPath(y)),E=Eg.isHandledMethod(S,y.name);h.start(S,A,b);let M=Reflect.apply(y,h.preferredThisArg(y,x,S),E?b.map(I=>p(I)):b),T=h.isChanged(S,r),P=h.stop();if(Eg.isHandledType(M)&&E&&(x instanceof Map&&y.name==="get"&&(A=wa.concat(A,b[0])),M=l.getProxy(M,A,g)),T){let I={name:y.name,args:b,result:M},k=h.isCloning?wa.initial(A):A,R=h.isCloning?wa.last(A):"";u(wa.get(t,k),R,S,P,I)?f(k,R,S,P,I):h.undo(S)}return(x instanceof Map||x instanceof Set)&&PTe(M)?DTe(M,y,x,A,m):M}return Reflect.apply(y,x,b)}},v=l.getProxy(t,i.pathAsArray?[]:"",g);return e=e.bind(v),c&&(i.onValidate=i.onValidate.bind(v)),v};Hk.target=t=>t&&t[Gk]||t;Hk.unsubscribe=t=>t[z$]||t;var Kj=Hk,GTe=typeof global=="object"&&global&&global.Object===Object&&global,X$=GTe,VTe=typeof self=="object"&&self&&self.Object===Object&&self,HTe=X$||VTe||Function("return this")(),Fl=HTe,jTe=Fl.Symbol,Ha=jTe,q$=Object.prototype,WTe=q$.hasOwnProperty,XTe=q$.toString,Zy=Ha?Ha.toStringTag:void 0;function qTe(t){var e=WTe.call(t,Zy),i=t[Zy];try{t[Zy]=void 0;var n=!0}catch{}var r=XTe.call(t);return n&&(e?t[Zy]=i:delete t[Zy]),r}var YTe=qTe,QTe=Object.prototype,JTe=QTe.toString;function KTe(t){return JTe.call(t)}var ZTe=KTe,$Te="[object Null]",e2e="[object Undefined]",Zj=Ha?Ha.toStringTag:void 0;function t2e(t){return t==null?t===void 0?e2e:$Te:Zj&&Zj in Object(t)?YTe(t):ZTe(t)}var am=t2e;function i2e(t){return t!=null&&typeof t=="object"}var Ju=i2e,n2e="[object Symbol]";function r2e(t){return typeof t=="symbol"||Ju(t)&&am(t)==n2e}var _T=r2e;function s2e(t,e){for(var i=-1,n=t==null?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}var Y$=s2e,o2e=Array.isArray,Lc=o2e,a2e=1/0,$j=Ha?Ha.prototype:void 0,eW=$j?$j.toString:void 0;function Q$(t){if(typeof t=="string")return t;if(Lc(t))return Y$(t,Q$)+"";if(_T(t))return eW?eW.call(t):"";var e=t+"";return e=="0"&&1/t==-a2e?"-0":e}var l2e=Q$,c2e=/\s/;function u2e(t){for(var e=t.length;e--&&c2e.test(t.charAt(e)););return e}var h2e=u2e,d2e=/^\s+/;function f2e(t){return t&&t.slice(0,h2e(t)+1).replace(d2e,"")}var p2e=f2e;function m2e(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ll=m2e,tW=0/0,g2e=/^[-+]0x[0-9a-f]+$/i,v2e=/^0b[01]+$/i,y2e=/^0o[0-7]+$/i,x2e=parseInt;function _2e(t){if(typeof t=="number")return t;if(_T(t))return tW;if(Ll(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ll(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=p2e(t);var i=v2e.test(t);return i||y2e.test(t)?x2e(t.slice(2),i?2:8):g2e.test(t)?tW:+t}var iW=_2e;function w2e(t){return t}var b2e=w2e,S2e="[object AsyncFunction]",A2e="[object Function]",M2e="[object GeneratorFunction]",C2e="[object Proxy]";function E2e(t){if(!Ll(t))return!1;var e=am(t);return e==A2e||e==M2e||e==S2e||e==C2e}var J$=E2e,T2e=Fl["__core-js_shared__"],y3=T2e,nW=function(){var t=/[^.]+$/.exec(y3&&y3.keys&&y3.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function P2e(t){return!!nW&&nW in t}var D2e=P2e,I2e=Function.prototype,L2e=I2e.toString;function B2e(t){if(t!=null){try{return L2e.call(t)}catch{}try{return t+""}catch{}}return""}var lm=B2e,R2e=/[\\^$.*+?()[\]{}|]/g,O2e=/^\[object .+?Constructor\]$/,F2e=Function.prototype,N2e=Object.prototype,k2e=F2e.toString,z2e=N2e.hasOwnProperty,U2e=RegExp("^"+k2e.call(z2e).replace(R2e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function G2e(t){if(!Ll(t)||D2e(t))return!1;var e=J$(t)?U2e:O2e;return e.test(lm(t))}var V2e=G2e;function H2e(t,e){return t==null?void 0:t[e]}var j2e=H2e;function W2e(t,e){var i=j2e(t,e);return V2e(i)?i:void 0}var cm=W2e,X2e=cm(Fl,"WeakMap"),fR=X2e,rW=Object.create,q2e=function(){function t(){}return function(e){if(!Ll(e))return{};if(rW)return rW(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),Y2e=q2e;function Q2e(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}var J2e=Q2e;function K2e(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}var Z2e=K2e,$2e=800,ePe=16,tPe=Date.now;function iPe(t){var e=0,i=0;return function(){var n=tPe(),r=ePe-(n-i);if(i=n,r>0){if(++e>=$2e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var nPe=iPe;function rPe(t){return function(){return t}}var sPe=rPe,oPe=function(){try{var t=cm(Object,"defineProperty");return t({},"",{}),t}catch{}}(),UC=oPe,aPe=UC?function(t,e){return UC(t,"toString",{configurable:!0,enumerable:!1,value:sPe(e),writable:!0})}:b2e,lPe=aPe,cPe=nPe(lPe),uPe=cPe;function hPe(t,e){for(var i=-1,n=t==null?0:t.length;++i<n&&e(t[i],i,t)!==!1;);return t}var dPe=hPe,fPe=9007199254740991,pPe=/^(?:0|[1-9]\d*)$/;function mPe(t,e){var i=typeof t;return e=e??fPe,!!e&&(i=="number"||i!="symbol"&&pPe.test(t))&&t>-1&&t%1==0&&t<e}var jk=mPe;function gPe(t,e,i){e=="__proto__"&&UC?UC(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var K$=gPe;function vPe(t,e){return t===e||t!==t&&e!==e}var Wk=vPe,yPe=Object.prototype,xPe=yPe.hasOwnProperty;function _Pe(t,e,i){var n=t[e];(!(xPe.call(t,e)&&Wk(n,i))||i===void 0&&!(e in t))&&K$(t,e,i)}var Xk=_Pe;function wPe(t,e,i,n){var r=!i;i||(i={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=n?n(i[a],t[a],a,i,t):void 0;l===void 0&&(l=t[a]),r?K$(i,a,l):Xk(i,a,l)}return i}var _w=wPe,sW=Math.max;function bPe(t,e,i){return e=sW(e===void 0?t.length-1:e,0),function(){for(var n=arguments,r=-1,s=sW(n.length-e,0),o=Array(s);++r<s;)o[r]=n[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=n[r];return a[e]=i(o),J2e(t,this,a)}}var SPe=bPe,APe=9007199254740991;function MPe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=APe}var qk=MPe;function CPe(t){return t!=null&&qk(t.length)&&!J$(t)}var Z$=CPe,EPe=Object.prototype;function TPe(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||EPe;return t===i}var Yk=TPe;function PPe(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}var DPe=PPe,IPe="[object Arguments]";function LPe(t){return Ju(t)&&am(t)==IPe}var oW=LPe,$$=Object.prototype,BPe=$$.hasOwnProperty,RPe=$$.propertyIsEnumerable,OPe=oW(function(){return arguments}())?oW:function(t){return Ju(t)&&BPe.call(t,"callee")&&!RPe.call(t,"callee")},Qk=OPe;function FPe(){return!1}var NPe=FPe,eee=typeof ko=="object"&&ko&&!ko.nodeType&&ko,aW=eee&&typeof zo=="object"&&zo&&!zo.nodeType&&zo,kPe=aW&&aW.exports===eee,lW=kPe?Fl.Buffer:void 0,zPe=lW?lW.isBuffer:void 0,UPe=zPe||NPe,GC=UPe,GPe="[object Arguments]",VPe="[object Array]",HPe="[object Boolean]",jPe="[object Date]",WPe="[object Error]",XPe="[object Function]",qPe="[object Map]",YPe="[object Number]",QPe="[object Object]",JPe="[object RegExp]",KPe="[object Set]",ZPe="[object String]",$Pe="[object WeakMap]",eDe="[object ArrayBuffer]",tDe="[object DataView]",iDe="[object Float32Array]",nDe="[object Float64Array]",rDe="[object Int8Array]",sDe="[object Int16Array]",oDe="[object Int32Array]",aDe="[object Uint8Array]",lDe="[object Uint8ClampedArray]",cDe="[object Uint16Array]",uDe="[object Uint32Array]",Zi={};Zi[iDe]=Zi[nDe]=Zi[rDe]=Zi[sDe]=Zi[oDe]=Zi[aDe]=Zi[lDe]=Zi[cDe]=Zi[uDe]=!0;Zi[GPe]=Zi[VPe]=Zi[eDe]=Zi[HPe]=Zi[tDe]=Zi[jPe]=Zi[WPe]=Zi[XPe]=Zi[qPe]=Zi[YPe]=Zi[QPe]=Zi[JPe]=Zi[KPe]=Zi[ZPe]=Zi[$Pe]=!1;function hDe(t){return Ju(t)&&qk(t.length)&&!!Zi[am(t)]}var dDe=hDe;function fDe(t){return function(e){return t(e)}}var Jk=fDe,tee=typeof ko=="object"&&ko&&!ko.nodeType&&ko,d1=tee&&typeof zo=="object"&&zo&&!zo.nodeType&&zo,pDe=d1&&d1.exports===tee,x3=pDe&&X$.process,mDe=function(){try{var t=d1&&d1.require&&d1.require("util").types;return t||x3&&x3.binding&&x3.binding("util")}catch{}}(),c0=mDe,cW=c0&&c0.isTypedArray,gDe=cW?Jk(cW):dDe,iee=gDe,vDe=Object.prototype,yDe=vDe.hasOwnProperty;function xDe(t,e){var i=Lc(t),n=!i&&Qk(t),r=!i&&!n&&GC(t),s=!i&&!n&&!r&&iee(t),o=i||n||r||s,a=o?DPe(t.length,String):[],l=a.length;for(var c in t)(e||yDe.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||jk(c,l)))&&a.push(c);return a}var nee=xDe;function _De(t,e){return function(i){return t(e(i))}}var ree=_De,wDe=ree(Object.keys,Object),bDe=wDe,SDe=Object.prototype,ADe=SDe.hasOwnProperty;function MDe(t){if(!Yk(t))return bDe(t);var e=[];for(var i in Object(t))ADe.call(t,i)&&i!="constructor"&&e.push(i);return e}var CDe=MDe;function EDe(t){return Z$(t)?nee(t):CDe(t)}var Kk=EDe;function TDe(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}var PDe=TDe,DDe=Object.prototype,IDe=DDe.hasOwnProperty;function LDe(t){if(!Ll(t))return PDe(t);var e=Yk(t),i=[];for(var n in t)n=="constructor"&&(e||!IDe.call(t,n))||i.push(n);return i}var BDe=LDe;function RDe(t){return Z$(t)?nee(t,!0):BDe(t)}var Zk=RDe,ODe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,FDe=/^\w*$/;function NDe(t,e){if(Lc(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||_T(t)?!0:FDe.test(t)||!ODe.test(t)||e!=null&&t in Object(e)}var kDe=NDe,zDe=cm(Object,"create"),v_=zDe;function UDe(){this.__data__=v_?v_(null):{},this.size=0}var GDe=UDe;function VDe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var HDe=VDe,jDe="__lodash_hash_undefined__",WDe=Object.prototype,XDe=WDe.hasOwnProperty;function qDe(t){var e=this.__data__;if(v_){var i=e[t];return i===jDe?void 0:i}return XDe.call(e,t)?e[t]:void 0}var YDe=qDe,QDe=Object.prototype,JDe=QDe.hasOwnProperty;function KDe(t){var e=this.__data__;return v_?e[t]!==void 0:JDe.call(e,t)}var ZDe=KDe,$De="__lodash_hash_undefined__";function e3e(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=v_&&e===void 0?$De:e,this}var t3e=e3e;function z0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}z0.prototype.clear=GDe;z0.prototype.delete=HDe;z0.prototype.get=YDe;z0.prototype.has=ZDe;z0.prototype.set=t3e;var uW=z0;function i3e(){this.__data__=[],this.size=0}var n3e=i3e;function r3e(t,e){for(var i=t.length;i--;)if(Wk(t[i][0],e))return i;return-1}var wT=r3e,s3e=Array.prototype,o3e=s3e.splice;function a3e(t){var e=this.__data__,i=wT(e,t);if(i<0)return!1;var n=e.length-1;return i==n?e.pop():o3e.call(e,i,1),--this.size,!0}var l3e=a3e;function c3e(t){var e=this.__data__,i=wT(e,t);return i<0?void 0:e[i][1]}var u3e=c3e;function h3e(t){return wT(this.__data__,t)>-1}var d3e=h3e;function f3e(t,e){var i=this.__data__,n=wT(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}var p3e=f3e;function U0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}U0.prototype.clear=n3e;U0.prototype.delete=l3e;U0.prototype.get=u3e;U0.prototype.has=d3e;U0.prototype.set=p3e;var bT=U0,m3e=cm(Fl,"Map"),y_=m3e;function g3e(){this.size=0,this.__data__={hash:new uW,map:new(y_||bT),string:new uW}}var v3e=g3e;function y3e(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var x3e=y3e;function _3e(t,e){var i=t.__data__;return x3e(e)?i[typeof e=="string"?"string":"hash"]:i.map}var ST=_3e;function w3e(t){var e=ST(this,t).delete(t);return this.size-=e?1:0,e}var b3e=w3e;function S3e(t){return ST(this,t).get(t)}var A3e=S3e;function M3e(t){return ST(this,t).has(t)}var C3e=M3e;function E3e(t,e){var i=ST(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}var T3e=E3e;function G0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}G0.prototype.clear=v3e;G0.prototype.delete=b3e;G0.prototype.get=A3e;G0.prototype.has=C3e;G0.prototype.set=T3e;var AT=G0,P3e="Expected a function";function $k(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(P3e);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var o=t.apply(this,n);return i.cache=s.set(r,o)||s,o};return i.cache=new($k.Cache||AT),i}$k.Cache=AT;var D3e=$k,I3e=500;function L3e(t){var e=D3e(t,function(n){return i.size===I3e&&i.clear(),n}),i=e.cache;return e}var B3e=L3e,R3e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,O3e=/\\(\\)?/g,F3e=B3e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(R3e,function(i,n,r,s){e.push(r?s.replace(O3e,"$1"):n||i)}),e}),N3e=F3e;function k3e(t){return t==null?"":l2e(t)}var z3e=k3e;function U3e(t,e){return Lc(t)?t:kDe(t,e)?[t]:N3e(z3e(t))}var V0=U3e,G3e=1/0;function V3e(t){if(typeof t=="string"||_T(t))return t;var e=t+"";return e=="0"&&1/t==-G3e?"-0":e}var MT=V3e;function H3e(t,e){e=V0(e,t);for(var i=0,n=e.length;t!=null&&i<n;)t=t[MT(e[i++])];return i&&i==n?t:void 0}var see=H3e;function j3e(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}var ez=j3e,hW=Ha?Ha.isConcatSpreadable:void 0;function W3e(t){return Lc(t)||Qk(t)||!!(hW&&t&&t[hW])}var X3e=W3e;function oee(t,e,i,n,r){var s=-1,o=t.length;for(i||(i=X3e),r||(r=[]);++s<o;){var a=t[s];e>0&&i(a)?e>1?oee(a,e-1,i,n,r):ez(r,a):n||(r[r.length]=a)}return r}var q3e=oee;function Y3e(t){var e=t==null?0:t.length;return e?q3e(t,1):[]}var Q3e=Y3e;function J3e(t){return uPe(SPe(t,void 0,Q3e),t+"")}var aee=J3e,K3e=ree(Object.getPrototypeOf,Object),tz=K3e,Z3e="[object Object]",$3e=Function.prototype,eIe=Object.prototype,lee=$3e.toString,tIe=eIe.hasOwnProperty,iIe=lee.call(Object);function nIe(t){if(!Ju(t)||am(t)!=Z3e)return!1;var e=tz(t);if(e===null)return!0;var i=tIe.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&lee.call(i)==iIe}var rIe=nIe;function sIe(t,e,i){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),i=i>r?r:i,i<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var s=Array(r);++n<r;)s[n]=t[n+e];return s}var oIe=sIe;function aIe(){this.__data__=new bT,this.size=0}var lIe=aIe;function cIe(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}var uIe=cIe;function hIe(t){return this.__data__.get(t)}var dIe=hIe;function fIe(t){return this.__data__.has(t)}var pIe=fIe,mIe=200;function gIe(t,e){var i=this.__data__;if(i instanceof bT){var n=i.__data__;if(!y_||n.length<mIe-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new AT(n)}return i.set(t,e),this.size=i.size,this}var vIe=gIe;function H0(t){var e=this.__data__=new bT(t);this.size=e.size}H0.prototype.clear=lIe;H0.prototype.delete=uIe;H0.prototype.get=dIe;H0.prototype.has=pIe;H0.prototype.set=vIe;var CM=H0;function yIe(t,e){return t&&_w(e,Kk(e),t)}var xIe=yIe;function _Ie(t,e){return t&&_w(e,Zk(e),t)}var wIe=_Ie,cee=typeof ko=="object"&&ko&&!ko.nodeType&&ko,dW=cee&&typeof zo=="object"&&zo&&!zo.nodeType&&zo,bIe=dW&&dW.exports===cee,fW=bIe?Fl.Buffer:void 0,pW=fW?fW.allocUnsafe:void 0;function SIe(t,e){if(e)return t.slice();var i=t.length,n=pW?pW(i):new t.constructor(i);return t.copy(n),n}var AIe=SIe;function MIe(t,e){for(var i=-1,n=t==null?0:t.length,r=0,s=[];++i<n;){var o=t[i];e(o,i,t)&&(s[r++]=o)}return s}var CIe=MIe;function EIe(){return[]}var uee=EIe,TIe=Object.prototype,PIe=TIe.propertyIsEnumerable,mW=Object.getOwnPropertySymbols,DIe=mW?function(t){return t==null?[]:(t=Object(t),CIe(mW(t),function(e){return PIe.call(t,e)}))}:uee,iz=DIe;function IIe(t,e){return _w(t,iz(t),e)}var LIe=IIe,BIe=Object.getOwnPropertySymbols,RIe=BIe?function(t){for(var e=[];t;)ez(e,iz(t)),t=tz(t);return e}:uee,hee=RIe;function OIe(t,e){return _w(t,hee(t),e)}var FIe=OIe;function NIe(t,e,i){var n=e(t);return Lc(t)?n:ez(n,i(t))}var dee=NIe;function kIe(t){return dee(t,Kk,iz)}var pR=kIe;function zIe(t){return dee(t,Zk,hee)}var fee=zIe,UIe=cm(Fl,"DataView"),mR=UIe,GIe=cm(Fl,"Promise"),gR=GIe,VIe=cm(Fl,"Set"),vR=VIe,gW="[object Map]",HIe="[object Object]",vW="[object Promise]",yW="[object Set]",xW="[object WeakMap]",_W="[object DataView]",jIe=lm(mR),WIe=lm(y_),XIe=lm(gR),qIe=lm(vR),YIe=lm(fR),Gf=am;(mR&&Gf(new mR(new ArrayBuffer(1)))!=_W||y_&&Gf(new y_)!=gW||gR&&Gf(gR.resolve())!=vW||vR&&Gf(new vR)!=yW||fR&&Gf(new fR)!=xW)&&(Gf=function(t){var e=am(t),i=e==HIe?t.constructor:void 0,n=i?lm(i):"";if(n)switch(n){case jIe:return _W;case WIe:return gW;case XIe:return vW;case qIe:return yW;case YIe:return xW}return e});var x_=Gf,QIe=Object.prototype,JIe=QIe.hasOwnProperty;function KIe(t){var e=t.length,i=new t.constructor(e);return e&&typeof t[0]=="string"&&JIe.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var ZIe=KIe,$Ie=Fl.Uint8Array,VC=$Ie;function eLe(t){var e=new t.constructor(t.byteLength);return new VC(e).set(new VC(t)),e}var nz=eLe;function tLe(t,e){var i=e?nz(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var iLe=tLe,nLe=/\w*$/;function rLe(t){var e=new t.constructor(t.source,nLe.exec(t));return e.lastIndex=t.lastIndex,e}var sLe=rLe,wW=Ha?Ha.prototype:void 0,bW=wW?wW.valueOf:void 0;function oLe(t){return bW?Object(bW.call(t)):{}}var aLe=oLe;function lLe(t,e){var i=e?nz(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var cLe=lLe,uLe="[object Boolean]",hLe="[object Date]",dLe="[object Map]",fLe="[object Number]",pLe="[object RegExp]",mLe="[object Set]",gLe="[object String]",vLe="[object Symbol]",yLe="[object ArrayBuffer]",xLe="[object DataView]",_Le="[object Float32Array]",wLe="[object Float64Array]",bLe="[object Int8Array]",SLe="[object Int16Array]",ALe="[object Int32Array]",MLe="[object Uint8Array]",CLe="[object Uint8ClampedArray]",ELe="[object Uint16Array]",TLe="[object Uint32Array]";function PLe(t,e,i){var n=t.constructor;switch(e){case yLe:return nz(t);case uLe:case hLe:return new n(+t);case xLe:return iLe(t,i);case _Le:case wLe:case bLe:case SLe:case ALe:case MLe:case CLe:case ELe:case TLe:return cLe(t,i);case dLe:return new n;case fLe:case gLe:return new n(t);case pLe:return sLe(t);case mLe:return new n;case vLe:return aLe(t)}}var DLe=PLe;function ILe(t){return typeof t.constructor=="function"&&!Yk(t)?Y2e(tz(t)):{}}var LLe=ILe,BLe="[object Map]";function RLe(t){return Ju(t)&&x_(t)==BLe}var OLe=RLe,SW=c0&&c0.isMap,FLe=SW?Jk(SW):OLe,NLe=FLe,kLe="[object Set]";function zLe(t){return Ju(t)&&x_(t)==kLe}var ULe=zLe,AW=c0&&c0.isSet,GLe=AW?Jk(AW):ULe,VLe=GLe,HLe=1,jLe=2,WLe=4,pee="[object Arguments]",XLe="[object Array]",qLe="[object Boolean]",YLe="[object Date]",QLe="[object Error]",mee="[object Function]",JLe="[object GeneratorFunction]",KLe="[object Map]",ZLe="[object Number]",gee="[object Object]",$Le="[object RegExp]",eBe="[object Set]",tBe="[object String]",iBe="[object Symbol]",nBe="[object WeakMap]",rBe="[object ArrayBuffer]",sBe="[object DataView]",oBe="[object Float32Array]",aBe="[object Float64Array]",lBe="[object Int8Array]",cBe="[object Int16Array]",uBe="[object Int32Array]",hBe="[object Uint8Array]",dBe="[object Uint8ClampedArray]",fBe="[object Uint16Array]",pBe="[object Uint32Array]",qi={};qi[pee]=qi[XLe]=qi[rBe]=qi[sBe]=qi[qLe]=qi[YLe]=qi[oBe]=qi[aBe]=qi[lBe]=qi[cBe]=qi[uBe]=qi[KLe]=qi[ZLe]=qi[gee]=qi[$Le]=qi[eBe]=qi[tBe]=qi[iBe]=qi[hBe]=qi[dBe]=qi[fBe]=qi[pBe]=!0;qi[QLe]=qi[mee]=qi[nBe]=!1;function EM(t,e,i,n,r,s){var o,a=e&HLe,l=e&jLe,c=e&WLe;if(i&&(o=r?i(t,n,r,s):i(t)),o!==void 0)return o;if(!Ll(t))return t;var h=Lc(t);if(h){if(o=ZIe(t),!a)return Z2e(t,o)}else{var u=x_(t),d=u==mee||u==JLe;if(GC(t))return AIe(t,a);if(u==gee||u==pee||d&&!r){if(o=l||d?{}:LLe(t),!a)return l?FIe(t,wIe(o,t)):LIe(t,xIe(o,t))}else{if(!qi[u])return r?t:{};o=DLe(t,u,a)}}s||(s=new CM);var f=s.get(t);if(f)return f;s.set(t,o),VLe(t)?t.forEach(function(g){o.add(EM(g,e,i,g,t,s))}):NLe(t)&&t.forEach(function(g,v){o.set(v,EM(g,e,i,v,t,s))});var p=c?l?fee:pR:l?Zk:Kk,m=h?void 0:p(t);return dPe(m||t,function(g,v){m&&(v=g,g=t[v]),Xk(o,v,EM(g,e,i,v,t,s))}),o}var vee=EM,mBe=1,gBe=4;function vBe(t){return vee(t,mBe|gBe)}var CT=vBe,yBe="__lodash_hash_undefined__";function xBe(t){return this.__data__.set(t,yBe),this}var _Be=xBe;function wBe(t){return this.__data__.has(t)}var bBe=wBe;function HC(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new AT;++e<i;)this.add(t[e])}HC.prototype.add=HC.prototype.push=_Be;HC.prototype.has=bBe;var SBe=HC;function ABe(t,e){for(var i=-1,n=t==null?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var MBe=ABe;function CBe(t,e){return t.has(e)}var EBe=CBe,TBe=1,PBe=2;function DBe(t,e,i,n,r,s){var o=i&TBe,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=i&PBe?new SBe:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],m=e[u];if(n)var g=o?n(m,p,u,e,t,s):n(p,m,u,t,e,s);if(g!==void 0){if(g)continue;d=!1;break}if(f){if(!MBe(e,function(v,y){if(!EBe(f,y)&&(p===v||r(p,v,i,n,s)))return f.push(y)})){d=!1;break}}else if(!(p===m||r(p,m,i,n,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var yee=DBe;function IBe(t){var e=-1,i=Array(t.size);return t.forEach(function(n,r){i[++e]=[r,n]}),i}var LBe=IBe;function BBe(t){var e=-1,i=Array(t.size);return t.forEach(function(n){i[++e]=n}),i}var RBe=BBe,OBe=1,FBe=2,NBe="[object Boolean]",kBe="[object Date]",zBe="[object Error]",UBe="[object Map]",GBe="[object Number]",VBe="[object RegExp]",HBe="[object Set]",jBe="[object String]",WBe="[object Symbol]",XBe="[object ArrayBuffer]",qBe="[object DataView]",MW=Ha?Ha.prototype:void 0,_3=MW?MW.valueOf:void 0;function YBe(t,e,i,n,r,s,o){switch(i){case qBe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case XBe:return!(t.byteLength!=e.byteLength||!s(new VC(t),new VC(e)));case NBe:case kBe:case GBe:return Wk(+t,+e);case zBe:return t.name==e.name&&t.message==e.message;case VBe:case jBe:return t==e+"";case UBe:var a=LBe;case HBe:var l=n&OBe;if(a||(a=RBe),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;n|=FBe,o.set(t,e);var h=yee(a(t),a(e),n,r,s,o);return o.delete(t),h;case WBe:if(_3)return _3.call(t)==_3.call(e)}return!1}var QBe=YBe,JBe=1,KBe=Object.prototype,ZBe=KBe.hasOwnProperty;function $Be(t,e,i,n,r,s){var o=i&JBe,a=pR(t),l=a.length,c=pR(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:ZBe.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var g=o;++u<l;){d=a[u];var v=t[d],y=e[d];if(n)var x=o?n(y,v,d,e,t,s):n(v,y,d,t,e,s);if(!(x===void 0?v===y||r(v,y,i,n,s):x)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var b=t.constructor,S=e.constructor;b!=S&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof S=="function"&&S instanceof S)&&(m=!1)}return s.delete(t),s.delete(e),m}var eRe=$Be,tRe=1,CW="[object Arguments]",EW="[object Array]",cA="[object Object]",iRe=Object.prototype,TW=iRe.hasOwnProperty;function nRe(t,e,i,n,r,s){var o=Lc(t),a=Lc(e),l=o?EW:x_(t),c=a?EW:x_(e);l=l==CW?cA:l,c=c==CW?cA:c;var h=l==cA,u=c==cA,d=l==c;if(d&&GC(t)){if(!GC(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new CM),o||iee(t)?yee(t,e,i,n,r,s):QBe(t,e,l,i,n,r,s);if(!(i&tRe)){var f=h&&TW.call(t,"__wrapped__"),p=u&&TW.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,g=p?e.value():e;return s||(s=new CM),r(m,g,i,n,s)}}return d?(s||(s=new CM),eRe(t,e,i,n,r,s)):!1}var rRe=nRe;function xee(t,e,i,n,r){return t===e?!0:t==null||e==null||!Ju(t)&&!Ju(e)?t!==t&&e!==e:rRe(t,e,i,n,xee,r)}var sRe=xee;function oRe(t,e){return t!=null&&e in Object(t)}var aRe=oRe;function lRe(t,e,i){e=V0(e,t);for(var n=-1,r=e.length,s=!1;++n<r;){var o=MT(e[n]);if(!(s=t!=null&&i(t,o)))break;t=t[o]}return s||++n!=r?s:(r=t==null?0:t.length,!!r&&qk(r)&&jk(o,r)&&(Lc(t)||Qk(t)))}var cRe=lRe;function uRe(t,e){return t!=null&&cRe(t,e,aRe)}var hRe=uRe,dRe=function(){return Fl.Date.now()},w3=dRe,fRe="Expected a function",pRe=Math.max,mRe=Math.min;function gRe(t,e,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(fRe);e=iW(e)||0,Ll(i)&&(h=!!i.leading,u="maxWait"in i,s=u?pRe(iW(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function f(A){var E=n,M=r;return n=r=void 0,c=A,o=t.apply(M,E),o}function p(A){return c=A,a=setTimeout(v,e),h?f(A):o}function m(A){var E=A-l,M=A-c,T=e-E;return u?mRe(T,s-M):T}function g(A){var E=A-l,M=A-c;return l===void 0||E>=e||E<0||u&&M>=s}function v(){var A=w3();if(g(A))return y(A);a=setTimeout(v,m(A))}function y(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:y(w3())}function S(){var A=w3(),E=g(A);if(n=arguments,r=this,l=A,E){if(a===void 0)return p(l);if(u)return clearTimeout(a),a=setTimeout(v,e),f(l)}return a===void 0&&(a=setTimeout(v,e)),o}return S.cancel=x,S.flush=b,S}var rz=gRe;function vRe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var yRe=vRe;function xRe(t,e){return e.length<2?t:see(t,oIe(e,0,-1))}var _Re=xRe;function wRe(t,e){return sRe(t,e)}var sz=wRe;function bRe(t,e){return e=V0(e,t),t=_Re(t,e),t==null||delete t[MT(yRe(e))]}var SRe=bRe;function ARe(t){return rIe(t)?void 0:t}var MRe=ARe,CRe=1,ERe=2,TRe=4,PRe=aee(function(t,e){var i={};if(t==null)return i;var n=!1;e=Y$(e,function(s){return s=V0(s,t),n||(n=s.length>1),s}),_w(t,fee(t),i),n&&(i=vee(i,CRe|ERe|TRe,MRe));for(var r=e.length;r--;)SRe(i,e[r]);return i}),yR=PRe;function DRe(t,e,i,n){if(!Ll(t))return t;e=V0(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=MT(e[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var h=a[l];c=n?n(h,l,a):void 0,c===void 0&&(c=Ll(h)?h:jk(e[r+1])?[]:{})}Xk(a,l,c),a=a[l]}return t}var IRe=DRe;function LRe(t,e,i){for(var n=-1,r=e.length,s={};++n<r;){var o=e[n],a=see(t,o);i(a,o)&&IRe(s,V0(o,t),a)}return s}var BRe=LRe;function RRe(t,e){return BRe(t,e,function(i,n){return hRe(t,n)})}var ORe=RRe,FRe=aee(function(t,e){return t==null?{}:ORe(t,e)}),zu=FRe,NRe="Expected a function";function kRe(t,e,i){var n=!0,r=!0;if(typeof t!="function")throw new TypeError(NRe);return Ll(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),rz(t,e,{leading:n,maxWait:e,trailing:r})}var zRe=kRe;function URe(t){for(let e of Object.keys(t))t[e]===void 0&&delete t[e];return t}function Yp(t,e){return Object.setPrototypeOf(t,e),t}var GRe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),VRe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),HRe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||ET&&"ontouchend"in document,jRe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,WRe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,XRe=()=>{if(typeof window>"u")return!1;let t=navigator.userAgent,e=navigator.vendor;return/Safari/i.test(t)&&/Apple Computer/.test(e)},qRe=()=>{if(typeof window>"u")return null;let t=navigator.userAgent.match(/Version\/(\d+\.\d)/);return t&&t[1]},YRe=()=>typeof window>"u"?void 0:new URLSearchParams(window.location.search).get("desktop-app-version")??"0.0.6",QRe=GRe();QRe&&YRe();var ET=VRe(),_ee=HRe(),JRe=jRe(),Fo=WRe(),PW=XRe(),DW=Number(qRe());function wee(t){return Array.isArray(t)?t:[t]}function KRe(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}function uA(t){return ET?t.metaKey:t.ctrlKey}var It=[],jC={},Bx={},TM={};function bee(t){It.includes(t)||It.push(t)}function bv(t){delete jC[t.pointerId];for(let e=0;e<It.length;e++)if(It[e].pointerId===t.pointerId){It.splice(e,1);break}}function ZRe(){It.splice(0,It.length)}function WC(t){if(t.pointerType!=="touch")return;let e=jC[t.pointerId];e===void 0&&(e={x:0,y:0},jC[t.pointerId]=e),e.x=t.pageX,e.y=t.pageY}function b3(t){let e=t.pointerId===It[0].pointerId?It[1]:It[0];return jC[e.pointerId]}function See(t){Bx[t.key]=!0,TM[t.key]=TM[t.key]===void 0?1:TM[t.key]+1}function Aee(t){if(ET&&Bx.Meta)for(let e in Bx)Bx[e]=!1;else Bx[t.key]=!1;TM={}}function $Re(t){t.addEventListener("pointerdown",bee,!0),t.addEventListener("pointerdown",WC,!0),t.addEventListener("pointermove",WC,!0),t.addEventListener("pointerup",bv,!0),t.addEventListener("pointercancel",bv,!0),t.addEventListener("pointerleave",bv,!0),window.addEventListener("keydown",See,!0),window.addEventListener("keyup",Aee,!0)}function eOe(t){t.removeEventListener("pointerdown",bee,!0),t.removeEventListener("pointerdown",WC,!0),t.removeEventListener("pointermove",WC,!0),t.removeEventListener("pointerup",bv,!0),t.removeEventListener("pointercancel",bv,!0),t.removeEventListener("pointerleave",bv,!0),window.removeEventListener("keydown",See,!0),window.removeEventListener("keyup",Aee,!0)}var Mee,tOe=new Promise(t=>{Mee=t}),hA;function iOe(){if(hA)return hA;async function t(){let e="https://unpkg.com/@splinetool/navmesh-wasm@0.9.419/build",[i,n]=await Promise.all([fw(()=>import("./navmesh-0b92f809.js"),[]),fetch(`${e}/navmesh.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});Mee(s)}return hA=t(),hA}var Cee,nOe=new Promise(t=>{Cee=t}),dA;function rOe(){if(dA)return dA;async function t(){let e=await fw(()=>import("./physics-dee4de67.js"),[]);await e.init(),Cee(e)}return dA=t(),dA}var Qn=class{modifyById(t,e){let i=this;if(i[t]===void 0)throw new Error("not expected");{let n={...i,[t]:e};return Object.setPrototypeOf(n,Qn.prototype),n}}add(t,e){var i;return((i=this.runOp({type:1,id:t,data:e}))==null?void 0:i.data)??this}runOp(t){let e=this;if(t.type===1){let i=e[t.id],n;i===void 0?n={type:2,id:t.id}:n={type:1,id:t.id,data:i};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,Qn.prototype),{data:o,actual:t,reverse:n}}else if(t.type===2){let{id:i}=t,n=e[i];if(n===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,Qn.prototype),delete r[i],{data:r,actual:t,reverse:{type:1,id:i,data:n}}}}return null}};function oz(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let i of e){let n=t[i];n&&typeof n=="object"&&oz(n)}return Object.freeze(t)}function sOe(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}var Eee=class extends Error{};function S3(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function ed(t,e,i){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let n=[],r=1/(i+1);for(let s=0;s<i;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;n.push(o)}return n}function az(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function oOe(){return typeof process<"u"}function Tee(t,e){for(let i of t)e(i.id,i.data)!==!0&&Tee(i.children,e)}function Pee(t,e){if(e(t.id,t.data)!==!0)for(let i of t.children)Pee(i,e)}var co=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,co.prototype)}deepFreeze(){let t=0;for(;t<this.length;)oz(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let i of t.children)this.fillCaches0(i,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let i=this.parent(t);if(i===e)return!0;t=i}return!1}rootAcestor(t){for(;t;){let e=this.parent(t);if(e)t=e;else return t}return t}isDescendantOf(t,e){for(;t;){let i=this.parent(t);if(i===e)return!0;t=i}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let i=this.get(t);i&&Pee(i,e)}}traverse(t){Tee(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let i=this.parent(t),n=this.childrenArray(i),r=n.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=n[r];return n=[...n],n[r]={...s,data:e},this.modifyArrayBy(i,n)}}modifyArrayBy(t,e){let i=t,n=e;for(;i!==null;){let s=n,o=i;if(i=this.parent(i),i===void 0)throw new Error;n=this.childrenArray(i);let a=n.findIndex(l=>l.id===o);if(a<0)throw new Error;n=[...n],n[a]={...n[a],children:s}}Object.setPrototypeOf(n,co.prototype);let r=n;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let i of e)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(t){let{parent:e,fi:i,id:n,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:i,id:n,data:r,children:s};return a=[...a,l],a.sort((c,h)=>c.fi-h.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:n}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let i=this.parent(e);if(i===void 0)return null;let n=this.childrenArray(i),r=n.findIndex(o=>o.id===e);t.localIndex=r,n=[...n];let s=n.splice(r,1)[0];return{data:this.modifyArrayBy(i,n),actual:t,reverse:{type:7,...s,parent:i}}}}moveOp(t){let{parent:e,fi:i,id:n}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:n});if(e!==null){let u=e;for(;u!==null;){if(u===void 0)throw new Error;if(u===n)throw new Eee("cyclic tree");u=this.parent(u)}}let r=this.parent(n);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(u=>u.id===n);o=[...o];let l=o.splice(a,1)[0],c=this.modifyArrayBy(r,o);r=e,o=c.childrenArray(r);let h=l.fi;return l={...l,fi:i},o=[...o,l],o.sort((u,d)=>u.fi-d.fi),t.localIndex=o.indexOf(l),c=c.modifyArrayBy(r,o),{data:c,actual:t,reverse:{type:9,parent:s,fi:h,id:n}}}previous(t,e){if(e===null){let n=this.childrenArray(t);return n.length===0?null:n[n.length-1].id}let i=null;for(let n of this.childrenArray(t)){if(n.id===e)return i;i=n.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let i=this.childrenArray(e),n=i.findIndex(r=>r.id===t)+1;if(n<i.length)return i[n].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let i=this.childrenArray(e),n=i.findIndex(r=>r.id===t)-1;return n>=0?this.traverseSortPrevious(i[n].id):e}}getAllSorted(t){let e=[];for(let i of t){let n=this.getWithSortKey(i.id);n!==void 0&&e.push({...i,...n})}e.sort((i,n)=>sOe(i.sortKey,n.sortKey));for(let i of e)delete i.sortKey;return e}getWithSortKey(t){var e=t;let i=[],n=this.get(e),r=n;if(n!==void 0){for(;e;)i.splice(0,0,n.fi),e=this.parent(e),e!==null&&(n=this.get(e));return{...r,sortKey:i}}}insertBeforeHelper(t,e,i){return this.insertAfterHelper(t,this.previous(t,e),i)}insertAfterHelper(t,e,i){let n=this.childrenArray(t);if(e===null){if(n.length===0)return ed(0,i,i);{let r=n[0].fi;return ed(r-i,r,i)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=n.find(o=>o.fi>r.fi);if(s===void 0){let o=n[n.length-1].fi;return ed(o,o+i,i)}else return ed(r.fi,s.fi,i)}}},XC;(t=>{function e(i,n){if(n.type!==0)return null;if(Array.isArray(i)){let r=n.props,s={},o=[...i],a=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=o[c],o[c]=r[l],a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}else{let r=n.props,s={},o={...i},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let c=r[l];c===void 0?delete o[l]:o[l]=c,a=!0}return a?{data:o,actual:n,reverse:{type:0,props:s}}:null}}t.runOp=e})(XC||(XC={}));var jt=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,jt.prototype)}deepFreeze(){let t=0;for(;t<this.length;)oz(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){var e;return(e=this.get(t))==null?void 0:e.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let i=this,n=i.findIndex(s=>s.id===t);if(n<0)throw new Error("not expected");let r=i[n];return i=[...i],i[n]={...r,data:e},this.modifyArrayBy(i)}}modifyArrayBy(t){Object.setPrototypeOf(t,jt.prototype);let e=t;return oOe()||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:i,data:n}=t,r=this,s={fi:e,id:i,data:n};return r=[...r,s],r.sort((o,a)=>o.fi-a.fi),t.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:t,reverse:{type:5,id:i}}}deleteOp(t){let{id:e}=t,i=this,n=i.findIndex(s=>s.id===e);if(n===-1)return null;t.localIndex=n,i=[...i];let r=i.splice(n,1)[0];return{data:this.modifyArrayBy(i),actual:t,reverse:{type:4,...r}}}moveOp(t){let{fi:e,id:i}=t,n=this;n=[...n];let r=n.findIndex(a=>a.id===i);if(r===-1)return null;let s=n[r].fi,o={...n[r],fi:e};return n[r]=o,n.sort((a,l)=>a.fi-l.fi),t.localIndex=n.indexOf(o),{data:this.modifyArrayBy(n),actual:t,reverse:{type:6,fi:s,id:i}}}previous(t){if(t===null)return this.length===0?null:this[this.length-1].id;let e=null;for(let i of this){if(i.id===t)return e;e=i.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let i=this;if(t===null){if(i.length===0)return ed(0,e,e);{let n=i[0].fi;return ed(n-e,n,e)}}else{let n=this.get(t);if(n===void 0)throw new Error("illegal args");let r=i.find(s=>s.fi>n.fi);if(r===void 0){let s=i[i.length-1].fi;return ed(s,s+e,e)}else return ed(n.fi,r.fi,e)}}};function u0(t){return t&&typeof t=="object"&&t instanceof hr}var hr=class{unusedFunOverridesTable(t){}runOp(t){let e=[],i=this,n=0,r={};for(;n<t.path.length;){if(e.push(i),i=i===void 0?void 0:i[t.path[n]],i!==void 0&&!u0(i))return null;n+=1}i=i?S3(i):new hr;for(let[a,l]of Object.entries(t.props)){let c=i[a];r[a]=c,l===void 0?delete i[a]:i[a]=l}for(;n>0;){if(Object.keys(i).length===0){let a=e[n-1];a&&(i=S3(a),delete i[t.path[n-1]])}else{let a=e[n-1];if(a){let l=S3(a);l[t.path[n-1]]=i,i=l}else{let l=new hr;l[t.path[n-1]]=i,i=l}}n-=1}let s=Object.setPrototypeOf(i,hr.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},_d;(t=>{function e(r,s){return __(r,s)??r}t.apply=e;function i(r,s){return cz(r,s)}t.merge=i;function n(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=Mc.zoomOnce(l,a[o]),l===void 0)return s;if(!u0(l))return;o+=1}if(l===void 0)return s;if(u0(l))if(s.type===0){let c={...s.props};for(let h of Object.keys(l))delete c[h];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=lz([s],l);return c?(console.log(c),c):s}else return s}t.filterOp=n})(_d||(_d={}));function lz(t,e){if(e===void 0)return;let i=!1,n=t.map(r=>{let s=r.id,o=__(r.data,e[s]);if(i=i||o!==void 0,o===void 0&&(o=r.data),r.children){let a=lz(r.children,e);return a!==void 0?i=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(i)return n}function aOe(t,e){if(e===void 0)return;let i=!1,n=t.map(r=>{let s=r.id,o=__(r.data,e[s]);return i=i||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}function __(t,e){if(!u0(e))return e;if(t instanceof co){let i=lz(t,e);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof jt)return aOe(t,e);if(Array.isArray(t)){let i=!1,n=t.map((r,s)=>{let o=__(r,e[s]);return i=i||o!==void 0,o===void 0&&(o=r),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}else{if(t instanceof hr)return cz(t,e);if(t&&typeof t=="object"){let i={},n=!1;for(let[r,s]of Object.entries(t)){let o=__(s,e[r]);n=n||o!==void 0,o===void 0&&(o=s),i[r]=o}return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}}}}function cz(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!u0(e))return e;if(!u0(t))return _d.apply(t,e);let i=new Set;for(let r of Object.keys(t))i.add(r);for(let r of Object.keys(e))i.add(r);let n=new hr;for(let r of i){let s=cz(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);n[r]=s}return n}function lOe(t,e){let i={cur:[],result:[],len:0};return t=w_(t,e,i)??t,[t,i.result]}function qC(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function YC(t){t&&(t.len-=1)}function cOe(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function Dee(t,e,i){let n=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=w_(s.data,e,qC(i,o));YC(i),n=n||l!==void 0,l===void 0&&(l=s.data);let c=Dee(s.children,e,i);return c!==void 0?n=!0:c=s.children,{...s,id:o,data:l,children:c}});if(n)return r}function uOe(t,e,i){let n=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(n=!0,o=a,i!==null))throw new Error("not supported");let l=w_(s.data,e,qC(i,o));return YC(i),n=n||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(n)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function w_(t,e,i){if(t instanceof co){let n=Dee(t,e,i);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof jt)return uOe(t,e,i);if(Array.isArray(t)){let n=!1,r=t.map((s,o)=>{let a=w_(s,e,qC(i,o));return YC(i),n=n||a!==void 0,a===void 0&&(a=s),a});return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!az(t)){let n={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"&&s!=="text"){let a=e[s];if(typeof a=="string"){if(i!==null)throw new Error("not supported");r=!0,s=a}let l=w_(o,e,qC(i,s));YC(i),r=r||l!==void 0,l===void 0&&(l=o),n[s]=l}else n[s]=o;return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}else if(typeof t=="string"){let n=e[t];if(n!==void 0){if(t.length!==36)throw new Error("for now you should only call this method when the key is a uuid");cOe(i)}return n}else return}}var xR;(t=>{function e(i,n){let r=Mc.zoom(n,i.path);if(typeof r=="object"){let s={};for(let o of Object.keys(i.props))s[o]=r[o];return{...i,props:s}}else return{...i,props:{}}}t.replaceProps=e})(xR||(xR={}));var No;(t=>{function e(l,c){return{...l,path:l.path.slice(c)}}t.drop=e;function i(l,c){var h;return((h=n(l,c))==null?void 0:h.data)??l}t.applySimple=i;function n(l,c){var d,f;let h=c.path;for(var u=[];;){let p;if(l instanceof hr&&c.type===0&&(p=l.runOp({...c,path:h.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===h.length&&(l instanceof co||l instanceof jt||l instanceof Qn?p=l.runOp(c):p=XC.runOp(l,c)),p!==void 0)if(p!==null){let v=p.data;for(let y=u.length-1;y>=0;y--){let x=h[y],b=u[y];if(b instanceof co){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof jt){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof Qn){if(typeof x=="number")throw new Error("illegal arg");v=b.modifyById(x,v)}else if(b instanceof hr){let S={...b,[x]:v};v=Object.setPrototypeOf(S,hr.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let S=v;v=[...b],v[x]=S}else v={...b,[x]:v};else return null}return{data:v,actual:{...p.actual,path:h},reverse:{...p.reverse,path:h}}}else return null;let m=h[u.length],g;if(l instanceof co){if(typeof m=="number")throw new Error("");g=(d=l.get(m))==null?void 0:d.data}else if(l instanceof jt){if(typeof m=="number")throw new Error("");g=(f=l.get(m))==null?void 0:f.data}else l!==null&&(g=l[m]);if(g!==void 0)u.push(l),l=g;else return null}}t.apply=n;function r(l,c){for(let h=0;h<l.length&&h<c.length;h++)if(l[h]!==c[h])return!0;return!1}t.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let h=0;h<l.length;h++)if(l[h]!==c[h])return!1;return!0}t.pathEq=s;function o(l,c){return r(l.path,c.path)}t.commutative=o;function a(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(h=>c.props[h]!==void 0):!1}t.subsumed=a})(No||(No={}));var IW;(t=>{function e(){return[]}t.empty=e;function i(c,h){let u=[];for(let d of c){let[f,...p]=d.path;f===h&&u.push({...d,path:p})}return u}t.removePrefix=i;function n(c,h){return c.map(u=>({...u,path:[h,...u.path]}))}t.addPrefix=n;function r(c,h){return[...c,...h]}t.concat=r;function s(c,h){return[...c.filter(u=>!h.some(d=>No.subsumed(u,d))),...h]}t.compress=s;function o(c,h){return c.every(u=>h.every(d=>No.commutative(u,d)))}t.commutative=o;function a(c,h){for(let u of h){let d=l(c,u);d!==null&&(c=d.data)}return c}t.applyAll=a;function l(c,h){var u=c;let d=[],f=[];for(let p of h)try{if(p.type===3){let m=Mc.zoom(u,[...p.path,p.id]),g=No.apply(u,{...p,type:2});if(g!==null){u=g.data;let[v,y]=lOe(u,{[p.id]:m});u=v;for(let x of y){let b=x[x.length-1];x.splice(x.length-1,1),d.push({type:0,path:x,props:{[b]:m}}),f.push({type:0,path:x,props:{[b]:p.id}})}f.push(g.reverse),d.push(g.actual)}}else{let m=No.apply(u,p);m!==null&&(d.push(m.actual),u=m.data,f.push(m.reverse))}}catch(m){if(m instanceof Eee)return null;throw m}return{data:u,actual:d,reverse:f.reverse()}}t.apply=l})(IW||(IW={}));var Iee=Symbol(),hOe=Symbol(),TT=Symbol(),ww=class{reportOp(t,e,i=[]){let n=this;if(e===null)return;n._current=e.data;let r=i;for(;!(n instanceof Bee);){let s=n._path,o=n._current;if(s!==""&&r.splice(0,0,s),n=n._parent,n===null)return;n.update(s,o)}n.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let i=e[TT];i&&i(),delete this._children[t]}}}},dOe=class extends ww{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,XC.runOp(this._current,t),t.path)}},fOe=class extends ww{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,Qn.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},Lee={get(t,e){if(e===TT)return()=>{t._parent=null};if(e===Iee)return t._current;if(e===hOe)return t;let{_current:i,_children:n}=t;if(e==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let r=n===void 0?void 0:n[e];if(r!==void 0)return r;let s=i[e],o=PT(t,e,s);return o!==s?(n===void 0&&(n={},t._children=n),n[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let i=t._current,n=Reflect.getOwnPropertyDescriptor(i,e);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:i[e]}}},pOe={...Lee,set(t,e,i){let n={type:0,props:{[e]:Lr(i)??i}};return t.deleteChildren(e),t.runOp(n),!0},deleteProperty(t,e){let i={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(i),!0}},mOe={...Lee,set(t,e,i){return i===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:i})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},uz=class extends ww{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[TT]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,i)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:i}=this,n=i===void 0?void 0:i[t];if(n!==void 0)return n;let r=(o=e.get(t))==null?void 0:o.data,s=PT(this,t,r);return s!==r?(i===void 0&&(i={},this._children=i),i[t]=s,s):r}add(t,e,i,n,r){this.runOp({type:7,parent:t,fi:e,id:i,data:n,children:r})}move(t,e,i){this.runOp({type:9,parent:t,fi:e,id:i})}insertAfter(t,e,i){let n=this._current.insertAfterHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(t,n[r],s.id,s.data,s.children)}}insertBefore(t,e,i){let n=this._current.insertBeforeHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(t,n[r],s.id,s.data,s.children)}}moveAfter(t,e,i){let n=this._current.insertAfterHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(t,n[r],s)}}moveBefore(t,e,i){let n=this._current.insertBeforeHelper(t,e,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(t,n[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},hz=class extends ww{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[TT]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let i=0;i<e;i++){let n=this._current[i].id,r=this._current[i].fi;t(this.data(this._current[i].id),n,r)}}find(t){let e=this.length;for(let i=0;i<e;i++){let n=this._current[i].id;if(t(this.data(n),n))return this.get(n)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:i}=this,n=i===void 0?void 0:i[t];if(n!==void 0)return n;let r=(o=e.get(t))==null?void 0:o.data,s=PT(this,t,r);return s!==r?(i===void 0&&(i={},this._children=i),i[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,i){this.runOp({type:4,fi:t,id:e,data:i})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.add(i[n],r.id,r.data)}}insertBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.add(i[n],r.id,r.data)}}moveAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.move(i[n],r)}}moveBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let n=0;n<e.length;n++){let r=e[n];this.move(i[n],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function A3(t,e,i){if(t.length>0){let n=t[t.length-1];if(n.type===0&&e.type===0&&Mc.equal(n.path,i)){Object.assign(n.props,e.props);return}}t.push({...e,path:i})}var Bee=class extends ww{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,i,n){A3(this.ts,e,t),A3(this.actual,i,t),A3(this.reverse,n,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function PT(t,e,i){return i instanceof co?new uz(t,e,i):i instanceof jt?new hz(t,e,i):i instanceof Qn?new Proxy(new fOe(t,e,i),mOe):i!==null&&typeof i=="object"?az(i)?i:new Proxy(new dOe(t,e,i),pOe):i}function Ree(t){let e=new Bee(t);return[PT(e,"",t),e]}function QC(t,e){let[i,n]=Ree(t);return e(i),n.result()}function Lr(t){return t instanceof uz||t instanceof hz?t._current:t!==null&&typeof t=="object"?t[Iee]:t}var Mc;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function i(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(h=>{delete c[h]}),c}else return o}t.removeOverridden=i;function n(s,o){if((s instanceof co||s instanceof uz)&&typeof o=="string"||(s instanceof jt||s instanceof hz)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=n;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=n(s,o[a]),a+=1;return s}t.zoom=r})(Mc||(Mc={}));function gOe(t,e){let i=[];if(e.length===t.length)for(var n=0;n<t.length;){if(e[n]==="*")i.push(t[n]);else if(t[n]!==e[n])return null;n+=1}else return null;return i}function Ta(t,e){let i=[];if(e.length<=t.length)for(var n=0;n<e.length;){if(e[n]==="*")i.push(t[n]);else if(t[n]!==e[n])return null;n+=1}else return null;return i}var Oee=class{},LW=class extends Oee{constructor(t){super(),this.id=t}},BW=class extends Oee{constructor(t){super(),this.data=t}},_R;try{_R=new TextDecoder}catch{}var ft,wd,Ce=0,Js={},Si,td,ba=0,pc=0,Po,Uu,Os=[],Ei,RW={useRecords:!1,mapsAsObjects:!0},Fee=class{},Nee=new Fee;Nee.name="MessagePack 0xC1";var h0=!1,JC=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(ft)return Hee(()=>(bR(),this?this.unpack(t,e):JC.prototype.unpack.call(RW,t,e)));wd=e>-1?e:t.length,Ce=0,pc=0,td=null,Po=null,ft=t;try{Ei=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(i){throw ft=null,t instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof JC){if(Js=this,this.structures)return Si=this.structures,fA();(!Si||Si.length>0)&&(Si=[])}else Js=RW,(!Si||Si.length>0)&&(Si=[]);return fA()}unpackMultiple(t,e){let i,n=0;try{h0=!0;let r=t.length,s=this?this.unpack(t,r):IT.unpack(t,r);if(e){for(e(s);Ce<r;)if(n=Ce,e(fA())===!1)return}else{for(i=[s];Ce<r;)n=Ce,i.push(fA());return i}}catch(r){throw r.lastPosition=n,r.values=i,r}finally{h0=!1,bR()}}_mergeStructures(t,e){t=t||[];for(let i=0,n=t.length;i<n;i++){let r=t[i];r&&(r.isShared=!0,i>=32&&(r.highByte=i-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let n=t[i],r=e[i];r&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[i]=n),t[i]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function fA(){try{if(!Js.trusted&&!h0){let e=Si.sharedLength||0;e<Si.length&&(Si.length=e)}let t=Mn();if(Ce==wd)Si.restoreStructures&&OW(),Si=null,ft=null,Uu&&(Uu=null);else if(Ce>wd){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!h0)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Si.restoreStructures&&OW(),bR(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function OW(){for(let t in Si.restoreStructures)Si[t]=Si.restoreStructures[t];Si.restoreStructures=null}function Mn(){let t=ft[Ce++];if(t<160)if(t<128){if(t<64)return t;{let e=Si[t&63]||Js.getStructures&&kee()[t&63];return e?(e.read||(e.read=dz(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Js.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[Uee()]=Mn();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(Mn(),Mn());return e}else{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=Mn();return e}else if(t<192){let e=t-160;if(pc>=Ce)return td.slice(Ce-ba,(Ce+=e)-ba);if(pc==0&&wd<140){let i=e<16?fz(e):zee(e);if(i!=null)return i}return wR(e)}else{let e;switch(t){case 192:return null;case 193:return Po?(e=Mn(),e>0?Po[1].slice(Po.position1,Po.position1+=e):Po[0].slice(Po.position0,Po.position0-=e)):Nee;case 194:return!1;case 195:return!0;case 196:return M3(ft[Ce++]);case 197:return e=Ei.getUint16(Ce),Ce+=2,M3(e);case 198:return e=Ei.getUint32(Ce),Ce+=4,M3(e);case 199:return Ef(ft[Ce++]);case 200:return e=Ei.getUint16(Ce),Ce+=2,Ef(e);case 201:return e=Ei.getUint32(Ce),Ce+=4,Ef(e);case 202:if(e=Ei.getFloat32(Ce),Js.useFloat32>2){let i=pz[(ft[Ce]&127)<<1|ft[Ce+1]>>7];return Ce+=4,(i*e+(e>0?.5:-.5)>>0)/i}return Ce+=4,e;case 203:return e=Ei.getFloat64(Ce),Ce+=8,e;case 204:return ft[Ce++];case 205:return e=Ei.getUint16(Ce),Ce+=2,e;case 206:return e=Ei.getUint32(Ce),Ce+=4,e;case 207:return Js.int64AsNumber?(e=Ei.getUint32(Ce)*4294967296,e+=Ei.getUint32(Ce+4)):e=Ei.getBigUint64(Ce),Ce+=8,e;case 208:return Ei.getInt8(Ce++);case 209:return e=Ei.getInt16(Ce),Ce+=2,e;case 210:return e=Ei.getInt32(Ce),Ce+=4,e;case 211:return Js.int64AsNumber?(e=Ei.getInt32(Ce)*4294967296,e+=Ei.getUint32(Ce+4)):e=Ei.getBigInt64(Ce),Ce+=8,e;case 212:if(e=ft[Ce++],e==114)return UW(ft[Ce++]&63);{let i=Os[e];if(i)return i.read?(Ce++,i.read(Mn())):i.noBuffer?(Ce++,i()):i(ft.subarray(Ce,++Ce));throw new Error("Unknown extension "+e)}case 213:return e=ft[Ce],e==114?(Ce++,UW(ft[Ce++]&63,ft[Ce++])):Ef(2);case 214:return Ef(4);case 215:return Ef(8);case 216:return Ef(16);case 217:return e=ft[Ce++],pc>=Ce?td.slice(Ce-ba,(Ce+=e)-ba):yOe(e);case 218:return e=Ei.getUint16(Ce),Ce+=2,pc>=Ce?td.slice(Ce-ba,(Ce+=e)-ba):xOe(e);case 219:return e=Ei.getUint32(Ce),Ce+=4,pc>=Ce?td.slice(Ce-ba,(Ce+=e)-ba):_Oe(e);case 220:return e=Ei.getUint16(Ce),Ce+=2,NW(e);case 221:return e=Ei.getUint32(Ce),Ce+=4,NW(e);case 222:return e=Ei.getUint16(Ce),Ce+=2,kW(e);case 223:return e=Ei.getUint32(Ce),Ce+=4,kW(e);default:if(t>=224)return t-256;if(t===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+t)}}}var vOe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function dz(t,e){function i(){if(i.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>vOe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Mn);return t.highByte===0&&(t.read=FW(e,t.read)),r()}let n={};for(let r=0,s=t.length;r<s;r++){let o=t[r];n[o]=Mn()}return n}return i.count=0,t.highByte===0?FW(e,i):i}var FW=(t,e)=>function(){let i=ft[Ce++];if(i===0)return e();let n=t<32?-(t+(i<<5)):t+(i<<5),r=Si[n]||kee()[n];if(!r)throw new Error("Record id is not defined for "+n);return r.read||(r.read=dz(r,t)),r.read()};function kee(){let t=Hee(()=>(ft=null,Js.getStructures()));return Si=Js._mergeStructures(t,Si)}var wR=DT,yOe=DT,xOe=DT,_Oe=DT;function DT(t){let e;if(t<16&&(e=fz(t)))return e;if(t>64&&_R)return _R.decode(ft.subarray(Ce,Ce+=t));let i=Ce+t,n=[];for(e="";Ce<i;){let r=ft[Ce++];if(!(r&128))n.push(r);else if((r&224)===192){let s=ft[Ce++]&63;n.push((r&31)<<6|s)}else if((r&240)===224){let s=ft[Ce++]&63,o=ft[Ce++]&63;n.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=ft[Ce++]&63,o=ft[Ce++]&63,a=ft[Ce++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|l&1023),n.push(l)}else n.push(r);n.length>=4096&&(e+=Mr.apply(String,n),n.length=0)}return n.length>0&&(e+=Mr.apply(String,n)),e}function NW(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=Mn();return e}function kW(t){if(Js.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[Uee()]=Mn();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(Mn(),Mn());return e}}var Mr=String.fromCharCode;function zee(t){let e=Ce,i=new Array(t);for(let n=0;n<t;n++){let r=ft[Ce++];if((r&128)>0){Ce=e;return}i[n]=r}return Mr.apply(String,i)}function fz(t){if(t<4)if(t<2){if(t===0)return"";{let e=ft[Ce++];if((e&128)>1){Ce-=1;return}return Mr(e)}}else{let e=ft[Ce++],i=ft[Ce++];if((e&128)>0||(i&128)>0){Ce-=2;return}if(t<3)return Mr(e,i);let n=ft[Ce++];if((n&128)>0){Ce-=3;return}return Mr(e,i,n)}else{let e=ft[Ce++],i=ft[Ce++],n=ft[Ce++],r=ft[Ce++];if((e&128)>0||(i&128)>0||(n&128)>0||(r&128)>0){Ce-=4;return}if(t<6){if(t===4)return Mr(e,i,n,r);{let s=ft[Ce++];if((s&128)>0){Ce-=5;return}return Mr(e,i,n,r,s)}}else if(t<8){let s=ft[Ce++],o=ft[Ce++];if((s&128)>0||(o&128)>0){Ce-=6;return}if(t<7)return Mr(e,i,n,r,s,o);let a=ft[Ce++];if((a&128)>0){Ce-=7;return}return Mr(e,i,n,r,s,o,a)}else{let s=ft[Ce++],o=ft[Ce++],a=ft[Ce++],l=ft[Ce++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Ce-=8;return}if(t<10){if(t===8)return Mr(e,i,n,r,s,o,a,l);{let c=ft[Ce++];if((c&128)>0){Ce-=9;return}return Mr(e,i,n,r,s,o,a,l,c)}}else if(t<12){let c=ft[Ce++],h=ft[Ce++];if((c&128)>0||(h&128)>0){Ce-=10;return}if(t<11)return Mr(e,i,n,r,s,o,a,l,c,h);let u=ft[Ce++];if((u&128)>0){Ce-=11;return}return Mr(e,i,n,r,s,o,a,l,c,h,u)}else{let c=ft[Ce++],h=ft[Ce++],u=ft[Ce++],d=ft[Ce++];if((c&128)>0||(h&128)>0||(u&128)>0||(d&128)>0){Ce-=12;return}if(t<14){if(t===12)return Mr(e,i,n,r,s,o,a,l,c,h,u,d);{let f=ft[Ce++];if((f&128)>0){Ce-=13;return}return Mr(e,i,n,r,s,o,a,l,c,h,u,d,f)}}else{let f=ft[Ce++],p=ft[Ce++];if((f&128)>0||(p&128)>0){Ce-=14;return}if(t<15)return Mr(e,i,n,r,s,o,a,l,c,h,u,d,f,p);let m=ft[Ce++];if((m&128)>0){Ce-=15;return}return Mr(e,i,n,r,s,o,a,l,c,h,u,d,f,p,m)}}}}}function M3(t){return Js.copyBuffers?Uint8Array.prototype.slice.call(ft,Ce,Ce+=t):ft.subarray(Ce,Ce+=t)}function Ef(t){let e=ft[Ce++];if(Os[e])return Os[e](ft.subarray(Ce,Ce+=t));throw new Error("Unknown extension type "+e)}var zW=new Array(4096);function Uee(){let t=ft[Ce++];if(t>=160&&t<192){if(t=t-160,pc>=Ce)return td.slice(Ce-ba,(Ce+=t)-ba);if(!(pc==0&&wd<180))return wR(t)}else return Ce--,Mn();let e=(t<<5^(t>1?Ei.getUint16(Ce):t>0?ft[Ce]:0))&4095,i=zW[e],n=Ce,r=Ce+t-3,s,o=0;if(i&&i.bytes==t){for(;n<r;){if(s=Ei.getUint32(n),s!=i[o++]){n=1879048192;break}n+=4}for(r+=3;n<r;)if(s=ft[n++],s!=i[o++]){n=1879048192;break}if(n===r)return Ce=n,i.string;r-=3,n=Ce}for(i=[],zW[e]=i,i.bytes=t;n<r;)s=Ei.getUint32(n),i.push(s),n+=4;for(r+=3;n<r;)s=ft[n++],i.push(s);let a=t<16?fz(t):zee(t);return a!=null?i.string=a:i.string=wR(t)}var UW=(t,e)=>{var i=Mn();let n=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let r=Si[t];return r&&r.isShared&&((Si.restoreStructures||(Si.restoreStructures=[]))[t]=r),Si[t]=i,i.read=dz(i,n),i.read()},Gee=typeof self=="object"?self:global;Os[0]=()=>{};Os[0].noBuffer=!0;Os[101]=()=>{let t=Mn();return(Gee[t[0]]||Error)(t[1])};Os[105]=t=>{let e=Ei.getUint32(Ce-4);Uu||(Uu=new Map);let i=ft[Ce],n;i>=144&&i<160||i==220||i==221?n=[]:n={};let r={target:n};Uu.set(e,r);let s=Mn();return r.used?Object.assign(n,s):(r.target=s,s)};Os[112]=t=>{let e=Ei.getUint32(Ce-4),i=Uu.get(e);return i.used=!0,i.target};Os[115]=()=>new Set(Mn());var Vee=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");Os[116]=t=>{let e=t[0],i=Vee[e];if(!i)throw new Error("Could not find typed array for code "+e);return new Gee[i](Uint8Array.prototype.slice.call(t,1).buffer)};Os[120]=()=>{let t=Mn();return new RegExp(t[0],t[1])};Os[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=Ce;Ce+=e-4,Po=[Mn(),Mn()],Po.position0=0,Po.position1=0;let n=Ce;Ce=i;try{return Mn()}finally{Ce=n}};Os[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function Hee(t){let e=wd,i=Ce,n=ba,r=pc,s=td,o=Uu,a=Po,l=new Uint8Array(ft.slice(0,wd)),c=Si,h=Si.slice(0,Si.length),u=Js,d=h0,f=t();return wd=e,Ce=i,ba=n,pc=r,td=s,Uu=o,Po=a,ft=l,h0=d,Si=c,Si.splice(0,Si.length,...h),Js=u,Ei=new DataView(ft.buffer,ft.byteOffset,ft.byteLength),f}function bR(){ft=null,Uu=null,Si=null}function wOe(t){t.unpack?Os[t.type]=t.unpack:Os[t.type]=t}var pz=new Array(147);for(let t=0;t<256;t++)pz[t]=+("1e"+Math.floor(45.15-t*.30103));var IT=new JC({useRecords:!1});IT.unpack;IT.unpackMultiple;IT.unpack;var bOe=new Float32Array(1);new Uint8Array(bOe.buffer,0,4);var PM;try{PM=new TextEncoder}catch{}var KC,mz,LT=typeof Buffer<"u",C3=LT?Buffer.allocUnsafeSlow:Uint8Array,jee=LT?Buffer:Uint8Array,GW=LT?4294967296:2144337920,He,Bn,Oe=0,Xl,ql=null,SOe=/[\u0080-\uFFFF]/,$y=Symbol("record-id"),Wee=class extends JC{constructor(t){super(t),this.offset=0;let e,i,n,r,s,o=0,a=jee.prototype.utf8Write?function(A,E,M){return He.utf8Write(A,E,M)}:PM&&PM.encodeInto?function(A,E){return PM.encodeInto(A,He.subarray(E)).written}:!1,l=this;t||(t={});let c=t&&t.sequential,h=t.structures||t.saveStructures,u=t.maxSharedStructures;if(u==null&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=t.maxOwnStructures;d==null&&(d=h?32:64),c&&!t.saveStructures&&(this.structures=[]);let f=u>32||d+u>64,p=u+64,m=u+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(A,E){if(He||(He=new C3(8192),Bn=new DataView(He.buffer,0,8192),Oe=0),Xl=He.length-10,Xl-Oe<2048?(He=new C3(He.length),Bn=new DataView(He.buffer,0,He.length),Xl=He.length-10,Oe=0):Oe=Oe+7&2147483640,e=Oe,s=l.structuredClone?new Map:null,l.bundleStrings?(ql=["",""],He[Oe++]=214,He[Oe++]=98,ql.position=Oe-e,Oe+=4):ql=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let M=i.sharedLength||0;if(M>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let T=0;T<M;T++){let P=i[T];if(!P)continue;let I,k=i.transitions;for(let R=0,F=P.length;R<F;R++){let V=P[R];I=k[V],I||(I=k[V]=Object.create(null)),k=I}k[$y]=T+64}o=M}c||(i.nextId=M+64)}n&&(n=!1),r=i||[];try{if(x(A),ql){Bn.setUint32(ql.position+e,Oe-ql.position-e);let M=ql;ql=null,x(M[0]),x(M[1])}if(l.offset=Oe,s&&s.idsToInsert){Oe+=s.idsToInsert.length*6,Oe>Xl&&S(Oe),l.offset=Oe;let M=MOe(He.subarray(e,Oe),s.idsToInsert);return s=null,M}return E&COe?(He.start=e,He.end=Oe,He):He.subarray(e,Oe)}finally{if(i){if(y<10&&y++,v>1e4)i.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let M=0,T=g.length;M<T;M++)g[M][$y]=0;g=[]}if(n&&l.saveStructures){let M=i.sharedLength||u;i.length>M&&(i=i.slice(0,M));let T=He.subarray(e,Oe);return l.saveStructures(i,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(A)):(o=M,T)}}E&EOe&&(Oe=e)}};let x=A=>{Oe>Xl&&(He=S(Oe));var E=typeof A,M;if(E==="string"){let T=A.length;if(ql&&T>=8&&T<4096){let k=SOe.test(A);ql[k?0:1]+=A,He[Oe++]=193,x(k?-T:T);return}let P;T<32?P=1:T<256?P=2:T<65536?P=3:P=5;let I=T*3;if(Oe+I>Xl&&(He=S(Oe+I)),T<64||!a){let k,R,F,V=Oe+P;for(k=0;k<T;k++)R=A.charCodeAt(k),R<128?He[V++]=R:R<2048?(He[V++]=R>>6|192,He[V++]=R&63|128):(R&64512)===55296&&((F=A.charCodeAt(k+1))&64512)===56320?(R=65536+((R&1023)<<10)+(F&1023),k++,He[V++]=R>>18|240,He[V++]=R>>12&63|128,He[V++]=R>>6&63|128,He[V++]=R&63|128):(He[V++]=R>>12|224,He[V++]=R>>6&63|128,He[V++]=R&63|128);M=V-Oe-P}else M=a(A,Oe+P,I);M<32?He[Oe++]=160|M:M<256?(P<2&&He.copyWithin(Oe+2,Oe+1,Oe+1+M),He[Oe++]=217,He[Oe++]=M):M<65536?(P<3&&He.copyWithin(Oe+3,Oe+2,Oe+2+M),He[Oe++]=218,He[Oe++]=M>>8,He[Oe++]=M&255):(P<5&&He.copyWithin(Oe+5,Oe+3,Oe+3+M),He[Oe++]=219,Bn.setUint32(Oe,M),Oe+=4),Oe+=M}else if(E==="number")if(A>>>0===A)A<64?He[Oe++]=A:A<256?(He[Oe++]=204,He[Oe++]=A):A<65536?(He[Oe++]=205,He[Oe++]=A>>8,He[Oe++]=A&255):(He[Oe++]=206,Bn.setUint32(Oe,A),Oe+=4);else if(A>>0===A)A>=-32?He[Oe++]=256+A:A>=-128?(He[Oe++]=208,He[Oe++]=A+256):A>=-32768?(He[Oe++]=209,Bn.setInt16(Oe,A),Oe+=2):(He[Oe++]=210,Bn.setInt32(Oe,A),Oe+=4);else{let T;if((T=this.useFloat32)>0&&A<4294967296&&A>=-2147483648){He[Oe++]=202,Bn.setFloat32(Oe,A);let P;if(T<4||(P=A*pz[(He[Oe]&127)<<1|He[Oe+1]>>7])>>0===P){Oe+=4;return}else Oe--}He[Oe++]=203,Bn.setFloat64(Oe,A),Oe+=8}else if(E==="object")if(!A)He[Oe++]=192;else{if(s){let P=s.get(A);if(P){if(!P.id){let I=s.idsToInsert||(s.idsToInsert=[]);P.id=I.push(P)}He[Oe++]=214,He[Oe++]=112,Bn.setUint32(Oe,P.id),Oe+=4;return}else s.set(A,{offset:Oe-e})}let T=A.constructor;if(T===Object)b(A,!0);else if(T===Array){M=A.length,M<16?He[Oe++]=144|M:M<65536?(He[Oe++]=220,He[Oe++]=M>>8,He[Oe++]=M&255):(He[Oe++]=221,Bn.setUint32(Oe,M),Oe+=4);for(let P=0;P<M;P++)x(A[P])}else if(T===Map){M=A.size,M<16?He[Oe++]=128|M:M<65536?(He[Oe++]=222,He[Oe++]=M>>8,He[Oe++]=M&255):(He[Oe++]=223,Bn.setUint32(Oe,M),Oe+=4);for(let[P,I]of A)x(P),x(I)}else{for(let P=0,I=KC.length;P<I;P++){let k=mz[P];if(A instanceof k){let R=KC[P];if(R.write){R.type&&(He[Oe++]=212,He[Oe++]=R.type,He[Oe++]=0),x(R.write.call(this,A));return}let F=He,V=Bn,Q=Oe;He=null;let X;try{X=R.pack.call(this,A,z=>(He=F,F=null,Oe+=z,Oe>Xl&&S(Oe),{target:He,targetView:Bn,position:Oe-z}),x)}finally{F&&(He=F,Bn=V,Oe=Q,Xl=He.length-10)}X&&(X.length+Oe>Xl&&S(X.length+Oe),Oe=AOe(X,He,Oe,R.type));return}}b(A,!A.hasOwnProperty)}}else if(E==="boolean")He[Oe++]=A?195:194;else if(E==="bigint"){if(A<BigInt(1)<<BigInt(63)&&A>=-(BigInt(1)<<BigInt(63)))He[Oe++]=211,Bn.setBigInt64(Oe,A);else if(A<BigInt(1)<<BigInt(64)&&A>0)He[Oe++]=207,Bn.setBigUint64(Oe,A);else if(this.largeBigIntToFloat)He[Oe++]=203,Bn.setFloat64(Oe,Number(A));else throw new RangeError(A+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Oe+=8}else if(E==="undefined")this.encodeUndefinedAsNil?He[Oe++]=192:(He[Oe++]=212,He[Oe++]=0,He[Oe++]=0);else if(E==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+E)},b=this.useRecords===!1?this.variableMapSize?A=>{let E=Object.keys(A),M=E.length;M<16?He[Oe++]=128|M:M<65536?(He[Oe++]=222,He[Oe++]=M>>8,He[Oe++]=M&255):(He[Oe++]=223,Bn.setUint32(Oe,M),Oe+=4);let T;for(let P=0;P<M;P++)x(T=E[P]),x(A[T])}:(A,E)=>{He[Oe++]=222;let M=Oe-e;Oe+=2;let T=0;for(let P in A)(E||A.hasOwnProperty(P))&&(x(P),x(A[P]),T++);He[M+++e]=T>>8,He[M+e]=T&255}:A=>{let E=Object.keys(A),M,T=r.transitions||(r.transitions=Object.create(null)),P=0;for(let k=0,R=E.length;k<R;k++){let F=E[k];M=T[F],M||(M=T[F]=Object.create(null),P++),T=M}let I=T[$y];if(I)I>=96&&f?(He[Oe++]=((I-=96)&31)+96,He[Oe++]=I>>5):He[Oe++]=I;else{I=r.nextId,I||(I=64),I<p&&this.shouldShareStructure&&!this.shouldShareStructure(E)?(I=r.nextOwnId,I<m||(I=p),r.nextOwnId=I+1):(I>=m&&(I=p),r.nextId=I+1);let k=E.highByte=I>=96&&f?I-96>>5:-1;T[$y]=I,r[I-64]=E,I<p?(E.isShared=!0,r.sharedLength=I-63,n=!0,k>=0?(He[Oe++]=(I&31)+96,He[Oe++]=k):He[Oe++]=I):(k>=0?(He[Oe++]=213,He[Oe++]=114,He[Oe++]=(I&31)+96,He[Oe++]=k):(He[Oe++]=212,He[Oe++]=114,He[Oe++]=I),P&&(v+=y*P),g.length>=d&&(g.shift()[$y]=0),g.push(T),x(E))}for(let k=0,R=E.length;k<R;k++)x(A[E[k]])},S=A=>{let E;if(A>16777216){if(A-e>GW)throw new Error("Packed buffer would be larger than maximum buffer size");E=Math.min(GW,Math.round(Math.max((A-e)*(A>67108864?1.25:2),4194304)/4096)*4096)}else E=(Math.max(A-e<<2,He.length-1)>>12)+1<<12;let M=new C3(E);return Bn=new DataView(M.buffer,0,E),He.copy?He.copy(M,0,e,A):M.set(He.slice(e,A)),Oe-=e,e=0,Xl=M.length-10,He=M}}useBuffer(t){He=t,Bn=new DataView(He.buffer,He.byteOffset,He.byteLength),Oe=0}};mz=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Fee];KC=[{pack(t,e,i){let n=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,n)}else if(n>0&&n<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(o+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(n)))}}},{pack(t,e,i){let n=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),i(n)}},{pack(t,e,i){let{target:n,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=101,n[r++]=0),i([t.name,t.message])}},{pack(t,e,i){let{target:n,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=120,n[r++]=0),i([t.source,t.flags])}},{pack(t,e){this.structuredClone?VW(t,16,e):HW(LT?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==jee&&this.structuredClone?VW(t,Vee.indexOf(i.name),e):HW(t,e)}},{pack(t,e){let{target:i,position:n}=e(1);i[n]=193}}];function VW(t,e,i,n){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=i(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=i(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=i(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function HW(t,e){let i=t.byteLength;var n,r;if(i<256){var{target:n,position:r}=e(i+2);n[r++]=196,n[r++]=i}else if(i<65536){var{target:n,position:r}=e(i+3);n[r++]=197,n[r++]=i>>8,n[r++]=i&255}else{var{target:n,position:r,targetView:s}=e(i+5);n[r++]=198,s.setUint32(r,i),r+=4}n.set(t,r)}function AOe(t,e,i,n){let r=t.length;switch(r){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:r<256?(e[i++]=199,e[i++]=r):r<65536?(e[i++]=200,e[i++]=r>>8,e[i++]=r&255):(e[i++]=201,e[i++]=r>>24,e[i++]=r>>16&255,e[i++]=r>>8&255,e[i++]=r&255)}return e[i++]=n,e.set(t,i),i+=r,i}function MOe(t,e){let i,n=e.length*6,r=t.length-n;for(e.sort((s,o)=>s.offset>o.offset?1:-1);i=e.pop();){let s=i.offset,o=i.id;t.copyWithin(s+n,s,r),n-=6;let a=s+n;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function j0(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");mz.unshift(t.Class),KC.unshift(t)}wOe(t)}var Xee=new Wee({useRecords:!1});Xee.pack;Xee.pack;var COe=512,EOe=1024,jW=new Wee({structuredClone:!0});j0({Class:Qn.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Qn.prototype),t}});j0({Class:jt.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,jt.prototype),t}});j0({Class:co.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,co.prototype),t}});j0({Class:LW.prototype.constructor,type:4,write(t){return t.id},read(t){return new LW(t)}});j0({Class:BW.prototype.constructor,type:5,write(t){return t.data},read(t){return new BW(t)}});j0({Class:hr.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,hr.prototype),t}});function TOe(t){var e=0;if(t.length===0)return e;for(let i=0;i<t.length;i++){let n=t[i];e=(e<<5)-e+n,e=e&e}return e}function SR(t){if(az(t))return t;if(Array.isArray(t))return t.map(SR);if(typeof t=="object"&&t!==null){let e={};for(let i of Object.keys(t).sort())e[i]=SR(t[i]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var AR;(t=>{function e(r){return jW.pack(r)}t.serialize=e;function i(r){return jW.unpack(r)}t.deserialize=i;function n(r){return TOe(e(SR(r))).toString()}t.checksum=n})(AR||(AR={}));var Yl={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Create"],MouseHover:["Transition","Animation","Create","Destroy","SwitchCamera","SceneTransition"],Scroll:["Transition","Animation","Create"],Start:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition"],Conditional:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MousePress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","SceneTransition","Reset"],KeyDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyPress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","Reset"],GameControl:["Transition","Animation","Audio","Video","Create"],Collision:["Transition","Animation","Audio","Video","Create","Destroy","Reset"],Trigger:["Transition","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"]},WW;(t=>{function e(n){return n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"}t.is=e;function i(n){return n==="MouseDown"||n==="MouseUp"||n==="MousePress"?{type:n,mode:"Object",disabled:!1,toggle:!1,actions:new jt}:{type:n,disabled:!1,key:void 0,toggle:!1,actions:new jt}}t.defaultData=i})(WW||(WW={}));var ZC;(t=>{function e(i){return{type:"Property",value:[i??null,"position","x"]}}t.propertyDefaultData=e,t.valueDefaultData={type:"Literal",value:0}})(ZC||(ZC={}));var MR;(t=>{function e(r){return{type:"Comparison",operator:"==",lOperand:ZC.propertyDefaultData(r),rOperand:{...ZC.valueDefaultData}}}t.comparisonDefaultData=e;function i(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}t.distanceDefaultData=i;function n(r,s){return{type:"State",object:r??null,state:s??null}}t.stateDefaultData=n})(MR||(MR={}));var XW;(t=>{function e(n){return n.type==="Conditional"}t.is=e;function i(n){return{type:"Conditional",disabled:!1,inActions:new jt,outActions:new jt,condition:MR.distanceDefaultData(n)}}t.defaultData=i})(XW||(XW={}));var qW;(t=>t.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new jt,drop:new jt}})(qW||(qW={}));var CR;(t=>t.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new jt})(CR||(CR={}));var ER;(t=>t.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(ER||(ER={}));var YW;(t=>{function e(n){return n.type==="MouseHover"}t.is=e;function i(){return{type:"MouseHover",disabled:!1,actions:new jt}}t.defaultData=i})(YW||(YW={}));var QW;(t=>{function e(n){return n.type==="Scroll"}t.is=e;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new jt}}t.defaultData=i})(QW||(QW={}));var JW;(t=>{function e(n){return n.type==="Start"}t.is=e;function i(){return{type:"Start",disabled:!1,actions:new jt}}t.defaultData=i})(JW||(JW={}));var KW;(t=>{function e(n){return n.type==="Collision"}t.is=e;function i(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new jt}}t.defaultData=i})(KW||(KW={}));var ZW;(t=>{function e(n){return n.type==="Trigger"}t.is=e;function i(n,r){return{type:"Trigger",disabled:!1,toggle:!1,target:"all",triggeringObjects:[],actions:new jt,triggerZone:"box",position:r.toArray(),rotation:[0,0,0],size:n.toArray(),radius:n.length()/2,helperVisible:!0}}t.defaultData=i})(ZW||(ZW={}));var W0="personal camera",f1="a218fcc3-276b-49b9-b485-49037fd14f5f",POe=2960946,ja=5526619,rv;(t=>{function e(n,r){return n[0]===r[0]&&n[1]===r[1]}t.isEqual=e;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s]}t.lerp=i})(rv||(rv={}));var Dp;(t=>{function e(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}t.isEqual=e;function i(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}t.add=i;function n(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}t.sub=n;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}t.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}t.mul=s;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}t.dist=o;function a(l,c,h){return[l[0]+(c[0]-l[0])*h,l[1]+(c[1]-l[1])*h,l[2]+(c[2]-l[2])*h]}t.lerp=a})(Dp||(Dp={}));var $C;(t=>{function e(n,r){return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]}t.isEqual=e;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s,n[2]+(r[2]-n[2])*s,n[3]+(r[3]-n[3])*s]}t.lerp=i})($C||($C={}));var d0;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function i(r){return r??t.identity}t.simplify=i;function n(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let c=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/c,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/c,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/c}return o}t.applyMatrix4=n})(d0||(d0={}));var Cs;(t=>{function e(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}t.toRgb255a1=i;function n(l){return{r:l.r,g:l.g,b:l.b}}t.clone=n;function r(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}t.fromHex=r;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}t.toHex=s;function o(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}t.equals=o;function a(l,c,h){return{r:l.r+(c.r-l.r)*h,g:l.g+(c.g-l.g)*h,b:l.b+(c.b-l.b)*h}}t.lerp=a})(Cs||(Cs={}));var vl;(t=>{t.white={...Cs.white,a:1},t.transparent={...Cs.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function i(o,a){return{...Cs.fromHex(o),a}}t.fromHexAndA=i;function n(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=n;function r(o,a){return Cs.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(vl||(vl={}));var TR;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(TR||(TR={}));var $W;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})($W||($W={}));var e8;(t=>t.defaultData={control1:[.5,0],control2:[.5,1]})(e8||(e8={}));var Gh;(t=>(t.linear=[0,0,1,1],t.ease=[.25,.1,.25,1],t.easeIn=[.42,0,1,1],t.easeOut=[0,0,.58,1],t.easeInOut=[.42,0,.58,1]))(Gh||(Gh={}));var Qp;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(i){return t.all.includes(i)}t.is=e})(Qp||(Qp={}));var f0;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(i){return i.type==="PerspectiveCamera"?i.perspective.zoom:i.orthographic.zoom}t.getZoom=e})(f0||(f0={}));var id;(t=>{function e(n,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(n[0],n[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[n[0]+n[0]*r,0,0]},grid:{count:[2,2,2],size:n.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function i(n,r){let s={...n};if(qee.forEach(o=>{Object.assign(s,{[o]:r[o]??n[o]})}),s.radial={...n.radial},r.radial){let o=n.radial,a=r.radial;Yee.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...n.linear},r.linear){let o=n.linear,a=r.linear;Qee.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...n.grid},r.grid){let o=n.grid,a=r.grid;Jee.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...n.toObject},r.toObject){let o=n.toObject,a=r.toObject;Kee.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...n.randomnessObject},r.randomnessObject){let o=n.randomnessObject,a=r.randomnessObject;Zee.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=i})(id||(id={}));var PR;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function i(n,r){let s=[];n.count!==void 0&&s.push({type:0,path:r,props:{count:n.count}});for(let o of e){let a=n[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=i})(PR||(PR={}));var qee=["count"],Yee=["radius","start","end","position","scale","rotation"],Qee=["position","scale","rotation"],Jee=["count","size"],Kee=["count","position","scale","rotation"],Zee=["strength","scale","rotation","position","movement","seed","freqScale"],DR;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(i){return t.all.includes(i)}t.is=e})(DR||(DR={}));var IR;(t=>{function e(n){return i(n)}t.defaultData=e;function i(n){if(n==="PointLight")return{type:n,color:vl.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(n==="SpotLight")return{type:n,color:vl.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(n==="DirectionalLight")return{type:n,color:vl.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(IR||(IR={}));var p0;(t=>t.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(p0||(p0={}));var LR;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(i,n){return i.castShadow===n.castShadow&&i.receiveShadow===n.receiveShadow}t.equals=e})(LR||(LR={}));var BR;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(i,n){return i.flatShading===n.flatShading&&i.side===n.side&&i.wireframe===n.wireframe}t.equals=e})(BR||(BR={}));var RR;(t=>t.defaultData={...BR.defaultData,...LR.defaultData})(RR||(RR={}));var eE;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(eE||(eE={}));var t8;(t=>{function e(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}t.is=e})(t8||(t8={}));function DOe(t){return t.type!=="displace"}var i8;(t=>{function e(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}t.is=e})(i8||(i8={}));var $ee=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],IOe=["wrapping","image","video","name"],Xs;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let c=s.texture;c&&Object.assign(c,a)}}t.patch=e;function i(s,o){return s==="light"&&o?n(o):r(s)}t.defaultData=i;function n(s){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function r(s){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:eE.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...o,type:"color",color:Cs.fromHex(ja)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Cs.fromHex(6710886),a:1},colorB:{...Cs.fromHex(6710886),a:1},colorC:{...Cs.fromHex(16777215),a:1},colorD:{...Cs.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:vl.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:vl.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:vl.fromHexAndA(0,1),contourColor:vl.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...Cs.fromHex(0),a:1},colorB:{...Cs.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Xs||(Xs={}));var uo;(t=>{function e(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}t.isMergable=e;function i(c){let h="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([d,f])=>{h+=`${d}${f}`,Array.isArray(f)?f.forEach(p=>h+=`${p}`):typeof f=="object"?Object.values(f).forEach(p=>{typeof p=="number"?h+=`${p.toFixed(4)}`:h+=`${p}`}):h+=`${f}`})}),h}t.getHash=i;function n(){return{layers:new jt}}t.defaultEmptyData=n;function r(c="layer1",h="layer2"){return o("phong",c,h)}t.defaultData=r;function s(c,h){return{...c,name:h}}t.withName=s;function o(c,h="layer1",u="layer2"){let d=new jt;return d.push({fi:0,data:Xs.defaultData("light",c),id:h}),d.push({fi:1,data:Xs.defaultData("color"),id:u}),{layers:d}}t.defaultTwoLayerData=o;function a(c,h="phong",u="layer1",d="layer2"){let f=Xs.defaultData("texture");Object.assign(f.texture,{image:c});let p=new jt;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Xs.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerTextureData=a;function l(c,h="phong",u="layer1",d="layer2"){let f=Xs.defaultData("video");Object.assign(f.texture,{video:c});let p=new jt;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Xs.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerVideoTextureData=l})(uo||(uo={}));var tE;(t=>{function e(){return{points:new jt,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(tE||(tE={}));var iE;(t=>{function e(){return{points:new jt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(iE||(iE={}));var ete={type:"Ellipse",width:100,height:100,spikes:16,angle:360,innerRadius:0},OR;(t=>{function e(i,n){let r={...i};return ite.forEach(s=>{Object.assign(r,{[s]:n[s]??i[s]})}),r}t.merge=e})(OR||(OR={}));var tte={shape:ete,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},ite=["depth","offset","angle","twist","startScale","endScale"],nE;(t=>{function e(n){return n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"}t.is2DParametricMesh=e;function i(n){return n==="PolygonGeometry"||n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"||n==="PathGeometry"||n==="VectorGeometry"||n==="ConeGeometry"||n==="CubeGeometry"||n==="CylinderGeometry"||n==="DodecahedronGeometry"||n==="HelixGeometry"||n==="IcosahedronGeometry"||n==="LatheGeometry"||n==="PyramidGeometry"||n==="SphereGeometry"||n==="PlaneGeometry"||n==="BackdropGeometry"||n==="TorusGeometry"||n==="TorusKnotGeometry"||n==="BooleanGeometry"||n==="TextGeometry"}t.isParametricMesh=i})(nE||(nE={}));var FR;(t=>{function e(i,n){let r={...i};return Object.assign(r,n),r.type==="PathGeometry"&&"extrusion"in n&&n.extrusion&&(r.extrusion={...i.extrusion},Object.assign(r.extrusion,OR.merge(r.extrusion,n.extrusion))),r}t.merge=e})(FR||(FR={}));var Sv;(t=>{function e(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:iE.defaultData(),extrusion:tte};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:tE.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}t.defaultData=e})(Sv||(Sv={}));var n8=["width","height","depth"],NR;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:Cs.white,near:.1,far:2e3})(NR||(NR={}));var rE;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(rE||(rE={}));var kR;(t=>t.defaultData={softShadowQuality:"low"})(kR||(kR={}));var zR;(t=>t.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(zR||(zR={}));var UR;(t=>t.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(UR||(UR={}));var m0;(t=>t.defaultData={usePhysics:!1,gravity:-10})(m0||(m0={}));var GR;(t=>t.defaultData={playCamera:W0,gameControlObject:null})(GR||(GR={}));var VR;(t=>t.defaultData={backgroundColor:vl.fromHexAndA(POe,1),postprocessing:rE.defaultData,fog:NR.defaultData,globalPhysics:m0.defaultData,ambient:zR.defaultData,ao:UR.defaultData,shadow:kR.defaultData,publish:GR.defaultData})(VR||(VR={}));var r8;(t=>{function e(n){return n==="Component"||n==="Instance"}t.isComponentRelated=e;function i(n){return n==="Empty"||n==="Instance"}t.isEmptyOrComponent=i})(r8||(r8={}));var g0;(t=>{t.identity={...TR.identity,hiddenMatrix:d0.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function i(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=i;function n(r,s){return URe({position:Dp.isEqual(r.position,s.position)?void 0:s.position,rotation:Dp.isEqual(r.rotation,s.rotation)?void 0:s.rotation,scale:Dp.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:d0.isEqual(r.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}t.diff=n})(g0||(g0={}));var Bs;(t=>t.defaultData={states:new jt,events:new jt,visible:!0,raycastLock:!1,physics:p0.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...g0.identity,cloner:null})(Bs||(Bs={}));var s8;(t=>t.defaultData={type:"Empty",...Bs.defaultData})(s8||(s8={}));var o8;(t=>t.defaultData={type:"Component",...Bs.defaultData})(o8||(o8={}));var Av;(t=>t.defaultData={type:"Mesh",...Bs.defaultData,...RR.defaultData})(Av||(Av={}));var b_;(t=>t.defaultData={...Bs.defaultData,...g0.identity,position:[0,0,f0.DefaultTargetOffset],...f0.defaultData})(b_||(b_={}));var HR;(t=>{function e(i){return{...Bs.defaultData,...IR.defaultData(i)}}t.defaultData=e,t.defaultDirectionalLightData={...t.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(HR||(HR={}));var sE;(t=>{function e(n,r,s=0){for(;s<r.length;){let o=n?n[r[s]]:void 0;if(r.length===s+1)return o;if(o)n=o.descendants,s+=1;else return}}t.resolveWithDes=e;function i(n,r,s=0){let o=e(n,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=i})(sE||(sE={}));var nd;(t=>{t.rootOverrideProps=["physics","events"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(n,r){return{...Bs.defaultData,...r,component:n,overrides:new hr,physics:void 0,events:void 0,type:"Instance"}}t.ofComponent=e;function i(n){let r=g0.fromObject(n.data);return e(n.id,r)}t.fromComponentData=i})(nd||(nd={}));var v0;(t=>t.defaultData={type:"Page",...Bs.defaultData,physics:{...p0.defaultData,fusedBody:!1},...VR.defaultData,camera:b_.defaultData})(v0||(v0={}));var jR;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:d0.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:p0.defaultData,states:new jt,events:new jt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...f0.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...Bs.defaultData,...Av.defaultData,geometry:Sv.defaultData("RectangleGeometry"),material:uo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...Bs.defaultData,...Av.defaultData,geometry:Sv.defaultData("BooleanGeometry"),material:uo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...Bs.defaultData,...Av.defaultData,geometry:Sv.defaultData("TextGeometry"),material:uo.defaultTwoLayerData("phong","layer1","layer2")}))(jR||(jR={}));var cp;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new hr}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new hr})))):Qp.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function i(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=QC(a.material,l=>{if(typeof l!="string")for(let[c,h]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&Xs.patch(u,h)}}).data),a.materials&&o.materials&&(a.materials=QC(a.materials,l=>{var c,h;for(let u=0;u<a.materials.length;u++){let d=o.materials[u];if(typeof d!="string")for(let[f,p]of Object.entries(d.layers)){let m=(h=(c=l[u])==null?void 0:c.layers)==null?void 0:h.data(f);m&&Xs.patch(m,p)}}}).data),a}function n(s,o){let a,l=[],c={orthographic:0,perspective:0,geometry:0};function h(u,d){for(let[f,p]of Object.entries(d.layers)){let{texture:m,...g}=p;if(m!==void 0&&Object.keys(m).length>0){let v={path:[...u,"layers",f,"texture"],props:m,type:0};l.push(v)}if(Object.keys(g).length>0){let v={path:[...u,"layers",f],props:g,type:0};l.push(v)}}}for(let[u,d]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...PR.toOps(d,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:d.slide,offset:d.offset},type:0});else if(u==="material")h(["material"],d);else if(u==="materials")for(let[f,p]of Object.entries(d))h(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&d.extrusion!==void 0){let f={path:[u,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[u],props:d,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[u]=d;return l}t.toOps=n;function r(s,o){var l,c,h,u,d,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,g0.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=a.pathSnapping)==null?void 0:c.slide)??0,offset:((h=o.pathSnapping)==null?void 0:h.offset)??((u=a.pathSnapping)==null?void 0:u.offset)??0})}),Qp.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let p=o;((d=p.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(a.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:FR.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=i(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:id.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:id.merge(a.cloner,o.cloner)});else if(DR.is(s.type)){let p=o;p.intensity!==void 0&&(a.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?a.color=p.color:a.color=Cs.clone(p.color))}return a}t.patch=r})(cp||(cp={}));var oE;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(oE||(oE={}));var Ip;(t=>t.defaultData={orbitControls:oE.defaultData,playPage:f1,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((e,i)=>{let n=0,r=0;return i<5?r=-30:i<10&&(r=30),i===0||i===10||i===5?n=30:(i===4||i===11||i===9)&&(n=-30),[120,[n,r],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(Ip||(Ip={}));var WR;(t=>t.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(WR||(WR={}));var XR;(t=>t.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(XR||(XR={}));var Mv;(t=>(t.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...WR.defaultData},isRandomSeed:!0,seed:t.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:XR.defaultData}),t.generateSeed=()=>Math.round(Math.random()*1e5)))(Mv||(Mv={}));var S_;(t=>{function e(n){return n.find(r=>r.data.type==="Page"&&r.data.globalPhysics.usePhysics)!==void 0}t.physicsEnabled=e;function i(n,r,s){n.traverseFrom(r,(o,a)=>{if(a.type==="Instance"){let l=n.data(a.component);l&&s(o,a,l.events)}else s(o,a,a.events)})}t.traverseModuleInstances=i})(S_||(S_={}));var qR;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(r={withLight:!0,withSquare:!0}){let s=[],o=jR.defaultMeshObject;r.withLight===!0&&s.push({fi:-1,data:HR.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]});let a=new co;return a.push({fi:1,id:f1,data:{...v0.defaultData,name:"Scene 1"},children:s}),a}t.defaultData={objects:e(),publish:Ip.defaultData,styles:Mv.defaultData()},t.emptyDataWithoutPage=function(){return{objects:new co,publish:Ip.defaultData,styles:Mv.defaultData()}},t.emptyDataWithPage=function(r){return{objects:e(r),publish:Ip.defaultData,styles:Mv.defaultData()}};function i(r){return{...t.defaultData,objects:Yp(r,co.prototype)}}t.withObjs=i;function n(r,s){return i([{id:r,data:s,children:[],fi:0}])}t.withObj=n})(qR||(qR={}));var aE;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(aE||(aE={}));var YR;(t=>{function e(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Yp(r,Qn.prototype)}t.defaultColors=e;function i(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...aE.emptyImage,name:"AI generated image"}),Yp(s,Qn.prototype)}t.defaultImages=i;function n(){return{materials:new Qn,images:new Qn,videos:new Qn,colors:new Qn,audios:new Qn,fonts:new Qn}}t.emptyData=n})(YR||(YR={}));var QR;(t=>t.list=["idle","move","jump","run"])(QR||(QR={}));var lE;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new jt,move:new jt,jump:new jt,run:new jt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:vl.fromHexAndA(3728051,1)}}))(lE||(lE={}));function a8(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let i=e.colorA,n=e.colorB,r=[[i.r,i.g,i.b,i.a],[n.r,n.g,n.b,n.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...zu(Lr(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let i={...Lr(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,i)}})}function jh(t,e){Object.values(t.shared.materials).forEach(i=>e(i))}function Wh(t,e){t.scene.objects.traverse((i,n)=>{"materials"in n?n.materials.forEach((r,s)=>{r===void 0&&(n.materials[s]=uo.defaultData(),r=n.materials[s]),typeof r!="string"&&e(r)}):"material"in n&&typeof n.material!="string"&&e(n.material),"overrides"in n&&Object.values(n.overrides).forEach(r=>{r.material&&typeof r.material!="string"&&e(r.material)})})}function LOe(t){Object.assign(t.scene.publish,{orbitControls:{...oE.defaultData,...Lr(t.scene.publish.orbitControls)}})}function BOe(t){Object.assign(t.scene.publish.settings,{video:{...Ip.defaultData.settings.video,...Lr(t.scene.publish.settings.video)}})}function ROe(t){function e(i){if(i.layers){for(let n of Object.values(i.layers))if(n){for(let[r,s]of Object.entries(n))if(($ee.includes(r)||typeof s=="boolean")&&delete n[r],r==="texture")for(let[o,a]of Object.entries(s))(IOe.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((i,n)=>{n.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function OOe(t){t.scene.publish.withBackground=!0}function FOe(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function NOe(t){t.scene.objects.traverse((e,i)=>{let n=i.cloner;n&&(n.radial.scale=n.radial.scale.map(r=>r+1),n.linear.scale=n.linear.scale.map(r=>r+1))})}function kOe(t){t.scene.objects.traverse((e,i)=>{let n=i.geometry;n&&(n.type==="DodecahedronGeometry"||n.type==="IcosahedronGeometry")&&(n.detail=Math.round(n.detail))})}function zOe(t){t.scene.objects.traverse((e,i)=>{let n=t.scene.objects.unproxy().parent(e);if(n){let r=Lr(t.scene.objects.data(n));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=Lr(i).booleanExclude!==!0)}})}function UOe(t){t.scene.objects.traverse((e,i)=>{if(i.type==="Mesh"){let n=i;i.geometry.type==="NonParametricGeometry"?n.material!==void 0&&delete n.material:n.materials!==void 0&&delete n.materials}})}function GOe(t){function e(n){Object.setPrototypeOf(n,hr.prototype),n.texture&&Object.setPrototypeOf(n.texture,hr.prototype)}function i(n){Object.setPrototypeOf(n,hr.prototype);for(let r in n)e(n[r])}t.scene.objects.traverse((n,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=Lr(o.material).layers;i(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],c=Lr(l).layers;i(c),l.layers=c}})})}function l8(t){t.layers===void 0&&Object.assign(t,uo.defaultTwoLayerData("lambert"))}function E3(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let i=[...e.colors];i.push(e.colors[9]);let n=[...e.steps];n.push(e.steps[9]);let r={...Lr(e),colors:i,steps:n};Object.assign(e,r)}})}function VOe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function c8(t){t.scene.objects.traverse((e,i)=>{"materials"in i?i.materials.forEach(n=>{typeof n!="string"&&E3(n)}):"material"in i&&typeof i.material!="string"&&E3(i.material)}),Object.values(t.shared.materials).forEach(e=>E3(e))}function HOe(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function jOe(t){t.shared.audios=Yp({},Qn.prototype)}function WOe(t){t.shared.videos=Yp({},Qn.prototype)}function XOe(t){let e=t.shared.materials;Object.entries(e).forEach(([i,n])=>{if(!n.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[i]:r})}})}function qOe(t){Object.entries(Lr(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(Lr(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function YOe(t){t.scene.publish.settings.web.preload=!1}function u8(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function h8(t){t.layers&&t.layers.forEach(e=>{DOe(e)&&e.isMask===void 0&&(e.isMask=!1),(e.type==="texture"||e.type==="video")&&e.blending===void 0&&(e.blending=0),(e.type==="noise"||e.type==="displace"&&e.displacementType==="noise")&&(e.voronoiStyle===void 0&&(e.voronoiStyle=0),e.highCut===void 0&&(e.highCut=1),e.lowCut===void 0&&(e.lowCut=0),e.smoothness===void 0&&(e.smoothness=.3),e.seed===void 0&&(e.seed=0),e.quality===void 0&&(e.quality=1))})}function QOe(t){t.shared.fonts=Yp({},Qn.prototype)}function JOe(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function KOe(t){let e=[];t.scene.objects.traverse((i,n)=>{let r=n;if(r.type==="TextFrame"){let s=uo.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=JOe(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,...Bs.defaultData,...Av.defaultData,flatShading:!1,wireframe:!1,geometry:{...Sv.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Lr(r.states),events:Lr(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=Lr(t.scene.objects).parent(i);t.scene.objects.insertAfter(c??null,i,[{id:i+"new",data:l,children:[]}]),e.push(i)}}),e.forEach(i=>{t.scene.objects.delete(i)})}function ZOe(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((i,n)=>{n.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new jt,move:new jt,jump:new jt}});else{let s=new jt;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:ri.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},h={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(h,zu(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(h,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...u,...h},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new jt({fi:0,id:ri.generateUUID(),data:c},{fi:1,id:ri.generateUUID(),data:d})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function $Oe(t){t.scene.objects.traverse((e,i)=>{function n(r,s){var l;let o=new jt,a=[];if(i.events.forEach((c,h,u)=>{if(c.type==="Audio"&&c.trigger===s){let d;a.push(h),c.interaction==="play"?d={...zu(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...zu(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:u,id:h,data:d})}}),a.forEach(c=>i.events.delete(c)),o.length){let c=(l=i.events.find(h=>h.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):i.events.insertBefore(null,[{id:ri.generateUUID(),data:{type:r,actions:o}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")})}function d8(t){var i;let e=(i=t.layers.find(n=>n.type==="light"))==null?void 0:i.data;if((e==null?void 0:e.category)==="basic"){let n=Xs.defaultData("light","phong"),r=e;Object.assign(r,n),r.visible=!1}}function f8(t){jh(t,d8),Wh(t,d8)}function eFe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function tFe(t){t.scene.objects.traverse((e,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function iFe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=uo.defaultTwoLayerData("phong"))})}function nFe(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function rFe(t){t.scene.objects.traverse((e,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function sFe(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function oFe(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function aFe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.resetYPosition=Math.abs(n.resetYPosition-i.position[1]))})})}function lFe(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((i,n)=>{e&&n.physics===null?n.collision=!1:n.collision="visibility"})}function cFe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.navmesh=lE.defaultDataThirdPerson.navmesh)})})}function uFe(t){t.scene.styles||(t.scene.styles=Mv.defaultData())}function p8(t){t.layers.forEach(e=>{e.type==="light"&&e.category!=="toon"&&e.occlusion===void 0&&(e.occlusion=!0)})}function hFe(t){t.scene.environment.ambientLight.occlusion===void 0&&(t.scene.environment.ambientLight.occlusion=!1),t.scene.environment.ambientLight.aoFullRes===void 0&&(t.scene.environment.ambientLight.aoFullRes=!1),t.scene.environment.ambientLight.radius===void 0&&(t.scene.environment.ambientLight.radius=256),t.scene.environment.ambientLight.bias===void 0&&(t.scene.environment.ambientLight.bias=.5),t.scene.environment.ambientLight.aoColor===void 0&&(t.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Wh(t,p8),jh(t,p8)}function dFe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&Object.assign(n.gameActions,{run:new jt})})})}function fFe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.keyAssignments=[...n.keyAssignments,["run",""],["none","Ctrl"]])})})}function m8(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.bumpMapIntensity===void 0&&(e.bumpMapIntensity=5)})}function pFe(t,e){if(e<1&&(Wh(t,a8),jh(t,a8),t.schema=1),e<2&&(LOe(t),t.schema=2),e<3&&(ROe(t),t.schema=3),e<4&&(OOe(t),t.schema=4),e<5&&(FOe(t),t.schema=5),e<6&&(NOe(t),t.schema=6),e<7&&(kOe(t),t.schema=7),e<8&&(t.schema=8),e<9&&(c8(t),t.schema=9),e<10&&(VOe(t),t.schema=10),e<11&&(HOe(t),t.schema=11),e<12&&(c8(t),t.schema=12),e<13&&(jOe(t),t.schema=13),e<14&&(XOe(t),t.schema=14),e<15&&(qOe(t),t.schema=15),e<16&&(YOe(t),t.schema=16),e<17&&(Wh(t,u8),jh(t,u8),t.schema=17),e<18&&(Wh(t,l8),jh(t,l8),t.schema=18),e<19&&(BOe(t),t.schema=19),e<20&&(QOe(t),KOe(t),t.schema=20),e<21&&(ZOe(t),$Oe(t),t.schema=21),e<22&&(f8(t),t.schema=22),e<23&&(eFe(t),t.schema=23),e<24&&(tFe(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(WOe(t),e<25&&(t.schema=25)),e<26&&(zOe(t),t.schema=26),e<27&&(UOe(t),t.schema=27),e<28&&(f8(t),t.schema=28),e<29&&(GOe(t),t.schema=29),e<30&&(iFe(t),t.schema=30),e<31&&(nFe(t),t.schema=31),e<33&&(rFe(t),t.schema=33),e<34&&(sFe(t),t.schema=34),e<35&&(oFe(t),t.schema=35),e<36&&(aFe(t),t.schema=36),e<37&&(lFe(t),t.schema=37),e<38&&(Wh(t,h8),jh(t,h8),t.schema=38),e<39&&(cFe(t),t.schema=39),e<40&&(uFe(t),t.schema=40),e<41&&(hFe(t),t.schema=41),e<42&&(dFe(t),t.schema=42),e<43&&(fFe(t),t.schema=43),e<99){Wh(t,m8),jh(t,m8),t.scene.publish.playCamera===null&&(t.scene.publish.playCamera=W0);let i=Lr(t.scene.objects),n=t.scene.objects;t.scene.publish.playPage=f1,n.insertBefore(null,null,[{id:f1,data:{...v0.defaultData,backgroundColor:t.scene.backgroundColor,fog:t.scene.fog,postprocessing:t.scene.postprocessing,ao:zu(t.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:t.scene.publish.playCamera,gameControlObject:t.scene.publish.gameControlObject},shadow:zu(t.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...m0.defaultData,...zu(t.scene.environment,"usePhysics","gravity")},camera:Lr(t.scene.ownerCamera)??v0.defaultData.camera,name:"Scene"},children:[]}]);for(let o of i)o.id!==qR.TRASH_CAN_ID&&n.move(f1,o.fi,o.id);let r=0,s=0;t.shared.penumbraSize&&t.scene.objects.traverse((o,a)=>{a.type==="DirectionalLight"?(a.penumbraSize=t.shared.penumbraSize[Math.min(r,2)],r+=1):a.type==="SpotLight"&&(a.penumbraSize=t.shared.penumbraSize[3+Math.min(s,1)],s+=1),(a.physics===void 0||a.physics===null)&&a.type!=="Instance"&&(a.physics={},Object.assign(a.physics,p0.defaultData)),a.physics!==void 0&&(a.physics.enabled=a.collision??"visibility",delete a.collision)}),t.schema=99}}function g8(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.alphaOverride===void 0&&(e.alphaOverride=1)})}function mFe(t){t.scene.objects.traverse((e,i)=>{let n=i.geometry;n&&n.type==="PathGeometry"&&(n.extrusion.capType="flat",n.extrusion.bevel=50,n.extrusion.bevelSides=6,n.extrusion.shape.type==="Custom"&&(n.extrusion.shape.shapeQuality="low"))})}var v8=102;function gFe(t){let e=t.schema??0;e!==v8&&(console.warn("updating from ",e,"to ",v8),pFe(t,e),e<100&&(t.scene.publish.joystickSizeAndXYOffset===void 0&&(t.scene.publish.joystickSizeAndXYOffset=Ip.defaultData.joystickSizeAndXYOffset),t.schema=100),e<101&&(Wh(t,g8),jh(t,g8),t.schema=101),e<102&&(mFe(t),t.schema=102))}function up(t,e=!1){let i=t[0].index!==null,n=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Rt,c=0;for(let h=0;h<t.length;++h){let u=t[h],d=0;if(i!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(e){let f;if(i)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,h),c+=f}}if(i){let h=0,u=[];for(let d=0;d<t.length;++d){let f=t[d].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+h);h+=t[d].attributes.position.count}l.setIndex(u)}for(let h in s){let u=y8(s[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(let h in o){let u=o[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){let f=[];for(let m=0;m<o[h].length;++m)f.push(o[h][m][d]);let p=y8(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(p)}}return l}function y8(t){let e,i,n,r=0;for(let a=0;a<t.length;++a){let l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=l.normalized),n!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new e(r),o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new Ot(s,i,n)}var vFe=Math.pow(2,-24),pA=class{constructor(){}};function mc(t,e,i){return i.min.x=e[t],i.min.y=e[t+1],i.min.z=e[t+2],i.max.x=e[t+3],i.max.y=e[t+4],i.max.z=e[t+5],i}function x8(t){let e=-1,i=-1/0;for(let n=0;n<3;n++){let r=t[n+3]-t[n];r>i&&(i=r,e=n)}return e}function _8(t,e){e.set(t)}function w8(t,e,i){let n,r;for(let s=0;s<3;s++){let o=s+3;n=t[s],r=e[s],i[s]=n<r?n:r,n=t[o],r=e[o],i[o]=n>r?n:r}}function mA(t,e,i){for(let n=0;n<3;n++){let r=e[t+2*n],s=e[t+2*n+1],o=r-s,a=r+s;o<i[n]&&(i[n]=o),a>i[n+3]&&(i[n+3]=a)}}function ex(t){let e=t[3]-t[0],i=t[4]-t[1],n=t[5]-t[2];return 2*(e*i+i*n+n*e)}function yFe(t,e){if(!t.index){let i=t.attributes.position.count,n=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;i>65535?r=new Uint32Array(new n(4*i)):r=new Uint16Array(new n(2*i)),t.setIndex(new Ot(r,1));for(let s=0;s<i;s++)r[s]=s}}function xFe(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];let e=[],i=new Set;for(let r of t.groups)i.add(r.start),i.add(r.start+r.count);let n=Array.from(i.values()).sort((r,s)=>r-s);for(let r=0;r<n.length-1;r++){let s=n[r],o=n[r+1];e.push({offset:s/3,count:(o-s)/3})}return e}function T3(t,e,i,n,r=null){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,m=-1/0,g=-1/0,v=r!==null;for(let y=e*6,x=(e+i)*6;y<x;y+=6){let b=t[y+0],S=t[y+1],A=b-S,E=b+S;A<s&&(s=A),E>l&&(l=E),v&&b<u&&(u=b),v&&b>p&&(p=b);let M=t[y+2],T=t[y+3],P=M-T,I=M+T;P<o&&(o=P),I>c&&(c=I),v&&M<d&&(d=M),v&&M>m&&(m=M);let k=t[y+4],R=t[y+5],F=k-R,V=k+R;F<a&&(a=F),V>h&&(h=V),v&&k<f&&(f=k),v&&k>g&&(g=k)}n[0]=s,n[1]=o,n[2]=a,n[3]=l,n[4]=c,n[5]=h,v&&(r[0]=u,r[1]=d,r[2]=f,r[3]=p,r[4]=m,r[5]=g)}function _Fe(t,e,i,n){let r=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let h=e*6,u=(e+i)*6;h<u;h+=6){let d=t[h+0];d<r&&(r=d),d>a&&(a=d);let f=t[h+2];f<s&&(s=f),f>l&&(l=f);let p=t[h+4];p<o&&(o=p),p>c&&(c=p)}n[0]=r,n[1]=s,n[2]=o,n[3]=a,n[4]=l,n[5]=c}function wFe(t,e,i,n,r){let s=i,o=i+n-1,a=r.pos,l=r.axis*2;for(;;){for(;s<=o&&e[s*6+l]<a;)s++;for(;s<=o&&e[o*6+l]>=a;)o--;if(s<o){for(let c=0;c<3;c++){let h=t[s*3+c];t[s*3+c]=t[o*3+c],t[o*3+c]=h;let u=e[s*6+c*2+0];e[s*6+c*2+0]=e[o*6+c*2+0],e[o*6+c*2+0]=u;let d=e[s*6+c*2+1];e[s*6+c*2+1]=e[o*6+c*2+1],e[o*6+c*2+1]=d}s++,o--}else return s}}var hu=32,bFe=(t,e)=>t.candidate-e.candidate,Ah=new Array(hu).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),gA=new Float32Array(6);function SFe(t,e,i,n,r,s){let o=-1,a=0;if(s===0)o=x8(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===1)o=x8(t),o!==-1&&(a=AFe(i,n,r,o));else if(s===2){let l=ex(t),c=1.25*r,h=n*6,u=(n+r)*6;for(let d=0;d<3;d++){let f=e[d],p=(e[d+3]-f)/hu;if(r<hu/4){let m=[...Ah];m.length=r;let g=0;for(let y=h;y<u;y+=6,g++){let x=m[g];x.candidate=i[y+2*d],x.count=0;let{bounds:b,leftCacheBounds:S,rightCacheBounds:A}=x;for(let E=0;E<3;E++)A[E]=1/0,A[E+3]=-1/0,S[E]=1/0,S[E+3]=-1/0,b[E]=1/0,b[E+3]=-1/0;mA(y,i,b)}m.sort(bFe);let v=r;for(let y=0;y<v;y++){let x=m[y];for(;y+1<v&&m[y+1].candidate===x.candidate;)m.splice(y+1,1),v--}for(let y=h;y<u;y+=6){let x=i[y+2*d];for(let b=0;b<v;b++){let S=m[b];x>=S.candidate?mA(y,i,S.rightCacheBounds):(mA(y,i,S.leftCacheBounds),S.count++)}}for(let y=0;y<v;y++){let x=m[y],b=x.count,S=r-x.count,A=x.leftCacheBounds,E=x.rightCacheBounds,M=0;b!==0&&(M=ex(A)/l);let T=0;S!==0&&(T=ex(E)/l);let P=1+1.25*(M*b+T*S);P<c&&(o=d,c=P,a=x.candidate)}}else{for(let v=0;v<hu;v++){let y=Ah[v];y.count=0,y.candidate=f+p+v*p;let x=y.bounds;for(let b=0;b<3;b++)x[b]=1/0,x[b+3]=-1/0}for(let v=h;v<u;v+=6){let y=~~((i[v+2*d]-f)/p);y>=hu&&(y=hu-1);let x=Ah[y];x.count++,mA(v,i,x.bounds)}let m=Ah[hu-1];_8(m.bounds,m.rightCacheBounds);for(let v=hu-2;v>=0;v--){let y=Ah[v],x=Ah[v+1];w8(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let v=0;v<hu-1;v++){let y=Ah[v],x=y.count,b=y.bounds,S=Ah[v+1].rightCacheBounds;x!==0&&(g===0?_8(b,gA):w8(b,gA,gA)),g+=x;let A=0,E=0;g!==0&&(A=ex(gA)/l);let M=r-g;M!==0&&(E=ex(S)/l);let T=1+1.25*(A*g+E*M);T<c&&(o=d,c=T,a=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function AFe(t,e,i,n){let r=0;for(let s=e,o=e+i;s<o;s++)r+=t[s*6+n*2];return r/i}function MFe(t,e){let i=t.attributes.position,n=t.index.array,r=n.length/3,s=new Float32Array(r*6),o=i.normalized,a=i.array,l=i.offset||0,c=3;i.isInterleavedBufferAttribute&&(c=i.data.stride);let h=["getX","getY","getZ"];for(let u=0;u<r;u++){let d=u*3,f=u*6,p,m,g;o?(p=n[d+0],m=n[d+1],g=n[d+2]):(p=n[d+0]*c+l,m=n[d+1]*c+l,g=n[d+2]*c+l);for(let v=0;v<3;v++){let y,x,b;o?(y=i[h[v]](p),x=i[h[v]](m),b=i[h[v]](g)):(y=a[p+v],x=a[m+v],b=a[g+v]);let S=y;x<S&&(S=x),b<S&&(S=b);let A=y;x>A&&(A=x),b>A&&(A=b);let E=(A-S)/2,M=v*2;s[f+M+0]=S+E,s[f+M+1]=E+(Math.abs(S)+E)*vFe,S<e[v]&&(e[v]=S),A>e[v+3]&&(e[v+3]=A)}}return s}function CFe(t,e){function i(v){d&&d(v/f)}function n(v,y,x,b=null,S=0){if(!p&&S>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),x<=h||S>=l)return i(y+x),v.offset=y,v.count=x,v;let A=SFe(v.boundingData,b,o,y,x,u);if(A.axis===-1)return i(y+x),v.offset=y,v.count=x,v;let E=wFe(a,o,y,x,A);if(E===y||E===y+x)i(y+x),v.offset=y,v.count=x;else{v.splitAxis=A.axis;let M=new pA,T=y,P=E-y;v.left=M,M.boundingData=new Float32Array(6),T3(o,T,P,M.boundingData,s),n(M,T,P,s,S+1);let I=new pA,k=E,R=x-P;v.right=I,I.boundingData=new Float32Array(6),T3(o,k,R,I.boundingData,s),n(I,k,R,s,S+1)}return v}yFe(t,e);let r=new Float32Array(6),s=new Float32Array(6),o=MFe(t,r),a=t.index.array,l=e.maxDepth,c=e.verbose,h=e.maxLeafTris,u=e.strategy,d=e.onProgress,f=t.index.count/3,p=!1,m=[],g=xFe(t);if(g.length===1){let v=g[0],y=new pA;y.boundingData=r,_Fe(o,v.offset,v.count,s),n(y,v.offset,v.count,s),m.push(y)}else for(let v of g){let y=new pA;y.boundingData=new Float32Array(6),T3(o,v.offset,v.count,y.boundingData,s),n(y,v.offset,v.count,s),m.push(y)}return m}function EFe(t,e){let i=CFe(t,e),n,r,s,o=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<i.length;h++){let u=i[h],d=l(u),f=new a(32*d);n=new Float32Array(f),r=new Uint32Array(f),s=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(h){return h.count?1:1+l(h.left)+l(h.right)}function c(h,u){let d=h/4,f=h/2,p=!!u.count,m=u.boundingData;for(let g=0;g<6;g++)n[d+g]=m[g];if(p){let g=u.offset,v=u.count;return r[d+6]=g,s[f+14]=v,s[f+15]=65535,h+32}else{let g=u.left,v=u.right,y=u.splitAxis,x;if(x=c(h+32,g),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=x/4,x=c(x,v),r[d+7]=y,x}}}var Ku=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,i){let n=1/0,r=-1/0;for(let s=0,o=e.length;s<o;s++){let a=e[s][i];n=a<n?a:n,r=a>r?a:r}this.min=n,this.max=r}setFromPoints(e,i){let n=1/0,r=-1/0;for(let s=0,o=i.length;s<o;s++){let a=i[s],l=e.dot(a);n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}isSeparated(e){return this.min>e.max||e.min>this.max}};Ku.prototype.setFromBox=function(){let t=new O;return function(e,i){let n=i.min,r=i.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){t.x=n.x*a+r.x*(1-a),t.y=n.y*l+r.y*(1-l),t.z=n.z*c+r.z*(1-c);let h=e.dot(t);s=Math.min(h,s),o=Math.max(h,o)}this.min=s,this.max=o}}();var TFe=function(){let t=new O,e=new O,i=new O;return function(n,r,s){let o=n.start,a=t,l=r.start,c=e;i.subVectors(o,l),t.subVectors(n.end,n.start),e.subVectors(r.end,r.start);let h=i.dot(c),u=c.dot(a),d=c.dot(c),f=i.dot(a),p=a.dot(a)*d-u*u,m,g;p!==0?m=(h*u-f*d)/p:m=0,g=(h+m*u)/d,s.x=m,s.y=g}}(),gz=function(){let t=new ge,e=new O,i=new O;return function(n,r,s,o){TFe(n,r,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1){n.at(a,s),r.at(l,o);return}else if(a>=0&&a<=1){l<0?r.at(0,o):r.at(1,o),n.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?n.at(0,s):n.at(1,s),r.closestPointToPoint(s,!0,o);return}else{let c;a<0?c=n.start:c=n.end;let h;l<0?h=r.start:h=r.end;let u=e,d=i;if(n.closestPointToPoint(h,!0,e),r.closestPointToPoint(c,!0,i),u.distanceToSquared(h)<=d.distanceToSquared(c)){s.copy(u),o.copy(h);return}else{s.copy(c),o.copy(d);return}}}}(),PFe=function(){let t=new O,e=new O,i=new Do,n=new Na;return function(r,s){let{radius:o,center:a}=r,{a:l,b:c,c:h}=s;if(n.start=l,n.end=c,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o||(n.start=l,n.end=h,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o)||(n.start=c,n.end=h,n.closestPointToPoint(a,!0,t).distanceTo(a)<=o))return!0;let u=s.getPlane(i);if(Math.abs(u.distanceToPoint(a))<=o){let d=u.projectPoint(a,e);if(s.containsPoint(d))return!0}return!1}}(),DFe=1e-15;function lg(t){return Math.abs(t)<DFe}var Zu=class extends ls{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new O),this.satBounds=new Array(4).fill().map(()=>new Ku),this.points=[this.a,this.b,this.c],this.sphere=new qo,this.plane=new Do,this.needsUpdate=!0}intersectsSphere(t){return PFe(t,this)}update(){let t=this.a,e=this.b,i=this.c,n=this.points,r=this.satAxes,s=this.satBounds,o=r[0],a=s[0];this.getNormal(o),a.setFromPoints(o,n);let l=r[1],c=s[1];l.subVectors(t,e),c.setFromPoints(l,n);let h=r[2],u=s[2];h.subVectors(e,i),u.setFromPoints(h,n);let d=r[3],f=s[3];d.subVectors(i,t),f.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,t),this.needsUpdate=!1}};Zu.prototype.closestPointToSegment=function(){let t=new O,e=new O,i=new Na;return function(n,r=null,s=null){let{start:o,end:a}=n,l=this.points,c,h=1/0;for(let u=0;u<3;u++){let d=(u+1)%3;i.start.copy(l[u]),i.end.copy(l[d]),gz(i,n,t,e),c=t.distanceToSquared(e),c<h&&(h=c,r&&r.copy(t),s&&s.copy(e))}return this.closestPointToPoint(o,t),c=o.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(o)),this.closestPointToPoint(a,t),c=a.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(a)),Math.sqrt(h)}}();Zu.prototype.intersectsTriangle=function(){let t=new Zu,e=new Array(3),i=new Array(3),n=new Ku,r=new Ku,s=new O,o=new O,a=new O,l=new O,c=new Na,h=new Na,u=new Na;return function(d,f=null,p=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let S=0;S<4;S++){let A=v[S],E=y[S];if(n.setFromPoints(E,i),A.isSeparated(n))return!1}let x=d.satBounds,b=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let S=0;S<4;S++){let A=x[S],E=b[S];if(n.setFromPoints(E,e),A.isSeparated(n))return!1}for(let S=0;S<4;S++){let A=y[S];for(let E=0;E<4;E++){let M=b[E];if(s.crossVectors(A,M),n.setFromPoints(s,e),r.setFromPoints(s,i),n.isSeparated(r))return!1}}return f&&(p||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let v=this.points,y=!1,x=0;for(let R=0;R<3;R++){let F=v[R],V=v[(R+1)%3];c.start.copy(F),c.end.copy(V),c.delta(o);let Q=y?h.start:h.end,X=lg(g.distanceToPoint(F));if(lg(g.normal.dot(o))&&X){h.copy(c),x=2;break}if((g.intersectLine(c,Q)||X)&&!lg(Q.distanceTo(V))){if(x++,y)break;y=!0}}if(x===1&&d.containsPoint(h.end))return f&&(f.start.copy(h.end),f.end.copy(h.end)),!0;if(x!==2)return!1;let b=d.points,S=!1,A=0;for(let R=0;R<3;R++){let F=b[R],V=b[(R+1)%3];c.start.copy(F),c.end.copy(V),c.delta(a);let Q=S?u.start:u.end,X=lg(m.distanceToPoint(F));if(lg(m.normal.dot(a))&&X){u.copy(c),A=2;break}if((m.intersectLine(c,Q)||X)&&!lg(Q.distanceTo(V))){if(A++,S)break;S=!0}}if(A===1&&this.containsPoint(u.end))return f&&(f.start.copy(u.end),f.end.copy(u.end)),!0;if(A!==2)return!1;if(h.delta(o),u.delta(a),o.dot(a)<0){let R=u.start;u.start=u.end,u.end=R}let E=h.start.dot(o),M=h.end.dot(o),T=u.start.dot(o),P=u.end.dot(o),I=M<T,k=E<P;return E!==P&&T!==M&&I===k?!1:(f&&(l.subVectors(h.start,u.start),l.dot(o)>0?f.start.copy(h.start):f.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(o)<0?f.end.copy(h.end):f.end.copy(u.end)),!0)}}}();Zu.prototype.distanceToPoint=function(){let t=new O;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();Zu.prototype.distanceToTriangle=function(){let t=new O,e=new O,i=["a","b","c"],n=new Na,r=new Na;return function(s,o=null,a=null){let l=o||a?n:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let h=0;h<3;h++){let u,d=i[h],f=s[d];this.closestPointToPoint(f,t),u=f.distanceToSquared(t),u<c&&(c=u,o&&o.copy(t),a&&a.copy(f));let p=this[d];s.closestPointToPoint(p,t),u=p.distanceToSquared(t),u<c&&(c=u,o&&o.copy(p),a&&a.copy(t))}for(let h=0;h<3;h++){let u=i[h],d=i[(h+1)%3];n.set(this[u],this[d]);for(let f=0;f<3;f++){let p=i[f],m=i[(f+1)%3];r.set(s[p],s[m]),gz(n,r,t,e);let g=t.distanceToSquared(e);g<c&&(c=g,o&&o.copy(t),a&&a.copy(e))}}return Math.sqrt(c)}}();var Bc=class{constructor(t,e,i){this.isOrientedBox=!0,this.min=new O,this.max=new O,this.matrix=new Qe,this.invMatrix=new Qe,this.points=new Array(8).fill().map(()=>new O),this.satAxes=new Array(3).fill().map(()=>new O),this.satBounds=new Array(3).fill().map(()=>new Ku),this.alignedSatBounds=new Array(3).fill().map(()=>new Ku),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}};Bc.prototype.update=function(){return function(){let t=this.matrix,e=this.min,i=this.max,n=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){let u=1*l|2*c|4*h,d=n[u];d.x=l?i.x:e.x,d.y=c?i.y:e.y,d.z=h?i.z:e.z,d.applyMatrix4(t)}let r=this.satBounds,s=this.satAxes,o=n[0];for(let l=0;l<3;l++){let c=s[l],h=r[l],u=1<<l,d=n[u];c.subVectors(o,d),h.setFromPoints(c,n)}let a=this.alignedSatBounds;a[0].setFromPointsField(n,"x"),a[1].setFromPointsField(n,"y"),a[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Bc.prototype.intersectsBox=function(){let t=new Ku;return function(e){this.needsUpdate&&this.update();let i=e.min,n=e.max,r=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(t.min=i.x,t.max=n.x,o[0].isSeparated(t)||(t.min=i.y,t.max=n.y,o[1].isSeparated(t))||(t.min=i.z,t.max=n.z,o[2].isSeparated(t)))return!1;for(let a=0;a<3;a++){let l=s[a],c=r[a];if(t.setFromBox(l,e),c.isSeparated(t))return!1}return!0}}();Bc.prototype.intersectsTriangle=function(){let t=new Zu,e=new Array(3),i=new Ku,n=new Ku,r=new O;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(t.copy(s),t.update(),s=t);let o=this.satBounds,a=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let u=0;u<3;u++){let d=o[u],f=a[u];if(i.setFromPoints(f,e),d.isSeparated(i))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let u=0;u<3;u++){let d=l[u],f=c[u];if(i.setFromPoints(f,h),d.isSeparated(i))return!1}for(let u=0;u<3;u++){let d=a[u];for(let f=0;f<4;f++){let p=c[f];if(r.crossVectors(d,p),i.setFromPoints(r,e),n.setFromPoints(r,h),i.isSeparated(n))return!1}}return!0}}();Bc.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Bc.prototype.distanceToPoint=function(){let t=new O;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();Bc.prototype.distanceToBox=function(){let t=["x","y","z"],e=new Array(12).fill().map(()=>new Na),i=new Array(12).fill().map(()=>new Na),n=new O,r=new O;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,n),s.closestPointToPoint(n,r),a&&a.copy(n),l&&l.copy(r)),0;let c=o*o,h=s.min,u=s.max,d=this.points,f=1/0;for(let m=0;m<8;m++){let g=d[m];r.copy(g).clamp(h,u);let v=g.distanceToSquared(r);if(v<f&&(f=v,a&&a.copy(g),l&&l.copy(r),v<c))return Math.sqrt(v)}let p=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){let y=(m+1)%3,x=(m+2)%3,b=g<<y|v<<x,S=1<<m|g<<y|v<<x,A=d[b],E=d[S];e[p].set(A,E);let M=t[m],T=t[y],P=t[x],I=i[p],k=I.start,R=I.end;k[M]=h[M],k[T]=g?h[T]:u[T],k[P]=v?h[P]:u[T],R[M]=u[M],R[T]=g?h[T]:u[T],R[P]=v?h[P]:u[T],p++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){r.x=m?u.x:h.x,r.y=g?u.y:h.y,r.z=v?u.z:h.z,this.closestPointToPoint(r,n);let y=r.distanceToSquared(n);if(y<f&&(f=y,a&&a.copy(n),l&&l.copy(r),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let g=e[m];for(let v=0;v<12;v++){let y=i[v];gz(g,y,n,r);let x=n.distanceToSquared(r);if(x<f&&(f=x,a&&a.copy(n),l&&l.copy(r),x<c))return Math.sqrt(x)}}return Math.sqrt(f)}}();var cg=new O,ug=new O,hg=new O,vA=new ge,yA=new ge,xA=new ge,b8=new O,S8=new O,A8=new O,_A=new O;function IFe(t,e,i,n,r,s){let o;return s===Tr?o=t.intersectTriangle(n,i,e,!0,r):o=t.intersectTriangle(e,i,n,s!==Ro,r),o===null?null:{distance:t.origin.distanceTo(r),point:r.clone()}}function LFe(t,e,i,n,r,s,o,a,l){cg.fromBufferAttribute(e,s),ug.fromBufferAttribute(e,o),hg.fromBufferAttribute(e,a);let c=IFe(t,cg,ug,hg,_A,l);if(c){n&&(vA.fromBufferAttribute(n,s),yA.fromBufferAttribute(n,o),xA.fromBufferAttribute(n,a),c.uv=ls.getInterpolation(_A,cg,ug,hg,vA,yA,xA,new ge)),r&&(vA.fromBufferAttribute(r,s),yA.fromBufferAttribute(r,o),xA.fromBufferAttribute(r,a),c.uv1=ls.getInterpolation(_A,cg,ug,hg,vA,yA,xA,new ge)),i&&(b8.fromBufferAttribute(i,s),S8.fromBufferAttribute(i,o),A8.fromBufferAttribute(i,a),c.normal=ls.getInterpolation(_A,cg,ug,hg,b8,S8,A8,new O),c.normal.dot(t.direction)>0&&c.normal.multiplyScalar(-1));let h={a:s,b:o,c:a,normal:new O,materialIndex:0};ls.getNormal(cg,ug,hg,h.normal),c.face=h,c.faceIndex=s}return c}function nte(t,e,i,n,r){let s=n*3,o=t.index.getX(s),a=t.index.getX(s+1),l=t.index.getX(s+2),{position:c,normal:h,uv:u,uv1:d}=t.attributes,f=LFe(i,c,h,u,d,o,a,l,e);return f?(f.faceIndex=n,r&&r.push(f),f):null}function BFe(t,e,i,n,r,s){for(let o=n,a=n+r;o<a;o++)nte(t,e,i,o,s)}function RFe(t,e,i,n,r){let s=1/0,o=null;for(let a=n,l=n+r;a<l;a++){let c=nte(t,e,i,a);c&&c.distance<s&&(o=c,s=c.distance)}return o}function cc(t,e,i,n){let r=t.a,s=t.b,o=t.c,a=e,l=e+1,c=e+2;i&&(a=i.getX(e),l=i.getX(e+1),c=i.getX(e+2)),r.x=n.getX(a),r.y=n.getY(a),r.z=n.getZ(a),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}function M8(t,e,i,n,r,s,o){let a=i.index,l=i.attributes.position;for(let c=t,h=e+t;c<h;c++)if(cc(o,c*3,a,l),o.needsUpdate=!0,n(o,c,r,s))return!0;return!1}var rte=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){let t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}};function Xh(t,e){return e[t+15]===65535}function Cv(t,e){return e[t+6]}function A_(t,e){return e[t+14]}function M_(t){return t+8}function C_(t,e){return e[t+6]}function OFe(t,e){return e[t+7]}var sv=new Gn,cE=new O,FFe=["x","y","z"];function JR(t,e,i,n,r){let s=t*2,o=X0,a=bd,l=Sd;if(Xh(s,a)){let c=Cv(t,l),h=A_(s,a);BFe(e,i,n,c,h,r)}else{let c=M_(t);uE(c,o,n,cE)&&JR(c,e,i,n,r);let h=C_(t,l);uE(h,o,n,cE)&&JR(h,e,i,n,r)}}function KR(t,e,i,n){let r=t*2,s=X0,o=bd,a=Sd;if(Xh(r,o)){let l=Cv(t,a),c=A_(r,o);return RFe(e,i,n,l,c)}else{let l=OFe(t,a),c=FFe[l],h=n.direction[c]>=0,u,d;h?(u=M_(t),d=C_(t,a)):(u=C_(t,a),d=M_(t));let f=uE(u,s,n,cE)?KR(u,e,i,n):null;if(f){let m=f.point[c];if(h?m<=s[d+l]:m>=s[d+l+3])return f}let p=uE(d,s,n,cE)?KR(d,e,i,n):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var NFe=function(){let t,e,i=[],n=new rte(()=>new Gn);return function(...s){t=n.getPrimitive(),e=n.getPrimitive(),i.push(t,e);let o=r(...s);n.releasePrimitive(t),n.releasePrimitive(e),i.pop(),i.pop();let a=i.length;return a>0&&(e=i[a-1],t=i[a-2]),o};function r(s,o,a,l,c=null,h=0,u=0){function d(y){let x=y*2,b=bd,S=Sd;for(;!Xh(x,b);)y=M_(y),x=y*2;return Cv(y,S)}function f(y){let x=y*2,b=bd,S=Sd;for(;!Xh(x,b);)y=C_(y,S),x=y*2;return Cv(y,S)+A_(x,b)}let p=s*2,m=X0,g=bd,v=Sd;if(Xh(p,g)){let y=Cv(s,v),x=A_(p,g);return mc(s,m,t),l(y,x,!1,u,h+s,t)}else{let y=M_(s),x=C_(s,v),b=y,S=x,A,E,M,T;if(c&&(M=t,T=e,mc(b,m,M),mc(S,m,T),A=c(M),E=c(T),E<A)){b=x,S=y;let Q=A;A=E,E=Q,M=T}M||(M=t,mc(b,m,M));let P=Xh(b*2,g),I=a(M,P,A,u+1,h+b),k;if(I===2){let Q=d(b),X=f(b)-Q;k=l(Q,X,!0,u+1,h+b,M)}else k=I&&r(b,o,a,l,c,h,u+1);if(k)return!0;T=e,mc(S,m,T);let R=Xh(S*2,g),F=a(T,R,E,u+1,h+S),V;if(F===2){let Q=d(S),X=f(S)-Q;V=l(Q,X,!0,u+1,h+S,T)}else V=F&&r(S,o,a,l,c,h,u+1);return!!V}}}(),kFe=function(){let t=new Zu,e=new Zu,i=new Qe,n=new Bc,r=new Bc;return function s(o,a,l,c,h=null){let u=o*2,d=X0,f=bd,p=Sd;if(h===null&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),h=n),Xh(u,f)){let m=a,g=m.index,v=m.attributes.position,y=l.index,x=l.attributes.position,b=Cv(o,p),S=A_(u,f);if(i.copy(c).invert(),l.boundsTree)return mc(o,d,r),r.matrix.copy(i),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:A=>r.intersectsBox(A),intersectsTriangle:A=>{A.a.applyMatrix4(c),A.b.applyMatrix4(c),A.c.applyMatrix4(c),A.needsUpdate=!0;for(let E=b*3,M=(S+b)*3;E<M;E+=3)if(cc(e,E,g,v),e.needsUpdate=!0,A.intersectsTriangle(e))return!0;return!1}});for(let A=b*3,E=S+b*3;A<E;A+=3){cc(t,A,g,v),t.a.applyMatrix4(i),t.b.applyMatrix4(i),t.c.applyMatrix4(i),t.needsUpdate=!0;for(let M=0,T=y.count;M<T;M+=3)if(cc(e,M,y,x),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}else{let m=o+8,g=p[o+6];return mc(m,d,sv),!!(h.intersectsBox(sv)&&s(m,a,l,c,h)||(mc(g,d,sv),h.intersectsBox(sv)&&s(g,a,l,c,h)))}}}();function uE(t,e,i,n){return mc(t,e,sv),i.intersectBox(sv,n)}var ZR=[],DM,X0,bd,Sd;function Rx(t){DM&&ZR.push(DM),DM=t,X0=new Float32Array(t),bd=new Uint16Array(t),Sd=new Uint32Array(t)}function wA(){DM=null,X0=null,bd=null,Sd=null,ZR.length&&Rx(ZR.pop())}var P3=Symbol("skip tree generation"),D3=new Gn,I3=new Gn,dg=new Qe,Tf=new Bc,tx=new Bc,ix=new O,bA=new O,zFe=new O,UFe=new O,GFe=new O,C8=new Gn,Ql=new rte(()=>new Zu),p1=class{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),p1.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e={cloneBuffers:!0,...e};let i=t.geometry,n=t._roots,r=i.getIndex(),s;return e.cloneBuffers?s={roots:n.map(o=>o.slice()),index:r.array.slice()}:s={roots:n,index:r.array},s}static deserialize(t,e,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),p1.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:n,roots:r}=t,s=new p1(e,{...i,[P3]:!0});if(s._roots=r,i.setIndex){let o=e.getIndex();if(o===null){let a=new Ot(t.index,1,!1);e.setIndex(a)}else o.array!==n&&(o.array.set(n),o.needsUpdate=!0)}return s}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[P3]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[P3]||(this._roots=EFe(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Gn))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));let e=this.geometry,i=e.index.array,n=e.attributes.position,r,s,o,a,l=0,c=this._roots;for(let u=0,d=c.length;u<d;u++)r=c[u],s=new Uint32Array(r),o=new Uint16Array(r),a=new Float32Array(r),h(0,l),l+=r.byteLength;function h(u,d,f=!1){let p=u*2;if(o[p+15]===65535){let m=s[u+6],g=o[p+14],v=1/0,y=1/0,x=1/0,b=-1/0,S=-1/0,A=-1/0;for(let E=3*m,M=3*(m+g);E<M;E++){let T=i[E],P=n.getX(T),I=n.getY(T),k=n.getZ(T);P<v&&(v=P),P>b&&(b=P),I<y&&(y=I),I>S&&(S=I),k<x&&(x=k),k>A&&(A=k)}return a[u+0]!==v||a[u+1]!==y||a[u+2]!==x||a[u+3]!==b||a[u+4]!==S||a[u+5]!==A?(a[u+0]=v,a[u+1]=y,a[u+2]=x,a[u+3]=b,a[u+4]=S,a[u+5]=A,!0):!1}else{let m=u+8,g=s[u+6],v=m+d,y=g+d,x=f,b=!1,S=!1;t?x||(b=t.has(v),S=t.has(y),x=!b&&!S):(b=!0,S=!0);let A=x||b,E=x||S,M=!1;A&&(M=h(m,d,x));let T=!1;E&&(T=h(g,d,x));let P=M||T;if(P)for(let I=0;I<3;I++){let k=m+I,R=g+I,F=a[k],V=a[k+3],Q=a[R],X=a[R+3];a[u+I]=F<Q?F:Q,a[u+I+3]=V>X?V:X}return P}}}traverse(t,e=0){let i=this._roots[e],n=new Uint32Array(i),r=new Uint16Array(i);s(0);function s(o,a=0){let l=o*2,c=r[l+15]===65535;if(c){let h=n[o+6],u=r[l+14];t(a,c,new Float32Array(i,o*4,6),h,u)}else{let h=o+8,u=n[o+6],d=n[o+7];t(a,c,new Float32Array(i,o*4,6),d)||(s(h,a+1),s(u,a+1))}}}raycast(t,e=Il){let i=this._roots,n=this.geometry,r=[],s=e.isMaterial,o=Array.isArray(e),a=n.groups,l=s?e.side:e;for(let c=0,h=i.length;c<h;c++){let u=o?e[a[c].materialIndex].side:l,d=r.length;if(Rx(i[c]),JR(0,n,u,t,r),wA(),o){let f=a[c].materialIndex;for(let p=d,m=r.length;p<m;p++)r[p].face.materialIndex=f}}return r}raycastFirst(t,e=Il){let i=this._roots,n=this.geometry,r=e.isMaterial,s=Array.isArray(e),o=null,a=n.groups,l=r?e.side:e;for(let c=0,h=i.length;c<h;c++){let u=s?e[a[c].materialIndex].side:l;Rx(i[c]);let d=KR(0,n,u,t);wA(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[c].materialIndex))}return o}intersectsGeometry(t,e){let i=this.geometry,n=!1;for(let r of this._roots)if(Rx(r),n=kFe(0,i,t,e),wA(),n)break;return n}shapecast(t,e,i){let n=this.geometry;if(t instanceof Function){if(e){let u=e;e=(d,f,p,m)=>{let g=f*3;return u(d,g,g+1,g+2,p,m)}}t={boundsTraverseOrder:i,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=Ql.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){let u=a;a=(d,f,p,m,g)=>u(d,f,p,m,g)?!0:M8(d,f,n,l,p,m,r)}else a||(l?a=(u,d,f,p)=>M8(u,d,n,l,f,p,r):a=(u,d,f)=>f);let c=!1,h=0;for(let u of this._roots){if(Rx(u),c=NFe(0,n,o,a,s,h),wA(),c)break;h+=u.byteLength}return Ql.releasePrimitive(r),c}bvhcast(t,e,i){let{intersectsRanges:n,intersectsTriangles:r}=i,s=this.geometry.index,o=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;dg.copy(e).invert();let c=Ql.getPrimitive(),h=Ql.getPrimitive();if(r){let d=function(f,p,m,g,v,y,x,b){for(let S=m,A=m+g;S<A;S++){cc(h,S*3,a,l),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let E=f,M=f+p;E<M;E++)if(cc(c,E*3,s,o),c.needsUpdate=!0,r(c,h,E,S,v,y,x,b))return!0}return!1};if(n){let f=n;n=function(p,m,g,v,y,x,b,S){return f(p,m,g,v,y,x,b,S)?!0:d(p,m,g,v,y,x,b,S)}}else n=d}t.getBoundingBox(I3),I3.applyMatrix4(e);let u=this.shapecast({intersectsBounds:d=>I3.intersectsBox(d),intersectsRange:(d,f,p,m,g,v)=>(D3.copy(v),D3.applyMatrix4(dg),t.shapecast({intersectsBounds:y=>D3.intersectsBox(y),intersectsRange:(y,x,b,S,A)=>n(d,f,y,x,m,g,S,A)}))});return Ql.releasePrimitive(c),Ql.releasePrimitive(h),u}intersectsBox(t,e){return Tf.set(t.min,t.max,e),Tf.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Tf.intersectsBox(i),intersectsTriangle:i=>Tf.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},n={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),Tf.set(t.boundingBox.min,t.boundingBox.max,e),Tf.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,c=t.attributes.position,h=t.index,u=Ql.getPrimitive(),d=Ql.getPrimitive(),f=bA,p=zFe,m=null,g=null;n&&(m=UFe,g=GFe);let v=1/0,y=null,x=null;return dg.copy(e).invert(),tx.matrix.copy(dg),this.shapecast({boundsTraverseOrder:b=>Tf.distanceToBox(b),intersectsBounds:(b,S,A)=>A<v&&A<s?(S&&(tx.min.copy(b.min),tx.max.copy(b.max),tx.needsUpdate=!0),!0):!1,intersectsRange:(b,S)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:A=>tx.distanceToBox(A),intersectsBounds:(A,E,M)=>M<v&&M<s,intersectsRange:(A,E)=>{for(let M=A*3,T=(A+E)*3;M<T;M+=3){cc(d,M,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=b*3,I=(b+S)*3;P<I;P+=3){cc(u,P,l,a),u.needsUpdate=!0;let k=u.distanceToTriangle(d,f,m);if(k<v&&(p.copy(f),g&&g.copy(m),v=k,y=P/3,x=M/3),k<r)return!0}}}});{let A=h?h.count:c.count;for(let E=0,M=A;E<M;E+=3){cc(d,E,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let T=b*3,P=(b+S)*3;T<P;T+=3){cc(u,T,l,a),u.needsUpdate=!0;let I=u.distanceToTriangle(d,f,m);if(I<v&&(p.copy(f),g&&g.copy(m),v=I,y=T/3,x=E/3),I<r)return!0}}}}}),Ql.releasePrimitive(u),Ql.releasePrimitive(d),v===1/0?null:(i.point?i.point.copy(p):i.point=p.clone(),i.distance=v,i.faceIndex=y,n&&(n.point?n.point.copy(g):n.point=g.clone(),n.point.applyMatrix4(dg),p.applyMatrix4(dg),n.distance=p.sub(n.point).length(),n.faceIndex=x),i)}closestPointToPoint(t,e={},i=0,n=1/0){let r=i*i,s=n*n,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:c=>(ix.copy(t).clamp(c.min,c.max),ix.distanceToSquared(t)),intersectsBounds:(c,h,u)=>u<o&&u<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(t,ix);let u=t.distanceToSquared(ix);return u<o&&(bA.copy(ix),o=u,a=h),u<r}}),o===1/0)return null;let l=Math.sqrt(o);return e.point?e.point.copy(bA):e.point=bA.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{mc(0,new Float32Array(e),C8),t.union(C8)}),t}},nx=I0(rwe()),VFe=.5*(Math.sqrt(3)-1),rx=(3-Math.sqrt(3))/6,HFe=1/3,Jl=1/6,m1=t=>Math.floor(t)|0,E8=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),L3=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function B3(t=Math.random){let e=ste(t),i=new Float64Array(e).map(r=>E8[r%12*2]),n=new Float64Array(e).map(r=>E8[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,c=(r+s)*VFe,h=m1(r+c),u=m1(s+c),d=(h+u)*rx,f=h-d,p=u-d,m=r-f,g=s-p,v,y;m>g?(v=1,y=0):(v=0,y=1);let x=m-v+rx,b=g-y+rx,S=m-1+2*rx,A=g-1+2*rx,E=h&255,M=u&255,T=.5-m*m-g*g;if(T>=0){let k=E+e[M],R=i[k],F=n[k];T*=T,o=T*T*(R*m+F*g)}let P=.5-x*x-b*b;if(P>=0){let k=E+v+e[M+y],R=i[k],F=n[k];P*=P,a=P*P*(R*x+F*b)}let I=.5-S*S-A*A;if(I>=0){let k=E+1+e[M+1],R=i[k],F=n[k];I*=I,l=I*I*(R*S+F*A)}return 70*(o+a+l)}}function jFe(t=Math.random){let e=ste(t),i=new Float64Array(e).map(s=>L3[s%12*3]),n=new Float64Array(e).map(s=>L3[s%12*3+1]),r=new Float64Array(e).map(s=>L3[s%12*3+2]);return function(s,o,a){let l,c,h,u,d=(s+o+a)*HFe,f=m1(s+d),p=m1(o+d),m=m1(a+d),g=(f+p+m)*Jl,v=f-g,y=p-g,x=m-g,b=s-v,S=o-y,A=a-x,E,M,T,P,I,k;b>=S?S>=A?(E=1,M=0,T=0,P=1,I=1,k=0):b>=A?(E=1,M=0,T=0,P=1,I=0,k=1):(E=0,M=0,T=1,P=1,I=0,k=1):S<A?(E=0,M=0,T=1,P=0,I=1,k=1):b<A?(E=0,M=1,T=0,P=0,I=1,k=1):(E=0,M=1,T=0,P=1,I=1,k=0);let R=b-E+Jl,F=S-M+Jl,V=A-T+Jl,Q=b-P+2*Jl,X=S-I+2*Jl,z=A-k+2*Jl,Y=b-1+3*Jl,j=S-1+3*Jl,J=A-1+3*Jl,H=f&255,Z=p&255,K=m&255,ne=.6-b*b-S*S-A*A;if(ne<0)l=0;else{let pe=H+e[Z+e[K]];ne*=ne,l=ne*ne*(i[pe]*b+n[pe]*S+r[pe]*A)}let W=.6-R*R-F*F-V*V;if(W<0)c=0;else{let pe=H+E+e[Z+M+e[K+T]];W*=W,c=W*W*(i[pe]*R+n[pe]*F+r[pe]*V)}let ve=.6-Q*Q-X*X-z*z;if(ve<0)h=0;else{let pe=H+P+e[Z+I+e[K+k]];ve*=ve,h=ve*ve*(i[pe]*Q+n[pe]*X+r[pe]*z)}let de=.6-Y*Y-j*j-J*J;if(de<0)u=0;else{let pe=H+1+e[Z+1+e[K+1]];de*=de,u=de*de*(i[pe]*Y+n[pe]*j+r[pe]*J)}return 32*(l+c+h+u)}}function ste(t){let e=new Uint8Array(512);for(let i=0;i<512/2;i++)e[i]=i;for(let i=0;i<512/2-1;i++){let n=i+~~(t()*(256-i)),r=e[i];e[i]=e[n],e[n]=r}for(let i=256;i<512;i++)e[i]=e[i-256];return e}var rl=new ls,WFe=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let n=0;n<t.count;n+=3){let r=1;rl.a.fromBufferAttribute(t,n),rl.b.fromBufferAttribute(t,n+1),rl.c.fromBufferAttribute(t,n+2),r*=rl.getArea(),e[n/3]=r}this.distribution=new Float32Array(t.count/3);let i=0;for(let n=0;n<e.length;n++)i+=e[n],this.distribution[n]=i;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,i=0,n=e.length-1,r=-1;for(;i<=n;){let s=Math.ceil((i+n)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?n=s-1:i=s+1}return r}sampleFace(t,e,i){let n=this.randomFunction(),r=this.randomFunction();return n+r>1&&(n=1-n,r=1-r),rl.a.fromBufferAttribute(this.positionAttribute,t*3),rl.b.fromBufferAttribute(this.positionAttribute,t*3+1),rl.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(rl.a,n).addScaledVector(rl.b,r).addScaledVector(rl.c,1-(n+r)),rl.getNormal(i),this}},XFe=I0(YZ()),qFe=new Qe,YFe=new Qe,QFe=new Qe,E_;(t=>{function e(i){return i&&i.__isSPEObject}t.is=e})(E_||(E_={}));var vz=t=>class extends t{constructor(){super(...arguments),this.previousModelViewMatrix=new Qe,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Qe,this.matrixWorldRigid=new Qe,this.shearScale=new Qe,this.shearScaleInv=new Qe}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof Ri&&(e=e.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===e)return!0;i=i.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let i of this.children)i.updateMatrixWorld(e)}updateWorldMatrix(e,i){let n=this.parent;if(e&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseChildren(e,i=0){for(let n of this.children)E_.is(n)&&n.traverseObject(e,i+1)}traverseObject(e,i=0){if(e(this,i)!==!0)for(let n of this.children)E_.is(n)&&n.traverseObject(e,i+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,i=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:n,v:r,q:s}=(0,XFe.SVD)(i),o=qFe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),a=YFe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=QFe.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,i){this.updateWorldMatrix(!0,!1);let n=new Qe().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),n.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof Qe?e.hiddenMatrix.premultiply(n):e.applyMatrix4(n),e.updateWorldMatrix(!1,!1),this.add(e),i!==void 0&&(this.children.pop(),this.children.splice(i,0,e)),this}copy(e,i=!1){return super.copy(e,i),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,i,n,r,s,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},JFe=class extends vz(Ri){},KFe=t=>t.type==="Mesh",cs=class extends JFe{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,e){}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let i=this.children[t];(i==null?void 0:i.object)!==e&&(i&&this.remove(i),i=new cs(e),this.add(i),this.children.splice(t,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=e.matrix,i.hiddenMatrix=e.hiddenMatrix),i.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return KFe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},qf=new O,Yf=new O,Ev=new Qe,ote=[new O(-1,1,1),new O(-1,-1,1),new O(1,-1,1),new O(1,1,1),new O(-1,1,-1),new O(-1,-1,-1),new O(1,-1,-1),new O(1,1,-1)],ZFe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],$Fe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],T8=(t,e,i)=>{t.updateEntityBoxSize(qf,Yf),Ev.copy(e).multiply(t.matrixWorld),Yf.x===0&&Yf.y===0&&Yf.z===0?i.push(new O(qf.x,qf.y,qf.z).applyMatrix4(Ev)):ote.forEach(n=>{i.push(n.clone().multiply(Yf).add(qf).applyMatrix4(Ev))})},P8=class extends Gn{constructor(){super(...arguments),this.matrix=new Qe,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let i=new Qe().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,i,e)}expandByObjectSize(t,e,i=!1){let n=[];return i===!0?t.traverseEntity(r=>{if(r.visible||r.cloner&&r.data.visible){if(!("geometry"in r)){n.push(new O);return}T8(r,e,n)}}):T8(t,e,n),this.setFromPoints(n)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(Ev.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(Yf).multiplyScalar(.5),this.getCenter(qf),Ev.copy(this.matrix).setPosition(qf),this.vertices=ote.map(t=>t.clone().multiply(Yf).applyMatrix4(Ev))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=ZFe.map(([t,e])=>new Na(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new O))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=$Fe.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},rd={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},eNe=class extends b${constructor(){super()}getPoints(t=12){let e=[],i,n=this.getCurveLengths(),r=n[n.length-1]/n.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?n[s]:n[s]-n[s-1],c=Math.ceil(t*l/r),h=a.getPoints(c);for(let u=0;u<h.length;u++){let d=h[u];i&&i.equals(d)||(e.push(d),i=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},$R=.001;function eO(t,e,i){return e.clone().sub(t).cross(e.clone().sub(i)).length()<=$R}function R3(t,e){let i=new O(...t.position),n=new O(...t.controlNext.position),r=new O(...e.controlPrevious.position),s=new O(...e.position);return eO(i,n,s)&&eO(i,r,s)}function ate(t){let e=t.points.map(h=>new O(...h.data.position)),i=[t.points[0]],n=new O(...i[0].data.position);for(let h=0;h<t.points.length-1;h++)eO(n,e[h],e[h+1])||(i.push(t.points[h]),n=e[h]);i.push(t.points[t.points.length-1]);let r=t.isClosed,s=i.length-(r?0:1),o=i.length,a=[];for(let h=0;h<o;h++){let u=i[h].data,d=new O(...u.position),f=new O(...u.controlPrevious.position),p=new O(...u.controlNext.position),m={position:d,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!t.isClosed&&(h===0||h===o-1)){a[h]={...m,removedLength:0};continue}let g=r&&h==0?o-1:h-1,v=r&&h==o-1?0:h+1,y=i[g].data,x=i[v].data,b=new O(...y.position),S=new O(...x.position),A=b.clone().sub(d).normalize(),E=S.clone().sub(d).normalize();Object.assign(m,{prevDir:A,nextDir:E});let M=R3(y,u),T=R3(u,x);if(!M||!T)a[h]={...m,removedLength:0};else{let P=A.clone().add(E).normalize(),I=P.clone().cross(A).length()/A.dot(P);a[h]={...m,tan:I,removedLength:u.roundness/I}}}for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d];if(f.removedLength!==0||p.removedLength!==0){let m=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,m/2),p.removedLength=Math.min(p.removedLength,m/2)}}let l=[];for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d],m=null;if(!R3(i[u].data,i[d].data))f.position.distanceTo(p.position)>$R&&(m=new MM(f.position,f.controlNext,p.controlPrevious,p.position));else{let g=f.position.clone(),v=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&g.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&v.add(p.prevDir.clone().setLength(p.removedLength))),g.distanceTo(v)>$R&&(m=new MM(g,g.clone().lerp(v,.3),v.clone().lerp(g,.3),v))}l[2*h+1]=m}for(let h=0;h<o;h++){let u=a[h];if(u.removedLength===0){l[2*h]=null;continue}let d=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(d),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(d),m=u.tan*u.removedLength,g=u.prevDir.clone().add(u.nextDir).normalize(),v=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,x=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(v),b=g.clone().multiplyScalar(-m).add(x),S=d.distanceTo(b)/d.distanceTo(v),A=u.prevDir.clone().multiplyScalar(S*d.distanceTo(f)).add(d),E=A.clone().lerp(b,2),M=f.clone().lerp(A,4/3),T=p.clone().lerp(E,4/3);l[2*h]=new MM(f,M,T,p)}let c=new eNe;return l.forEach(h=>{h&&c.add(h)}),c}var fi;(t=>{function e(i){return i&&i.__isEntity}t.is=e})(fi||(fi={}));var wu=t=>fi.is(t),tNe={type:"completeState",isfromEntity:!0},yz=t=>class extends vz(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new P8,this._recursiveBBox=new P8,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let i=this.children[e];if(fi.is(i))return i}entityChildrenCount(){let e=this.children.length;for(;e--;)if(fi.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let i=e.parent;if(fi.is(i))e=i;else return}return e}forInstancesRec(e){this.instances.forEach(i=>{i.disposed||e(i),i.forInstancesRec(e)})}super_Entity(e,i){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,i,n=!1){if(!(this.data.states.length===0&&!n)){for(let r of this.data.states)cp.toOps(this.data,r.data).forEach(s=>{let o=xR.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,i)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=cp.patch(this.data,r),cp.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,i){e.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{wu(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let i;return this.traverseEntity(n=>{n.uuid===e&&(i=n)}),i}traverseSortNextHelper(){let e=this.parent;if(e){let i=e.children,n=i.indexOf(this)+1;if(fi.is(i[n]))return i[n];if(fi.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&fi.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let i=this;for(;e>0&&i!==null;)i=i.parent,e-=1;return i}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let i=this.parent;for(;i;){if(e===i)return!0;i=i.parent}return!1}countToAccestor(e){let i=0,n=this;for(;n!==e;){if(n===null)return-1;n=n.parent,i+=1}return i}forEachEntity(e){for(let i of this.children)wu(i)&&e(i)}traverseEntityAncestors(e){this.traverseAncestors(i=>{fi.is(i)&&e(i)})}traverseConcreteEntity(e,i=0){if(e(this,i)!==!0)for(let n of this.children)wu(n)&&n.isConcreteEntity&&n.traverseEntity(e,i+1)}traverseEntity(e,i=0){if(e(this,i)!==!0)for(let n of this.children)wu(n)&&n.traverseEntity(e,i+1)}traverseVisibleEntity(e){e(this);for(let i of this.children)wu(i)&&i.visible&&i.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(e,i=!1){return super.copy(e,i),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>wu(e))}isAncestorOf(e){if(this.uuid===e)return!1;let i=!1;return this.traverseEntity(n=>{n.uuid===e&&(i=!0)}),i}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return yR(i,e)}updateTransformState(e){let i=!1;return e.position&&(this.position.fromArray(e.position),i=!0),e.rotation&&(this.rotation.fromArray(e.rotation),i=!0),e.scale&&(i=!0,this.scale.fromArray(e.scale)),e.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??d0.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)fi.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{fi.is(e)&&e.disposeRecursively()})}toState(e=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return yR(i,e)}updateByObjUpdateOp(e,i){this.updateByOp({type:0,props:e,path:[]},{...this.data,...e},i,!1)}updateByOp(e,i,n,r){let s=this.data;this.data=i;let o=e,a=Ta(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let c={...e.props};if(delete c.name,Object.values(e.props).some(h=>h===void 0)){let h=this.data;if(h!==void 0){let u=Mc.zoom(h,e.path.slice(2));if(u)for(let d in e.props)e.props[d]===void 0&&d in u&&(c[d]=u[d])}}o={...e,props:c,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:h,...u}=l;l=u}if(e.props.material!==void 0&&"material"in l){let{material:h,...u}=l;l=u}let c=Mc.removeOverridden(e.path,e.props,l);o={...e,props:c}}}if(this.updateByPatchedOpBase(o,cp.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),Ta(e.path,["overrides"])){let l=[],c=[...e.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let h of Object.keys(e.props)){l[l.length-1]=h;let u=n.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=e.props[h],u.updateState(_d.apply(u.component.data,u.overrideData),n))}}else{let h=n.scene.findInstance([this.uuid,...l]);if(h){let u=Mc.zoom(h.component.data,c);if(e={...e,path:c},e.type===0){let d=e.props;if(u)for(let[f,p]of Object.entries(e.props))p===void 0&&(d===e.props&&(d={...e.props}),d[f]=u[f]);e={...e,props:d}}h.overrideData=sE.resolve(i.overrides,l),h.updateByOp(e,No.applySimple(h.data,e),n,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let c;for(let h of nd.rootOverrideProps)h in e.props&&(c===void 0&&(c={}),c[h]=e.props[h]);c&&(l={...e,props:c})}else for(let c of nd.rootOverrideProps)if(Ta(e.path,[c])){l=e;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let h=_d.filterOp(c.overrideData,l);h&&c.updateByOp(h,No.applySimple(c.data,h),n,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let h=_d.filterOp(c.overrideData,e);if(h){let u;s===c.data&&e===h?u=i:u=No.applySimple(c.data,h),c.updateByOp(h,u,n,!0)}}})}}updateByPatchedOpBase(e,i,n){if(this.dataPatched=i,e.path.length===0&&e.type===0)e.props.type!==void 0&&!Qp.is(e.props.type)&&rd.changeEntityProptotype(this,i,n);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){rd.changeEntityProptotype(this,i,n);for(let r of this.children)fi.is(r)&&r.updateVisible()}this.updateByPatchedOp(e,i,n)}updateByPatchedOp(e,i,n){if(e.path.length===0&&e.type===0&&this.updateState(e.props,n),Ta(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),Ta(e.path,["cloner"])!==null){let r=No.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(i.cloner,n.scene):(this.setFromClonerState(i.cloner,n),this.expandCloner(n.scene)),this.updateVisible()}}updatePathSnapping(e){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var p,m,g,v,y;let i=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,n=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,r=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let o=e.find(i);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data;if(a.geometry.path.points.length<=1)return;let l=ate(a.geometry.path),c=(n+r)%1;n+r===1&&c===0&&(c=1);let h=l.getPointAt(c),u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new Qe;o.updateMatrixWorld();let d=new Qe().multiplyMatrices(u.clone().invert(),o.matrixWorld);h.applyMatrix4(d);let f={position:h.toArray(),rotation:a.rotation};if(s==="tangential"){let x=new Qe().extractRotation(o.matrixWorld),b=l.getTangentAt(c).applyMatrix4(x).add(h),S=new Qe().lookAt(h,b,new O(0,1,0)),A=new Er().setFromRotationMatrix(S);f={...f,rotation:[A.x,A.y,A.z]}}this.updateTransformState(f),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent(tNe)})}updateVisible(){var e;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((e=this.dataPatched.cloner)==null?void 0:e.hideBase)!==!0)}updateState_Entity(e,i){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),i&&"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,i),this.updateVisible()),this.updateTransformState(e)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof rd.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,i){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new rd.Cloner(this,e),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,i.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},lte=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters),n=i.width/2,r=i.radiusTop??n,s=i.radiusBottom??n;return r===s?(r=n,s=n):r>s?(r=n,s=s*n/r):(r=r*n/s,s=n),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:c,radiusBottom:h,cornerRadius:u,cornerSegments:d,hollow:f}=t.parameters,p;return u||f?p=new cte(c,h,n,r,s,o,a,l*Math.PI/180,u,u,d,f):p=new Rk(c,h,n,r,s,o,a,l*Math.PI/180),p.scale(1,1,i/e),Object.assign(p,{userData:{...t,type:"CylinderGeometry"}})}};function Mh(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function D8(t){return new ge(t.y,-t.x)}var cte=class extends Rt{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],m=[],g=[],v=0,y=i/2,x=new O,b=new O;d&&t==0&&(t=l),d&&e==0&&(e=c);let S=new ge(t,y),A=new ge(e,-y),E=null,M=null,T=null,P=null,I=S.clone().sub(A),k=0,R=0,F=0;u>0&&(k=Math.min(t,e)*(1-u),R=t-k,F=e-k);let V=S.clone();V.x-=k;let Q=Math.PI-I.angle(),X=I.angle(),z=Math.tan(X/2),Y=Math.tan(Q/2),j=z+Y,J=u?j:Y,H=u?j:z;if(l=Math.min(l,(t-R)/J,I.length()/j),c=Math.min(c,(e-F)/H,I.length()/j),l>0){let de=l/z;E=S.clone().sub(new ge(de,l)),u&&(T=E.clone(),T.x-=k-j*l),S.sub(I.clone().setLength(de))}if(c>0){let de=c/Y;M=A.clone().sub(new ge(de,-c)),A.add(I.clone().setLength(de)),u&&(P=M.clone(),P.x-=k-j*c,V.sub(I.clone().setLength(de)))}I=S.clone().sub(A);let Z=I.length()<.5,K=[];for(let de=0;de<=n;de++){let pe=[],ce=de/n,ye=ce*a+o,ae=new ge(Math.sin(ye),Math.cos(ye));P&&M?(ne(pe,ce,ae,Q,c,P,-1,!0),ne(pe,ce,ae,X,c,M,-1,!1)):M?(W(pe,ae,M.x,0,-1),ne(pe,ce,ae,X,c,M,-1,!1)):s||W(pe,ae,e,F,-1);let le=D8(I).normalize();if(Mh(le,ae,x),!Z)for(let Ee=0;Ee<=r;Ee++){let Te=Ee/r,Be=I.clone().multiplyScalar(Te).add(A);Mh(Be,ae,b),p.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(ce,.5+b.y/i),pe.push(v++)}if(T&&E?(ne(pe,ce,ae,Q,l,E,1,!1),ne(pe,ce,ae,X,l,T,1,!0)):E?(ne(pe,ce,ae,Q,l,E,1,!1),W(pe,ae,E.x,0,1)):s||W(pe,ae,t,R,1),u&&!Z){let Ee=D8(I).multiplyScalar(-1).normalize();Mh(Ee,ae,x);for(let Te=0;Te<=r;Te++){let Be=Te/r,Ue=I.clone().multiplyScalar(-Be).add(V);Mh(Ue,ae,b),p.push(b.x,b.y,b.z),m.push(x.x,x.y,x.z),g.push(ce,.5+b.y/i),pe.push(v++)}}u&&!s&&pe.push(pe[0]),K.push(pe)}for(let de=0;de<K.length-1;de++)for(let pe=0;pe<K[0].length-1;pe++){if(s&&u&&pe==r)continue;let ce=K[de][pe],ye=K[de+1][pe],ae=K[de+1][pe+1],le=K[de][pe+1],Ee=p[ae*3+0],Te=p[ae*3+2];f.push(ce,ye,le),(Ee!=0||Te!=0)&&f.push(ye,ae,le)}a<Math.PI*2&&(ve(-1,K[0],o),ve(1,K[K.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new gt(p,3)),this.setAttribute("normal",new gt(m,3)),this.setAttribute("uv",new gt(g,2));function ne(de,pe,ce,ye,ae,le,Ee,Te){for(let Be=0;Be<h+1;Be++){let Ue=Be/h,Ie=Ee<0?Ue:1-Ue;Te&&(Ie-=1),Ie*=ye;let Pe=new ge(Math.sin(Ie),Math.cos(Ie)*Ee),Je=Pe.clone().multiplyScalar(ae).add(le);Mh(Je,ce,b),p.push(b.x,b.y,b.z),Mh(Pe,ce,x),m.push(x.x,x.y,x.z),g.push(pe,.5+b.y/i),de.push(v++)}}function W(de,pe,ce,ye,ae){let le=new O,Ee=new ge,Te=[ce,ye];ae<0&&Te.reverse();for(let Be of Te)Ee.set(Be,y*ae),Mh(Ee,pe,le),p.push(le.x,le.y,le.z),m.push(0,ae,0),g.push(.5,.5),de.push(v++)}function ve(de,pe,ce){let ye=new ge(Math.sin(ce),Math.cos(ce)),ae=new ge(-Math.cos(ce),Math.sin(ce)),le=new O,Ee=de<0?(Ue,Ie,Pe)=>f.push(Ue,Ie,Pe):(Ue,Ie,Pe)=>f.push(Ue,Pe,Ie),Te=new ge((t+e+R+F)/4,0);Mh(Te,ye,le),p.push(le.x,le.y,le.z),m.push(ae.x,0,ae.y),g.push(.5,.5);let Be=v++;for(let Ue of pe){let Ie=p.slice(Ue*3,Ue*3+3);p.push(...Ie),m.push(ae.x,0,ae.y);let Pe=g.slice(Ue*2,Ue*2+2);g.push(...Pe),v++}for(let Ue=Be+1;Ue<v-1;Ue++)Ee(Be,Ue,Ue+1);Ee(Be,v-1,Be+1)}}},iNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:u}=t.parameters,d;return c>0||h>0||l<360?d=new cte(0,e/2,n,r,s,o,a,l*Math.PI/180,c,h,u,0,!0):d=new A$(e/2,n,r,s,o),d.scale(1,1,i/e),Object.assign(d,{userData:{...t,type:"ConeGeometry"}})}},nNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,c;return a==0?c=new Ic(e,i,n,r,s,o):c=new rNe(e,i,n,r,s,o,a,l),Object.assign(c,{userData:{...t,type:"CubeGeometry"}})}},O3=Math.PI/2,rNe=class extends Rt{constructor(t=1,e=1,i=1,n=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,i/2);let c=[],h=[],u=[],d=[],f=0,p=0;m("z","y","x",-1,-1,i,e,t,s,r,0),m("z","y","x",1,-1,i,e,-t,s,r,1),m("x","z","y",1,1,t,i,e,n,s,2),m("x","z","y",1,-1,t,i,-e,n,s,3),m("x","y","z",1,-1,t,e,i,n,r,4),m("x","y","z",-1,-1,t,e,-i,n,r,5),o>0&&(g("z","y","x",-1,-1,1,i,e,t,s,0),g("z","y","x",1,-1,-1,i,e,t,s,1),g("z","y","x",-1,1,-1,i,e,t,s,1),g("z","y","x",1,1,1,i,e,t,s,0),g("x","y","z",-1,-1,-1,t,e,i,n,0),g("x","y","z",1,-1,1,t,e,i,n,1),g("x","y","z",-1,1,1,t,e,i,n,0),g("x","y","z",1,1,-1,t,e,i,n,1),g("y","x","z",-1,-1,1,e,t,i,r,0),g("y","x","z",1,-1,-1,e,t,i,r,1),g("y","x","z",1,1,1,e,t,i,r,1),g("y","x","z",-1,1,-1,e,t,i,r,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new gt(h,3)),this.setAttribute("normal",new gt(u,3)),this.setAttribute("uv",new gt(d,2));function m(y,x,b,S,A,E,M,T,P,I,k){let R=(E-2*o)/P,F=(M-2*o)/I,V=E/2-o,Q=M/2-o,X=T/2,z=P+1,Y=I+1,j=0,J=0,H=new O;for(let Z=0;Z<Y;Z++){let K=Z*F-Q;for(let ne=0;ne<z;ne++){let W=ne*R-V;H[y]=W*S,H[x]=K*A,H[b]=X,h.push(H.x,H.y,H.z),H[y]=0,H[x]=0,H[b]=T>0?1:-1,u.push(H.x,H.y,H.z),d.push(ne/P),d.push(1-Z/I),j+=1}}for(let Z=0;Z<I;Z++)for(let K=0;K<P;K++){let ne=f+K+z*Z,W=f+K+z*(Z+1),ve=f+(K+1)+z*(Z+1),de=f+(K+1)+z*Z;c.push(ne,W,de),c.push(W,ve,de),J+=6}l.addGroup(p,J,k),p+=J,f+=j}function g(y,x,b,S,A,E,M,T,P,I,k){let R=(M-2*o)/I,F=M/2-o,V=T/2-o,Q=P/2,X=I+1,z=0,Y=0,j=new O,J=new O;for(let H=0;H<a+1;H++){let Z=H/a*O3,K=Math.sin(Z)*o,ne=(1-Math.cos(Z))*o,W=Math.sin(Z),ve=Math.cos(Z);j[x]=(V+K)*A,j[b]=(Q-ne)*E,J[y]=0,J[x]=W*Math.sign(j[x]),J[b]=ve*Math.sign(j[b]);for(let de=0;de<X;de++){let pe=de*R-F;j[y]=pe*S,h.push(j.x,j.y,j.z),u.push(J.x,J.y,J.z),d.push(de/I),d.push(0),z+=1}}for(let H=0;H<a;H++)for(let Z=0;Z<I;Z++){let K=f+Z+X*H,ne=f+Z+X*(H+1),W=f+(Z+1)+X*(H+1),ve=f+(Z+1)+X*H;c.push(K,ne,ve),c.push(ne,W,ve),Y+=6}l.addGroup(p,Y,k),p+=Y,f+=z}function v(y,x,b){let S=new O,A=new O(t/2,e/2,i/2);A.subScalar(o);let E=[],M=y*x*b>0?(P,I,k)=>c.push(P,I,k):(P,I,k)=>c.push(P,k,I);for(let P=0;P<=a;P++){let I=[],k=O3*(1-P/a),R=Math.cos(k),F=Math.sin(k),V=0;for(let Q=0;Q<=P;Q++){let X=Math.cos(V),z=Math.sin(V);S.x=R*X,S.y=F,S.z=R*z;let Y=A.clone().addScaledVector(S,o);h.push(y*Y.x,x*Y.y,b*Y.z),u.push(y*S.x,x*S.y,b*S.z),d.push(0,0),I.push(f++),V+=O3/P}E.push(I)}let T=E.length-1;for(let P=0;P<T;P++){let I=E[P],k=E[P+1],R=I.length-1;M(I[0],k[1],k[0]);for(let F=1;F<=R;F++)M(I[F-1],I[F],k[F]),M(I[F],k[F+1],k[F])}}}},xz=class extends Rt{constructor(t=[],e=[],i="",n=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];c(),h(),this.setAttribute("position",new gt(o,3)),this.setAttribute("normal",new gt(l,3)),this.setAttribute("uv",new gt(a,2));return;function c(){var X;r=Math.min(1-1e-5,r),r==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new O,f=d.clone(),p=new ls,m=r*n,g=n-m,v=s+1,y=new O,x=(z,Y)=>y.subVectors(z,Y).normalize(),b=(z,Y)=>Array(z).fill(void 0).map(Y),S=b(t.length/3,(z,Y)=>new O().fromArray(t,Y*3).setLength(n)),A=[],E=1e6;for(let z=0;z<S.length;z++){let Y=S[z],j=[],J,H,Z,K=1e10,ne=-1;for(;(ne=e.indexOf(z,ne+1))!=-1;){let pe=ne-ne%3;J=e[pe+(ne+1)%3],H=e[pe+(ne+2)%3],Z=Y.distanceToSquared(S[J]),K=Math.min(K,Z),j.push([J,H,Z])}K+=1e-6;let W=[],ve=0,de=j.length;for(let pe=0;pe<de;pe++){[J,H,Z]=j[ve];let ce=((X=A[J])==null?void 0:X.includes(z))==!0;Z<=K&&W.push(J+ +ce*E),ve=j.findIndex(ye=>ye[0]==H)}A.push(W)}let M=[];{let z=0,Y=0,j,J,H=u==3;for(let Z=0;Z<=s;Z++){j=Z*(Z+1)/2,J=(Z+1)*(Z+2)/2;for(let K=0;K<s-Z;K++)[z,Y]=[j+K+Z+2,J+K+Z+3],M.push(j,J,...H?[Y,j]:[z,J],Y,z),[j,J]=[z,Y];M.push(j,J,j+s+2)}}let T=d.clone(),P=d.clone(),I=d.clone(),k=d.clone(),R=d.clone(),F=[],V=b(S.length,()=>b(u,()=>d.clone()));for(let z=0;z<S.length;z++){d.copy(S[z]).normalize(),T.copy(d).multiplyScalar(g);let Y=A[z];for(let W=0;W<Y.length;W++){let ve=Y[W],de=Y[(W+1)%u];p.setFromPointsAndIndices(S,z,ve%E,de%E),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(T,V[z][W])}let j=[],J=[],H=[],Z=new O;s==0&&[...V[z]].reduce((W,ve)=>W.add(ve),Z).multiplyScalar(1/u);for(let W=0;W<u;W++){let ve=[],de=(W-1+u)%u,pe=V[z][de],ce=V[z][W];d.copy(pe).sub(T),f.copy(ce).sub(T);let ye=T.angleTo(d),ae=d.angleTo(f),le=Math.cos(ye)*m;s==0?P.copy(Z):P.copy(T).setLength(g+le),J.push(le);let Ee=[P,pe,ce];for(let Te=0;Te<2;Te++){let Be=Ee[Te],Ue=Ee[Te+1];k.subVectors(Be,T),R.subVectors(Ue,T),I.crossVectors(k,R).normalize();for(let Ie=0;Ie<v;Ie++){let Pe=[ye,ae][Te]*Ie/v;d.copy(k).applyAxisAngle(I,Pe).add(T),j.push(d.clone()),Te&&(x(d,T),ve.push([Ie==0?Be:d.clone(),y.clone()]))}Te&&(x(Ue,T),ve.push([Ue,y.clone()]))}H.push(ve)}F.push(H);let K=2*v,ne=2;for(let W=0;W<u;W++){let ve=K*W,de=K*((W+1)%u),pe=[j[ve]];for(let ye=1;ye<v;ye++){k=j[ve+ye],R=j[de+ye],pe.push(k);for(let ae=1,le=ye-ne+1;ae<=le;ae++)d.lerpVectors(k,R,ae/(le+1)),d.sub(T).setLength(J[W]).add(T),pe.push(d.clone());pe.push(R)}for(let ye=0;ye<v;ye++)pe.push(j[ye+v+ve]);pe.push(j[de+v]);let ce=M.map(ye=>pe[ye]);o.push(...ce.map(ye=>[ye.x,ye.y,ye.z]).flat()),l.push(...ce.map(ye=>(x(ye,T),[y.x,y.y,y.z])).flat())}}let Q=[];for(let z=0;z<A.length;z++)for(let Y=0;Y<u;Y++){let j=A[z][Y];if(j<E){let J=A[j].findIndex(K=>K%E==z),H=F[z][Y],Z=F[j][J];for(let K=0;K<v;K++){let ne=H[K],W=Z[v-K],ve=H[K+1],de=Z[v-(K+1)];[ne,W,ve,ve,W,de].forEach(pe=>{o.push(pe[0].x,pe[0].y,pe[0].z),l.push(pe[1].x,pe[1].y,pe[1].z)})}Q.push(H[0][0],Z[v][0],H[v][0],Z[0][0])}}for(;Q.length;){let z,Y,j,J;[z,Y]=Q.splice(0,2);let H=[z];for(;z!=Y;)H.push(Y),j=Q.indexOf(Y),J=j%2,Y=Q.splice(j-J,2)[1-J];y.subVectors(H[0],H[1]).cross(d.subVectors(H[0],H[2])).normalize();let Z=y.dot(H[0])<0;Z&&y.negate();for(let K=1;K<=H.length-2;K++)[H[K+ +Z],H[K+1-+Z],H[0]].forEach(ne=>{o.push(ne.x,ne.y,ne.z),l.push(y.x,y.y,y.z)})}}function h(){let u=new O;for(let A=0;A<o.length;A+=3){u.x=o[A+0],u.y=o[A+1],u.z=o[A+2];let E=b(u)/2/Math.PI+.5,M=S(u)/Math.PI+.5;a.push(E,1-M)}let d=new O,f=new O,p=new O,m=new O,g=new ge,v=new ge,y=new ge,x=(A,E,M,T)=>{T<0&&A.x===1&&(a[E]=A.x-1),M.x===0&&M.z===0&&(a[E]=T/2/Math.PI+.5)};for(let A=0,E=0;A<o.length;A+=9,E+=6){d.set(o[A+0],o[A+1],o[A+2]),f.set(o[A+3],o[A+4],o[A+5]),p.set(o[A+6],o[A+7],o[A+8]),g.set(a[E+0],a[E+1]),v.set(a[E+2],a[E+3]),y.set(a[E+4],a[E+5]),m.copy(d).add(f).add(p).divideScalar(3);let M=b(m);x(g,E+0,d,M),x(v,E+2,f,M),x(y,E+4,p,M)}for(let A=0;A<a.length;A+=6){let E=a[A+0],M=a[A+2],T=a[A+4],P=Math.max(E,M,T),I=Math.min(E,M,T);P>.9&&I<.1&&(E<.2&&(a[A+0]+=1),M<.2&&(a[A+2]+=1),T<.2&&(a[A+4]+=1))}function b(A){return Math.atan2(A.z,-A.x)}function S(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}}static fromJSON(t){return new xz(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},sNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new ute(e*.5,s,o):new M$(e*.5,r);return a.scale(1,i/e,n/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},ute=class extends xz{constructor(t=1,e=.2,i=4){let n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,i),this.type=a}static fromJSON(t){return new ute(t.radius,t.corner,t.cornerSides)}},sx=1e-12,_z=class{constructor(t){this.position=new ge,this.startPosition=new ge,this.uuid=ri.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new _z(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},tO=class extends _z{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new tO(this.parent).copy(this)}},Tv=class extends _z{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new tO(this),new tO(this))}static create(t,e){let i=new Tv(t,new ge(...e.position));return i.controls[0].position.set(...e.controlPrevious.position),i.controls[1].position.set(...e.controlNext.position),i.roundness=e.roundness,i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,i}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let i=0,n=this.controls.length;i<n;i++){let r=this.controls[i];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new Tv(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,n;let t=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),e=(n=this.curveAfter)==null?void 0:n.getTangentAt(0);return[t,e]}computeNormals(t=new ge,e=new ge){let[i,n]=this.computeTangents();return i&&n&&(I8(i,t),I8(n,e)),[t,e]}computeTangent(t=new ge){let[e,i]=this.computeTangents();return e&&i&&t.copy(e).add(i).normalize(),t}computeNormal(t=new ge){let[e,i]=this.computeNormals();return t.copy(e).add(i).normalize(),t}};function I8(t,e=new ge){let i=t.length();return e.set(-t.y/i,t.x/i)}var wz=t=>t,q0=new ge,BT=new ge,oNe=new ge,aNe=new ge,lNe=new ge,cNe=new ge,hte=new O,dte=new O;function uNe(t){let e=new ge;e.addVectors(t.v0,q0.subVectors(t.v1,t.v0).multiplyScalar(2/3));let i=new ge;return i.addVectors(t.v2,BT.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new gl(t.v0,e,i,t.v2)}function Ox(t,e,i=Number.EPSILON){return Math.abs(t-e)<i}function hNe(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function dNe(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function fte(t,e,i){let n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2));return Math.acos((r*r+n*n-s*s)/(2*r*n))}function fNe(t,e,i){return B8(t,e)&&B8(e,i)&&iO(t.position,e.position,i.position)}function iO(t,e,i){return q0.copy(e).sub(t).cross(BT.copy(i).sub(t))===0}function pNe(t,e,i,n,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.y-e.y)/s,c=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return n.set(a+l,o+c),r.set(a-l,o-c),[n,r]}function mNe(t,e,i){let n=t.distanceTo(i),r=e.distanceTo(i);return n<r?e:t}function gNe(t,e,i,n,r,s){let o=e.x-t.x,a=e.y-t.y,l=i.x-t.x,c=i.y-t.y,h=Math.sqrt((o+l)*(o+l)+(a+c)*(a+c)),u;return fte(e,t,i)>Math.PI&&(h*=-1),Ox(c,a)?u=(a+c)*(n/h-.5)*8/3/(o-l):u=(o+l)*(n/h-.5)*8/3/(c-a),r.set(e.x-u*a,e.y+u*o),s.set(i.x+u*c,i.y-u*l),[r,s]}function L8(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function B8(t,e){return iO(t.position,t.controls[1].position,e.position)&&iO(t.position,e.controls[0].position,e.position)}function vNe(t,e,i,n,r=.5){let s=q0.subVectors(e,t).multiplyScalar(r).add(t),o=BT.subVectors(i,e).multiplyScalar(r).add(e),a=oNe.subVectors(n,i).multiplyScalar(r).add(i),l=s,c=aNe.subVectors(o,s).multiplyScalar(r).add(s),h=lNe.subVectors(a,o).multiplyScalar(r).add(o),u=a,d=cNe.subVectors(h,c).multiplyScalar(r).add(c);return[t.x,t.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,n.x,n.y]}function yNe(t,e,i=12,n=!0){let r=dte.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=wz(e[a]),c=q0,h=Lp(l,i);for(let u=0;u<=h;u++)if(l instanceof gl||l instanceof Nd||l instanceof Cl){if(l.getPoint(u/h,c),r.set(c.x,c.y,0),s!==void 0&&dNe(s,r))continue;s===void 0&&(s=hte),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return n&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function xNe(t,e,i,n=12,r=!0){let s=dte.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(i[l]===!1)continue;let c,h=wz(e[l]),u=q0,d=Lp(h,n);a.push(d);for(let f=0;f<=d;f++)if(h instanceof gl||h instanceof Nd||h instanceof Cl){if(h.getPoint(f/d,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=hte:(t.setXYZ(o,c.x,c.y,c.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),c.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function R8(t,e=12,i=!1){let n=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(i&&o.roundedCurveCorner!==void 0){let l=Lp(o.roundedCurveCorner,e)*.5;r>0&&(n[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=Lp(o.curveAfter,e)),n.push(a)}return t.length>0&&i&&t[0].roundedCurveCorner!==void 0&&(n[t.length-1]+=Lp(t[0].roundedCurveCorner,e)*.5),n}function Lp(t,e=12){return t&&t instanceof vT?e*2:t&&(t instanceof Cl||t instanceof w$)?1:t&&t instanceof Bk?e*t.points.length:e}function _Ne(t,e,i=12,n=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=wz(e[o]),l=Lp(a,i),c=q0;for(let h=0;h<=l;h++)if(a instanceof gl||a instanceof Nd||a instanceof Cl){if(a.getPoint(h/l,c),r!==void 0&&hNe(r,c,sx))continue;r===void 0&&(r=BT),r.copy(c),t.push(c.x,c.y),s++}}return Ox(t[0],t[t.length-2],sx)&&Ox(t[1],t[t.length-1],sx)&&(t.pop(),t.pop()),n&&s>1&&!(Ox(t[s-1],t[1],sx)&&Ox(t[s-2],t[0],sx))&&(t.push(t[0],t[1]),s++),t}var F3=new ge,wNe=new ge,bNe=new ge,SNe=new ge,ANe=new ge,MNe=new ge,Cn=class extends OC{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Do(new O(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=ri.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,i){let n=new Cn;return n.isClosed=t.isClosed,n.points=t.points.map(r=>Tv.create(r.id,r.data)),typeof t.roundness=="number"&&(n.roundness=t.roundness),n.shapeHoles=t.shapeHoles.map(r=>Cn.createFromState(r)),e!==void 0&&i!==void 0&&n.applySize(e,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,i=this.points.length;e<i;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,i=this.points.findIndex(n=>n.uuid===t);if(i<0){let n=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)n+=a;else return l+n}}return i}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let i=F3.set(t,e);for(let n=0,r=this.points.length;n<r;n++){let s=this.points[n];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let n=0,r=this.shapeHoles.length;n<r;n++)this.shapeHoles[n].applyScale(t,e);this._update()}createPoint(t,e=0,i=ri.generateUUID()){let n;t instanceof ge?n=t:n=new ge(t,e);let r=new Tv(i,n);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];if(n.uuid===t)return n}for(let e=0,i=this.shapeHoles.length;e<i;e++){let n=this.shapeHoles[e].getPointByUuid(t);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(i=>i.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,i=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let n=i?this.roundedCurveDivisions:this.curveDivisions;return yNe(t,i?this.roundedCurves:this.curves,e,this.autoClose),n.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=R8(this.points,t,!1),this.roundedCurveDivisions=R8(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,i=12){return xNe(t,this.curves,e,i,this.autoClose).reduce((n,r)=>n+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),_Ne(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let n=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=Lp(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=n.reduce((o,a)=>o+a,0));for(let o=0,a=n.length;o<a;o++){let l=n[o];if(s<i+l)return[o,(s-i+1)/l];i+=l}return[0,1]}getCurveT(t,e,i){let n=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(L8(n,r)){let l=n.position.distanceTo(r.position);return n.position.distanceTo(F3.set(i.x,i.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){L8(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let i=this.curves[this.curves.length-1];t.curveBefore=i,e.curveAfter=i;let n=i.clone();t.roundedCurveBefore=n,e.roundedCurveAfter=n,t.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,i=this.points.length;e<i;e++){let n=this.points[e];if(e===0)this.moveTo(n.position.x,n.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(n,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(e,i)}if(this.points.length>2){let e=0;for(let i=0,n=this.points.length;i<n;i++){let r=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],o=this.points[i+1]??this.points[0],a=r.roundness,l=s&&o&&fNe(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let c=r.curveBefore,h=r.curveAfter;if(c===void 0||h===void 0)continue;let u=r.roundedCurveBefore,d=r.roundedCurveAfter,f=c.getLength(),p=h.getLength(),m=Math.min(a,f*.499),g=Math.min(a,p*.499),v=Math.min(m,g),y=1-v/f,x=v/p,b=c.getPointAt(y,F3),S=h.getPointAt(x,wNe);this._subSplitCurve(c,u,y,b,void 0),this._subSplitCurve(h,d,x,void 0,S);let A;if(this.useCubicForRoundedCorners){let E=fte(b,r.position,S)/2,M=Math.tan(E)*b.distanceTo(r.position),[T,P]=pNe(b,S,M,bNe,SNe),I=mNe(T,P,r.position),[k,R]=gNe(I,b,S,M,ANe,MNe);A=new gl(b.clone(),k.clone(),R.clone(),S.clone())}else A=new Nd(b.clone(),r.position.clone(),S.clone());r.roundedCurveCorner=A,this.roundedCurves.splice(i+e,0,A),e++}}}}_subSplitCurve(t,e,i,n,r){if(t instanceof Cl)n!==void 0&&e.v2.copy(n),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(i,0),l=vNe(s.v0,s.v1,s.v2,s.v3,a);return n!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new Cn(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var i;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let n=0;n<e;n++){let r=n*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],c=t.points[r+4],h=t.points[r+5],u=t.points[r+6],d=new Tv(ri.generateUUID(),new ge(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(c,h),d.roundness=u,this.points.push(d)}return this.shapeHoles=(i=t.shapeHoles)!=null&&i.length?t.shapeHoles.map(n=>{let r=new Cn;return r.fromJSON(n),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t){let e=(n,r)=>{r instanceof gl&&r.v3.equals(n.position)&&n.controls[0].position.copy(r.v2)},i=n=>{let r=[],s,o;for(s=0,o=n.length;s<o;s++)n[s]instanceof Nd&&(n[s]=uNe(n[s]));for(s=0,o=n.length;s<o;s++){let c=n[s],h=s>0?n[s-1]:null,u;c instanceof gl?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof Cl&&(u=this.createPoint(c.v1)),u!==void 0&&(h!==null&&e(u,h),r.push(u))}let a=n[n.length-1],l=!1;return a instanceof gl?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof Cl&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=i(t.curves),t instanceof OC&&(this.shapeHoles=t.holes.map(n=>{let r=new Cn;return r.fromShape(n),r})),this.update(),this}updatePoint(t,e){let i=this.getPointByUuid(t);i&&(e.position!==void 0&&i.position.fromArray(e.position),e.roundness!==void 0&&(i.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var n;let i=(n=this.getPointByUuid(t))==null?void 0:n.controls[0];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var n;let i=(n=this.getPointByUuid(t))==null?void 0:n.controls[1];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}},nO=Math.PI*2;function N3({x:t,y:e},i,n,r,s){return{x:t*i+r,y:e*n+s}}function CNe(t,e){let i=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:n-r*i,y:r+n*i},{x:s+o*i,y:o-s*i},{x:s,y:o}]}function O8(t,e,i,n){let r=t*n-e*i<0?-1:1,s=Math.min(1,Math.max(-1,t*i+e*n));return r*Math.acos(s)}function ENe(t,e,i,n,r,s,o,a,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(o,2),f=Math.pow(a,2),p=h*u-h*f-u*d;p<0&&(p=0),p/=h*f+u*d,p=Math.sqrt(p)*(l===c?-1:1);let m=p*r/s*a,g=p*-s/r*o,v=m+(t+i)/2,y=g+(e+n)/2,x=(o-m)/r,b=(a-g)/s,S=(-o-m)/r,A=(-a-g)/s,E=O8(1,0,x,b),M=O8(x,b,S,A);return!c&&M>0&&(M-=nO),c&&M<0&&(M+=nO),{centerx:v,centery:y,ang1:E,ang2:M}}function TNe({px:t,py:e,cx:i,cy:n,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let c=(t-i)/2,h=(e-n)/2;if(c===0&&h===0)return[];r=Math.abs(r),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(r,2)+Math.pow(h,2)/Math.pow(s,2);u>1&&(r*=Math.sqrt(u),s*=Math.sqrt(u));let d=ENe(t,e,i,n,r,s,c,h,o,a),{ang1:f,ang2:p}=d,{centerx:m,centery:g}=d,v=Math.abs(p)/(nO/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);p/=y;for(let x=0;x<y;x++)l.push(CNe(f,p)),f+=p;return l.map(x=>{let{x:b,y:S}=N3(x[0],r,s,m,g),{x:A,y:E}=N3(x[1],r,s,m,g),{x:M,y:T}=N3(x[2],r,s,m,g);return{x1:b,y1:S,x2:A,y2:E,x:M,y:T}})}var Ii;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Ii||(Ii={}));var Kn;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Kn||(Kn={}));function Lt(t,e){if(!t)throw e||"Assertion Failed!"}var Mt=function(){function t(){}return t.vertEq=function(e,i){return e.s===i.s&&e.t===i.t},t.vertLeq=function(e,i){return e.s<i.s||e.s===i.s&&e.t<=i.t},t.transLeq=function(e,i){return e.t<i.t||e.t===i.t&&e.s<=i.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,i){return Math.abs(e.s-i.s)+Math.abs(e.t-i.t)},t.edgeEval=function(e,i,n){Lt(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,s=n.s-i.s;return r+s>0?r<s?i.t-e.t+(e.t-n.t)*(r/(r+s)):i.t-n.t+(n.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,i,n){Lt(t.vertLeq(e,i)&&t.vertLeq(i,n));var r=i.s-e.s,s=n.s-i.s;return r+s>0?(i.t-n.t)*r+(i.t-e.t)*s:0},t.transEval=function(e,i,n){Lt(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,s=n.t-i.t;return r+s>0?r<s?i.s-e.s+(e.s-n.s)*(r/(r+s)):i.s-n.s+(n.s-e.s)*(s/(r+s)):0},t.transSign=function(e,i,n){Lt(t.transLeq(e,i)&&t.transLeq(i,n));var r=i.t-e.t,s=n.t-i.t;return r+s>0?(i.s-n.s)*r+(i.s-e.s)*s:0},t.vertCCW=function(e,i,n){return e.s*(i.t-n.t)+i.s*(n.t-e.t)+n.s*(e.t-i.t)>=0},t.interpolate=function(e,i,n,r){return e=e<0?0:e,n=n<0?0:n,e<=n?n===0?(i+r)/2:i+(r-i)*(e/(e+n)):r+(i-r)*(n/(e+n))},t.intersect=function(e,i,n,r,s){var o,a,l;t.vertLeq(e,i)||(l=e,e=i,i=l),t.vertLeq(n,r)||(l=n,n=r,r=l),t.vertLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.vertLeq(n,i)?t.vertLeq(i,r)?(o=t.edgeEval(e,n,i),a=t.edgeEval(n,i,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,n.s,a,i.s)):(o=t.edgeSign(e,n,i),a=-t.edgeSign(e,r,i),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,n.s,a,r.s)):s.s=(n.s+i.s)/2,t.transLeq(e,i)||(l=e,e=i,i=l),t.transLeq(n,r)||(l=n,n=r,r=l),t.transLeq(e,n)||(l=e,e=n,n=l,l=i,i=r,r=l),t.transLeq(n,i)?t.transLeq(i,r)?(o=t.transEval(e,n,i),a=t.transEval(n,i,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,n.t,a,i.t)):(o=t.transSign(e,n,i),a=-t.transSign(e,r,i),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,n.t,a,r.t)):s.t=(n.t+i.t)/2},t}(),ox=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),SA=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),Tg=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),F8=function(){function t(){var e=new Tg,i=new ox,n=new SA(0),r=new SA(1);e.next=e.prev=e,e.anEdge=null,i.next=i.prev=i,n.next=n,n.Sym=r,r.next=r,r.Sym=n,this.vHead=e,this.fHead=i,this.eHead=n,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var i=new SA(0),n=new SA(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return n.next=r,r.Sym.next=i,i.next=e,e.Sym.next=n,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i},t.prototype.splice_=function(e,i){var n=e.Onext,r=i.Onext;n.Sym.Lnext=i,r.Sym.Lnext=e,e.Onext=r,i.Onext=n},t.prototype.makeVertex_=function(e,i,n){var r=e;Lt(r,"Vertex can't be null!");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i;var o=i;do o.Org=r,o=o.Onext;while(o!==i)},t.prototype.makeFace_=function(e,i,n){var r=e;Lt(r,"Face can't be null");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i,r.trail=null,r.marked=!1,r.inside=n.inside;var o=i;do o.Lface=r,o=o.Lnext;while(o!==i)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var i=e.next,n=e.Sym.next;i.Sym.next=n,n.Sym.next=i},t.prototype.killVertex_=function(e,i){var n=e.anEdge,r=n;do r.Org=i,r=r.Onext;while(r!==n);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,i){var n=e.anEdge,r=n;do r.Lface=i,r=r.Lnext;while(r!==n);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new Tg,i=new Tg,n=new ox,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(i,r.Sym,this.vHead),this.makeFace_(n,r,this.fHead),r},t.prototype.splice=function(e,i){var n=!1,r=!1;if(e!==i){if(i.Org!==e.Org&&(r=!0,this.killVertex_(i.Org,e.Org)),i.Lface!==e.Lface&&(n=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(i,e),!r){var s=new Tg;this.makeVertex_(s,i,e.Org),e.Org.anEdge=e}if(!n){var o=new ox;this.makeFace_(o,i,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var i=e.Sym,n=!1;if(e.Lface!==e.Rface&&(n=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!n){var r=new ox;this.makeFace_(r,e,e.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(e.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var i=this.makeEdge_(e),n=i.Sym;this.splice_(i,e.Lnext),i.Org=e.Dst;var r=new Tg;return this.makeVertex_(r,n,i.Org),i.Lface=n.Lface=e.Lface,i},t.prototype.splitEdge=function(e){var i=this.addEdgeVertex(e),n=i.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,n),e.Dst=n.Org,n.Dst.anEdge=n.Sym,n.Rface=e.Rface,n.winding=e.winding,n.Sym.winding=e.Sym.winding,n.idx=e.idx,n.Sym.idx=e.Sym.idx,n},t.prototype.connect=function(e,i){var n=!1,r=this.makeEdge_(e),s=r.Sym;if(i.Lface!==e.Lface&&(n=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,i),r.Org=e.Dst,s.Org=i.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!n){var o=new ox;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var i=e.anEdge,n,r,s,o,a;r=i.Lnext;do n=r,r=n.Lnext,n.Lface=null,n.Rface===null&&(n.Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),s=n.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(n));while(n!=i);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var i=e.anEdge,n=0;do n++,i=i.Lnext;while(i!==e.anEdge);return n},t.prototype.mergeConvexFaces=function(e){var i,n,r,s,o,a,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(n=i.anEdge,o=n.Org;r=n.Lnext,s=n.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&Mt.vertCCW(n.Lprev.Org,n.Org,s.Lnext.Lnext.Org)&&Mt.vertCCW(s.Lprev.Org,s.Org,n.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),n=null,s=null)),!(n&&n.Lnext.Org===o);)n=r;return!0},t.prototype.check=function(){var e=this.fHead,i=this.vHead,n=this.eHead,r,s,o,a,l,c;for(s=e,s=e;(r=s.next)!==e;s=r){Lt(r.prev===s),l=r.anEdge;do Lt(l.Sym!==l),Lt(l.Sym.Sym===l),Lt(l.Lnext.Onext.Sym===l),Lt(l.Onext.Sym.Lnext===l),Lt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(Lt(r.prev===s&&r.anEdge===null),a=i,a=i;(o=a.next)!==i;a=o){Lt(o.prev===a),l=o.anEdge;do Lt(l.Sym!==l),Lt(l.Sym.Sym===l),Lt(l.Lnext.Onext.Sym===l),Lt(l.Onext.Sym.Lnext===l),Lt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Lt(o.prev===a&&o.anEdge===null),c=n,c=n;(l=c.next)!==n;c=l)Lt(l.Sym.next===c.Sym),Lt(l.Sym!==l),Lt(l.Sym.Sym===l),Lt(l.Org!==null),Lt(l.Dst!==null),Lt(l.Lnext.Onext.Sym===l),Lt(l.Onext.Sym.Lnext===l);Lt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),N8=function(){function t(){this.handle=null}return t}(),k8=function(){function t(){this.key=null,this.node=0}return t}(),PNe=function(){function t(e,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var n=0;n<e+1;n++)this.nodes[n]=new N8,this.handles[n]=new k8;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var i=this.nodes,n=this.handles,r,s,o;for(r=i[e].handle;;){if(o=e<<1,o<this.size&&this.leq(n[i[o+1].handle].key,n[i[o].handle].key)&&++o,Lt(o<=this.max),s=i[o].handle,o>this.size||this.leq(n[r].key,n[s].key)){i[e].handle=r,n[r].node=e;break}i[e].handle=s,n[s].node=e,e=o}},t.prototype.floatUp_=function(e){var i=this.nodes,n=this.handles,r,s,o;for(r=i[e].handle;;){if(o=e>>1,s=i[o].handle,o===0||this.leq(n[s].key,n[r].key)){i[e].handle=r,n[r].node=e;break}i[e].handle=s,n[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var i,n;if(i=++this.size,i*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new N8;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new k8}return this.freeList===0?n=i:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[i].handle=n,this.handles[n].node=i,this.handles[n].key=e,this.initialized&&this.floatUp_(i),n},t.prototype.extractMin=function(){var e=this.nodes,i=this.handles,n=e[1].handle,r=i[n].key;return this.size>0&&(e[1].handle=e[this.size].handle,i[e[1].handle].node=1,i[n].key=null,i[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var i=this.nodes,n=this.handles,r;Lt(e>=1&&e<=this.max&&n[e].key!==null),r=n[e].node,i[r].handle=i[this.size].handle,n[i[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(n[i[r>>1].handle].key,n[i[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),n[e].key=null,n[e].node=this.freeList,this.freeList=e},t}(),k3=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),z8=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),DNe=function(){function t(e,i){this.frame=e,this.leq=i,this.head=new z8,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,e,i.key));return i},t.prototype.insertBefore=function(e,i){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,i));var n=new z8;return n.key=i,n.next=e.next,e.next.prev=n,n.prev=e,e.next=n,n},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),INe=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.edgeLeq=function(e,i,n){var r=e.event,s=i.eUp,o=n.eUp;if(s.Dst===r)return o.Dst===r?Mt.vertLeq(s.Org,o.Org)?Mt.edgeSign(o.Dst,s.Org,o.Org)<=0:Mt.edgeSign(s.Dst,o.Org,s.Org)>=0:Mt.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return Mt.edgeSign(s.Dst,r,s.Org)>=0;var a=Mt.edgeEval(s.Dst,r,s.Org),l=Mt.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,i){i.fixUpperEdge&&Lt(i.eUp.winding===0),i.eUp.activeRegion=null,e.dict.delete(i.nodeUp)},t.fixUpperEdge=function(e,i,n){Lt(i.fixUpperEdge),e.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=n,n.activeRegion=i},t.topLeftRegion=function(e,i){var n=i.eUp.Org,r;do i=t.regionAbove(i);while(i.eUp.Org===n);if(i.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(i).eUp.Sym,i.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,i,r),i=t.regionAbove(i)}return i},t.topRightRegion=function(e){var i=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===i);return e},t.addRegionBelow=function(e,i,n){var r=new k3;return r.eUp=n,r.nodeUp=e.dict.insertBefore(i.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,n.activeRegion=r,r},t.isWindingInside=function(e,i){switch(e.windingRule){case Ii.ODD:return(i&1)!==0;case Ii.NONZERO:return i!==0;case Ii.POSITIVE:return i>0;case Ii.NEGATIVE:return i<0;case Ii.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,i){i.windingNumber=t.regionAbove(i).windingNumber+i.eUp.winding,i.inside=t.isWindingInside(e,i.windingNumber)},t.finishRegion=function(e,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,t.deleteRegion(e,i)},t.finishLeftRegions=function(e,i,n){for(var r,s=null,o=i,a=i.eUp;o!==n;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,i,n,r,s,o){var a,l,c,h,u=!0;c=n;do Lt(Mt.vertLeq(c.Org,c.Dst)),t.addRegionBelow(e,i,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=t.regionBelow(i).eUp.Rprev),l=i,h=s;a=t.regionBelow(l),c=a.eUp.Sym,c.Org===h.Org;)c.Onext!==h&&(e.mesh.splice(c.Oprev,c),e.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!u&&t.checkForRightSplice(e,l)&&(t.addWinding(c,h),t.deleteRegion(e,l),e.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,Lt(l.windingNumber-c.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,i,n){e.mesh.splice(i,n)},t.vertexWeights=function(e,i,n){var r=Mt.vertL1dist(i,e),s=Mt.vertL1dist(n,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*i.coords[0]+a*n.coords[0],e.coords[1]+=o*i.coords[1]+a*n.coords[1],e.coords[2]+=o*i.coords[2]+a*n.coords[2]},t.getIntersectData=function(e,i,n,r,s,o){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,t.vertexWeights(i,n,r),t.vertexWeights(i,s,o)},t.checkForRightSplice=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp;if(Mt.vertLeq(r.Org,s.Org)){if(Mt.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;Mt.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),i.dirty=n.dirty=!0)}else{if(Mt.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp,o;if(Lt(!Mt.vertEq(r.Dst,s.Dst)),Mt.vertLeq(r.Dst,s.Dst)){if(Mt.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=i.inside}else{if(Mt.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;i.dirty=n.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=i.inside}return!0},t.checkForIntersect=function(e,i){var n=t.regionBelow(i),r=i.eUp,s=n.eUp,o=r.Org,a=s.Org,l=r.Dst,c=s.Dst,h,u,d=new Tg,f,p;if(Lt(!Mt.vertEq(c,l)),Lt(Mt.edgeSign(l,e.event,o)<=0),Lt(Mt.edgeSign(c,e.event,a)>=0),Lt(o!==e.event&&a!==e.event),Lt(!i.fixUpperEdge&&!n.fixUpperEdge),o===a||(h=Math.min(o.t,l.t),u=Math.max(a.t,c.t),h>u))return!1;if(Mt.vertLeq(o,a)){if(Mt.edgeSign(c,o,a)>0)return!1}else if(Mt.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),Mt.intersect(l,o,c,a,d),Lt(Math.min(o.t,l.t)<=d.t),Lt(d.t<=Math.max(a.t,c.t)),Lt(Math.min(c.s,l.s)<=d.s),Lt(d.s<=Math.max(a.s,o.s)),Mt.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),f=Mt.vertLeq(o,a)?o:a,Mt.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),Mt.vertEq(d,o)||Mt.vertEq(d,a)?(t.checkForRightSplice(e,i),!1):!Mt.vertEq(l,e.event)&&Mt.edgeSign(l,e.event,d)>=0||!Mt.vertEq(c,e.event)&&Mt.edgeSign(c,e.event,d)<=0?c===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),i=t.topLeftRegion(e,i),r=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),n),t.addRightEdges(e,i,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),n=i,i=t.topRightRegion(i),p=t.regionBelow(i).eUp.Rprev,n.eUp=s.Oprev,s=t.finishLeftRegions(e,n,null),t.addRightEdges(e,i,s.Onext,r.Rprev,p,!0),!0):(Mt.edgeSign(l,e.event,d)>=0&&(t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),Mt.edgeSign(c,e.event,d)<=0&&(i.dirty=n.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,c),t.regionAbove(i).dirty=i.dirty=n.dirty=!0,!1)},t.walkDirtyRegions=function(e,i){for(var n=t.regionBelow(i),r,s;;){for(;n.dirty;)i=n,n=t.regionBelow(n);if(!i.dirty&&(n=i,i=t.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,r=i.eUp,s=n.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,i)&&(n.fixUpperEdge?(t.deleteRegion(e,n),e.mesh.delete(s),n=t.regionBelow(i),s=n.eUp):i.fixUpperEdge&&(t.deleteRegion(e,i),e.mesh.delete(r),i=t.regionAbove(n),r=i.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!i.fixUpperEdge&&!n.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,i))return}else t.checkForRightSplice(e,i);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,i),e.mesh.delete(r),i=t.regionAbove(n))}},t.connectRightVertex=function(e,i,n){var r,s=n.Onext,o=t.regionBelow(i),a=i.eUp,l=o.eUp,c=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,i),Mt.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),i=t.topLeftRegion(e,i),s=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),o),c=!0),Mt.vertEq(l.Org,e.event)&&(e.mesh.splice(n,l.Oprev),n=t.finishLeftRegions(e,o,null),c=!0),c){t.addRightEdges(e,i,n.Onext,s,s,!0);return}Mt.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(n.Lprev,r),t.addRightEdges(e,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,i)},t.connectLeftDegenerate=function(e,i,n){var r,s,o,a,l;if(r=i.eUp,Mt.vertEq(r.Org,n)){Lt(!1),t.spliceMergeVertices(e,r,n.anEdge);return}if(!Mt.vertEq(r.Dst,n)){e.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(e.mesh.delete(r.Onext),i.fixUpperEdge=!1),e.mesh.splice(n.anEdge,r),t.sweepEvent(e,n);return}Lt(!1),i=t.topRightRegion(i),l=t.regionBelow(i),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Lt(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(n.anEdge,o),Mt.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,i,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,i){var n,r,s,o,a,l,c=new k3;if(c.eUp=i.anEdge.Sym,n=e.dict.search(c).key,r=t.regionBelow(n),!!r){if(o=n.eUp,a=r.eUp,Mt.edgeSign(o.Dst,i,o.Org)===0){t.connectLeftDegenerate(e,n,i);return}if(s=Mt.vertLeq(a.Dst,o.Dst)?n:r,n.inside||s.fixUpperEdge){if(s===n)l=e.mesh.connect(i.anEdge.Sym,o.Lnext);else{var h=e.mesh.connect(a.Dnext,i.anEdge);l=h.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,n,l)),t.sweepEvent(e,i)}else t.addRightEdges(e,n,i.anEdge,i.anEdge,null,!0)}},t.sweepEvent=function(e,i){e.event=i,t.debugEvent(e);for(var n=i.anEdge;n.activeRegion===null;)if(n=n.Onext,n===i.anEdge){t.connectLeftVertex(e,i);return}var r=t.topLeftRegion(e,n.activeRegion);Lt(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,i,n,r){var s=new k3,o=e.mesh.makeEdge();o.Org.s=n,o.Org.t=r,o.Dst.s=i,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new DNe(e,t.edgeLeq);var i=e.bmax[0]-e.bmin[0],n=e.bmax[1]-e.bmin[1],r=e.bmin[0]-i,s=e.bmax[0]+i,o=e.bmin[1]-n,a=e.bmax[1]+n;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var i,n=0;(i=e.dict.min().key)!==null;)i.sentinel||(Lt(i.fixUpperEdge),Lt(++n===1)),Lt(i.windingNumber===0),t.deleteRegion(e,i)},t.removeDegenerateEdges=function(e){var i,n,r,s=e.mesh.eHead;for(i=s.next;i!==s;i=n)n=i.next,r=i.Lnext,Mt.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(t.spliceMergeVertices(e,r,i),e.mesh.delete(i),i=r,r=i.Lnext),r.Lnext===i&&(r!==i&&((r===n||r===n.Sym)&&(n=n.next),e.mesh.delete(r)),(i===n||i===n.Sym)&&(n=n.next),e.mesh.delete(i))},t.initPriorityQ=function(e){var i,n,r,s=0;for(r=e.mesh.vHead,n=r.next;n!==r;n=n.next)s++;for(s+=8,i=e.pq=new PNe(s,Mt.vertLeq),r=e.mesh.vHead,n=r.next;n!==r;n=n.next)n.pqHandle=i.insert(n);return n!==r?!1:(i.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,i){var n,r,s;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,s=n.anEdge,Lt(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,i){i===void 0&&(i=!0);var n,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(n=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!Mt.vertEq(r,n));)r=e.pq.extractMin(),t.spliceMergeVertices(e,n.anEdge,r.anEdge);t.sweepEvent(e,n)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(i&&e.mesh.check(),!0):!1},t}(),LNe=function(){function t(){this.mesh=new F8,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Ii.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]},t.prototype.normalize_=function(e){var i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),e[0]/=i,e[1]/=i,e[2]/=i},t.prototype.longAxis_=function(e){var i=0;return Math.abs(e[1])>Math.abs(e[0])&&(i=1),Math.abs(e[2])>Math.abs(e[i])&&(i=2),i},t.prototype.computeNormal_=function(e){var i,n,r,s,o,a,l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],m=this.mesh.vHead;i=m.next;for(var g=0;g<3;++g)s=i.coords[g],c[g]=s,p[g]=i,l[g]=s,f[g]=i;for(i=m.next;i!==m;i=i.next)for(var v=0;v<3;++v)s=i.coords[v],s<c[v]&&(c[v]=s,p[v]=i),s>l[v]&&(l[v]=s,f[v]=i);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,n=p[y],r=f[y],h[0]=n.coords[0]-r.coords[0],h[1]=n.coords[1]-r.coords[1],h[2]=n.coords[2]-r.coords[2],i=m.next;i!==m;i=i.next)u[0]=i.coords[0]-r.coords[0],u[1]=i.coords[1]-r.coords[1],u[2]=i.coords[2]-r.coords[2],d[0]=h[1]*u[2]-h[2]*u[1],d[1]=h[2]*u[0]-h[0]*u[2],d[2]=h[0]*u[1]-h[1]*u[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,e[0]=d[0],e[1]=d[1],e[2]=d[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(h)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,i,n=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(i=n.next;i!==n;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,i=[0,0,0],n,r,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),n=this.sUnit,r=this.tUnit;var o=this.longAxis_(i);n[o]=0,n[(o+1)%3]=1,n[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=i[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,n),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,c=e.next;c!==e;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},t.prototype.addWinding_=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,i){var n,r;if(n=i.anEdge,!(n.Lnext!==n&&n.Lnext.Lnext!==n))throw"Mono region invalid";for(;Mt.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;Mt.vertLeq(n.Org,n.Dst);n=n.Lnext);r=n.Lprev;for(var s=void 0;n.Lnext!==r;)if(Mt.vertLeq(n.Dst,r.Org)){for(;r.Lnext!==n&&(Mt.edgeGoesLeft(r.Lnext)||Mt.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==n&&(Mt.edgeGoesRight(n.Lprev)||Mt.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)s=e.connect(n,n.Lprev),n=s.Sym;n=n.Lnext}if(r.Lnext===n)throw"Mono region invalid";for(;r.Lnext.Lnext!==n;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var i,n=e.fHead.next;n!==e.fHead;n=i)if(i=n.next,n.inside&&!this.tessellateMonoRegion_(e,n))return!1;return!0},t.prototype.discardExterior_=function(e){for(var i,n=e.fHead.next;n!==e.fHead;n=i)i=n.next,n.inside||e.zapFace(n)},t.prototype.setWindingNumber_=function(e,i,n){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:n?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,i,n,r){var s,o=0,a=0,l;n>3&&e.mergeConvexFaces(n);for(var c=e.vHead.next;c!==e.vHead;c=c.next)c.n=-1;for(var h=e.fHead.next;h!==e.fHead;h=h.next)if(h.n=-1,!!h.inside){s=h.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=a,a++),l++,s=s.Lnext}while(s!==h.anEdge);if(l>n)throw"Face vertex greater that support polygon";h.n=o,++o}this.elementCount=o,i===Kn.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*n,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var c=e.vHead.next;c!==e.vHead;c=c.next)if(c.n!==-1){var u=c.n*r;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],r>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,h=e.fHead.next;h!==e.fHead;h=h.next)if(h.inside){s=h.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==h.anEdge);for(var f=l;f<n;++f)this.elements[d++]=-1;if(i===Kn.CONNECTED_POLYGONS){s=h.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==h.anEdge);for(var p=l;p<n;++p)this.elements[d++]=-1}}},t.prototype.outputContours_=function(e,i){var n,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=n=a.anEdge;do this.vertexCount++,n=n.Lnext;while(n!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,h=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=n=a.anEdge;do this.vertices[l++]=n.Org.coords[0],this.vertices[l++]=n.Org.coords[1],i>2&&(this.vertices[l++]=n.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,o++,n=n.Lnext;while(n!==r);this.elements[h++]=s,this.elements[h++]=o,s+=o}},t.prototype.addContour=function(e,i){this.mesh===null&&(this.mesh=new F8),e<2&&(e=2),e>3&&(e=3);for(var n=null,r=0;r<i.length;r+=e)n===null?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=i[r+0],n.Org.coords[1]=i[r+1],e>2?n.Org.coords[2]=i[r+2]:n.Org.coords[2]=0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},t.prototype.tesselate=function(e,i,n,r,s,o){if(e===void 0&&(e=Ii.ODD),i===void 0&&(i=Kn.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),INe.computeInterior(this,o);var a=this.mesh;return i===Kn.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),i===Kn.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,i,n,r),!0},t}();function sd(t){var e=t.windingRule,i=e===void 0?Ii.ODD:e,n=t.elementType,r=n===void 0?Kn.POLYGONS:n,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,c=t.normal,h=c===void 0?[0,0,1]:c,u=t.contours,d=u===void 0?[]:u,f=t.strict,p=f===void 0?!0:f,m=t.debug,g=m===void 0?!1:m;if(!d&&p)throw new Error("Contours can't be empty");if(d){var v=new LNe;t.edgeCreateCallback&&(v.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(v.vertexIdCallback=t.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(i,r,o,l,h,p),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}Ii.ODD;Ii.NONZERO;Ii.POSITIVE;Ii.NEGATIVE;Ii.ABS_GEQ_TWO;Kn.POLYGONS;Kn.CONNECTED_POLYGONS;Kn.BOUNDARY_CONTOURS;var rO=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let i=t*rO.eSize;this.buffer=new ArrayBuffer(i);let n=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*n,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*n,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*n,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let i=t*rO.eSize,n=new ArrayBuffer(i),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(n,s*r,3*t);s+=3*t;let a=new Float32Array(n,s*r,3*t);s+=3*t;let l=new Float32Array(n,s*r,2*t);e?(o.set(this.positions.subarray(0,this.size*3)),a.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(o.set(this.positions),a.set(this.normals),l.set(this.uvs)),this.buffer=n,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let n=this.capacity;for(;e>n;)n*=2;this.realloc(n)}let i=this.size;return this.size=e,i}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},pte=rO;pte.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var BNe=I0(owe()),bz={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},mte={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},gte={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},z3=(t,e)=>([i,n])=>(n<i&&(n+=e),(t>=i?t:t+e)<=n),Sz=class extends Rt{constructor(t,e,i=0,n=12,r=3,s=Ii.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._curveSegments=n,this._bevelSegmentsInput=r;let a=this._shape.extractShapePointsToFlatArray([],n),l=this._shape.shapeHoles.map(T=>{let P=T.extractShapePointsToFlatArray([],n),I=[];for(let k=P.length-1;k>=1;k-=2){let R=P[k-1],F=P[k-0];I.push(R,F)}return I}),c=[],h=[];for(let T=0;T<a.length;T+=2)h.push([a[T],a[T+1]]);c.push(h);for(let T=0;T<l.length;T++){let P=l[T],I=[];for(let k=0;k<P.length;k+=2)I.push([P[k],P[k+1]]);c.push(I)}let u=c[0].length?(0,BNe.default)(c).distance:i;i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,u,e/2),this._bevelSegments=Math.floor(r));let d;try{d=sd({windingRule:s,elementType:Kn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a]})}catch{d=bz}let f;try{f=sd({windingRule:Ii.ODD,elementType:Kn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{f=mte}if(!d)throw new Error("error generating geometry");let p=d.elementCount;if(f){d.elementCount+=f.elementCount;for(let T=0;T<f.elements.length;T++){let P=f.elements[T],I=T%2===0?d.vertexCount:0;d.elements.push(P+I)}for(let T=0;T<f.vertexIndices.length;T++){let P=f.vertexIndices[T],I=d.vertexCount;d.vertexIndices.push(P+I)}for(let T=0;T<f.vertices.length;T++){let P=f.vertices[T];d.vertices.push(P)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let T=0,P=d.vertexCount;T<P;T++){let I=T*2,k=d.vertices[I+0],R=d.vertices[I+1];k<m&&(m=k),k>g&&(g=k),R<v&&(v=R),R>y&&(y=R)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new pte(this._computeBufferEstimatedSize(d));let x=[],b=[];for(let T=d.elementCount-1;T>=0;T--){let P=T>=p,I=T*2,k=d.elements[I+0],R=d.elements[I+1],F=k+R,V={start:k,count:R,normals:[],continuous:[],concave:[]},Q=k,X=F-1,z=k+1,Y=this._shape.roundedCurves.length;do{let K=Q-k,ne=d.vertices[X*2+0],W=d.vertices[X*2+1],ve=d.vertices[Q*2+0],de=d.vertices[Q*2+1],pe=d.vertices[z*2+0],ce=d.vertices[z*2+1],ye=ve-ne,ae=de-W,le=Math.sqrt(ye*ye+ae*ae);ye/=le,ae/=le;let Ee=ve-pe,Te=de-ce,Be=Math.sqrt(Ee*Ee+Te*Te);Ee/=Be,Te/=Be,V.normals[K*2+0]=-Te,V.normals[K*2+1]=Ee,V.concave[K]=ye*Te-ae*Ee>0;let Ue=d.vertexIndices[Q];if(Array.isArray(Ue))V.continuous[K]=!1;else{let[Ie,Pe]=this._shape.getCurveIndexFromVertexId(Ue-1,!0);if(Pe>0&&Pe<1)V.continuous[K]=!0;else{let Je=Pe===1?Ie+1:Ie-1;Je=(Je+Y)%Y;let Ke=Pe===1?0:1,U=this._shape.roundedCurves[Ie].getTangent(Pe),L=this._shape.roundedCurves[Je].getTangent(Ke);V.continuous[K]=U.dot(L)>.95}}P&&(V.normals[K*2+0]*=-1,V.normals[K*2+1]*=-1),[X,Q,z]=[Q,z,z+1],z>=F&&(z-=R)}while(z!==k+1);let j=[];j.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(k*2,F*2),vertexCount:R,vertexIndices:new Array(R).fill(!0).map((K,ne)=>[ne,ne]),elements:[0,R],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(k*2,F*2)});let J=0;for(let K=1;K<=this._bevelSegments;K++){let ne=K/this._bevelSegments*Math.PI/2,W=(1-Math.cos(ne))*this._bevel,ve=[],de=[],pe=0;for(let ye=0;ye<R;ye++){let ae=ye*2,le=(ye-1+R)%R*2,Ee=d.vertices[V.start*2+ae+0],Te=d.vertices[V.start*2+ae+1],Be=-V.normals[le+0]*W,Ue=-V.normals[le+1]*W,Ie=-V.normals[ae+0]*W,Pe=-V.normals[ae+1]*W;if(V.concave[ye]||!V.concave[ye]&&P){let Je=Math.atan2(Ue,Be),Ke=Math.atan2(Pe,Ie);Ke>Je&&(Ke-=Math.PI*2);let U=Ke-Je;if(V.continuous[ye]||P){let L=Je+U/2,te=Math.cos(L)*W,_e=Math.sin(L)*W;ve[2*pe+0]=Ee+te*(P?-1:1),ve[2*pe+1]=Te+_e*(P?-1:1),de[pe]=ye,pe++}else{let L=Math.max(1,Math.floor(n/4*Math.abs(U)/Math.PI));for(let te=0;te<=L;te++){let _e=Je+U*(te/L),we=Math.cos(_e)*W,Me=Math.sin(_e)*W;ve[2*pe+0]=Ee+we,ve[2*pe+1]=Te+Me,de[pe]=ye,pe++}}}else ve[2*pe+0]=Ee+Be,ve[2*pe+1]=Te+Ue,de[pe]=ye,pe++,ve[2*pe+0]=Ee,ve[2*pe+1]=Te,de[pe]=ye,pe++,ve[2*pe+0]=Ee+Ie,ve[2*pe+1]=Te+Pe,de[pe]=ye,pe++}let ce=sd({windingRule:Ii.POSITIVE,elementType:Kn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ve],edgeCreateCallback:ye=>{let ae=ye.Org.idx,le=de[ae],Ee=de[(ae+1)%de.length];ye.idx=[le,Ee],ye.Sym.idx=[Ee,le]},vertexIdCallback:ye=>{let ae=ye.Lprev.idx;return[ae?ae[1]:0,ye.idx?ye.idx[0]:0]}});if(!ce)throw console.log("Error"),new Error(`error generating bevel geometry for ${K}'th loop`);if(!ce.vertexCount){let ye=(K-1)/this._bevelSegments*Math.PI/2;J=(1-Math.sin(ye))*this._bevel;break}for(let ye=0;ye<ce.vertexIndices.length;ye++){let[ae,le]=ce.vertexIndices[ye];if(ae===le)continue;let Ee=le;le<ae&&(Ee+=R);for(let Te=ae;Te<Ee;Te++){let Be=Te%R,Ue=(Te+1)%R;if(!V.continuous[Be]||!V.continuous[Ue]){ce.vertexIndices[ye]=[ae,Be],ce.vertexIndices.splice(ye+1,0,[Ue,le]),ce.vertices.splice((ye+1)*2,0,ce.vertices[ye*2],ce.vertices[ye*2+1]);break}}}j.push({bevelI:K,angle:ne,size:W,boundary:ce,reverseMap:de,insetPoints:ve})}let H=(K,ne,W)=>{let ve=0,de=K.boundary.vertexIndices.length;for(;ve<de&&W(K.boundary.vertexIndices[ne]);)ne=(ne+1)%de,ve++;return ve},Z=x.length;for(let K=1;K<j.length;K++){let ne=j[K-1],W=j[K],ve=ne.boundary.vertexIndices.length,de=W.boundary.vertexIndices.length;if(!ve||!de)break;let pe=V.concave.length,ce=0,ye=z3(ce,R);for(;!ne.boundary.vertexIndices.filter(ye).length||!W.boundary.vertexIndices.filter(ye).length;)ce++,ye=z3(ce,R);let ae=ne.boundary.vertexIndices.findIndex(ye),le=W.boundary.vertexIndices.findIndex(ye);do ae=(ae+1)%ve;while(ye(ne.boundary.vertexIndices[ae]));do le=(le+1)%de;while(ye(W.boundary.vertexIndices[le]));ce=(ce+1)%R;let Ee=ce,Te=0,Be=this._buildBevelVert(V,ne,(ae-1+ve)%ve,void 0,Te),Ue=this._buildBevelVert(V,W,(le-1+de)%de,void 0,Te),Ie=Be,Pe=Ue,Je,Ke,U=!1;do{Te=(ce||pe)/pe,ye=z3(ce,R);let L=H(ne,ae,ye),te=H(W,le,ye),_e=U;if(U=!1,L&&!te){for(let we=0;we<L;we++)Je=this._buildBevelVert(V,ne,(ae+we)%ve,we/(L-1),Te),x.push(Ie.topN,Je.topP,Pe.topN),o===!1&&x.push(Je.bottomP,Ie.bottomN,Pe.bottomN),Ie=Je;U=!0}else if(!L&&te)for(let we=0;we<te;we++)Ke=this._buildBevelVert(V,W,(le+we)%de,we/(te-1),Te),x.push(Pe.topN,Ie.topP,Ke.topP),o===!1&&x.push(Ie.bottomP,Pe.bottomN,Ke.bottomP),Pe=Ke;else if(L&&te)if(Je=this._buildBevelVert(V,ne,ae,0,Te),Ke=this._buildBevelVert(V,W,le,0,Te),_e?(x.push(Ie.topN,Ke.topP,Pe.topN),x.push(Ie.topN,Je.topP,Ke.topP),o===!1&&(x.push(Ke.bottomP,Ie.bottomN,Pe.bottomN),x.push(Ke.bottomP,Je.bottomP,Ie.bottomN))):(x.push(Pe.topN,Ie.topN,Je.topP),x.push(Pe.topN,Je.topP,Ke.topP),o===!1&&(x.push(Je.bottomP,Ie.bottomN,Pe.bottomN),x.push(Je.bottomP,Pe.bottomN,Ke.bottomP))),Ie=Je,Pe=Ke,L===te)for(let we=1;we<L;we++)Je=this._buildBevelVert(V,ne,(ae+we)%ve,we/(L-1),Te),Ke=this._buildBevelVert(V,W,(le+we)%de,we/(te-1),Te),x.push(Ie.topN,Je.topP,Pe.topN),x.push(Pe.topN,Je.topP,Ke.topP),o===!1&&(x.push(Je.bottomP,Ie.bottomN,Pe.bottomN),x.push(Je.bottomP,Pe.bottomN,Ke.bottomP)),Ie=Je,Pe=Ke;else if(L>te){let we=L/te,Me=0;for(let We=1;We<L;We++)Je=this._buildBevelVert(V,ne,(ae+We)%ve,We/(L-1),Te),x.push(Ie.topN,Je.topP,Pe.topN),o===!1&&x.push(Je.bottomP,Ie.bottomN,Pe.bottomN),Ie=Je,We>(Me+1)*we&&(Me++,Ke=this._buildBevelVert(V,W,(le+Me)%de,Me/(te-1),Te),x.push(Pe.topN,Je.topP,Ke.topP),o===!1&&x.push(Je.bottomP,Pe.bottomN,Ke.bottomP),Pe=Ke)}else{let we=te/L,Me=0;for(let We=1;We<te;We++)Ke=this._buildBevelVert(V,W,(le+We)%de,We/(te-1),Te),x.push(Pe.topN,Je.topP,Ke.topP),o===!1&&x.push(Je.bottomP,Pe.bottomN,Ke.bottomP),Pe=Ke,We>(Me+1)*we&&(Me++,Je=this._buildBevelVert(V,ne,(ae+Me)%ve,Me/(L-1),Te),x.push(Ie.topN,Je.topP,Pe.topN),o===!1&&x.push(Je.bottomP,Ie.bottomN,Pe.bottomN),Ie=Je)}ae=(ae+L)%ve,le=(le+te)%de,ce=(ce+1)%pe}while(ce!==Ee)}if(o===!1&&this._depth>this._bevel*2&&this._buildWall(j,V,x),P){let K=[];for(let ne=x.length-1;ne>=Z+2;ne-=3){let W=x[ne-2],ve=x[ne-1],de=x[ne-0];K.push(de,ve,W)}x.splice(Z,x.length-Z,...K)}if(P){let K=[];for(let ne=j[j.length-1].boundary.vertices.length-1;ne>=1;ne-=2){let W=j[j.length-1].boundary.vertices[ne-1],ve=j[j.length-1].boundary.vertices[ne-0];K.push(W,ve)}b.push(K)}if(!P){let K=j[j.length-1],ne;try{ne=sd({windingRule:j.length>1?Ii.POSITIVE:Ii.ODD,elementType:Kn.POLYGONS,vertexSize:2,strict:!0,contours:[K.insetPoints,...b]})}catch{ne=gte}if(!ne)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<u&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let W=0;W<ne.elementCount*3;W+=3){let ve=this._buildSurfaceVert(ne,ne.elements[W+0],J),de=this._buildSurfaceVert(ne,ne.elements[W+1],J),pe=this._buildSurfaceVert(ne,ne.elements[W+2],J);x.push(ve.top,de.top,pe.top),o===!1&&x.push(pe.bottom,de.bottom,ve.bottom)}}this.vertexCache={}}this._buffer.shrink();let S=new Ot(Uint32Array.from(x),1),A=new Ot(this._buffer.positions,3),E=new Ot(this._buffer.normals,3),M=new Ot(this._buffer.uvs,2);A.needsUpdate=!0,E.needsUpdate=!0,M.needsUpdate=!0,S.needsUpdate=!0,this.setAttribute("position",A),this.setAttribute("normal",E),this.setAttribute("uv",M),this.setIndex(S)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let n=t[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,n,r),a=this._buildBevelVert(e,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e,i){let n=e.toString();if(n in this.vertexCache)return this.vertexCache[n];let r=t.vertices[e*2+0],s=t.vertices[e*2+1],o=(r-this._minX)/this._width,a=(s-this._minY)/this._height;this.forPathBevel&&(a=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,h=l*2,u={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=r,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[h+0]=o,this._buffer.uvs[h+1]=a,this.forPathBevel===!1&&(this._buffer.positions[c+3]=r,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=i,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[h+2]=o,this._buffer.uvs[h+3]=a),this.vertexCache[n]=u,u}_buildBevelVert(t,e,i,n=1,r){let s=`${e.bevelI}:${i}`;if(s in this.vertexCache&&r!==0&&r!==1&&(!r||r===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[o,a]=e.boundary.vertexIndices[i],l,c,h,u;o!==a?(c=o,l=a,u=!1,h=t.continuous[c]&&t.continuous[l]):(l=o,c=(l-1+t.count)%t.count,u=t.concave[l]&&e.bevelI>0,h=t.continuous[l]||u);let d=Math.cos(e.angle),f=Math.sin(e.angle),p=i*2,m=l*2,g=c*2,v=e.boundary.vertices[p+0],y=e.boundary.vertices[p+1],x=(1-f)*this._bevel,b=(v-this._minX)/this._width,S=(y-this._minY)/this._height;this.forPathBevel&&(r!==void 0&&(b=r),S=1);let A=t.normals[m+0],E=t.normals[m+1],M=t.normals[g+0],T=t.normals[g+1];if(u){let F=M-A,V=T-E;A=A+F*(1-n),E=E+V*(1-n);let Q=Math.sqrt(A*A+E*E);A/=Q,E/=Q}let P=this.forPathBevel?this._buffer.get(h?1:2):this._buffer.get(h?2:4),I=P*3,k=P*2,R={i,fi:l,topP:P+0,topN:P+0,bottomP:P+1,bottomN:P+1,pathBevelUCoord:r};return this._buffer.positions[I+0]=v,this._buffer.positions[I+1]=y,this._buffer.positions[I+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[I+0]=A*d,this._buffer.normals[I+1]=E*d,this._buffer.normals[I+2]=f,this._buffer.uvs[k+0]=b,this._buffer.uvs[k+1]=S,this.forPathBevel===!1&&(this._buffer.positions[I+3]=v,this._buffer.positions[I+4]=y,this._buffer.positions[I+5]=x,this._buffer.normals[I+3]=A*d,this._buffer.normals[I+4]=E*d,this._buffer.normals[I+5]=-f,this._buffer.uvs[k+2]=S,this._buffer.uvs[k+3]=b),h||(this.forPathBevel?(P+=1,I+=3,k+=2):(P+=2,I+=6,k+=4),R.topP=P+0,R.bottomP=P+1,this._buffer.positions[I+0]=v,this._buffer.positions[I+1]=y,this._buffer.positions[I+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[I+0]=M*d,this._buffer.normals[I+1]=T*d,this._buffer.normals[I+2]=f,this._buffer.uvs[k+0]=b,this._buffer.uvs[k+1]=S,this.forPathBevel===!1&&(this._buffer.positions[I+3]=v,this._buffer.positions[I+4]=y,this._buffer.positions[I+5]=x,this._buffer.normals[I+3]=M*d,this._buffer.normals[I+4]=T*d,this._buffer.normals[I+5]=-f,this._buffer.uvs[k+2]=S,this._buffer.uvs[k+3]=b)),this.vertexCache[s]=R,R}clone(){let t=new Sz(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=CT(this.userData),t}},vte=class extends Rt{constructor(t,e=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Ii.ODD,this.elementType=Kn.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:Ii.ODD,elementType:Kn.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let n=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,c;for(let d=0,f=n.length/2;d<f;d++){let p=d*2,m=n[p+0],g=n[p+1];if(l!==void 0&&m!==l&&(o=!1),c!==void 0&&g!==c&&(a=!1),l=m,c=g,!o&&!a)break}if(!o&&!a)try{s=sd({contours:[n,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=bz}let h=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Ot(new Float32Array(h*3),3),this._normalAttribute=new Ot(new Float32Array(h*3),3),this._uvAttribute=new Ot(new Float32Array(h*2),2),this._indexAttribute=new Ot(new Uint32Array(u*3),1),s){let d=1/0,f=-1/0,p=1/0,m=-1/0;for(let y=0,x=h;y<x;y++){let b=y*2,S=s.vertices[b+0],A=s.vertices[b+1];S<d&&(d=S),S>f&&(f=S),A<p&&(p=A),A>m&&(m=A)}let g=f-d,v=m-p;for(let y=0,x=h;y<x;y++){let b=y*2,S=s.vertices[b+0],A=s.vertices[b+1],E=(S-d)/g,M=(A-p)/v;this._positionAttribute.setXYZ(y,S,A,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,E,M)}for(let y=0,x=u;y<x;y++){let b=y*3,S=s.elements[b+0],A=s.elements[b+1],E=s.elements[b+2];this._indexAttribute.setX(b+0,S),this._indexAttribute.setX(b+1,A),this._indexAttribute.setX(b+2,E)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new vte(this._shape,this._curveSegments);return t.userData=CT(this.userData),t}},yte=class extends Sz{constructor(t,e,i=0,n=12,r=3,s=Ii.ODD){super(t,e,i,n,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let n=t[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,n,r),a=this._buildBevelVert(e,n,(r+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new yte(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=CT(this.userData),t}},um=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var c,h;let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Ii.ODD},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??i.roundness;o!==void 0&&(o instanceof Cn?(o.width!==n||o.height!==r)&&o.applySize(n,r):o=new Cn(n,r).fromJSON(o),((c=t.parameters)==null?void 0:c.roundness)!==void 0&&((h=t.parameters)==null?void 0:h.roundness)>0&&o.update());let l=o??new Cn(n,r);return{parameters:Object.assign(i,{width:n,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:i,extrudeBevelSegments:n,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new vte(t.shape,r,{windingRule:o}):a=new yte(t.shape,e,i,r,n,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},xte=Math.PI*2,Az=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof Cn?t.shape:new Cn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:n,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c=t.shape,h=e*.5,u=i*.5,d=RNe(c,h,u,r*Math.PI/180,n,s);c.isClosed=!0,c.update();let f=um.create({shape:c,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(f,{userData:{...t,type:"EllipseGeometry"}})}};function RNe(t,e,i,n,r,s){if(n>=xte)return r>30||r%4===0?(FNe(t,e,i,s),Math.round(r/4)):U8(t,n,r,e,i,s);n=Math.max(n,.001);let o={x:0,y:i},a=n+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*i},c=TNe({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:i,largeArcFlag:n>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?ONe(t,o.x,o.y,c,r,e,i,s):U8(t,n,r,e,i,s)}function ONe(t,e,i,n,r,s,o,a){let l=Math.round(r/n.length);t.addPoint(Pv(e,i));for(let c=0,h=n.length;c<h;c++){let u=n[c],d=t.points[c],f=Pv(u.x,u.y);d.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),t.addPoint(f)}return a>0?_te(t,s,o,a):t.addPoint(Pv(0,0)),l}function U8(t,e,i,n,r,s){let o=-e/i;for(let a=0;a<=i;a++){let l=o*a,c=Math.sin(l)*n,h=Math.cos(l)*r;t.addPoint(Pv(c,h))}return e<xte?s>0?_te(t,n,r,s):t.addPoint(Pv(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&wte(t,n,r,s)),1}function FNe(t,e,i,n=0,r=0,s=0){let o=.5522847498,a=e*o,l=i*o;t.addPoint(AA(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(AA(r,s+i,r-a,s+i,r+a,s+i)),t.addPoint(AA(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(AA(r,s-i,r+a,s-i,r-a,s-i)),n>0&&wte(t,e,i,n)}function Pv(t,e){return new Tv(ri.generateUUID(),new ge(t,e))}function AA(t,e,i,n,r,s){let o=Pv(t,e);return o.controls[0].position.set(i,n),o.controls[1].position.set(r,s),o}function _te(t,e,i,n){bte(t,e,i,n).forEach(r=>t.addPoint(r))}function wte(t,e,i,n){let r=bte(t,e,i,n),s=new Cn;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function bte(t,e,i,n){let r=n*e/100,s=r*(Math.abs(i)/Math.abs(e)),o=new ge(r/e,s/i),a=t.points.map(l=>{let c=l.clone();return c.uuid=ri.generateUUID(),c}).reverse();return a.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),h=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(h),l.controls[1].position.copy(c)}),a}var NNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??n),s=Math.abs(i.depth??n),o=Math.abs(Math.min(n,s))/2;return{parameters:Object.assign(i,{width:n,height:r,depth:s,radius:o,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(t){let{width:e,height:i,depth:n,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=t.parameters,d=new Ste(!1,e,i,n,r,s,o,a,l,c,h,u);return Object.assign(d,{userData:{...t,type:"HelixGeometry"}})}},U3=new wv([0,0,0],1),Ste=class extends Rt{constructor(t=!0,e=1,i=1,n=1,r=1,s=1,o=1,a=1,l=1,c=1,h=1,u=1){if(super(),s===0)return;let d=t&&s===1;d&&(u=0),h>100&&(h=100),h===0&&(u=0);let f=()=>new O,p=new O,m=f(),g=f(),v=f(),y,x,b,S,A,E,M,T,P=f(),I=f(),k=f(),R=f(),F=f(),V=f(),Q=f(),X=f(),z=i-2*a+.001,Y=z/s,j=Math.ceil(o*s),J=j+1,H=z/j,Z=-z/2,K=c+1,ne=2*Math.PI/c,W=Math.PI/2/u,ve=.01,de=Math.min((1-h/100)*a,a-ve),pe=a-de,ce=0,ye=2,ae=u*ye+ye,le=K*ae/ye,Ee=le+K*J,Te=K*(J+ae),[Be,Ue,Ie]=[3,3,2].map(ue=>Array(Te*ue).fill(0)),Pe=[],Je=r-a;function Ke(ue,Ge){let re=Math.PI/2;E=Ge*H,T=2*Math.PI*(E%Y)/Y+re,E+=Z,M=Math.sin(T)*Je,A=Math.cos(T)*Je,t?ue.set(A,M,E):ue.set(A,E,M)}Ke(p,-1e-10),Ke(m,0),P.copy(p),Ke(p,1);let U=p.distanceTo(m),L=d?0:pe+de,te=U*j+2*L,_e=de,we=te-L;for(let ue=0;ue<=j;ue++){Ke(g,ue),X.subVectors(g,P).normalize(),P.copy(g),V.copy(g).setComponent(+t+1,0).normalize(),Q.crossVectors(X,V).normalize();let Ge=ue===0,re=ue===j,be=Ge?3*Math.PI/2:W,Re=Ge?_e:we,Ne=Ge?K:Ee,tt=Ge?0:Te-K,xt=X.clone().multiplyScalar(Ge?-pe:pe).add(g),kt=X.clone().multiplyScalar(Ge?-1:1).normalize();for(let q=0;q<K;q++){let oe=q*ne;if(I.addVectors(p.copy(V).multiplyScalar(a*Math.cos(oe)),m.copy(Q).multiplyScalar(a*Math.sin(oe))),k.copy(I).normalize(),Ge||re){d||(ce=tt+q,[0,1,2].forEach(xe=>{Be[ce*3+xe]=xt.getComponent(xe),Ue[ce*3+xe]=kt.getComponent(xe)}),Ie[ce*2]=+re,Ie[ce*2+1]=q/c),m.copy(k).multiplyScalar(de),v.addVectors(g,m);for(let xe=0;xe<u;xe++){let Fe=xe*W+be;R.addVectors(p.copy(X).multiplyScalar(pe*Math.sin(Fe)),m.copy(k).multiplyScalar(pe*Math.cos(Fe))),F.copy(R).normalize(),m.addVectors(v,R),R.normalize(),ce=Ne+xe*K+q,[0,1,2].forEach(pt=>{Be[ce*3+pt]=m.getComponent(pt),Ue[ce*3+pt]=F.getComponent(pt)});let Xe=+Ge+Math.sin(Fe);Ie[ce*2]=(Re+pe*Xe)/te,Ie[ce*2+1]=q/c}}m.addVectors(g,I),ce=le+ue*K+q,[0,1,2].forEach(xe=>{Be[ce*3+xe]=m.getComponent(xe),Ue[ce*3+xe]=k.getComponent(xe)}),Ie[ce*2]=(L+ue*U)/te,Ie[ce*2+1]=q/c}}let Me=J+2*u+ye,[We,Le]=[+d,Me-1];for(let ue=We;ue<=Le-1;ue++){let Ge=d&&ue===Le-1;for(let re=0;re<K-1;re++)y=ue*K+re,x=y+1,b=(Ge?re:y)+K,S=(Ge?re+1:x)+K,ue===0?Pe.push(x,S,b):ue===Me-2?Pe.push(y,x,b):Pe.push(y,x,b,x,S,b)}this.setIndex(Pe),this.setAttribute("position",new gt(Be,3)),this.setAttribute("normal",new gt(Ue,3)),this.setAttribute("uv",new gt(Ie,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let t=this.userData.parameters,e=Math.ceil(t.tubularSegments),i=t.radialSegments+1,n=Array.from(this.getIndex().array),r,s,o,a,l=6*(e-1)*t.radialSegments,c=e,h=c===e;for(let u=0;u<t.radialSegments;u++)r=c*i+u,s=r+1,o=(h?u:r)+i,a=(h?u+1:s)+i,n[l++]=r,n[l++]=s,n[l++]=o,n[l++]=s,n[l++]=a,n[l++]=o;return n.length=l,U3.array=n,U3.count=n.length,U3}},kNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new Ate(e*.5,s,o):new D$(e*.5,r);return a.scale(1,i/e,n/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},Ate=class extends xz{constructor(t=1,e=.2,i=4){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,i),this.type=o}static fromJSON(t){return new Ate(t.radius,t.corner,t.cornerSides)}},zNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var n;(((n=t.parameters)==null?void 0:n.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{points:e,segments:i,verticalSegments:n}=t.parameters,r=new OC;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new S$(r.extractPoints(n).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},Kl=new Qe,G3=new Ri,MA=new O,hE=class extends qr{constructor(){super(),this.uuid=ri.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new Pr().getNormalMatrix(t);for(let i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return Kl.makeRotationX(t),this.applyMatrix4(Kl),this}rotateY(t){return Kl.makeRotationY(t),this.applyMatrix4(Kl),this}rotateZ(t){return Kl.makeRotationZ(t),this.applyMatrix4(Kl),this}translate(t,e,i){return Kl.makeTranslation(t,e,i),this.applyMatrix4(Kl),this}scale(t,e,i){return Kl.makeScale(t,e,i),this.applyMatrix4(Kl),this}lookAt(t){return G3.lookAt(t),G3.updateMatrix(),this.applyMatrix4(G3.matrix),this}fromBufferGeometry(t){let e=this,i=t.index!==null?t.index:void 0,n=t.attributes;if(n.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=n.position,s=n.normal,o=n.color,a=n.uv,l=n.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)e.vertices.push(new O().fromBufferAttribute(r,u)),o!==void 0&&e.colors.push(new Tt().fromBufferAttribute(o,u));function c(u,d,f,p){let m=o===void 0?[]:[e.colors[u].clone(),e.colors[d].clone(),e.colors[f].clone()],g=s===void 0?[]:[new O().fromBufferAttribute(s,u),new O().fromBufferAttribute(s,d),new O().fromBufferAttribute(s,f)],v=new sO(u,d,f,g,m,p);e.faces.push(v),a!==void 0&&e.faceVertexUvs[0].push([new ge().fromBufferAttribute(a,u),new ge().fromBufferAttribute(a,d),new ge().fromBufferAttribute(a,f)]),l!==void 0&&e.faceVertexUvs[1].push([new ge().fromBufferAttribute(l,u),new ge().fromBufferAttribute(l,d),new ge().fromBufferAttribute(l,f)])}let h=t.groups;if(h.length>0)for(let u=0;u<h.length;u++){let d=h[u],f=d.start,p=d.count;for(let m=f,g=f+p;m<g;m+=3)i!==void 0?c(i.getX(m),i.getX(m+1),i.getX(m+2),d.materialIndex):c(m,m+1,m+2,d.materialIndex)}else if(i!==void 0)for(let u=0;u<i.count;u+=3)c(i.getX(u),i.getX(u+1),i.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(MA).negate(),this.translate(MA.x,MA.y,MA.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,i=e===0?1:1/e,n=new Qe;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let t=new O,e=new O;for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let i=0,n=this.vertices.length;i<n;i++)e[i]=new O;if(t){let i=new O,n=new O;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];i.subVectors(c,l),n.subVectors(a,l),i.cross(n),e[o.a].add(i),e[o.b].add(i),e[o.c].add(i)}}else{this.computeFaceNormals();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let i=0,n=this.vertices.length;i<n;i++)e[i].normalize();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let i=this.faces[t],n=i.vertexNormals;n.length===3?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,i=this.faces.length;e<i;e++){let n=this.faces[e];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(let r=0,s=n.vertexNormals.length;r<s;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}let t=new hE;t.faces=this.faces;for(let e=0,i=this.morphTargets.length;e<i;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new O,c={a:new O,b:new O,c:new O};r.push(l),s.push(c)}}let n=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=n.faceNormals[r],l=n.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,i=this.faces.length;e<i;e++){let n=this.faces[e];n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gn),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new qo),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,i=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let n,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,c=this.colors,h=t.colors;e!==void 0&&(n=new Pr().getNormalMatrix(e));for(let u=0,d=o.length;u<d;u++){let f=o[u].clone();e!==void 0&&f.applyMatrix4(e),s.push(f)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let f=l[u],p,m,g=f.vertexNormals,v=f.vertexColors,y=new sO(f.a+r,f.b+r,f.c+r);y.normal.copy(f.normal),n!==void 0&&y.normal.applyMatrix3(n).normalize();for(let x=0,b=g.length;x<b;x++)p=g[x].clone(),n!==void 0&&p.applyMatrix3(n).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let x=0,b=v.length;x<b;x++)m=v[x],y.vertexColors.push(m.clone());y.materialIndex=f.materialIndex+i,a.push(y)}for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let y=0,x=g.length;y<x;y++)v.push(g[y].clone());this.faceVertexUvs[u].push(v)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},i=[],n=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let c=this.vertices[a],h=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);e[h]===void 0?(e[h]=a,i.push(this.vertices[a]),n[a]=i.length-1):n[a]=n[e[h]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let c=this.faces[a];c.a=n[c.a],c.b=n[c.b],c.c=n[c.c];let h=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(h[u]===h[(u+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-i.length;return this.vertices=i,o}setFromPoints(t){this.vertices=[];for(let e=0,i=t.length;e<i;e++){let n=t[e];this.vertices.push(new O(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function i(a,l){return a.materialIndex-l.materialIndex}t.sort(i);let n=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;n&&n.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(n[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(t[p]=f[p]);return t}let e=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];e.push(p.x,p.y,p.z)}let i=[],n=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],m=!0,g=!1,v=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,x=p.vertexNormals.length>0,b=p.color.r!==1||p.color.g!==1||p.color.b!==1,S=p.vertexColors.length>0,A=0;if(A=c(A,0,0),A=c(A,1,m),A=c(A,2,g),A=c(A,3,v),A=c(A,4,y),A=c(A,5,x),A=c(A,6,b),A=c(A,7,S),i.push(A),i.push(p.a,p.b,p.c),i.push(p.materialIndex),v){let E=this.faceVertexUvs[0][f];i.push(d(E[0]),d(E[1]),d(E[2]))}if(y&&i.push(h(p.normal)),x){let E=p.vertexNormals;i.push(h(E[0]),h(E[1]),h(E[2]))}if(b&&i.push(u(p.color)),S){let E=p.vertexColors;i.push(u(E[0]),u(E[1]),u(E[2]))}}function c(f,p,m){return m?f|1<<p:f&~(1<<p)}function h(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return r[p]!==void 0||(r[p]=n.length/3,n.push(f.x,f.y,f.z)),r[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=s.length,s.push(f.getHex())),o[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=a.length/2,a.push(f.x,f.y)),l[p]}return t.data={},t.data.vertices=e,t.data.normals=n,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=i,t}clone(){return new hE().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let u=0,d=e.length;u<d;u++)this.vertices.push(e[u].clone());let i=t.colors;for(let u=0,d=i.length;u<d;u++)this.colors.push(i[u].clone());let n=t.faces;for(let u=0,d=n.length;u<d;u++)this.faces.push(n[u].clone());for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let y=0,x=g.length;y<x;y++){let b=g[y];v.push(b.clone())}this.faceVertexUvs[u].push(v)}}let r=t.morphTargets;for(let u=0,d=r.length;u<d;u++){let f={};if(f.name=r[u].name,r[u].vertices!==void 0){f.vertices=[];for(let p=0,m=r[u].vertices.length;p<m;p++)f.vertices.push(r[u].vertices[p].clone())}if(r[u].normals!==void 0){f.normals=[];for(let p=0,m=r[u].normals.length;p<m;p++)f.normals.push(r[u].normals[p].clone())}this.morphTargets.push(f)}let s=t.morphNormals;for(let u=0,d=s.length;u<d;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,m=s[u].vertexNormals.length;p<m;p++){let g=s[u].vertexNormals[p],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),f.vertexNormals.push(v)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,m=s[u].faceNormals.length;p<m;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=t.skinWeights;for(let u=0,d=o.length;u<d;u++)this.skinWeights.push(o[u].clone());let a=t.skinIndices;for(let u=0,d=a.length;u<d;u++)this.skinIndices.push(a[u].clone());let l=t.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=t.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new UNe().fromGeometry(this),e=new Rt,i=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",CA.call(new Ot(i,3),t.vertices)),t.normals.length>0){let n=new Float32Array(t.normals.length*3);e.setAttribute("normal",CA.call(new Ot(n,3),t.normals))}if(t.colors.length>0){let n=new Float32Array(t.colors.length*3);e.setAttribute("color",G8.call(new Ot(n,3),t.colors))}if(t.uvs.length>0){let n=new Float32Array(t.uvs.length*2);e.setAttribute("uv",V8.call(new Ot(n,2),t.uvs))}if(t.uvs2.length>0){let n=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",V8.call(new Ot(n,2),t.uvs2))}e.groups=t.groups;for(let n in t.morphTargets){let r=[],s=t.morphTargets[n];for(let o=0,a=s.length;o<a;o++){let l=s[o],c=new gt(l.data.length*3,3);c.name=l.name,r.push(CA.call(c,l.data))}e.morphAttributes[n]=r}if(t.skinIndices.length>0){let n=new gt(t.skinIndices.length*4,4);e.setAttribute("skinIndex",H8.call(n,t.skinIndices))}if(t.skinWeights.length>0){let n=new gt(t.skinWeights.length*4,4);e.setAttribute("skinWeight",H8.call(n,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Rt,i=t.geometry;if(t.isPoints||t.isLine){let n=new gt(i.vertices.length*3,3),r=new gt(i.colors.length*3,3);if(e.setAttribute("position",CA.call(n,i.vertices)),e.setAttribute("color",G8.call(r,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new gt(i.lineDistances.length,1);e.setAttribute("lineDistance",GNe.call(s,i.lineDistances))}i.boundingSphere!==null&&(e.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(e.boundingBox=i.boundingBox.clone())}else t.isMesh&&(e=i.toBufferGeometry());return e}};hE.prototype.isGeometry=!0;var UNe=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],i,n,r,s=t.faces;for(n=0;n<s.length;n++){let o=s[n];o.materialIndex!==r&&(r=o.materialIndex,i!==void 0&&(i.count=n*3-i.start,e.push(i)),i={start:n*3,materialIndex:r})}i!==void 0&&(i.count=n*3-i.start,e.push(i)),this.groups=e}fromGeometry(t){let e=t.faces,i=t.vertices,n=t.faceVertexUvs,r=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let g=0;g<a;g++)l[g]={name:o[g].name,data:[]};this.morphTargets.position=l}let c=t.morphNormals,h=c.length,u;if(h>0){u=[];for(let g=0;g<h;g++)u[g]={name:c[g].name,data:[]};this.morphTargets.normal=u}let d=t.skinIndices,f=t.skinWeights,p=d.length===i.length,m=f.length===i.length;i.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<e.length;g++){let v=e[g];this.vertices.push(i[v.a],i[v.b],i[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let b=v.normal;this.normals.push(b,b,b)}let x=v.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let b=v.color;this.colors.push(b,b,b)}if(r===!0){let b=n[0][g];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new ge,new ge,new ge))}if(s===!0){let b=n[1][g];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new ge,new ge,new ge))}for(let b=0;b<a;b++){let S=o[b].vertices;l[b].data.push(S[v.a],S[v.b],S[v.c])}for(let b=0;b<h;b++){let S=c[b].vertexNormals[g];u[b].data.push(S.a,S.b,S.c)}p&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},sO=class{constructor(t,e,i,n,r,s=0){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new O,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Tt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function GNe(t){return this.array.set(t),this}function G8(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new Tt),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this}function V8(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new ge),e[i++]=s.x,e[i++]=s.y}return this}function CA(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new O),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z}return this}function H8(t){let e=this.array,i=0;for(let n=0,r=t.length;n<r;n++){let s=t[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new Ht),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this}var VNe=["a","b","c"];function HNe(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function V3(t,e,i){let n=Math.min(t,e),r=Math.max(t,e),s=n+"_"+r;return i.get(s)}function H3(t,e,i,n,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,c;if(n.has(l))c=n.get(l);else{let h=i[o],u=i[a];c={a:h,b:u,newEdge:null,faces:[]},n.set(l,c)}c.faces.push(r),s[t].edges.push(c),s[e].edges.push(c)}function jNe(t,e,i,n){let r,s,o;for(r=0,s=t.length;r<s;r++)i[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],H3(o.a,o.b,t,n,o,i),H3(o.b,o.c,t,n,o,i),H3(o.c,o.a,t,n,o,i)}function EA(t,e,i,n,r){t.push(new sO(e,i,n,void 0,void 0,r))}function fg(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function TA(t,e,i,n){t.push([e.clone(),i.clone(),n.clone()])}var WNe=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Rt?t=new hE().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new O,i,n,r,s,o,a=t.vertices,l=t.faces,c=t.faceVertexUvs[0],h=c!==void 0&&c.length>0,u=[],d=new Map;jNe(a,l,u,d);let f=[],p,m,g,v,y,x,b;for(let ve of Array.from(d.keys())){for(m=d.get(ve),g=new O,y=3/8,x=1/8,b=m.faces.length,b!=2&&(y=.5,x=0,b!=1),g.addVectors(m.a,m.b).multiplyScalar(y),e.set(0,0,0),s=0;s<b;s++){for(v=m.faces[s],o=0;o<3&&(p=a[HNe(v,VNe[o])],!(p!==m.a&&p!==m.b));o++);p&&e.add(p)}e.multiplyScalar(x),g.add(e),m.newEdge=f.length,f.push(g)}let S,A,E,M,T,P,I,k=[];for(n=0,r=a.length;n<r;n++){for(P=a[n],T=u[n].edges,i=T.length,i==3?S=3/16:i>3&&(S=3/(8*i)),A=1-i*Number(S),E=S,i<=2&&(i==2?(A=3/4,E=1/8):i==1||i==0),I=P.clone().multiplyScalar(A),e.set(0,0,0),s=0;s<i;s++)M=T[s],p=M.a!==P?M.a:M.b,e.add(p);e.multiplyScalar(Number(E)),I.add(e),k.push(I)}let R=k.concat(f),F=k.length,V,Q,X,z=[],Y=[],j,J,H,Z,K=new ge,ne=new ge,W=new ge;for(n=0,r=l.length;n<r;n++)v=l[n],V=Number(V3(v.a,v.b,d).newEdge)+F,Q=Number(V3(v.b,v.c,d).newEdge)+F,X=Number(V3(v.c,v.a,d).newEdge)+F,EA(z,V,Q,X,v.materialIndex),EA(z,v.a,V,X,v.materialIndex),EA(z,v.b,Q,V,v.materialIndex),EA(z,v.c,X,Q,v.materialIndex),h&&(j=c[n],J=j[0],H=j[1],Z=j[2],K.set(fg(J.x,H.x),fg(J.y,H.y)),ne.set(fg(H.x,Z.x),fg(H.y,Z.y)),W.set(fg(J.x,Z.x),fg(J.y,Z.y)),TA(Y,K,ne,W),TA(Y,J,K,W),TA(Y,H,ne,K),TA(Y,Z,W,ne));t.vertices=R,t.faces=z,h&&(t.faceVertexUvs[0]=Y)}},nr=new O,XNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=t.geometry??(e==null?void 0:e.geometry)??new Rt().copy(new Ic(100,100,100)),n;e===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(nr),n={width:nr.x,height:nr.y,depth:nr.z,subdivisions:0}):n=e.parameters;let r={...n,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:i}}static build(t){let{width:e,height:i,depth:n,subdivisions:r}=t.parameters,s=t.geometry??new Rt().copy(new Ic(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(nr)):nr.set(o.width,o.height,o.depth),(e!==nr.x||i!==nr.y||n!==nr.z)&&s.scale(nr.x===0?1:e/nr.x,nr.y===0?1:i/nr.y,nr.z===0?1:n/nr.z);let a=s.originalGeometry;try{r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new WNe(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,i){new N$(i).load(t,n=>{let r=this.normalizeInputs({geometry:n});n.boundingBox.getSize(nr);let s=100/nr.x;Object.assign(r.parameters,{width:100,height:nr.y*s,depth:nr.z*s}),e(this.build(r))})}},Mte=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof Cn?t.shape:new Cn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:n,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,c=e*.5,h=i*.5,u=0,d=0,f=2*Math.PI/n;for(let m=0;m<n;m++){let g=f*m,v=u+Math.sin(g)*c,y=d+Math.cos(g)*h;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=r;l.roundness=r,l.update();let p=um.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(p,{userData:{...t,type:"PolygonGeometry"}})}},qNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=new QNe(e*.5,i,r,s,o,a,l);return c.scale(1,1,n/e),Object.assign(c,{userData:{...t,type:"PyramidGeometry"}})}};function ax(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function j3(t,e,i,n,r,s){let o=e.clone().sub(t),a=i.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),n===r){let c=o.add(a).normalize();s.copy(t).addScaledVector(c,n/Math.sin(l/2))}else{let c=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(c)),s.addScaledVector(a,n/Math.sin(c))}}function YNe(t,e,i){let n=t.clone().sub(e),r=i.clone().sub(e);return n.projectOnVector(r),n.add(e)}var QNe=class extends Rt{constructor(t=.5,e=1,i=4,n=1,r=!1,s=0,o=4){super(),i=Math.floor(Math.max(3,i)),n=Math.floor(n),o=Math.floor(o);let a=[],l=[],c=[],h=[],u=0,d=e/2,f=Math.PI/i,p=t*Math.cos(Math.PI/i),m=2*Math.PI/i,g=(i-2)*Math.PI/i,v=Math.PI-g,y=new O(0,-d,0),x=new O(0,d,0),b=new ge(t,-d),S=new ge(p,-d),A=new ge(0,x.y).sub(S),E=new ge(0,x.y).sub(b),M=new ge(A.y,-A.x).normalize(),T=new ge(E.y,-E.x).normalize(),P=t*Math.cos(Math.PI/i)*Math.tan((Math.PI-A.angle())/2)-1e-8;s=Math.min(s,P);let I;{let X=new O(M.x,M.y,0),z=new O(Math.cos(m)*X.x,X.y,Math.sin(m)*X.x);I=X.angleTo(z)}let k=s/Math.tan((Math.PI-A.angle())/2),R=s/Math.tan((Math.PI-I)/2),F=new O;if(!r){l.push(y.x,y.y,y.z),c.push(0,-1,0),h.push(0,0);let X=u++,z=[],Y=b.clone(),j=k/Math.cos(Math.PI/i);Y.x-=j;for(let J=0;J<i;J++){let H=J/i*Math.PI*2+f,Z=new ge(Math.sin(H),Math.cos(H));ax(Y,Z,F),l.push(F.x,F.y,F.z),c.push(0,-1,0),h.push(0,0),z.push(u++)}for(let J=0;J<z.length;J++)a.push(z[J],X,z[(J+1)%z.length])}{let X=new O,z=new O,Y=new O,j=new O,J=new O,H=new O;for(let Z=0;Z<i;Z++){let K=Z/i*Math.PI*2+f,ne=(Z+.5)/i*Math.PI*2+f,W=(Z+1)/i*Math.PI*2+f,ve=new ge(Math.sin(K),Math.cos(K)),de=new ge(Math.sin(ne),Math.cos(ne)),pe=new ge(Math.sin(W),Math.cos(W));ax(b,ve,z),ax(b,pe,Y),ax(M,de,X),j3(x,z,Y,R,R,j),l.push(j.x,j.y,j.z),j3(z,x,Y,R,k,J),l.push(J.x,J.y,J.z),j3(Y,z,x,k,R,H),l.push(H.x,H.y,H.z),c.push(X.x,X.y,X.z),c.push(X.x,X.y,X.z),c.push(X.x,X.y,X.z),h.push(0,0),h.push(0,0),h.push(0,0);let ce=u++,ye=u++,ae=u++;if(a.push(ce,ye,ae),s>0){{let Te=z.clone().add(Y).multiplyScalar(.5),Be=x.clone().sub(Te).normalize(),Ue=y.clone().sub(Te).normalize().add(Be).normalize().multiplyScalar(-1),Ie=H.clone().sub(J);V(Te,Ie,Ue,A.angle())}let le,Ee;{let Te=new O;ax(T,pe,Te);let Be=H.clone().add(j).multiplyScalar(.5);Be=YNe(Be,Y,x);let Ue=H.clone().sub(j);[le,Ee]=V(Be,Ue,Te,I,j.y)}{let Te=le,Be=Te.clone().setY(0).normalize(),Ue=new O(0,-1,0),Ie=Be.clone().cross(Ue);Q(Te,Be,Ue,Ie)}{let Te=A.angle(),Be=Math.PI-Te,Ue=x.clone();Ue.y-=s/Math.sin(Te-Math.PI/2);let Ie=new O,Pe=[];for(let Ke=0;Ke<o;Ke++){let U=[],L=Math.PI/2-Be*Ke/o,te=Math.cos(L),_e=Math.sin(L),we=ne;for(let Me=0;Me<=Ke;Me++){let We=Math.cos(we),Le=Math.sin(we);X.x=te*Le,X.y=_e,X.z=te*We,Ie.copy(Ue).addScaledVector(X,s),l.push(Ie.x,Ie.y,Ie.z),c.push(X.x,X.y,X.z),h.push(0,0),U.push(u++),we+=Math.PI*2/Ke/i}Pe.push(U)}Ee.reverse(),Pe.push(Ee);let Je=Pe.length-1;for(let Ke=0;Ke<Je;Ke++){let U=Pe[Ke],L=Pe[Ke+1],te=U.length-1;a.push(L[1],U[0],L[0]);for(let _e=1;_e<=te;_e++)a.push(U[_e],U[_e-1],L[_e]),a.push(L[_e+1],U[_e],L[_e])}}}}}this.setIndex(a),this.setAttribute("position",new gt(l,3)),this.setAttribute("normal",new gt(c,3)),this.setAttribute("uv",new gt(h,2));function V(X,z,Y,j,J){let H=-j/2,Z=(Math.PI-j)/2,K=z.clone().normalize().cross(Y);X.addScaledVector(Y,-s/Math.sin(Z));let ne=new O,W=new O,ve=1,de=u,pe=[];for(let ce=0;ce<=o;ce++){let ye=H+ce/o*j;W.set(0,0,0),W.addScaledVector(K,Math.sin(ye)),W.addScaledVector(Y,Math.cos(ye));for(let ae=0;ae<=ve;ae++){let le=ae/ve-.5;if(ne.copy(X),ne.addScaledVector(z,le),ne.addScaledVector(W,s),J!=null){let Ee=Math.max(0,ne.y-J);ne.addScaledVector(z,-Ee/z.y)}l.push(ne.x,ne.y,ne.z),c.push(W.x,W.y,W.z),h.push(0,0),ae===0&&pe.push(u),u++}}for(let ce=0;ce<o;ce++)for(let ye=0;ye<ve;ye++){let ae=de+ye+(ve+1)*ce,le=ae+(ve+1),Ee=le+1,Te=ae+1;a.push(ae,le,Te),a.push(le,Ee,Te)}return[X.clone().addScaledVector(z,.5),pe]}function Q(X,z,Y,j){let J=Math.PI/2,H=E.angle()-J,Z=[],K=new O,ne=new O;for(let ve=0;ve<=o;ve++){let de=[],pe=ve/o;for(let ce=0;ce<=ve;ce++){let ye=((ve?ce/ve:0)-.5)*v,ae=Math.cos(ye),le=Math.sin(ye),Ee=Math.atan(Math.tan(H)*ae),Te=(J+Ee)*pe,Be=Math.cos(Te),Ue=Math.sin(Te);K.set(0,0,0),K.addScaledVector(z,Ue*ae),K.addScaledVector(Y,Be),K.addScaledVector(j,Ue*le),ne.copy(X).addScaledVector(K,s),l.push(ne.x,ne.y,ne.z),c.push(K.x,K.y,K.z),h.push(0,0),de.push(u++)}Z.push(de)}let W=Z.length-1;for(let ve=0;ve<W;ve++){let de=Z[ve],pe=Z[ve+1],ce=de.length-1;a.push(de[0],pe[1],pe[0]);for(let ye=1;ye<=ce;ye++)a.push(de[ye-1],de[ye],pe[ye]),a.push(de[ye],pe[ye+1],pe[ye])}}}},Cte=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),n=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof Cn?t.shape:new Cn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:n}}static build(t){let e=t.shape,{width:i,height:n,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c={x:i*.5,y:n*.5},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(b,S,A){return S>i&&A>n?Math.min(b*i/S,b*n/A):S>i?b*i/S:A>n?b*n/A:b}let f=[];f[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let p=h.x,m=u.x,g=u.y,v=h.y;e.addPoint(e.createPoint(p,g)),e.addPoint(e.createPoint(m,g)),e.addPoint(e.createPoint(m,v)),e.addPoint(e.createPoint(p,v)),e.isClosed=!0;let y=!0;for(let b=0,S=e.points.length;b<S;b++)e.points[b].roundness=f[b],b>0&&f[b]!==f[b-1]&&(y=!1);y&&(e.roundness=f[0]),e.useCubicForRoundedCorners=s!==1,e.update();let x=um.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...t,type:"RectangleGeometry"}})}},JNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e=100,height:i=e,depth:n=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:c}=t.parameters,h=new Fk(.5*e,r,s,o,a,l,c);return h.scale(1,i/e,n/e),Object.assign(h,{userData:{...t,type:"SphereGeometry"}})}},KNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(t){let{width:e=100,height:i=e,widthSegments:n=8,heightSegments:r=8}=t.parameters,s=new mT(e,i,n,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},ZNe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:n,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new $Ne(e,i,n,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},$Ne=class extends Rt{constructor(t=1,e=1,i=1,n=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),n=Math.min(180-c,n),n*=Math.PI/180;let h=[],u=Math.PI/2,d=(ve=0,de=0,pe=0)=>new O(ve,de,pe),f=d(),p=d(),[m,g,v]=[e/2,t/2,i/2],y=-g,x=+g,[b,S,A]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],E=(ve,de=!1)=>Math.sin(ve-Math.PI/(1+ +de)),M=(ve,de=!1)=>Math.cos(ve-Math.PI/(1+ +de));A.y=Math.sin(n)*e-m;let T=Math.cos(n)*e-v,P=b.z-c;n<=u?(A.z=Math.min(T,P),A.z==P&&(A.y-=(T-P)/Math.tan(u-n))):S.z=Math.min(S.z-T-v,b.z-c),f.subVectors(b,S),p.subVectors(A,S);let I=Math.min(f.length(),p.length())*r/100,k=I*Math.tan(n/2),R=I/Math.cos(n/2),F=f.clone().normalize().add(p.normalize()).setLength(R).add(S);f.set(0,E(n,!0),M(n,!0)),h.push([A,f.clone()]);let V=(Math.PI-n)/s;for(let ve=0;ve<=s;ve++){let de=u+n+ve*V;f.set(0,Math.sin(de)*k,Math.cos(de)*k),f.add(F),p.set(0,E(de),M(de)),h.push([f.clone(),p.clone()])}h.push([b,d(0,1,0)]);let Q=Math.sin(V/2)*k*2,X=h.length-1,z=h[0][0].distanceTo(h[1][0]),Y=h[X-1][0].distanceTo(h[X][0]),j=z+Q*s+Y;h[0].push(1);for(let ve=0;ve<=s;ve++)h[ve+1].push(1-(z+ve*Q)/j);h[X].push(0);let[J,H,Z]=h[0],K,ne,W;for(let ve=1;ve<h.length;ve++)[K,ne,W]=h[ve],o.push(y,J.y,J.z,y,K.y,K.z,x,J.y,J.z,x,J.y,J.z,y,K.y,K.z,x,K.y,K.z),a.push(0,H.y,H.z,0,ne.y,ne.z,0,H.y,H.z,0,H.y,H.z,0,ne.y,ne.z,0,ne.y,ne.z),l.push(0,Z,0,W,1,Z,1,Z,0,W,1,W),[J,H,Z]=[K,ne,W];this.setAttribute("position",new gt(o,3)),this.setAttribute("normal",new gt(a,3)),this.setAttribute("uv",new gt(l,2))}},Ete=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof Cn?t.shape:new Cn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,innerRadiusPercent:n,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,u=e*.5,d=i*.5,f=0,p=0,m=o*Math.PI/360/r,g=Math.PI/2*3*-1,v=u*n/100,y=d*n/100;if(r===3&&n===50){m=2*Math.PI/r;for(let b=0;b<r;b++){let S=m*b,A=f+Math.sin(S)*u,E=p+Math.cos(S)*d;h.addPoint(h.createPoint(A,E))}}else for(let b=0;b<r;b++){let S=f+Math.cos(g)*u,A=p+Math.sin(g)*d;h.addPoint(h.createPoint(S,A)),g+=m,S=f+Math.cos(g)*v,A=p+Math.sin(g)*y,h.addPoint(h.createPoint(S,A)),g+=m}h.isClosed=!0;for(let b=0,S=h.points.length;b<S;b++)h.points[b].roundness=s;h.roundness=s,h.update();let x=um.create({shape:h,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(x,{userData:{...t,type:"StarGeometry"}})}},eke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i}=t.parameters,n=new mT(e,i);return Object.assign(n,{userData:{...t,type:"TextFrameGeometry"}})}},tke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:n,height:r,depth:s})}}static build(t){let{width:e,height:i,depth:n,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=ike(e,i,n,e*.5,o,s,0,0,r,a,l);return c.scale(1,i/e,1),Object.assign(c,{userData:{...t,type:"TorusGeometry"}})}};function ike(t,e,i,n,r,s,o,a,l,c,h){return[e,i]=[i,e],o=e/2,r/=2*Math.PI,r==1&&(c=0),new Ste(!0,t,e,i,n,r,s,o,a,l,c,h)}var nke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(t){let{width:e,tube:i,tubularSegments:n,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==i&&(a-=i);let l=new I$(a,i,n,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},rke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof Cn?t.shape:new Cn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e=100,height:i,cornerRadius:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,c=e*.5,h=i*.5;a?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=n;l.roundness=n,l.update();let u=um.create({shape:l,parameters:{roundness:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...t,type:"TriangleGeometry"}})}};function ske(t,e){let i=2*Math.PI;return(t%i+i)%i===(e%i+i)%i}var oke=new Qe,ake=new Qe;function lke(t,e,i){let n=[new O,new O,new O],r=[new O,new O,new O];return t.extractBasis(n[0],n[1],n[2]),e.extractBasis(r[0],r[1],r[2]),n.forEach((s,o)=>{let a=r[o],l=ri.lerp(s.length(),a.length(),i);s.lerp(a,i).setLength(l)}),new Qe().makeBasis(n[0],n[1],n[2])}var cke=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=(e==null?void 0:e.shapeData)??Az.create({parameters:ete}).userData.shape;return{path:t.path??iE.defaultData(),parameters:Object.assign(i,{width:n,height:r,depth:s,extrusion:{...tte,...i.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new uke(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Rt,{userData:{...t,type:"PathGeometry"}})}},uke=class extends Rt{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!ske(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:i,offset:n}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(n*r),o=this.inputs.path.isClosed?Math.ceil((i+n)*r):Math.ceil(Math.min(1,i+n)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],c=[];for(let X=0;X<a;X++){let z=this.inputs.path.isClosed?(X+s)%t.length:Math.min(X+s,t.length-1);l.push(t[z].clone()),c.push(e[z].clone())}let h=(X,z,Y)=>{l[X]=l[X].clone().lerp(l[z],Y),c[X]=lke(c[X],c[z],Y)},u=0,d=n*r%1;(!this.inputs.path.isClosed||i<=1)&&(d||n===0)&&(u=d,h(0,1,u));let f=0,p=(n+i)*r%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&n+i<1)&&p&&(f=p,h(l.length-1,l.length-2,1-f)),i===0){let X=l.length-1;l[X].copy(l[0]),c[X].copy(c[0])}this._applyPathModifiers(c,u,f);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:x,infos:b,vertices:S}=this._computeShapePoints(y),A=0,E;v==="round"&&(E=new Sz(this.inputs.shapeData,2*m,m,y,g,void 0,!0),A=E.getAttribute("position").count);let M=0,T=0;b.sort((X,z)=>X.start-z.start),b.forEach(X=>{X.verticesStart=M,X.verticesCount=X.continuous.reduce((z,Y,j)=>z+(j===0||!Y?2:1),0),T+=X.verticesCount,M=T});let P=T*a,I,k=0;if(this._isOpenEnded()&&v==="flat"){try{I=sd({windingRule:Ii.ODD,elementType:Kn.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{I=gte}k=I.vertexCount}let R=P+2*k+A*2,F=P+2*k,V={positions:new Float32Array(R*3),normals:new Float32Array(R*3),uvs:new Float32Array(R*2)},Q=[];if(b.forEach(X=>{this._extrudeRegion(X,S,c,l,V,Q,this._isGeometryClosed()&&!this._isOpenEnded())}),I&&(this._closeEnd(I,P,Q,V,c[0],l[0],!1),this._closeEnd(I,P+k,Q,V,c[c.length-1],l[l.length-1],!0)),E){V.positions.set(E.getAttribute("position").array,F*3),V.normals.set(E.getAttribute("normal").array,F*3),V.uvs.set(E.getAttribute("uv").array,F*2);let X=Q.length;Q.push(...E.getIndex().array.map(j=>j+F)),F+=A,V.positions.set(E.getAttribute("position").array,F*3),V.normals.set(E.getAttribute("normal").array,F*3),V.uvs.set(E.getAttribute("uv").array,F*2);let z=Q.length;Q.push(...E.getIndex().array.map(j=>j+F)),this.setAttribute("position",new Ot(V.positions,3)),this.setAttribute("normal",new Ot(V.normals,3)),this.setAttribute("uv",new Ot(V.uvs,2)),this.setIndex(Q);let Y=oke;Y.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(Y,F,R),Y.copy(c[0]).setPosition(l[0]).multiply(ake.makeScale(1,1,-1)),this.applyMatrix4OnRange(Y,F-A,F),this.reverseIndicesOnRange(X,z)}else this.setAttribute("position",new Ot(V.positions,3)),this.setAttribute("normal",new Ot(V.normals,3)),this.setAttribute("uv",new Ot(V.uvs,2)),this.setIndex(Q)}_extractPathPoints(){let t=ate(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(i=>{e[e.length-1].distanceToSquared(i)>.001&&e.push(i)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],i=t.length,n=this.inputs.path.isClosed,r=new O,s=new O,o=new O,a=new O,l=new O(0,1,0);for(let p=0;p<i;p++){let m=t[p],g;p===0?g=n?t[t.length-2]:m.clone().multiplyScalar(2).sub(t[1]):g=t[p-1];let v;p===i-1?v=n?t[1]:m.clone().multiplyScalar(2).sub(t[p-1]):v=t[p+1];let y=m.clone().sub(g).normalize(),x=v.clone().sub(m).normalize(),b=y.clone().add(x).normalize();o.copy(b),p===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let S=l.clone().cross(b).normalize(),A=b.clone().cross(S).normalize();l.copy(A),a.copy(S),p===0&&(r.copy(A),s.copy(b));let E=new Qe().makeBasis(S,A,b);e.push(E)}let c=n?s:o,h=n?r:new O(0,1,0),u=c.clone().cross(a).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return e;let f=h.clone().cross(u);c.dot(f)>0&&(d*=-1);for(let p=1;p<e.length;p++){let m=new Qe().makeRotationZ(d*p/e.length);e[p].multiply(m)}return e}_applyPathModifiers(t,e,i){let n=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new Qe,c=new Qe;return t.forEach((h,u)=>{let d=u===0?0:u===n-1?1:(u-e)/(n-(i===0?0:1)-(e+(1-i)));l.makeRotationZ(ri.lerp(r,r+s,d));let f=ri.lerp(o,a,d);c.makeScale(f,f,f),h.multiply(l).multiply(c)}),t}_computeShapePoints(t=12,e=Ii.ODD){let i=this.inputs.shapeData,n=i.extractShapePointsToFlatArray([],t),r=i.shapeHoles.map(c=>{let h=c.extractShapePointsToFlatArray([],t),u=[];for(let d=h.length-1;d>=1;d-=2){let f=h[d-1],p=h[d-0];u.push(f,p)}return u}),s;try{s=sd({windingRule:e,elementType:Kn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[n]})}catch{s=bz}let o;try{o=sd({windingRule:Ii.ODD,elementType:Kn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=mte}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let h=o.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(h+u)}for(let c=0;c<o.vertexIndices.length;c++){let h=o.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(h+u)}for(let c=0;c<o.vertices.length;c++){let h=o.vertices[c];s.vertices.push(h)}}for(let c=0,h=s.vertexCount;c<h;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let h=c>=a,u=c*2,d=s.elements[u+0],f=s.elements[u+1],p=d+f,m={start:d,count:f,normals:[],isHole:h,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=d,v=p-1,y=d+1,x=i.roundedCurves.length;do{let b=g-d;s.vertices[v*2+0],s.vertices[v*2+1];let S=s.vertices[g*2+0],A=s.vertices[g*2+1],E=s.vertices[y*2+0],M=s.vertices[y*2+1],T=S-E,P=A-M,I=Math.sqrt(T*T+P*P);T/=I,P/=I,m.normals[b*2+0]=-P,m.normals[b*2+1]=T;let k=s.vertexIndices[g];if(Array.isArray(k))m.continuous[b]=!1;else{let[R,F]=i.getCurveIndexFromVertexId(k-1,!0);if(F>0&&F<1)m.continuous[b]=!0;else{let V=F===1?R+1:R-1;V=(V+x)%x;let Q=F===1?0:1,X=i.roundedCurves[R].getTangent(F),z=i.roundedCurves[V].getTangent(Q);m.continuous[b]=X.dot(z)>.95}}h&&(m.normals[b*2+0]*=-1,m.normals[b*2+1]*=-1),[v,g,y]=[g,y,y+1],y>=p&&(y-=f)}while(y!==d+1)}return{regions:[n,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,i,n,r){let s=e*2,o=e*3;t.positions[o+0]=i.x,t.positions[o+1]=i.y,t.positions[o+2]=i.z,t.normals[o+0]=n.x,t.normals[o+1]=n.y,t.normals[o+2]=n.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,i,n,r,s,o){let a=new O,l=new O,c=new O,h=new O,u=new ge;i.forEach((f,p)=>{let m=n[p],g=t.verticesStart*i.length+t.verticesCount*p;for(let v=0;v<t.count;v++){let y=(t.start+v)*2;if(a.set(e[y+0],e[y+1],0),c.copy(a).applyMatrix4(f).add(m),t.continuous[v])h.set(t.normals[v*2+0],t.normals[v*2+1],0);else{let x=v===0?(t.start+t.count-1)*2:y-2;l.set(e[x+0],e[x+1],0),h.copy(a).sub(l),h.set(-h.y,h.x,0),t.isHole||h.negate()}if(h.applyMatrix4(f).normalize(),u.set(v===0?1:v/t.count,p/(i.length-1)),this._insertVertex(r,g,c,h,u),g++,!t.continuous[v]||v===0){if(v===0)h.set(t.normals[v*2+0],t.normals[v*2+1],0),u.set(0,p/(i.length-1));else{let x=v===t.count-1?t.start*2:y+2;l.set(e[x+0],e[x+1],0),h.copy(l).sub(a),h.set(-h.y,h.x,0),t.isHole||h.negate()}h.applyMatrix4(f).normalize(),this._insertVertex(r,g,c,h,u),g++}}});let d=i.length-1;for(let f=0;f<d;f++){let p=t.verticesStart*i.length+t.verticesCount*f,m=t.verticesStart*i.length+t.verticesCount*(f+1),g=0;for(let v=0;v<t.count;v++){(!t.continuous[v]||v===0)&&g++;let y=v===t.count-1?0:g+1,x=p+g,b=p+y,S=m+y,A=m+g;t.isHole?s.push(x,S,b,x,A,S):s.push(x,b,S,x,S,A),g++}}}_closeEnd(t,e,i,n,r,s,o){let a=t.vertexCount,l=new O(0,0,o?-1:1).applyMatrix4(r),c=new O,h=new ge;for(let d=0;d<a;d++){let f=2*d;c.set(t.vertices[f+0],t.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(n,e+d,c,l,h)}let u=t.elements;for(let d=0;d<t.elementCount;d++){let f=3*d,p=u[f+0]+e,m=u[f+(o?1:2)]+e,g=u[f+(o?2:1)]+e;i.push(p,m,g)}}applyMatrix4OnRange(t,e,i){let n=t.elements,r=new Pr().getNormalMatrix(t).elements,s,o,a,l,c=this.attributes.position,h=this.attributes.normal;if(!c||!h)return;let u=c.array,d=h.array,f=c.itemSize;for(let p=e*f,m=i*f;p<m;p+=f){if(p===e)debugger;s=u[p+0],o=u[p+1],a=u[p+2],l=1/(n[3]*s+n[7]*o+n[11]*a+n[15]),u[p+0]=(n[0]*s+n[4]*o+n[8]*a+n[12])*l,u[p+1]=(n[1]*s+n[5]*o+n[9]*a+n[13])*l,u[p+2]=(n[2]*s+n[6]*o+n[10]*a+n[14])*l,s=d[p+0],o=d[p+1],a=d[p+2],d[p+0]=r[0]*s+r[3]*o+r[6]*a,d[p+1]=r[1]*s+r[4]*o+r[7]*a,d[p+2]=r[2]*s+r[5]*o+r[8]*a}c.needsUpdate=!0,h.needsUpdate=!0}reverseIndicesOnRange(t,e){let i=this.index;if(i){for(let n=t;n<e;n+=3){let r=i.getX(n),s=i.getX(n+1),o=i.getX(n+2);i.setXYZ(n,o,s,r)}i.needsUpdate=!0}}};function Tte(){let t=new Rt;return t.setAttribute("position",new Ot(new Float32Array([]),3)),t.setIndex(new Ot(new Uint16Array([]),1)),t}var hke=Tte().attributes,dke=12,fke=1,Pte=class extends Rt{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,hke),this.userData={parameters:t,type:"TextGeometry"};let i=e.getFont(t.font);i!=null&&i.isLoaded?(this.font=i,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let i=e.getFont(t);i&&(this.font=i,await i.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,c=l===2?a.toUpperCase():l===3?a.toLowerCase():a,h=pke(t,e,c),{shapes:u,charWidths:d,charCoords:f}=e.generateShapes(h,t),p=i*.5,m=n*.5,g=u.map(x=>new Cn().fromShape(x));this.vectorShapes=g;let v=g.map(x=>um.create({shape:x,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Ii.NONZERO:Ii.ODD,subdivisions:this.isLowResolution&&r>0?fke:dke}})),y=v.length?up(v):Tte();y.translate(-p,m,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([x,b])=>{this.setAttribute(x,b)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let t=Yp(new Rt,Pte.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,i])=>{this.setAttribute(e,i)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function pke(t,e,i){i=i??t.text;let n=[""],r="";for(let s of i)r+=s,s===" "||s===`
`?(n[n.length-1]+=r,r="",s===`
`&&n.push("")):e.getTextWidth(n[n.length-1]+r,t)>t.width&&(n[n.length-1].length&&n.push(""),e.getTextWidth(n[n.length-1]+r,t)>t.width&&(r.length===1?(n[n.length-1]+=r,r=""):(n[n.length-1]+=r.slice(0,-1),r=r[r.length-1],n.push(""))));return n[n.length-1]+=r,n}var Dte,Mz=new Promise(t=>{Dte=t}),j8=!1,PA;function mke(){if(j8)return;if(PA)return PA;async function t(){let e="https://unpkg.com/@splinetool/modelling-wasm@0.9.419/build",[i,n]=await Promise.all([fw(()=>import("./process-10f79362.js"),[]),fetch(`${e}/process.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});Dte(s),j8=!0}return PA=t(),PA}function dE(t,e,i){let n={parameters:t,type:t.type};if(t.type==="PathGeometry")n.path=t.path;else if(t.type==="VectorGeometry"){let s=Cn.createFromState(t.shape,t.width,t.height);n.shape=s}else if(t.type==="NonParametricGeometry")t.data.groups&&t.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),n.geometry=new N$().parse(t);else{if(t.type==="SubdivGeometry")return new Es(t,i);if(t.type==="TextGeometry")return new Pte(t,e)}let r;try{r=Q8(n)}catch(s){console.error(s)}if(!r){let s=Cn.createFromState(tE.defaultData(),100,100);n.shape=s,r=Q8(n)}return r}var gke=new Qe;function oO(t,e,i,n){let r=t.position.array,s=t.normal.array,o=gke.makeScale(e,i,n).invert().elements,a,l,c;for(var h=0,u=r.length;h<u;h+=3)r[h]*=e,r[h+1]*=i,r[h+2]*=n,a=s[h],l=s[h+1],c=s[h+2],s[h]=o[0]*a+o[4]*l+o[8]*c,s[h+1]=o[1]*a+o[5]*l+o[9]*c,s[h+2]=o[2]*a+o[6]*l+o[10]*c;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var DA=new Gn,pg=new O,Ct;Mz.then(t=>{Ct=t});var W8=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),X8=new Uint32Array([0,1,2,3]),q8=new Uint8Array([4]),Es=class extends Rt{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let i=this.data.scaleBaked,n=Dp.div(e,i);this.subdividedGeometry&&oO(this.subdividedGeometry.attributes,...n),this.originalGeometry&&oO(this.originalGeometry.attributes,...n),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*n[0],height:r.height*n[1],depth:r.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(pg.fromArray(n));let s=pg.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,i;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:i}=Es.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new Ic(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let n=this.subdividedGeometry??this.originalGeometry;Object.assign(this,n),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Es.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new qo,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;DA.setFromBufferAttribute(e),DA.getCenter(i),t.boundingSphere.radius=i.distanceTo(DA.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),DA.getSize(pg);let n={width:pg.x,height:pg.y,depth:pg.z};return this.userData.parameters=n,n}static build(t,e,i,n){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;i===!1&&(a=-1),e&&(Ct.free_bvh(e),Ct.free_subdivision_surface(e));try{r=Es.allocate(t,n)}catch(l){console.error(l,t),r=Es.allocate({positionWASM:W8,indexWASM:X8,verticesPerFaceWASM:q8},n)}if(Ct.set_destination_refinement_level(r,0),s=Es.buildLevel(r,!0,a),t.subdivisions>0)try{Ct.set_destination_refinement_level(r,t.subdivisions),o=Es.buildLevel(r,!1,a)}catch{try{Ct.set_destination_refinement_level(r,t.subdivisions-1),o=Es.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,i){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let n=t.shape!==void 0||t.path!==void 0?e.geometry:dE(t,i,!1),r;t.type==="TorusGeometry"&&t.arc===Math.PI*2?r=n.getClosedTorusIndicesForBooleanOrSubdiv():r=n.getIndex();let s,o,a,l;({positions:s,triIndices:l}=RT(n.getAttribute("position"),r));let c;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let h=t.radialSegments*t.heightSegments*3*2,u=h+t.radialSegments*3;c=[h,u]}return{indices:o,verticesPerFace:a}=Ite(s,l,n,c),{positions:s,indices:o,verticesPerFace:a}}static allocate(t,e){var x;let i,n,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(i=t.positionWASM,n=t.indexWASM,r=t.verticesPerFaceWASM):(i=W8,n=X8,r=q8);let a=i.length,l=n.length,c=r.length,h=i.length+s.length+o.length,u=n.length+r.length,d=h*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=h*Float32Array.BYTES_PER_ELEMENT,p=Ct._malloc(d),m=new Float32Array(Ct.HEAPF32.buffer,p,h),g=new Uint32Array(Ct.HEAPU32.buffer,p+f,u);m.set(i,0),m.set(s,i.length),m.set(o,i.length+s.length),g.set(n,0),g.set(r,n.length);let v;(x=t==null?void 0:t.scaleBaked)!=null&&x.some(b=>b!==1)&&(v=new Qe().makeScale(...t.scaleBaked)),e&&(v?v.premultiply(e):v=e);let y=v?Ct.alloc_subdivision_surface2(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):Ct.alloc_subdivision_surface(p,a,p+f,l,p+f+n.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ct._free(p),y}static buildLevel(t,e,i,n,r){let s=r?Ct.get_mesh_data2(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,i,r.elements):Ct.get_mesh_data(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,i),o=8,a=Ct.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),c=0,h=Ct.HEAPU32[a[c]>>2],u=Ct.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=Ct.HEAPU32[a[c]>>2],f=Ct.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=Ct.HEAPU32[a[c]>>2],m=Ct.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let g=Ct.HEAPU32[a[c]>>2],v=Ct.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,n===void 0){let y=new Rt;if(y.setIndex(new wv(v,1)),y.setAttribute("position",new gt(u,3)),y.setAttribute("normal",new gt(f,3)),e){y.setAttribute("faceMap",new wv(m,1));let x=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new Ot(x,4))}return Ct.free_mesh_data(s),y.userData.type="SubdivGeometry",y}n.getAttribute("position").copyArray(u),n.getAttribute("normal").copyArray(f),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,Ct.free_mesh_data(s)}static freeSubdivPointer(t){Ct.free_bvh(t),Ct.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,i){let n=Ct.get_wireframe_data_for_base_level(t),r=4,s=Ct.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(2,2+2),a=0,l=Ct.HEAPU32[s[a]>>2],c=Ct.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let h=Ct.HEAPU32[s[a]>>2],u=Ct.HEAPU32.subarray(h>>2,(h>>2)+o[a]);if(e===void 0){let d=new Rt;d.setAttribute("position",new gt(c,3));let f=new Float32Array(c.length);for(let p=0,m=c.length;p<m;)f[p++]=i.r,f[p++]=i.g,f[p++]=i.b;return d.setAttribute("color",new Ot(f,3)),d.setIndex(new wv(u,1)),Ct.free_wireframe_data_for_base_level(n),d}e.getAttribute("position").copyArray(c),e.attributes.position.needsUpdate=!0,Ct.free_wireframe_data_for_base_level(n)}static updateCollabMesh(t,e,i){let n=e===0;n||Ct.set_destination_refinement_level(t,e);let r=i?Ct.get_topological_data2(t,n?Ct.Level.CONTROL:Ct.Level.REFINED,i.elements):Ct.get_topological_data(t,n?Ct.Level.CONTROL:Ct.Level.REFINED),s=6,o=Ct.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,c=Ct.HEAPU32[o[l]>>2],h=new Float32Array(Ct.HEAPF32.subarray(c>>2,(c>>2)+a[l]));l++;let u=Ct.HEAPU32[o[l]>>2],d=new Uint32Array(Ct.HEAPU32.subarray(u>>2,(u>>2)+a[l]));l++;let f=Ct.HEAPU32[o[l]>>2],p=new Uint8Array(Ct.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return Ct.free_topological_data(r),{positions:h,indices:d,verticesPerFace:p}}},Y8=["getX","getY","getZ"];function RT(t,e){let i={},n=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let c=0;c<n;c++){let h=e?e.getX(c):c,u="";for(let d=0;d<3;d++)u+=`${~~(t[Y8[d]](h)*a)},`;if(u in i)s.push(i[u]);else{for(let d=0;d<3;d++)o.push(t[Y8[d]](h));i[u]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:o,triIndices:l}}var IA=new O,W3=new O,X3=new O,q3=new O;function Ite(t,e,i,n){let r=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let l=i.userData.shape.extractShapePointsToFlatArray([]),c=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&i.userData.parameters.angle>=360){let d=l.length/2/c;l=l.filter((f,p)=>Math.floor(p/2)%d===0)}let h=0;for(let d=0;d<l.length;d+=2)h+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);t.length=0;let u=0;if(h<0)for(let d=0;d<l.length;d+=2)t.push(l[d],l[d+1],0),r.push(u++);else for(let d=l.length-2;d>=0;d-=2)t.push(l[d],l[d+1],0),r.push(u++);return s.push(u),{indices:r,verticesPerFace:s}}let o=new Float32Array([i.userData.parameters.depth])[0],a=0;for(;a<e.length;){if(i.useNgonForTopBottomFaceDuringBake){let l=0;if((t[e[a]*3+2]===o||t[e[a]*3+2]===0)&&l++,(t[e[a+1]*3+2]===o||t[e[a+1]*3+2]===0)&&l++,(t[e[a+2]*3+2]===o||t[e[a+2]*3+2]===0)&&l++,l===3)break}if(e[a+1]===e[a+3]&&e[a+2]===e[a+5]||e[a+0]===e[a+3]&&e[a+2]===e[a+4]){IA.set(t[e[a]*3],t[e[a]*3+1],t[e[a]*3+2]),W3.set(t[e[a+1]*3],t[e[a+1]*3+1],t[e[a+1]*3+2]),X3.set(t[e[a+4]*3],t[e[a+4]*3+1],t[e[a+4]*3+2]),q3.set(t[e[a+5]*3],t[e[a+5]*3+1],t[e[a+5]*3+2]),W3.sub(IA).normalize(),X3.sub(IA).normalize(),q3.sub(IA).normalize();let l=W3.cross(X3).dot(q3);Math.abs(l)>.005||n&&n.some((c,h)=>h%2===1?!1:a>=n[h]&&a<n[h+1])?(r.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3):(r.push(e[a],e[a+1],e[a+4],e[a+5]),s.push(4),a+=6)}else r.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3}if(i.useNgonForTopBottomFaceDuringBake){let l=[],c=[],h=0;for(let u=0,d=0;u<t.length;u+=3,d++)t[u+2]===0&&(l.push(d),h++),t[u+2]===o&&c.push(d);if(i.userData.parameters.extrudeBevelSize===0){let u=c[0];c[0]=c[1],c[1]=u}l.reverse(),r.push(...l,...c),s.push(h,h)}return{indices:r,verticesPerFace:s}}var gu={};iwe(gu,{calcBoolean:()=>wke,calcBooleanTopological:()=>_ke,freeMeshSet:()=>Mke,getMeshSet:()=>bke,hasOpenEdges:()=>Ske,transformMeshSet:()=>Ake});var Lte,vke=new Promise(t=>{Lte=t}),LA;function yke(){if(LA)return LA;async function t(){let e="https://unpkg.com/@splinetool/boolean-wasm@0.9.419/build",[i,n]=await Promise.all([fw(()=>import("./boolean-613a7c9c.js"),[]),fetch(`${e}/boolean.wasm`).then(o=>o.arrayBuffer())]),r=i.default,s=await r({wasmBinary:n});Lte(s)}return LA=t(),LA}var ai,Dv;vke.then(t=>ai=t);function xke(t,e,i){let n,r;t.userData.parameters.type==="TorusGeometry"&&t.userData.parameters.arc===Math.PI*2?r=t.getClosedTorusIndicesForBooleanOrSubdiv():r=t.getIndex();let{positions:s,triIndices:o}=RT(t.getAttribute("position"),r),a;if(e&&i){let{indices:l,verticesPerFace:c}=Ite(s,o,t);a=c.length,n=[];for(let h=0,u=0;h<a;h++){n.push(c[h]);for(let d=0;d<c[h];d++)n.push(l[u++])}}else{let l=o.length;n=Array(l+l/3),a=0;for(let c=0,h=0;h<n.length;)n[h++]=3,a++,n[h++]=o[c++],n[h++]=o[c++],n[h++]=o[c++]}return{positions:s,faceIndices:n,nFaces:a}}function Bte(t){let e=t.length,i=e*Uint32Array.BYTES_PER_ELEMENT,n=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?i:n,s=ai._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(ai.HEAPU32.buffer,s,e):new Float32Array(ai.HEAPF32.buffer,s,e)).set(t,0),s}function Rte(t){switch(t){case 0:return ai.OP.UNION;case 1:return ai.OP.INTERSECTION;case 2:return ai.OP.A_MINUS_B;case 3:return ai.OP.B_MINUS_A;case 4:return ai.OP.SYMMETRIC_DIFFERENCE;case 5:return ai.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function _ke(t,e){Dv===void 0&&(Dv=ai.init_csg());let i=Bte(t),n=ai.csg_calc_topological(Dv,i,t.length,Rte(e));ai._free(i);let r=6,s=ai.HEAPU32.subarray(n>>2,(n>>2)+r),o=s.subarray(3,3+3),a=0,l=ai.HEAPU32[s[a]>>2],c=new Float32Array(ai.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let h=ai.HEAPU32[s[a]>>2],u=new Uint32Array(ai.HEAPU32.subarray(h>>2,(h>>2)+o[a]));a++;let d=ai.HEAPU32[s[a]>>2],f=new Uint8Array(ai.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return ai.free_mesh_data(n),{positions:c,indices:u,verticesPerFace:f}}function wke(t,e,i,n){Dv===void 0&&(Dv=ai.init_csg());let r=Bte(t),s=ai.csg_calc(Dv,r,t.length,n,Rte(e));ai._free(r);let o=5,a=ai.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),c=0,h=ai.HEAPU32[a[c]>>2],u=ai.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=ai.HEAPU32[a[c]>>2],f=ai.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=l[c];i.setAttribute("position",new gt(u,3)),i.setAttribute("normal",new gt(f,3));let m=ai.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new qo),i.boundingSphere.center.set(m[0],m[1],m[2]),i.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,i.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},ai.free_mesh_data(s),p}function bke(t,e,i){if(ai===void 0)return-1;let n,r,s;if(e&&t.userData.positions!==void 0){let m=t.userData;s=m.verticesPerFace.length,n=m.positions,r=Array(m.verticesPerFace.reduce((g,v)=>g+v,0)+s);for(let g=0,v=0,y=0;g<m.verticesPerFace.length;g++){r[y++]=m.verticesPerFace[g];for(let x=0;x<m.verticesPerFace[g];x++)r[y++]=m.indices[v++]}}else({positions:n,faceIndices:r,nFaces:s}=xke(t,e,i));let o=n.length,a=r.length,l=n.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=ai._malloc(h),f=new Float32Array(ai.HEAPF32.buffer,d,l),p=new Uint32Array(ai.HEAPU32.buffer,d+u,c);return f.set(n,0),p.set(r,0),ai.get_csg_mesh(d,o,d+u,a,s)}function Ske(t){return ai.has_open_edges(t)}function Ake(t,e){ai.transform_csg_mesh(t,e.elements)}function Mke(t){ai.free_csg_mesh(t)}var Cke={ConeGeometry:iNe,CubeGeometry:nNe,CylinderGeometry:lte,DodecahedronGeometry:sNe,EllipseGeometry:Az,HelixGeometry:NNe,IcosahedronGeometry:kNe,LatheGeometry:zNe,NonParametricGeometry:XNe,PolygonGeometry:Mte,PyramidGeometry:qNe,RectangleGeometry:Cte,SphereGeometry:JNe,PlaneGeometry:KNe,BackdropGeometry:ZNe,StarGeometry:Ete,TextFrameGeometry:eke,TorusGeometry:tke,TorusKnotGeometry:nke,TriangleGeometry:rke,PathGeometry:cke,VectorGeometry:um},Q8=t=>Cke[t.type].create(t);function lx(t){return t!==null&&"booleanOp"in t}var Ote=class extends yz($s){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Qe}updateVisible(){super.updateVisible(),this.visible=!lx(this.parent)&&this.visible,lx(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(gu.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),lx(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof Ote&&(t.freeBooleanPointer(),lx(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t){let e=super.updateTransformState(t);return e&&lx(this.parent)&&this.invalidateDownstreamBooleanData(!0),e}},BA=new Gn;function Cz(t,e=0,i=t.count,n,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=e;u<i;u++){let d=t.getX(u),f=t.getY(u),p=t.getZ(u);d<s&&(s=d),f<o&&(o=f),p<a&&(a=p),d>l&&(l=d),f>c&&(c=f),p>h&&(h=p)}BA.min.set(s,o,a),BA.max.set(l,c,h),BA.getCenter(n),BA.getSize(r).multiplyScalar(.5)}var Eke=new Rt,Tke=new gw,go=class extends Ote{constructor(t,e){super(Eke,Tke),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?Cz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},J8=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},Kd=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=ri.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,i){return i=i??{},this.analyze(t,i),this.flow(t,e,i)}flow(t,e,i){i=i??{},t.addFlow(i.slot,i.cache,i.context);let n={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),n}build(t,e,i){e=e??this.getType(t,e);let n=t.getNodeData(i??this);return t.analyzing&&this.appendDepsNode(t,n,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,i)}updateFrame(t){}generateReadonly(t,e,i,n,r,s){return""}generate(t,e,i,n,r){return""}parse(t,e,i,n){}appendDepsNode(t,e,i){e.deps=(e.deps||0)+1;let n=t.getTypeLength(i);(n>(e.outputMax||0)||this.getType(t,i))&&(e.outputMax=n,e.output=i)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,i;for(e in this)i=this[e],i instanceof Kd&&(t+='"'+e+'":'+i.getHash()+",");if(this.hashProperties)for(let n=0;n<this.hashProperties.length;n++)e=this.hashProperties[n],i=this[e],t+='"'+e+'":"'+String(i)+'",';return t+='"id":"'+this.uuid+'"}',t}},Pke=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,i){i=i!==void 0?i:!0,this.keywords[t]={callback:e,cache:i}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},Ks=new Pke,Oi=class extends Kd{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=e.shared!==void 0?e.shared:!0,this.unique=e.unique!==void 0?e.unique:!1}build(t,e,i,n){if(e=e??this.getType(t),this.getShared(t,e)){let r=this.getUnique(t,e);r&&this.uuid===void 0&&(this.uuid=ri.generateUUID()),i=t.getUUID(i??this.getUUID(),!r);let s=t.getNodeData(i),o=s.output||this.getType(t);if(t.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,s,e),this.generate(t,e,i)):super.build(t,e,i);if(r)return s.name=s.name||super.build(t,e,i),s.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||s.deps===1))return super.build(t,e,i);i=this.getUUID(!1);let a=this.getTemp(t,i);if(a)return t.format(a,o,e);{a=super.generate(t,e,i,s.output,n);let l=this.generate(t,o,i);return t.addNodeCode(a+" = "+l+";"),t.format(a,o,e)}}return super.build(t,e,i)}getShared(t,e){return e!=="sampler2D"&&e!=="samplerCube"&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return typeof this.scope=="string"&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let i=t.getVars()[e];return i?i.name:void 0}generate(t,e,i,n,r){return this.getShared(t,e)||console.error("TempNode is not shared"),i=i??this.uuid,t.getTempVar(i,n??this.getType(t),r,this.getLabel()).name}},vo=class extends Oi{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,i,n,r,s){i=t.getUUID(i??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,i,n,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,r,s,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,r,s,this.getLabel())),t.format(o.fragment.name,n,e))}},Gr=class extends vo{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof ge?t:new ge(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,i,n,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",n,e)}},ya=class extends vo{constructor(e=0,i,n){super("v3"),this.nodeType="Vector3",this.value=e instanceof O?e:new O(e,i,n)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,i,n,r,s,o){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,i)}},ho=class extends Tt{constructor(t,e,i,n){super(t,e,i),this.isColorA=!0,this.a=n}setRGBA(t,e,i,n){super.setRGB(t,e,i),this.a=n}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let i;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let n,r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(n[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(n[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},vu=class extends vo{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof ho?t:new ho(t.r,t.g,t.b,t.a)}generateReadonly(t,e,i,n,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,e)}},Dke=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,K8=/[a-z_0-9]+/gi,nt=class extends Oi{constructor(t,e,i,n,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(t,e,i,n)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,i,n,r){let s,o=0,a=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)t.include(this.includes[c],this);for(let c in this.extensions)t.extensions[c]=!0;let l=[];for(;s=K8.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let h=l[c],u=h[0],d=this.isMethod?!this.getInputByName(u):!0,f=u;if(this.keywords[u]||this.useKeywords&&d&&Ks.containsKeyword(u)){let p=this.keywords[u];if(!p){let m=Ks.getKeywordData(u);m.cache&&(p=t.keywords[u]),p=p||Ks.getKeyword(u,t),m.cache&&(t.keywords[u]=p)}f=p.build(t)}u!==f&&a[h.index+o-1]!=="."&&(a=a.substring(0,h.index+o)+f+a.substring(h.index+u.length+o),o+=f.length-u.length),this.getIncludeByName(f)===void 0&&Ks.contains(f)&&t.include(Ks.get(f))}return e==="source"?a:this.isMethod?(this.isInterface||t.include(this,void 0,a),this.name):t.format("( "+a+" )",this.getType(t),e)}parse(t,e,i,n){if(this.src=t||"",this.includes=e??[],this.extensions=i??{},this.keywords=n??{},this.isMethod){let r=Dke.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(K8);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let c=s[o++];this.inputs.push({name:c,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Ike=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Fte=class extends Oi{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||Fte.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,i,n,r){this.src=t||"";let s,o,a="",l=Ike.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,i,n,r){return t.format(this.name,this.getType(t),e)}},Di=Fte;Di.PI="PI",Di.PI2="PI2",Di.RECIPROCAL_PI="RECIPROCAL_PI",Di.RECIPROCAL_PI2="RECIPROCAL_PI2",Di.LOG2="LOG2",Di.EPSILON="EPSILON";var Lke=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Bke=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Nte=class extends Oi{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,i,n,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=Lke.exec(t);if(e){let i=e[2],n;for(;n=Bke.exec(i);)this.inputs.push({type:n[1],name:n[2]});this.name=e[1]}else this.name="";this.type=this.name}},Ez=class extends Oi{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",n=t.isShader("vertex")?"uv"+i:"vUv"+i;return t.format(n,this.getType(t),e)}};Ks.addKeyword("uv",function(){return new Ez});Ks.addKeyword("uv2",function(){return new Ez(1)});var Pg=class extends Oi{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??Pg.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case Dc:return["Linear"];case Vt:return["sRGB"];default:return[]}}generate(t,e){var o;let i=this.input.build(t,"v4"),n=this.getType(t),r=Pg.Nodes[this.method],s=t.include(r);if(s===Pg.LINEAR_TO_LINEAR)return t.format(i,n,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+i+", "+a+" )",n,e)}else return t.format(s+"( "+i+" )",n,e)}fromEncoding(t){let e=Pg.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=Pg.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},vc=Pg;vc.Nodes={LinearToLinear:new nt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new nt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new nt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},vc.LINEAR_TO_LINEAR="LinearToLinear",vc.SRGB_TO_LINEAR="sRGBToLinear",vc.LINEAR_TO_SRGB="LinearTosRGB";var Qi=class extends nt{constructor(t="",e,i,n,r){super(t,r,n,i,e),this.nodeType="Expression"}},Au=class extends vo{constructor(t=new ur,e,i,n){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new Ez,this.bias=i,this.project=n!==void 0?n:!1}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if(e==="sampler2D")return this.getTexture(t,e);let i=this.getTexture(t,e),n=this.uv.build(t,this.project?"v4":"v2"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s,o;this.project?s="texture2DProj":s=r?"tex2DBias":"tex2D",r?o=s+"( "+i+", "+n+", "+r+" )":o=s+"( "+i+", "+n+" )";let a={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace??new vc(new Qi("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(t,l),t.removeContext(),t.format(o,l,e)}},ht=class extends vo{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,i,n,r,s){return t.format(this.value+(this.value%1?"":".0"),n,e)}},Z8=class extends Oi{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,i,n,r){n=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(t,t.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return t.format(o,n,e)}},kte=class extends Oi{constructor(t,e,i=kte.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=i}getType(t){let e=this.a.getType(t),i=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(i)>t.getTypeLength(e)?i:e}generate(t,e){let i=this.getType(t);this.type=i;let n=this.a.build(t,i),r=this.b.build(t,i);return t.format("( "+n+" "+this.op+" "+r+" )",i,e)}},js=kte;js.ADD="+",js.SUB="-",js.MUL="*",js.DIV="/";var Pi=class extends Oi{constructor(t,e=Pi.ABS,i,n){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:n=e,typeof i!="string"?this.c=i:n=i,this.method=n,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case Pi.MIX:case Pi.CLAMP:case Pi.REFRACT:case Pi.SMOOTHSTEP:case Pi.FACEFORWARD:return 3;case Pi.MIN:case Pi.MAX:case Pi.MOD:case Pi.STEP:case Pi.REFLECT:case Pi.DISTANCE:case Pi.DOT:case Pi.CROSS:case Pi.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),i=this.b?t.getTypeLength(this.b.getType(t)):0,n=this.c?t.getTypeLength(this.c.getType(t)):0;return e>i&&e>n?this.a.getType(t):i>n?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case Pi.LENGTH:case Pi.DISTANCE:case Pi.DOT:return"f";case Pi.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let i,n,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),c=this.getType(t);switch(this.type=c,this.method){case Pi.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case Pi.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case Pi.CROSS:i=this.a.build(t,"v3"),n=this.b.build(t,"v3");break;case Pi.STEP:i=this.a.build(t,s===1?"f":l),n=this.b.build(t,l);break;case Pi.MIN:case Pi.MAX:case Pi.MOD:i=this.a.build(t,l),n=this.b.build(t,o===1?"f":l);break;case Pi.REFRACT:i=this.a.build(t,l),n=this.b.build(t,l),r=this.c.build(t,"f");break;case Pi.MIX:i=this.a.build(t,l),n=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:i=this.a.build(t,l),this.b&&(n=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let h=[];h.push(i),n&&h.push(n),r&&h.push(r);let u=this.getNumInputs(t);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return t.format(this.method+"( "+h.join(", ")+" )",c,e)}},zt=Pi;zt.RAD="radians",zt.DEG="degrees",zt.EXP="exp",zt.EXP2="exp2",zt.LOG="log",zt.LOG2="log2",zt.SQRT="sqrt",zt.INV_SQRT="inversesqrt",zt.FLOOR="floor",zt.CEIL="ceil",zt.NORMALIZE="normalize",zt.FRACT="fract",zt.SATURATE="saturate",zt.SIN="sin",zt.COS="cos",zt.TAN="tan",zt.ASIN="asin",zt.ACOS="acos",zt.ARCTAN="atan",zt.ABS="abs",zt.SIGN="sign",zt.LENGTH="length",zt.NEGATE="negate",zt.INVERT="invert",zt.MIN="min",zt.MAX="max",zt.MOD="mod",zt.STEP="step",zt.REFLECT="reflect",zt.DISTANCE="distance",zt.DOT="dot",zt.CROSS="cross",zt.POW="pow",zt.MIX="mix",zt.CLAMP="clamp",zt.REFRACT="refract",zt.SMOOTHSTEP="smoothstep",zt.FACEFORWARD="faceforward";var Fx=class extends Oi{constructor(t,e,i){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=i}bilinearCubeUV(t,e,i,n){let r=new Z8(Fx.Nodes.bilinearCubeUV,[e,i,n]);this.colorSpaceTL=this.colorSpaceTL??new vc(new Qi("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new vc(new Qi("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new vc(new Qi("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new vc(new Qi("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new Qi(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new Qi(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new Qi(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new Qi(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new Qi("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let i=this.uv,n=this.bias||t.context.roughness,r=new Z8(Fx.Nodes.roughnessToMip,[n]),s=new zt(r,Fx.Nodes.m0,Fx.Nodes.cubeUV_maxMipLevel,zt.CLAMP),o=new zt(s,zt.FLOOR),a=new zt(s,zt.FRACT),l=this.bilinearCubeUV(t,this.value,i,o),c=this.bilinearCubeUV(t,this.value,i,new js(o,new ht(1).setReadonly(!0),js.ADD)),h=new zt(l,c,a,zt.MIX);return t.format(h.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},aO=Fx;aO.Nodes=function(){let t=new Nte(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new Di("float cubeUV_maxMipLevel 8.0",!0),i=new Di("float cubeUV_minMipLevel 4.0",!0),n=new Di("float cubeUV_maxTileSize 256.0",!0),r=new Di("float cubeUV_minTileSize 16.0",!0),s=new nt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new nt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new nt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,i,n,r]);a.useKeywords=!1;let l=new Di("float r0 1.0",!0),c=new Di("float v0 0.339",!0),h=new Di("float m0 -2.0",!0),u=new Di("float r1 0.8",!0),d=new Di("float v1 0.276",!0),f=new Di("float m1 -1.0",!0),p=new Di("float r4 0.4",!0),m=new Di("float v4 0.046",!0),g=new Di("float m4 2.0",!0),v=new Di("float r5 0.305",!0),y=new Di("float v5 0.016",!0),x=new Di("float m5 3.0",!0),b=new Di("float r6 0.21",!0),S=new Di("float v6 0.0038",!0),A=new Di("float m6 4.0",!0),E=[l,c,h,u,d,f,p,m,g,v,y,x,b,S,A],M=new nt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,E);return{bilinearCubeUV:a,roughnessToMip:M,m0:h,cubeUV_maxMipLevel:e}}();var Dg=class extends Oi{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Dg.VIEW}getShared(){return this.scope===Dg.WORLD}build(t,e,i,n){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,i,n):super.build(t,e,i)}generate(t,e,i,n,r){let s;switch(this.scope){case Dg.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Dg.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case Dg.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},eo=Dg;eo.LOCAL="local",eo.WORLD="world",eo.VIEW="view",eo.NORMAL="normal";Ks.addKeyword("viewNormal",function(){return new eo(eo.VIEW)});Ks.addKeyword("localNormal",function(){return new eo(eo.NORMAL)});Ks.addKeyword("worldNormal",function(){return new eo(eo.WORLD)});var du=class extends Oi{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??du.LOCAL}getType(){switch(this.scope){case du.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case du.LOCAL:case du.WORLD:return!1}return!0}generate(t,e,i,n,r){let s;switch(this.scope){case du.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case du.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case du.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case du.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},yl=du;yl.LOCAL="local",yl.WORLD="world",yl.VIEW="view",yl.PROJECTION="projection";Ks.addKeyword("position",function(){return new yl});Ks.addKeyword("worldPosition",function(){return new yl(yl.WORLD)});Ks.addKeyword("viewPosition",function(){return new yl(yl.VIEW)});var rc=class extends Oi{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??rc.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case rc.SPHERE:return"v2"}return this.type}generate(t,e){let i=this.getUnique(t);if(t.isShader("fragment")){let n;switch(this.scope){case rc.VECTOR:{let r=new eo(eo.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new yl(yl.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,c=`reflect( -normalize( ${a} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let h=`inverseTransformDirection( ${c}, viewMatrix )`;i?(t.addNodeCode(`vec3 reflectVec = ${h};`),n="reflectVec"):n=h;break}case rc.CUBE:{let r=new rc(rc.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";i?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),n="reflectCubeVec"):n=s;break}case rc.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new rc(rc.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),n="reflectSphereVec"):n=r;break}}return t.format(n,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},Iv=rc;Iv.CUBE="cube",Iv.SPHERE="sphere",Iv.VECTOR="vector";var Rke=class extends Oi{constructor(t=new Au,e,i){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new aO(this.value,e??new Iv(Iv.VECTOR),i),this.irradianceNode=new aO(this.value,new eo(eo.WORLD),new ht(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},Oke=class extends vo{constructor(t=new Ek,e,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new Iv,this.bias=i}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let i=this.getTexture(t,e),n=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+i+", "+n+", "+r+" )":s="texCube( "+i+", "+n+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new vc(new Qi("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},Fke=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Nke=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,kke=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,zke=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// NOTE: We use the blue channel to avoid temporal reprojection
// with incorrect velocity if the fragment is transparent.
gVelocity = vec4(velocity, gl_FragColor.a < 1.0 ? 0.0 : 1.0, 1.);
`,$8=["x","y","z","w"],Uke=["float","vec2","vec3","vec4"],Gke={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},Vke={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Hke=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function t(e,i){return e.deps.length-i.deps.length}return function(e,i){let n=this.getIncludes(e,i);if(!n)return"";let r="";n=n.sort(t);for(let s=0;s<n.length;s++)n[s].src&&(r+=n[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.addVertexParsCode(Fke),this.addFragmentParsCode(Nke),this.buildShader("vertex",t),this.buildShader("fragment",e);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let n=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+n+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+n+";"),this.addVertexFinalCode("vUv"+n+" = uv"+n+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(kke),this.addFragmentFinalCode(zke)),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,i){return this.addSlot(t).addCache(e).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,i,n="varying",r="V",s=""){let o=this.getVars(n),a=o[t];if(!a){let l=o.length;a={name:i||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,i,n){return this.getVar(t,e,i,this.shader,"T",n)}getAttribute(t,e){if(!this.attributes[t]){let i=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(i.name+" = "+t+";"),this.attributes[t]={varying:i,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let i="";for(let n=0,r=t.length;n<r;++n){let s=t[n],o=s.type,a=s.name,l=s.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?i+=e+" "+c.substring(0,c.length-2)+" "+a+`[${l}];
`:i+=e+" "+c+" "+a+`;
`}return i}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof Kd?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,i,n,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new J8({type:e,size:i.size,name:n||"nodeUA"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new J8({type:e,name:n||"nodeU"+a+(s?"_"+s:""),node:i,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,i,n,r){return this.createUniform("vertex",t,e,i,n,r)}createFragmentUniform(t,e,i,n,r){return this.createUniform("fragment",t,e,i,n,r)}include(t,e,i){var s;let n;if(t=typeof t=="string"?Ks.get(t):t,this.context.include===!1)return t.name;t instanceof nt?n=this.includes.functions:t instanceof Di?n=this.includes.consts:t instanceof Nte&&(n=this.includes.structs);let r=n[this.shader]=n[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof nt&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return i&&(o.src=i),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return Uke[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!=null&&i.isNode)return i}}resolve(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case jp:case Wp:return new Oke(i);case pw:return new Rke(new Au(i));default:return new Au(i)}else{if(i.isVector2)return new Gr(i);if(i.isVector3)return new ya(i);if(i.isVector4)return new vu(i)}}}}format(t,e,i){switch(this.colorToVector(i+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return Gke[t]||t}getFormatByType(t){return Vke[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return $8[t]}getIndexByElement(t){return $8.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=Dc,e===Dc&&this.context.gamma&&(e=Vt),e}},En=class extends vo{constructor(t=0,e,i,n){super("c"),this.nodeType="Color",this.value=t instanceof ho?t:new ho(t||0,e,i,n)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,i,n,r,s){i=t.getUUID(i??this.getUUID()),n=n??this.getType(t);let o=t.getNodeData(i),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,i,n,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(n,this,r,s,this.getLabel())),t.format(o.vertex.name,n,e)):(o.fragment||(o.fragment=t.createFragmentUniform(n,this,r,s,this.getLabel())),t.format(o.fragment.name,n,e))}generateReadonly(t,e,i,n,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,e)}},Ni=class extends vo{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,i,n,r,s){return t.format(this.value.toString(),n,e)}},Ts=class extends vo{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,i,n){return t.format(this.value?"true":"false",n,e)}},Vf=class extends vo{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},Tz=class extends vo{},jke=class extends Tz{constructor(t){super("v3"),this.image=t,this._value=new O}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},lO=class extends Tz{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},zte=class extends vo{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new Pr}generateReadonly(t,e,i,n,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",n,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},Rc=class extends vo{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new Qe}generateReadonly(e,i,n,r,s,o){return e.format("mat4("+this.value.elements.join(", ")+")",r,i)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function e9(t,e,i){t.setUvTransform(i[0],i[1],e[0],e[1],0,0,0)}var Wke=class extends zte{constructor(t,e){super(new Pr),this.repeat=t,this.offset=e,e9(this.value,t,e)}updateMatrix(){e9(this.value,this.repeat,this.offset)}},Hf=class extends vo{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof Ht?new Array(t).fill(e):new Array(t).fill(new Ht(0))}},t9=class extends Oi{constructor(t,e,i,n){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=i,this.mode=n}generate(t,e){if(t.isShader("fragment")){let i=[];return i.push(this.a.build(t,"c")),i.push(this.b.build(t,"c")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),t.format("spe_blend("+i.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Ute=class extends Oi{constructor(t,e){super("v3"),this.nodeType="CustomColor",this.color=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(Ute.Nodes.customColor);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.build(t,"v3")})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("CustomColorNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},cO=Ute;cO.Nodes=function(){return{customColor:new nt(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var Gte=class extends Oi{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(Gte.Nodes.customNormal);t.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(t,"v3")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Vte=Gte;Vte.Nodes=function(){return{customNormal:new nt(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Nx=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="CustomTexture",this.texture=t,this.textureSize=e,this.crop=i,this.projection=n,this.axis=r,this.side=s,this.size=o,this.blending=a,this.mat=l,this.isMask=u,this.alpha=c,this.mode=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,n;switch(this.projection.value){case 3:n=t.include(Nx.Nodes.cylindrical);break;case 2:n=t.include(Nx.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],a=new nt(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);n=t.include(a);break;case 4:n=t.include(Nx.Nodes.triplanar);break;default:n=t.include(Nx.Nodes.uv);break}t.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.blending.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.projection.value===4){let s=`${i}_writeUvs`,o=s+"0",a=s+"1",l=s+"2",c=`${i}_triplanarWeights`;t.addFragmentVariable(o,"vec2"),t.addFragmentVariable(a,"vec2"),t.addFragmentVariable(l,"vec2"),t.addFragmentVariable(c,"vec3"),r.push(o),r.push(a),r.push(l),r.push(c)}else{let s=`${i}_writeUvs`;t.addFragmentVariable(s,"vec2"),r.push(s)}return t.format(n+"("+r.join(",")+")",this.getType(t),e)}},Pz=Nx;Pz.Nodes=function(){let t=new nt(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),e=new nt(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new nt(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),n=new nt(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:t,spherical:e,uv:i,triplanar:n}}();var kx=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=i,this.far=n,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=c,this.isMask=u,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new nt(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[kx.Nodes.vectorLinearWorldSpaceDepth,kx.Nodes.vectorLinearObjectSpaceDepth,kx.Nodes.vectorSphericalObjectSpaceDepth,kx.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${i}_SMOOTH`),this.isVector.value>.5&&t.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${i}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(n),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.isMask.build(t,"b")),s.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Hte=kx;Hte.Nodes=function(){let t=new nt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new nt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new nt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),n=new nt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:n}}();var Xke=class extends Oi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=i,this.intensity=n,this.factor=r,this.isMask=a,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=new nt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),n=t.include(i),r=[];return r.push(this.color.build(t,"c")),r.push(this.bias.build(t,"f")),r.push(this.scale.build(t,"f")),r.push(this.intensity.build(t,"f")),r.push(this.factor.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),t.format(n+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},jte=class extends Oi{constructor(t,e,i,n,r,s,o,a,l){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=i,this.steps=n,this.offset=r,this.morph=s,this.angle=o,this.isMask=l,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(jte.Nodes.gradient),n=[];return n.push(this.gradientType.build(t,"i")),n.push(this.smooth.build(t,"b")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.offset.build(t,"v2")),n.push(this.morph.build(t,"v2")),n.push(this.angle.build(t,"f")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Wte=jte;Wte.Nodes=function(){return{gradient:new nt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var Xte=class extends Oi{constructor(t,e,i,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.isMask=n,this.alpha=e,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=t.include(Xte.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let n=[];return n.push(this.texture.generate(t,"t")),n.push("normal"),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},qte=Xte;qte.Nodes=function(){return{matcap:new nt(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var Dz=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t.VORONOI="voronoi",t))(Dz||{}),qs=function(){let t=new nt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new nt(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new Di("float F3 0.3333333"),e.keywords.G3=new Di("float G3 0.1666667");let i=new nt(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),n=new nt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new nt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new nt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,r]),o=new nt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new nt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new nt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),c=new nt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Di("int NUM_OCTAVES 5");let h=new nt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new nt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,r,h]),d=new nt(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),f=new nt(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),p=new nt(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new nt(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new nt(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new nt(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new nt(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,f,p,m,g,v]);return{simplex:e,simplexFractal:i,simplexAshima:s,fbm:c,perlin:u,voronoi:y}}(),Yte=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=i,this.fA=n,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=f,this.highCut=p,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,i,n,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(Dz)[this.noiseType.value],o=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,a=new nt(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[qs.simplex,qs.simplexFractal,qs.simplexAshima,qs.fbm,qs.perlin,qs.voronoi]),l=t.include(a),c=[];return c.push(this.scale.build(t,"f")),c.push(this.size.build(t,"v3")),c.push(this.move.build(t,"f")),c.push(this.fA.build(t,"v2")),c.push(this.fB.build(t,"v2")),c.push(this.distortion.build(t,"v2")),c.push(this.colorA.build(t,"v4")),c.push(this.colorB.build(t,"v4")),c.push(this.colorC.build(t,"v4")),c.push(this.colorD.build(t,"v4")),c.push(this.voronoiStyle.build(t,"i")),c.push(this.highCut.build(t,"f")),c.push(this.lowCut.build(t,"f")),c.push(this.smoothness.build(t,"f")),c.push(this.seed.build(t,"f")),c.push(this.quality.build(t,"i")),c.push(this.isMask.build(t,"b")),c.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),c.push(this.alpha.build(t,"f")),c.push(this.calpha),t.format(l+"("+c.join(",")+")",this.getType(t),e)}};Yte.numOctaves=5;var Qte=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=i,this.contourWidth=n,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.compensation.value&&t.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let n=this.outlineWidth.build(t,"f"),r=this.resolution.build(t,"v2"),s=this.compensation.build(t,"b"),o=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(n,"uniform float"),t.addVertexParsVariable(r,"uniform vec2"),t.addVertexParsVariable(s,"uniform bool"),t.addVertexParsVariable(o,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float"),t.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${r} * (${n} / 2.0) * ${i}_clipPosition.w * 2.0 * ${o};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(Qte.Nodes.outline),r=[];return r.push(this.outlineColor.build(t,"c")),r.push(this.contourColor.build(t,"c")),r.push(this.outlineWidth.build(t,"f")),r.push(this.contourWidth.build(t,"f")),r.push(this.contourThreshold.build(t,"f")),r.push(this.outlineThreshold.build(t,"f")),r.push(this.contourFrequency.build(t,"f")),r.push(this.outlineSmoothing.build(t,"f")),r.push(this.contourDirection.build(t,"v3")),r.push(this.positionalLines.build(t,"b")),r.push(this.resolution.build(t,"v2")),r.push(this.normalMap.getTexture(t,"t")),r.push(this.depthMap.getTexture(t,"t")),r.push(this.pixelRatio.build(t,"f")),r.push(this.compensation.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(n+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},Jte=Qte;Jte.Nodes=function(){let t=new nt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new nt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[t])}}();var fu=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v){super("v3"),this.nodeType="Pattern",this.style=t,this.projection=e,this.axis=i,this.blending=n,this.offset=r,this.colorA=s,this.colorB=o,this.frequency=a,this.size=l,this.variation=c,this.smoothness=h,this.zigzag=u,this.rotation=d,this.vertical=f,this.horizontal=p,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.require("position"),t.require("uv"),t.requires.uv=[!0],t.require("normal"),t.requires.normal=!0,t.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let n=`g${this.uuid.toString().replace(/-/g,"")}`,r=new nt(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new nt(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let h=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${h};
				float d1 = ${u};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let h=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,u="";this.axis.value===0?u=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?u=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,u=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${u}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${h};
				`}let a=new nt(`vec3 ${n}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,r,fu.DrawFunctions.circle,fu.DrawFunctions.ring,fu.DrawFunctions.polygon,fu.DrawFunctions.cross,fu.DrawFunctions.diamond,fu.DrawFunctions.checkerboard,fu.DrawFunctions.line,fu.DrawFunctions.wave]),l=t.include(a),c=[];return c.push("normal"),c.push(this.blending.build(t,"f")),c.push(this.style.build(t,"i")),c.push(this.offset.build(t,"v2")),c.push(this.colorA.build(t,"v4")),c.push(this.colorB.build(t,"v4")),c.push(this.frequency.build(t,"v2")),c.push(this.size.build(t,"f")),c.push(this.variation.build(t,"f")),c.push(this.smoothness.build(t,"f")),c.push(this.zigzag.build(t,"f")),c.push(this.rotation.build(t,"f")),c.push(this.vertical.build(t,"v2")),c.push(this.horizontal.build(t,"v2")),c.push(this.sides.build(t,"i")),c.push(this.isMask.build(t,"b")),c.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),c.push(this.alpha.build(t,"f")),c.push(this.calpha),t.format(l+"("+c.join(",")+")",this.getType(t),e)}else return console.warn("PatterNode is not compatible with "+t.shader+" shader."),t.format("vec3(0.0)",this.getType(t),e)}},Kte=fu;Kte.DrawFunctions=function(){let t=new nt(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),e=new nt(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[t]),i=new nt(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[e]),n=new nt(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[e]),r=new nt(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[e]),s=new nt(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[e]),o=new nt(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[e]),a=new nt(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new nt(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[e]),c=new nt(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:e,circle:i,ring:n,polygon:r,cross:s,diamond:o,checkerboard:a,line:l,wave:c}}();var Zte=class extends Oi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=i,this.noiseStrength=n,this.noiseScale=r,this.offset=s,this.isMask=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(Zte.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(t,"f")),n.push(this.movement.build(t,"f")),n.push(this.wavelengths.build(t,"v3")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.offset.build(t,"v3")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},$te=Zte;$te.Nodes=function(){let t=new nt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[qs.simplex]);return{rainbow:new nt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[t])}}();var eie=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=i,this.source=n,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let i=t.include(eie.Nodes.toon),n=[];return n.push(this.positioning.build(t,"i")),n.push(this.colors.build(t,"v4[]")),n.push(this.steps.build(t,"f[]")),n.push(this.source.build(t,"v3")),n.push(this.isWorldSpace.build(t,"b")),n.push(this.noiseStrength.build(t,"f")),n.push(this.noiseScale.build(t,"f")),n.push(this.shadowColor.build(t,"v4")),n.push(this.offset.build(t,"v3")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},tie=eie;tie.Nodes=function(){let t=new nt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new nt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new nt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),n=new nt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new nt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[n]);return{toon:new nt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[qs.simplex,t,i,r])}}();var qke=function(){return{textureBicubic:new nt(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function Yke(t,e){return t>=e?new ge(e/t,1):new ge(1,t/e)}var iie=class extends Oi{constructor(t,e,i,n,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=i,this.transmissionSamplerSize=n,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",6),t.define("BLUR_SLOD",Math.pow(2,Et.transmissionLod.value)),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let i=t.include(iie.Nodes.transmission),n=[];return n.push(this.thickness.build(t,"f")),n.push(this.ior.build(t,"f")),n.push(this.roughness.build(t,"f")),n.push(this.transmissionSamplerSize.build(t,"v2")),n.push(this.transmissionSamplerMap.getTexture(t,"t")),n.push(this.transmissionDepthMap.getTexture(t,"t")),n.push(this.aspectRatio.build(t,"v2")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},nie=iie;nie.Nodes=function(){let t=new nt(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),e=new nt(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new nt(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),n=new nt(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[qke.textureBicubic,i,t]),r=new nt(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[n,e]);return{transmission:new nt(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[r])}}();var uO=(t=>(t.NOISE="noise",t.MAP="map",t))(uO||{}),rie=class extends Oi{constructor(t,e,i,n,r,s,o,a,l,c,h){super("v3"),this.displacementTypeIndex=new Ni(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(uO)[this.displacementTypeIndex.value]==="map"&&(this.mat=new zte(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=c,this.noiseFunctionIndex=h,this.voronoiStyle=n,this.smoothness=r,this.seed=s,this.highCut=o,this.lowCut=a,this.quality=l}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let i,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(uO)[this.displacementTypeIndex.value]){case"map":{i=t.include(rie.Nodes.map),n.push(this.movementOrTexture.getTexture(t,"t")),n.push("uv"),n.push(this.cropOrOffset.build(t,"f")),this.mat&&n.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(Dz)[this.noiseFunctionIndex.value],s=new nt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=r=="voronoi"?`
					float v = ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,a=new nt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[qs.simplex,qs.simplexFractal,qs.simplexAshima,qs.fbm,qs.perlin,qs.voronoi]),l=new nt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);i=t.include(l),n.push(this.scale.build(t,"f")),n.push(this.cropOrOffset.build(t,"v3")),n.push(this.movementOrTexture.build(t,"f")),n.push(this.voronoiStyle.build(t,"i")),n.push(this.smoothness.build(t,"f")),n.push(this.seed.build(t,"f")),n.push(this.highCut.build(t,"f")),n.push(this.lowCut.build(t,"f")),n.push(this.quality.build(t,"i"));break}}return n.push(this.intensity.build(t,"f")),n.push("displaced_normal"),t.format(i+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},sie=rie;sie.Nodes=function(){let t=new nt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new nt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new nt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var Et={normalRenderTarget:new Au,normalRenderTargetDepth:new Au,transmissionRenderTarget:new Au,aspectRatio:new Gr,transmissionSize:new Gr(2048,2048),transmissionRenderTargetDepth:new Au,aoRenderTarget:new Au,aoEnabled:new Ts,pixelRatioNode:new ht(1),resolution:new Gr,penumbraSize:new Vf(5,.5),frameIndex:new Ni(0),transmissionLod:new Ni(2)};for(let t of Object.values(Et))t.isRenderGlobal=!0;var oie=class extends Kd{constructor(){super("basic"),this.nodeType="Basic",this.color=new En(ja),this.shadingAlpha=new ht(1),this.shadingBlend=new Ni(0),this.previousModelViewMatrix=new Rc,this.previouseProjectionMatrix=new Rc}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({resolution:Et.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(R0.merge([it.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{this.color===void 0&&(this.color=new En(ja)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let i=this.color.flow(t,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,s=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=n!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",i.code];n&&o.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),s?o.push(s.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${i.result};`);let a="1.0";this.mask&&(this.mask.analyze(t),a=`luminance(${this.mask.flow(t,"v3").result})`),n?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${n.result} * ${a} );`):o.push("gl_FragColor = vec4("+i.result+", 1.0 );"),r&&o.push(`gl_FragColor.a *= ${r.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),e=o.join(`
`)}return e}},Qke=class extends Kd{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new En(ja),this.emissive=new En(0),this.emissiveIntensity=new ht(1),this.previousModelViewMatrix=new Rc,this.previouseProjectionMatrix=new Rc,this.shadingAlpha=new ht(1),this.shadingBlend=new Ni(0),this.occlusion=new Ts(!0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({resolution:Et.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(R0.merge([it.fog,it.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),n.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Et.penumbraSize}),t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({aoMap:Et.aoRenderTarget}),t.mergeUniform({aoEnabled:Et.aoEnabled}),this.color===void 0&&(this.color=new En(ja)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),n=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.occlusion.flow(t,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];u.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&u.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+r.result+";"),u.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );

					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},y0=function(){let t=new nt(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),e=new nt(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:t,perturbNormalArb:e}}(),Jke=class extends Kd{constructor(){super("phong"),this.nodeType="Phong",this.color=new En(ja),this.specular=new En(1118481),this.shininess=new ht(30),this.previousModelViewMatrix=new Rc,this.previouseProjectionMatrix=new Rc,this.shadingAlpha=new ht(1),this.shadingBlend=new Ni(0),this.occlusion=new Ts(!0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({resolution:Et.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(R0.merge([it.fog,it.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Et.penumbraSize}),t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({aoMap:Et.aoRenderTarget}),t.mergeUniform({aoEnabled:Et.aoEnabled}),this.color===void 0&&(this.color=new En(ja)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t);let i=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),r=this.specular.flow(t,"c"),s=this.shininess.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){t.include(y0.dHdxy),t.include(y0.perturbNormalArb);let f=this.bumpMap.texture.flow(t,"t"),p=this.bumpMap.flow(t,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${g}
					`)}u.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );
					
					outgoingLight *= ao;
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},Kke=class extends Kd{constructor(){super("standard"),this.nodeType="Standard",this.color=new En(ja),this.roughness=new ht(.3),this.metalness=new ht(0),this.reflectivity=new ht(.5),this.previousModelViewMatrix=new Rc,this.previouseProjectionMatrix=new Rc,this.shadingAlpha=new ht(1),this.shadingBlend=new Ni(0),this.occlusion=new Ts(!0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({resolution:Et.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(R0.merge([it.fog,it.lights])),it.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Et.penumbraSize}),t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({aoMap:Et.aoRenderTarget}),t.mergeUniform({aoEnabled:Et.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new En(ja)),this.color.analyze(t,{slot:"color",context:i}),this.roughness.analyze(t),this.metalness.analyze(t);let n=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let r=this.color.flow(t,"c",{slot:"color",context:i}),s=this.roughness.flow(t,"f"),o=this.metalness.flow(t,"f"),a=this.shadingAlpha.flow(t,"f"),l=this.shadingBlend.flow(t,"i"),c=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(t,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=h!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let f=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){t.include(y0.dHdxy),t.include(y0.perturbNormalArb);let m=this.bumpMap.texture.flow(t,"t"),g=this.bumpMap.flow(t,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${y}
					`)}if(f.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(t,"t"),g=this.roughnessMap.flow(t,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,f.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else f.push(s.code,"	float roughnessFactor = "+s.result+";");h&&f.push(h.code,"#ifdef ALPHATEST","	if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),f.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),f.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?f.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):f.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),f.push("#include <lights_fragment_begin>"),f.push("#include <lights_fragment_end>"),f.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let p="1.0";this.mask&&(this.mask.analyze(t),p=`luminance(${this.mask.flow(t,"v3").result})`),f.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${p} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${p}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&f.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),h?f.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):f.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&f.push(`gl_FragColor.a *= ${u.result};`),f.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=f.join(`
`)}return e}},Zke=class extends Kd{constructor(){super("toon"),this.nodeType="Toon",this.color=new En(ja),this.specular=new En(1118481),this.shininess=new ht(30),this.previousModelViewMatrix=new Rc,this.previouseProjectionMatrix=new Rc,this.shadingAlpha=new ht(1),this.shadingBlend=new Ni(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({resolution:Et.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(R0.merge([it.fog,it.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=n.join(`
`)}else{t.mergeUniform({penumbraSize:Et.penumbraSize}),t.mergeUniform({frameIndex:Et.frameIndex}),t.mergeUniform({aoMap:Et.aoRenderTarget}),t.mergeUniform({aoEnabled:Et.aoEnabled}),this.color===void 0&&(this.color=new En(ja)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),n=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){t.include(y0.dHdxy),t.include(y0.perturbNormalArb);let d=this.bumpMap.texture.flow(t,"t"),f=this.bumpMap.flow(t,"v3"),p=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${p});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${p});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${p});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${p});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${m}
					`)}h.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	vec3 specular = "+n.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(t),u=`luminance(${this.mask.flow(t,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${u} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${u}, ${o.result} );
				}
				`),a&&h.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=h.join(`
`)}return e}},$ke=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),i=this.cache.get(t);return i===void 0?(i={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,i)):(i.time=e,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},eze=class extends $ke{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},Y3;function tze(t){return typeof t=="string"?t:(Y3||(Y3=new eze),Y3.load(t))}var ize=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},nze=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},aie=class extends ize{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type==="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let n=[1e3,1001,1002];for(let r of n){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var i=new FileReader;i.readAsDataURL(new Blob([t],{type:"video/mp4"}));let n;await new Promise(r=>{i.onloadend=s=>{var o;n=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=n}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=tze(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let i;return this.isVideo?i=new vEe(this.img,void 0,t,t):i=new ur(this.img,void 0,t,t),this.loaded&&(i.needsUpdate=!0),this[t]=i,i}}disposeTextures(){var t,e,i;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(i=this[1002])==null||i.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},hp=class extends aie{};function Ds(t,e){return e.color(t)}function rze(t,e){switch(t.type){case"fresnel":return aze(t,e);case"gradient":return lze(t);case"depth":return cze(t);case"normal":return uze(t);case"noise":return hze(t,e);case"rainbow":return dze(t);case"toon":return fze(t,e);case"outline":return pze(t,e);case"transmission":return mze(t);case"color":return oze(t,e);case"pattern":return gze(t,e)}}function sze(t){return{type:t.type}}function Nl(t){let{alpha:e,mode:i,isMask:n}=t;return{...sze(t),alpha:e,mode:i,isMask:n}}function oze(t,e){return{...Nl(t),color:Ds(t.color,e)}}function aze(t,e){let{bias:i,scale:n,intensity:r,factor:s,color:o,isMask:a}=t;return{...Nl(t),color:Ds(o,e),bias:i,scale:n,intensity:r,factor:s}}function lze(t){let{gradientType:e,smooth:i,colors:n,steps:r,angle:s,offset:o,morph:a}=t;return{...Nl(t),gradientType:e,smooth:i,colors:n.map(l=>new Ht(l[0],l[1],l[2],l[3])),num:n.length,steps:r,offset:new ge(...o),morph:new ge(...a),angle:s}}function cze(t){let{gradientType:e,near:i,far:n,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:c,smooth:h}=t;return{...Nl(t),gradientType:e,near:i,far:n,isVector:r,isWorldSpace:s,origin:new O(...o),direction:a?new O(...a):new O(1,0,0),colors:l.map(u=>u!==void 0?new Ht(u[0],u[1],u[2],u[3]):new Ht(0,0,0,0)),steps:c.slice(0,l.length),smooth:h}}function uze(t){let{cnormal:e}=t;return{...Nl(t),cnormal:new O(e[0],e[1],e[2])}}function hze(t,e){return{...Nl(t),scale:t.scale,move:t.move,fA:new ge(...t.fA),fB:new ge(...t.fB),size:new O(...t.size),distortion:new ge(...t.distortion),colorA:Ds(t.colorA,e),colorB:Ds(t.colorB,e),colorC:Ds(t.colorC,e),colorD:Ds(t.colorD,e),noiseType:t.noiseType,voronoiStyle:t.voronoiStyle,highCut:t.highCut,lowCut:t.lowCut,smoothness:t.smoothness,seed:t.seed,quality:t.quality}}function dze(t){return{...Nl(t),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new O(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new O(...t.offset)}}function fze(t,e){return{...Nl(t),positioning:t.positioning,colors:t.colors.map(i=>new Ht(i[0],i[1],i[2],i[3])),num:t.colors.length,steps:t.steps,source:new O(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:Ds(t.shadowColor,e),offset:new O(...t.offset)}}function pze(t,e){return{...Nl(t),outlineColor:Ds(t.outlineColor,e),contourColor:Ds(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new O(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function mze(t,e){return{...Nl(t),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}function gze(t,e){return{...Nl(t),style:t.style,projection:t.projection,axis:t.axis,blending:t.blending,offset:new ge(...t.offset),colorA:Ds(t.colorA,e),colorB:Ds(t.colorB,e),frequency:new ge(...t.frequency),size:t.size,variation:t.variation,smoothness:t.smoothness,zigzag:t.zigzag,rotation:t.rotation,vertical:new ge(...t.vertical),horizontal:new ge(...t.horizontal),sides:t.sides}}var fE=class extends ho{},lie={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},cie={depth:["colors"]};function vze(t,e,i){var s,o;if(e==="isMask")return!0;let n=lie[t.type],r=cie[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==i.length)return!0}}return n!==void 0?n.includes(e):!1}function uie(t,e,i){let n=i.uniforms[`f${i.id}_texture`];if(!n)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=n;l.image instanceof hp||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=n;l.image instanceof hp||l.image.deref(),l.image=a}if("wrapping"in s){let o=n;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=i.uniforms[`f${i.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function yze(t,e,i,n){let r=!1;for(let[s,o]of Object.entries(t)){if(s==="bumpMap"||s==="roughnessMap"){r=!0;continue}if(!s||o===void 0)continue;if(die(s,i,n)){s==="visible"&&i.type==="light"&&(r=!0);continue}i.visible=n.visible;let a=i.uniforms[`f${i.id}_${s}`];if(a&&!(a instanceof Tz))switch(r=r||vze(i,s,o),a.constructor){case En:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof fE?a.value=new ho(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case vu:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof fE?a.value=new ho(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case Gr:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case ya:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case Au:{uie(o,e,i);break}case Hf:{a.value=o.map(l=>new Ht(...l));break}default:{a.value=o;break}}}return r}var Bp=class{constructor(t,e,i,n){this.id=t,this.uuid=e,this.data=i,this.uniforms={};for(let r in n)this.uniforms[`f${this.id}_${r}`]=n[r];for(let r in i)die(r,this,i)}get type(){return this.data.type}static create(t,e,i,n){if(i.type==="light")return yu.createLigherLayer(t,e,i,n);if(i.type==="texture"||i.type==="video"){let r=i.type==="texture"?n.image(i.texture.image):n.video(i.texture.video),s=new lO(r,i.texture.wrapping),o=new jke(r),a=new Wke(i.texture.repeat,i.texture.offset),l=new ht(i.crop?1:0),c=new Ni(i.projection??0),h=new Ni(["x","y","z"].indexOf(i.axis)??0),u=new Ni(i.side??0),d=new Gr(i.size?new ge(i.size[0],i.size[1]):new ge(100,100)),f=new ht(i.blending??0),p=new ht(i.alpha??1),m=new Ni(i.mode??0),g=new Ts(i.isMask??!1),v=new Pz(s,o,l,c,h,u,d,f,a,p,m,g),y=new Qi(v.calpha,"f");return new wn(t,e,i,{texture:s,textureSize:o,crop:l,projection:c,axis:h,side:u,size:d,blending:f,mat:a,alpha:p,mode:m,isMask:g},v,m,y,g)}else if(i.type==="matcap"){let r=n.image(i.texture.image),s=new lO(r,i.texture.wrapping),o=new ht(i.alpha??1),a=new Ni(i.mode??0),l=new Ts(i.isMask??!1),c=new qte(s,o,a,l),h=new Qi(c.calpha,"f");return new wn(t,e,i,{texture:s,alpha:o,mode:a,isMask:l},c,a,h,l)}else if(i.type==="displace")if(i.displacementType==="noise"){let r=new ya(new O(...i.offset)),s=new ht(i.scale??10),o=new ht(i.intensity??8),a=new ht(i.movement??1),l=new Ni(i.noiseType??0),c=new Ni(i.voronoiStyle??0),h=new ht(i.smoothness??.5),u=new ht(i.seed??0),d=new ht(i.highCut??1),f=new ht(i.lowCut??0),p=new Ni(i.quality??1),m=new sie(o,a,r,c,h,u,d,f,p,s,l);return new hie(t,e,i,{offset:r,scale:s,intensity:o,movement:a,noiseType:l,voronoiStyle:c,smoothness:h,seed:u,highCut:d,lowCut:f,quality:p},m)}else throw new Error;else return wze(t,e,i,n)}updateByOp(t,e,i){let n=t;if(n.path[0]===void 0){if(n.type===0)return"type"in n.props||"category"in n.props||"visible"in n.props?(i.scene.markNeedsUpdateRendererDirty(),!0):yze(n.props,i.shared,this,e)}else if(n.path[0]==="texture")return"texture"in e||"video"in e?uie(n.props,i.shared,this):!0;return!1}dispose(){if(xze(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof hp||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let i=`f${this.id}_${t}`;this.hasValueByKey(i)&&e!==void 0&&(this.uniforms[i].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let i=this.getName(e);i&&t.push(i)}return t}},wn=class extends Bp{constructor(t,e,i,n,r,s,o,a){super(t,e,i,n),this.params=n,this.color=r,this.mode=s,this.alpha=o,this.isMask=a}},hie=class extends Bp{constructor(t,e,i,n,r){super(t,e,i,n),this.position=r}},yu=class extends Bp{constructor(t,e,i,n,r){super(t,e,i,r),this.node=n}static createLigherLayer(t,e,i,n){let r,s=new ht(i.alpha),o=new Ni(i.mode),a=new ht(i.bumpMapIntensity),l=new ht(i.alphaOverride),c;if(!i.visible)r=new oie,c={};else if(i.category==="lambert"){r=new Qke;let h=new En(n.color(i.emissive)??0),u=new Ts(i.occlusion??!0);c={emissive:h,occlusion:u},r.emissive=h,r.occlusion=u}else if(i.category==="toon"){r=new Zke;let h=new ht(i.shininess??30),u=new En(n.color(i.specular)??1118481);c={shininess:h,specular:u},r.shininess=h,r.specular=u}else if(i.category==="physical"){r=new Kke;let h=new ht(i.roughness??.3),u=new ht(i.metalness??0),d=new ht(i.reflectivity??.5),f=new Ts(i.occlusion??!0);c={roughness:h,metalness:u,reflectivity:d,occlusion:f},r.roughness=h,r.metalness=u,r.reflectivity=d,r.occlusion=f}else{r=new Jke;let h=new ht(i.shininess??30),u=new En(i.specular!==void 0?n.color(i.specular)??1118481:1118481),d=new Ts(i.occlusion??!0);c={shininess:h,specular:u,occlusion:d},r.shininess=h,r.specular=u,r.occlusion=d}return r.alpha=new ht(1),r.shadingAlpha=s,r.shadingBlend=o,r.bumpMapIntensity=a,r.alphaOverride=l,c.alpha=r.shadingAlpha,c.mode=r.shadingBlend,c.bumpMapIntensity=r.bumpMapIntensity,c.alphaOverride=r.alphaOverride,new yu(t,e,i,r,c)}get category(){return this.node.category}};function xze(t){let e=t instanceof Bp?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function ha(t){return{alpha:new ht(t.alpha??1),mode:new Ni(t.mode??0),isMask:new Ts(t.isMask??!1)}}function _ze(t,e,i,n){switch(t.type){case"color":{let r=new En(n.color??ja),s=ha(n),o=new cO(r,s.alpha),a=new Qi(o.calpha,"f");return new wn(e,i,t,{color:r,...s},o,s.mode,a,s.isMask)}case"fresnel":{let r=new En(n.color??16777215),s=new ht(n.bias??.1),o=new ht(n.scale??1),a=new ht(n.intensity??2),l=new ht(n.factor??1),c=ha(n),h=new Xke(r,s,o,a,l,c.alpha,c.mode,c.isMask),u=new Qi(h.calpha,"f");return new wn(e,i,t,{color:r,bias:s,scale:o,intensity:a,factor:l,...c},h,c.mode,u,c.isMask)}case"rainbow":{let r=new ht(n.filmThickness??30),s=new ht(n.movement??0),o=new ya(n.wavelengths??new O(0,0,0)),a=new ht(n.noiseStrength??0),l=new ht(n.noiseScale??1),c=new ya(n.offset??new O(0,0,0)),h=ha(n),u=new $te(r,s,o,a,l,c,h.alpha,h.isMask),d=new Qi(u.calpha,"f");return new wn(e,i,t,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:c,...h},u,h.mode,d,h.isMask)}case"transmission":{let r=new ht(n.thickness??10),s=new ht(n.ior??1.5),o=new ht(n.roughness??.5),a=Et.transmissionSize,l=Et.transmissionRenderTarget,c=Et.transmissionRenderTargetDepth,h=window.innerWidth,u=window.innerHeight,d=h>=u?new Gr(u/h,1):new Gr(1,h/u),f=ha(n),p=new nie(r,s,o,a,l,c,d,f.alpha),m=new Qi(p.calpha,"f");return new wn(e,i,t,{thickness:r,ior:s,roughness:o,aspectRatio:d,...f},p,f.mode,m,f.isMask)}case"toon":{let r=new Ni(n.positioning??0),s;n.colors?s=new Hf(n.colors.length,n.colors):(s=new Hf(10,new Ht(0,0,0,1)),s.value[1]=new Ht(1,1,1,1));let o;n.steps?o=new Vf(n.steps.length,n.steps):(o=new Vf(10,1),o.value[0]=0);let a=new ya(n.source??new O(0,0,0)),l=new Ts(n.isWorldSpace??!0),c=new ht(n.noiseStrength??0),h=new ht(n.noiseScale??1),u=new vu(n.shadowColor),d=new ya(n.offset??new O(0,0,0)),f=ha(n),p=new tie(r,s,o,a,l,c,h,u,d,f.alpha),m=new Qi(p.calpha,"f");return new wn(e,i,t,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:c,noiseScale:h,shadowColor:u,offset:d,...f},p,f.mode,m,f.isMask)}case"outline":{let r=new En(n.outlineColor??16777215),s=new En(n.contourColor??16777215),o=new ht(n.outlineWidth??.1),a=new ht(n.contourWidth??.1),l=new ht(n.outlineThreshold??.1),c=new ht(n.contourThreshold??.1),h=new ht(n.outlineSmoothing??.1),u=new ht(n.contourFrequency??.1),d=new ya(n.contourDirection??new O(0,1,0)),f=new Ts(n.positionalLines??!1),p=new Ts(n.compensation??!0),m=Et.normalRenderTarget,g=Et.normalRenderTargetDepth,v=Et.pixelRatioNode,y=Et.resolution,x=ha(n),b=new Jte(r,s,o,a,l,c,h,u,d,f,p,y,m,g,v,x.alpha),S=new Qi(b.calpha,"f");return new wn(e,i,t,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:c,outlineSmoothing:h,contourFrequency:u,contourDirection:d,positionalLines:f,compensation:p,...x},b,x.mode,S,x.isMask)}case"depth":{let r=new Ni(n.gradientType??0),s=new Ts(n.smooth??!1),o=new ht(n.near??50),a=new ht(n.far??200),l=new ht(n.isVector??1),c=new ht(n.isWorldSpace??0),h=new ya(n.origin??new O),u=new ya(n.direction??new O),d;n.colors?d=new Hf(n.colors.length,n.colors):(d=new Hf(2,new Ht(0,0,0,1)),d.value[1]=new Ht(1,1,1,1));let f;n.steps?f=new Vf(n.steps.length,n.steps):(f=new Vf(2,1),f.value[0]=0);let p=ha(n),m=new Hte(r,s,o,a,l,c,h,u,d,f,p.alpha,p.isMask),g=new Qi(m.calpha,"f");return new wn(e,i,t,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:c,origin:h,direction:u,colors:d,steps:f,...p},m,p.mode,g,p.isMask)}case"noise":{let r=new ht(n.scale??1),s=new ya(n.size??new O(100,100,100)),o=new ht(n.move??1),a=new Gr(n.fA??new ge(1.7,9.2)),l=new Gr(n.fB??new ge(8.3,2.8)),c=new Gr(n.distortion??new ge(1,1)),h=new vu(n.colorA),u=new vu(n.colorB),d=new vu(n.colorC),f=new vu(n.colorD),p=new Ni(n.noiseType??0),m=new Ni(n.voronoiStyle??0),g=new ht(n.highCut??1),v=new ht(n.lowCut??0),y=new ht(n.smoothness??.5),x=new ht(n.seed??.5),b=new Ni(n.quality??1),S=ha(n),A=new Yte(r,s,o,a,l,c,h,u,d,f,S.alpha,p,S.isMask,m,g,v,y,x,b),E=new Qi(A.calpha,"f");return new wn(e,i,t,{scale:r,size:s,move:o,fA:a,fB:l,distortion:c,colorA:h,colorB:u,colorC:d,colorD:f,noiseType:p,...S,voronoiStyle:m,highCut:g,lowCut:v,smoothness:y,seed:x,quality:b},A,S.mode,E,S.isMask)}case"normal":{let r=new ya(n.cnormal??new O(1,1,1)),s=ha(n),o=new Vte(r,s.alpha),a=new Qi(o.calpha,"f");return new wn(e,i,t,{cnormal:r,...s},o,s.mode,a,s.isMask)}case"gradient":{let r=new Ni(n.gradientType??0),s=new Ts(n.smooth??!1),o;n.colors?o=new Hf(n.colors.length,n.colors):(o=new Hf(10,new Ht(0,0,0,1)),o.value[1]=new Ht(1,1,1,1));let a;n.steps?a=new Vf(n.steps.length,n.steps):(a=new Vf(10,1),a.value[0]=0);let l=new Gr(n.offset??new ge(0,0)),c=new Gr(n.morph??new ge(0,0)),h=new ht(n.angle??0),u=ha(n),d=new Wte(r,s,o,a,l,c,h,u.alpha,u.isMask),f=new Qi(d.calpha,"f");return new wn(e,i,t,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:c,angle:h,...u},d,u.mode,f,u.isMask)}case"pattern":{let r=new Ni(n.style??0),s=new Ni(n.projection??0),o=new Ni(["x","y","z"].indexOf(n.axis)??0),a=new ht(n.blending??0),l=new Gr(n.offset??new ge(0,0)),c=new vu(n.colorA),h=new vu(n.colorB),u=new Gr(n.frequency??new ge(10,10)),d=new ht(n.size??.5),f=new ht(n.variation??0),p=new ht(n.smoothness??.5),m=new ht(n.zigzag??0),g=new ht(n.rotation??0),v=new Gr(n.vertical??new ge(0,1)),y=new Gr(n.horizontal??new ge(0,1)),x=new Ni(n.sides??6),b=ha(n),S=new Kte(r,s,o,a,l,c,h,u,d,f,p,m,g,v,y,x,b.alpha,b.isMask),A=new Qi(S.calpha,"f");return new wn(e,i,t,{style:r,projection:s,axis:o,blending:a,offset:l,colorA:c,colorB:h,frequency:u,size:d,variation:f,smoothness:p,zigzag:m,rotation:g,vertical:v,horizontal:y,sides:x,...b},S,b.mode,A,b.isMask)}default:{let r=new En(1,0,0,1),s=ha(n),o=new cO(r,s.alpha),a=new Qi(o.calpha,"f");return new wn(e,i,t,{color:r,...s},o,s.mode,a,s.isMask)}}}function wze(t,e,i,n){let r=rze(i,n);return _ze(i,t,e,r)}function die(t,e,i){if(i.type==="displace"&&(t==="intensity"||t==="visible")){let n=e.uniforms[`f${e.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(t==="alpha"||t==="visible")){let n=e.uniforms[`f${e.id}_alpha`];if(!n)return;if(n.value=i.alpha*(i.visible?1:0),i.type==="outline"&&t==="visible"){let r=e.uniforms[`f${e.id}_compensation`];r&&(r.value=i.compensation&&i.visible)}return n}}function pE(t,e){let i=0,n=t.layers.find(r=>r.data.type==="light");if(n&&n.data.alphaOverride<1)return!0;for(let r of t.layers){if(r.data.type!=="displace"&&r.data.isMask)return!0;if(r.data.type!=="displace"&&"alpha"in r.data&&r.data.type!=="light"&&r.data.type!=="fresnel"&&r.data.type!=="texture"&&r.data.type!=="matcap"&&r.data.type!=="rainbow"&&r.data.type!=="outline"&&r.data.type!=="pattern"){let s=r.data.visible?r.data.alpha:0;if(s===1&&r.data.type==="depth"||r.data.type==="gradient"){for(let o of r.data.colors)if(o[3]<1){s=o[3];break}}else if(s===1&&r.data.type==="noise"){let o=e.color(r.data.colorA).a,a=e.color(r.data.colorB).a,l=e.color(r.data.colorC).a,c=e.color(r.data.colorD).a,h=Math.min(o,Math.min(a,Math.min(l,c)));h<1&&(s=h)}i+=(1-i)*s}}return i<1}var zd=class extends Wi{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},bze=class extends zd{constructor(t,e,i,n){super(),this.flatShading=t,this.side=e,this.wireframe=i,this.root=n}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(t,e,i){return this.root.getFlavor(t,e,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,i){this.root.updateByOp(t,e,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Iz=class extends zd{constructor(t,e){super(),this.data=t,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,i){let n=i?6:(t?3:0)+e;if(n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let r=this.flavors[n];return r===void 0&&(r=new bze(t,e,i,this),this.flavors[n]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var t;return((t=this.lightLayer.getNode("occlusion"))==null?void 0:t.value)??!1}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let i=t.layers??uo.defaultTwoLayerData("phong").layers;try{this.layers=i.map(n=>Bp.create(this.layerIdGen++,n.id,n.data,e.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(),this.transparent=pE(t,e.shared)}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof yu),this.lightLayer===void 0&&(this.lightLayer=new yu(0,"",{...Xs.defaultData("light","phong"),visible:!1},new oie,{})),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let t=this.layers.find(r=>r instanceof yu);if(!t)return;let e=t.data,i=e.bumpMap,n=e.roughnessMap;t.node.bumpMap=void 0,t.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let s=this.layers[r];s instanceof wn&&s.color instanceof Pz&&(s.uuid===i&&(t.node.bumpMap=s.color),s.uuid===n&&(t.node.roughnessMap=s.color))}}updateByOp(t,e,i){if(e!==void 0?this.data=e:e=this.data,this.transparent=pE(e,i.shared),t.path[0]==="layers"){this.data=e;let n=i.shared,r=t.path[1];if(r===void 0){if(this.layers.reverse(),t.type===4){let s=Bp.create(this.layerIdGen++,t.id,t.data,i.shared);this.layers.splice(t.localIndex,0,s),i.scene.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),i.scene.markNeedsUpdateRendererDirty();else if(t.type===6){let s=this.layers.findIndex(a=>a.uuid===t.id),o=this.layers[s];this.layers.splice(s,1),this.layers.splice(t.localIndex,0,o),i.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{t.type===0&&t.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(o=>o.uuid===r);if(s){let o=e.layers.data(r);if(s.updateByOp({...t,path:t.path.slice(2)},o,i)){let a=Bp.create(this.layerIdGen++,r,o,n);this.layers.splice(this.layers.findIndex(l=>l.uuid===r),1,a),this.onUpdate()}}}}else this.reset(e,i)}applyMasks(){for(let t=0;t<this.layers.length;++t){let e=this.layers[t];e instanceof wn?e.color.mask=void 0:e instanceof yu&&(e.node.mask=void 0)}for(let t=0;t<this.layers.length;++t){let e=this.layers[t];if(e instanceof wn&&e.isMask.value&&e.data.visible&&t>0){let i=t-1,n=this.layers[i];n instanceof yu?n.node.mask=new js(e.color,e.alpha,js.MUL):n instanceof wn&&(n.isMask.value||(n.color.mask=new js(e.color,e.alpha,js.MUL)))}}}blendColors(){let t=this.layers.findIndex(i=>i instanceof wn),e=this.layers.findIndex(i=>i instanceof yu);if(t!==-1&&t<e){let i=this.layers[t].color;for(let n=t+1;n<e;++n){let r=this.layers[n];if(r instanceof wn){if(r.isMask.value)continue;i=new t9(i,r.color,r.alpha,r.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let t=new Qi("outgoingLight","f"),e=this.layers.findIndex(i=>i instanceof yu);if(this.layers.length>e+1){for(let i=e+1;i<this.layers.length;++i){let n=this.layers[i];if(n instanceof wn){if(n.isMask.value)continue;t=new t9(t,n.color,n.alpha,n.mode)}}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof hie);if(t.length>0){let e=t[0].position;for(let i=1;i<t.length;++i)t[i]&&(e=new js(e,t[i].position,js.ADD),e=new js(e,new ht(.5).setReadonly(!0),js.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let i=(n,r,s)=>Math.min(Math.max(n,r),s);for(let n of this.layers)if(n.type==="displace"){let r=i(n.uniforms[`f${n.id}_intensity`].value,t,e);n.uniforms[`f${n.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let i=(lie[e.type]??[]).map(a=>e[a]),n=(cie[e.type]??[]).map(a=>{var l;return((l=e[a])==null?void 0:l.length)??0}),r=[...i,...n],s="isMask"in e&&e.isMask,o=`"${e.type}-${e.visible}-${s}"`;r.length?t+=`[${o}, "${r.join('","')}"],`:t+=o}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new Hke;t.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof wn){let e=t.params.texture;if(e instanceof lO&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(zd.prototype,{properties:{get:function(){return this.fragment.properties}}});var hO=class extends Iz{},Sze=I0(awe()),i9=new Map;function Aze(t){if(typeof t=="string")return t;let e=i9.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},i9.set(t,e)),e.url}var zx=class{constructor({src:t,volume:e,delay:i,loop:n}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:Aze(t),format:"wav"},this.sound=new Sze.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),i!==void 0&&(this.delay=i),n!==void 0&&(this.loop=n)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,i){this.sound.on(t,e,i)}off(t,e,i){this.sound.off(t,e,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},Mze=class{constructor(){this.type="ShapePath",this.color=new Tt,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new RC,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var i;return(i=this.currentPath)==null||i.lineTo(t,e),this}quadraticCurveTo(t,e,i,n){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,i,n),this}bezierCurveTo(t,e,i,n,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,i,n,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function i(f,p,m,g){let v=f.x,y=p.x,x=m.x,b=g.x,S=f.y,A=p.y,E=m.y,M=g.y,T=(b-x)*(S-E)-(M-E)*(v-x),P=(y-v)*(S-E)-(A-S)*(v-x),I=(M-E)*(y-v)-(b-x)*(A-S),k=T/I,R=P/I;if(I===0&&T!==0||k<=0||k>=1||R<0||R>1)return null;if(T===0&&I===0){for(let F=0;F<2;F++)if(n(F===0?m:g,f,p),e.loc===t.ORIGIN){let V=F===0?m:g;return{x:V.x,y:V.y,t:e.t}}else if(e.loc===t.BETWEEN){let V=+(v+e.t*(y-v)).toPrecision(10),Q=+(S+e.t*(A-S)).toPrecision(10);return{x:V,y:Q,t:e.t}}return null}else{for(let Q=0;Q<2;Q++)if(n(Q===0?m:g,f,p),e.loc===t.ORIGIN){let X=Q===0?m:g;return{x:X.x,y:X.y,t:e.t}}let F=+(v+k*(y-v)).toPrecision(10),V=+(S+k*(A-S)).toPrecision(10);return{x:F,y:V,t:k}}}function n(f,p,m){let g=m.x-p.x,v=m.y-p.y,y=f.x-p.x,x=f.y-p.y,b=g*x-y*v;if(f.x===p.x&&f.y===p.y){e.loc=t.ORIGIN,e.t=0;return}if(f.x===m.x&&f.y===m.y){e.loc=t.DESTINATION,e.t=1;return}if(b<-Number.EPSILON){e.loc=t.LEFT;return}if(b>Number.EPSILON){e.loc=t.RIGHT;return}if(g*y<0||v*x<0){e.loc=t.BEHIND;return}if(Math.sqrt(g*g+v*v)<Math.sqrt(y*y+x*x)){e.loc=t.BEYOND;return}let S;g!==0?S=y/g:S=x/v,e.loc=t.BETWEEN,e.t=S}function r(f,p){let m=[],g=[];for(let v=1;v<f.length;v++){let y=f[v-1],x=f[v];for(let b=1;b<p.length;b++){let S=p[b-1],A=p[b],E=i(y,x,S,A);E!==null&&m.find(M=>M.t<=E.t+Number.EPSILON&&M.t>=E.t-Number.EPSILON)===void 0&&(m.push(E),g.push(new ge(E.x,E.y)))}}return g}function s(f,p,m){let g=new ge;p.getCenter(g);let v=[];return m.forEach(y=>{y.boundingBox.containsPoint(g)&&r(f,y.points).forEach(x=>{v.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),v.sort((y,x)=>y.point.x-x.point.x),v}function o(f,p,m,g,v){(v==null||v==="")&&(v="nonzero");let y=new ge;f.boundingBox.getCenter(y);let x=[new ge(m,y.y),new ge(g,y.y)],b=s(x,f.boundingBox,p);b.sort((P,I)=>P.point.x-I.point.x);let S=[],A=[];b.forEach(P=>{P.identifier===f.identifier?S.push(P):A.push(P)});let E=S[0].point.x,M=[],T=0;for(;T<A.length&&A[T].point.x<E;)M.length>0&&M[M.length-1]===A[T].identifier?M.pop():M.push(A[T].identifier),T++;if(M.push(f.identifier),v==="evenodd"){let P=M.length%2===0,I=M[M.length-2];return{identifier:f.identifier,isHole:P,for:I}}else if(v==="nonzero"){let P=!0,I=null,k=null;for(let R=0;R<M.length;R++){let F=M[R];p[F]&&(P?(k=p[F].isCW,P=!1,I=F):k!==p[F].isCW&&(k=p[F].isCW,P=!0))}return{identifier:f.identifier,isHole:P,for:I}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let a=0,l=999999999,c=-999999999,h=[];this.subPaths.forEach(f=>{let p=f.getPoints(),m=-999999999,g=999999999,v=-999999999,y=999999999;for(let x=0;x<p.length;x++){let b=p[x];b.y>m&&(m=b.y),b.y<g&&(g=b.y),b.x>v&&(v=b.x),b.x<y&&(y=b.x)}c<=v&&(c=v+1),l>=y&&(l=y-1),p.length&&h.push({curves:f.curves,points:p,isCW:P$.isClockWise(p),identifier:a++,boundingBox:new bTe(new ge(y,g),new ge(v,m))})});let u=h.map(f=>{var p;return o(f,h,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),d=[];return h.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let m=new OC;m.curves=f.curves,u.filter(g=>(g==null?void 0:g.isHole)&&g.for===f.identifier).forEach(g=>{if(g){let v=h[g.identifier],y=new RC;y.curves=v.curves,m.holes.push(y)}}),d.push(m)}}),d}},fie,n9=new Promise(t=>{fie=t}),r9=!1,RA;function Cze(){if(r9)return;if(RA)return RA;async function t(){let e=await fw(()=>import("./opentype-fc28cde9.js"),[]);fie(e),r9=!0}return RA=t(),RA}var Eze=class{async load(t,e,i=()=>{}){let{load:n}=await n9;n(t,(r,s)=>{r||!s?i(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:i}=await n9;try{let n=e(t),r=new i,s=o=>n.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:r}}catch(n){console.error(n)}}};async function Tze(t){return await(await fetch(t)).arrayBuffer()}var Pze=new Eze;async function s9(t){let e,i,n=!1;if(t.url?(e=await Tze(t.url),i=t.url,n=t.url.startsWith("/")):t.data&&(e=t.data.buffer),e){let r=await Pze.parse(e);if(r)return{font:r.font,url:i,intercepted:n,arr:e,bidi:r.bidi}}}function Dze(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var Ize=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=s9(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=s9(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,i){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(e);let r=n.tokenizer.tokens,s=[],o=0,a=i.length===r.length;for(let l=0;l<i.length;l++){let c=i[l].index,h=String.fromCharCode(i[l].unicode),u=r[o];if(Dze(c,u)||a)s.push({char:h,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let d=u.char,f="",p=[u.state.glyphIndex],m=[],g=!1;for(;!g;)o++,f=e.charAt(o),d+=f,p.push(t.charToGlyphIndex(f)),m=t.stringToGlyphs(d),m.length===1&&m[0].index===c&&(g=!0),o>e.length&&(g=!0);s.push({char:h,index:c,replacements:p,replacementChars:Array.from(d)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let i=this.font,n=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(v=>this.getTextWidth(v,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,c=this.computeSpaceWidthForLine(t,0,e),h=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),u=this.getLineInitialOffsetY(r,t.length,e.height,n,e.verticalAlign),d=[],f=t.map(v=>[]),p=t.map(v=>[]),m;for(let v=0;v<t.length;v++){let y=t[v],x={features:{liga:!0}},b=[];try{b=i.stringToGlyphs(y,x)}catch(A){console.warn(A)}h=this.getLineInitialOffsetX(s[v],o,e.horizontalAlign,y,a);let S=[];try{S=this.reverseLigaturesTable(i,y,b)}catch(A){console.warn(A)}c=this.computeSpaceWidthForLine(t,v,e);for(let A=0;A<b.length;A++){let E=b[A],M=E.index===0?`
`:E.unicode?String.fromCharCode(E.unicode):void 0,T=S[A],P=0,I=0;A===0&&e.horizontalAlign===2&&E.leftSideBearing!==void 0&&(I=-E.leftSideBearing*n),m&&(P=i.getKerningValue(E,m)*n),h+=I+P;let k=0;if(M===`
`)k=l;else if(M===" ")k=c;else{let R=this.createPath(E,n,h,u,e);R&&(k=R.offsetX-(P+I),d.push(R.path))}if(T.replacements.length===1)p[v].push([h,u]),f[v].push(k);else{let R=T.replacements.map(X=>(i.glyphs.get(X).advanceWidth??0)*n),F=R.reduce((X,z)=>X+=z,0),V=R.map(X=>X/F),Q=h;for(let X=0;X<V.length;X++){let z=k*V[X];p[v].push([Q,u]),f[v].push(z),Q+=z}}h+=k,m=E}u-=r}let g=[];for(let v=0,y=d.length;v<y;v++)g.push(...d[v].toShapes());return{shapes:g,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,i,n,r){return(i===3||i===2)&&n.indexOf(`
`)>=0&&(t-=r),i===3?e*.5-t*.5:i===2?e-t:0}getLineInitialOffsetY(t,e,i,n,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*n,a=t-o,l=-this.ascender*n-a/2;return r===3?-(i-s-l):r===2?-(i*.5-s*.5-l):l}createPath(t,e,i,n,r){var l;let s=t.getPath(i,-n,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new Mze,a=(t.advanceWidth??1)*e;if(t)for(let c of s.commands){let h=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(h&&c.type!=="Z"&&h.x===c.x&&-h.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let h=Lze(c.curves);h!==void 0&&c.currentPoint.distanceTo(h)>0&&c.lineTo(h.x,h.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,i){let n=this.getCharWidth(" ",i),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(i.horizontalAlign===4&&e<t.length-1&&s){let o=i.width,a=this.getTextWidth(r,i);return(o-(a-s*n))/s}}return n}countSpaces(t){return(t.match(/ /g)||[]).length}};function Lze(t){if(t.length){let e=t[0];if(e instanceof Cl)return e.v1;if(e instanceof gl||e instanceof Nd)return e.v0}}var Bze=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e){let i=this.objects.get(t);return i===void 0?(i=this.createObject(t,e),this.objects.set(t,i)):i.isShared=!0,i}mutateIfUnique(t,e){let i=this.objects.get(t);if(i&&i.isShared!==!0)return this.objects.delete(t),this.objects.set(e,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let i=this.objects.get(t);e===i&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},o9=class extends Bze{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e){let i=dE(t,e,this.flatShading);return i.computeBoundingSphere(),i}},Rze={markNeedsUpdateRendererDirty:()=>{}},Oze=class extends nze{constructor(t){super(),this.shared=t}create(t){return new aie(t,this.shared)}},Lz=class{constructor(t,e={}){if(this.geometryCache=new o9(!0),this.geometryCache2=new o9(!1),this.imageHolderCache=new Oze(this),this.thisContext={scene:Rze,shared:this},this.deletedMaterial=new hO(uo.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new hp(aE.emptyImage,this),this.deletedVideo=new hp(eE.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[i,n]of Object.entries(e.images))this.addImage(i,n);if(e.videos)for(let[i,n]of Object.entries(e.videos))this.addVideo(i,n);if(e.audios)for(let[i,n]of Object.entries(e.audios))this.addAudio(i,n.data);this.reset(t)}setRequestRender(t){this._requestRender=t}reset(t){for(let[e,i]of Object.entries(t.images))this.addImage(e,i);for(let[e,i]of Object.entries(t.videos))this.addVideo(e,i);for(let[e,i]of Object.entries(t.colors))this.addColor(e,i);for(let[e,i]of Object.entries(t.materials))this.addMaterial(e,new hO(i,this.thisContext));for(let[e,i]of Object.entries(t.audios))this.addAudio(e,i.data);for(let[e,i]of Object.entries(t.fonts))this.addFont(e,i)}addMaterial(t,e){e.uuid=t,this.materials[t]?(this.materials[t].reset(e.data,this.thisContext),e.dispose()):this.materials[t]=e}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):t==null?(console.error("material is undefined or null"),this.deletedMaterial):new Iz(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new hp(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new hp(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new fE(e.r,e.g,e.b,e.a):this.colors[t]=new fE(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[t];return this.colors[t].r=e.r??i.r,this.colors[t].g=e.g??i.g,this.colors[t].b=e.b??i.b,this.colors[t].a=e.a??i.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let i=this.getColor(t);i?e=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new ho(0,0,0,0))}else return"a"in t?new ho(t.r,t.g,t.b,t.a):new ho(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof zx)return e;{let i=new zx({src:e});return this.audios[t]=i,i}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof zx&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new Ize(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof zx&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}};new Lz(YR.emptyData());var Y0=class extends go{updateByPatchedOp(t,e,i){if(super.updateByPatchedOp(t,e,i),gOe(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[n,r]of Object.entries(t.props)){let s=i.shared.material(r);this.material[Number(n)]=s}else if(Ta(t.path,["material"])&&this.material instanceof zd)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(No.drop(t,1),e.material,i);else if(Ta(t.path,["materials","*"])&&Array.isArray(this.material)){let n=t.path[1];if("materials"in e&&n<this.material.length){let r=e.materials[n];typeof r!="string"&&this.material[n].updateByOp(No.drop(t,2),r,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(t,e){var n,r;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let i=this.dataPatched;if(((n=t.geometry)==null?void 0:n.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe),e.scene.markNeedsUpdateRendererDirty()),((r=t.geometry)==null?void 0:r.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(s=>e.shared.material(s).getFlavor(i.flatShading,i.side,i.wireframe)),e.scene.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe)],e.scene.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&wee(this.material).forEach(t=>{t instanceof zd&&(t instanceof hO||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},a9=new O,l9=new Ht,c9=new Ht,Fze=new O,u9=new Qe,fo=class extends Y0{constructor(t,e,i){super(t,e),this.data=e,this.localGeometry=void 0,e.bindMode&&e.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=e.bindMode,this.bindMatrix=new Qe().fromArray(e.bindMatrix),this.bindMatrixInverse=new Qe)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Rt&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof Lz){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return nE.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return nE.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),Ta(t.path,["geometry"])&&this.updateByPatchedOpGeometry(No.drop(t,1),e.geometry,i)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var n;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=dE(c,e,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&oO(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(n=this.localGeometry)==null||n.dispose(),this.localGeometry=dE(r,e,this.data.flatShading)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,i){var r;let n=!1;t.type===0&&t.path.length===0&&sz(["scaleBaked"],Object.keys(t.props))&&this.geometryCreateDeleyed instanceof Es&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),n||((r=i.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;this.is2DType?t.set(0,0,i.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let e=new Ht,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){e.fromBufferAttribute(i,n);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(n,e.x,e.y,e.z,e.w)}}boneTransform(t,e){let i=this.skeleton;if(i===void 0)return;let n=this.geometry;l9.fromBufferAttribute(n.attributes.skinIndex,t),c9.fromBufferAttribute(n.attributes.skinWeight,t),a9.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){let s=c9.getComponent(r);if(s!==0){let o=l9.getComponent(r);u9.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),e.addScaledVector(Fze.copy(a9).applyMatrix4(u9),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};function Nze(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,i=t.geometry.attributes,n=i.position.array,r=i.normal.array,s=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=new O(r[l],r[l+1],r[l+2]);e.has(c)?(o=e.get(c))==null||o.normals.push(h):e.set(c,{normals:[h],result:new O})}e.forEach((l,c)=>{for(let h of l.normals)l.result.add(h);l.result.divideScalar(l.normals.length)});for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,h=(a=e.get(c))==null?void 0:a.result;h&&(s[l]=h.x,s[l+1]=h.y,s[l+2]=h.z)}t.geometry.setAttribute("extrudeNormal",new gt(s,3))}function kze(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),n=new O;for(let r=0;r<e.length;r+=3)n.set(e[r],e[r+1],e[r+2]).normalize(),i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z;t.geometry.setAttribute("extrudeNormal",new gt(i,3))}function Bz(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof zd)||t.material.getLayersOfType("outline").length===0)return;t instanceof fo&&t.is2DAndNoDepth?kze(t):Nze(t)}function Rz(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),n=parseInt(t.uuid.replace(/\D/g,"")),r=[ri.seededRandom(n),ri.seededRandom(n+1e4),ri.seededRandom(n+2e4)];for(let s=0;s<e.length;s++)i[s]=r[s%3];t.geometry.setAttribute("randomColor",new Ot(i,3))}Mz.then(t=>{});var Zl=new Gn,cx=new O;function zze(t){let e=!1;return t.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var T_=class extends fo{constructor(t,e,i){super(t,e,i),this.data=e,this.hiddenMatrixOld=new Qe,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:n,subdivPointer:r}=Es.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,i!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=i),n!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=n??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,Bz(this),Rz(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let i=this.material;this.material=i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){Es.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Es.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Es.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Es.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,go.prototype.raycast.call(this,t,e),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new qo,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;Zl.setFromBufferAttribute(e),Zl.getCenter(i),t.boundingSphere.radius=i.distanceTo(Zl.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Zl.getSize(cx),this.hasNonUniformScale&&cx.divide(this.scale);let n={width:cx.x,height:cx.y,depth:cx.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(t){let e=this.originalGeometry;Zl.min.set(t[0],t[2],t[4]),Zl.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(Zl.min.applyMatrix4(this.shearScaleInv),Zl.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new qo);let i=e.boundingSphere.center;Zl.getCenter(i),e.boundingSphere.radius=i.distanceTo(Zl.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(Es.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,i){super.updateByPatchedOpGeometry(t,e,i),this.localGeometry&&this.createGeometryByControls(e)}},h9=-1,Uze=1,Gze={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},Vze={polygon_center:0,edge:1,vertex:2},OA=(t,e)=>(i,n)=>!e||i===0||t===0?0:t*n/100,Gt=(t,e)=>{let i=Math.abs(e),n=i*-1;return(t-h9)*(i-n)/(Uze-h9)+n};function Hze(t){let e=[],i={};for(var n=0,r=t.length;n<r;n++){var s=JSON.stringify(t[n].pos.map(o=>Math.round(o*1e4)/1e4));i[s]||(e.push(t[n]),i[s]=!0)}return e}var jze=new O,FA=new O,Wze=new O,Xze=new O;function Lv(t,e){let i=Wze.fromArray(t),n=Xze.fromArray(e);FA.copy(n).sub(i);let r=FA.length();return FA.normalize().multiplyScalar(r*.5),jze.copy(i).add(FA).toArray()}var Ma=new ls,NA=new O,mE=new O,Qf=new O;function qze(t){let e=[];for(let i=0;i<=t.index.count;i++)if(NA.fromArray(t.index.array,i*3),Ma.setFromAttributeAndIndices(t.attributes.position,NA.x,NA.y,NA.z),Ma.getNormal(mE),Ma.getMidpoint(Qf),!(isNaN(Qf.x)||isNaN(Qf.y)||isNaN(Qf.z))){let{a:n,b:r,c:s}=Ma,o=n.toArray(),a=r.toArray(),l=s.toArray(),c=n.distanceTo(r),h=r.distanceTo(s),u=s.distanceTo(n),d=Lv(o,a),f=Lv(a,l),p=Lv(l,o),m=[c,h,u],g=Math.max(...m),v=m.filter(b=>Math.round(b)===Math.round(g)).length>1,y=[],x=Ma.getMidpoint(Qf).toArray();g===c&&!v&&(y=[f,p,p],x=d),g===h&&!v&&(y=[d,p,p],x=f),g===u&&!v&&(y=[d,f,f],x=p),v&&(y=[d,f,p]),e.push({vertices:[o,a,l],faceCenters:y,midpoint:x,norm:Ma.getNormal(mE).toArray()})}return e}function Yze(t){let e=[],{position:i}=t.attributes;for(let n=0;n<i.count;n++){Ma.setFromAttributeAndIndices(i,n*3,n*3+1,n*3+2),Ma.getNormal(mE),Ma.getMidpoint(Qf);let r=Ma.a.toArray(),s=Ma.b.toArray(),o=Ma.c.toArray();e.push({vertices:[r,s,o],faceCenters:[Lv(r,s),Lv(s,o),Lv(o,r)],midpoint:Qf.toArray(),norm:mE.toArray()})}return e}var Qze=4,Jze=.5,Q3=t=>.5*(1-Math.cos(t*Math.PI)),Kze=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,i=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),i<0&&(i=-i);let n=Math.floor(t),r=Math.floor(e),s=Math.floor(i),o=t-n,a=e-r,l=i-s,c,h,u=0,d=.5,f,p,m;for(let g=0;g<Qze;g++){let v=n+(r<<4)+(s<<8);c=Q3(o),h=Q3(a),f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),p=this.perlin[v+16&4095],p+=c*(this.perlin[v+16+1&4095]-p),f+=h*(p-f),v+=256,p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),m=this.perlin[v+16&4095],m+=c*(this.perlin[v+16+1&4095]-m),p+=h*(m-p),f+=Q3(l)*(p-f),u+=f*d,d*=Jze,n<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(n++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return u}noiseSeed(t){let e=(()=>{let i,n;return{setSeed(r){n=i=(r??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return n=(1664525*n+1013904223)%4294967296,n/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let i=0;i<4095+1;i++)this.perlin[i]=e.rand()}},Zze=Kze,d9=new O,f9=new Qe,p9=new B0;function m9(t){let e=!1;return t.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="TextGeometry"&&(e=!0)}),e}var pie=class extends fo{constructor(t,e,i){super(t,e,i),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:i}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(f9.copy(i).invert(),p9.copy(t.ray).applyMatrix4(f9),p9.intersectBox(this.singleBBox,d9))){let n=d9.applyMatrix4(i),r=t.ray.origin.distanceTo(n);e.push({distance:r,point:n.clone(),object:this})}}},_s=1e-4,$l,mie,gie,vie,g9=new O,v9=new O;Mz.then(t=>{$l=t,mie=[$l.get_face_center,$l.get_edge_midpoint,$l.get_vertex_position],gie=[$l.get_face_normal,$l.get_edge_normal,$l.get_vertex_normal],vie=[$l.face_count,$l.edge_count,$l.vertex_count]});var $ze=new Qe,eUe=new Qe,Ch=new O,Pf=new O,ux=new O,J3=new O,tUe=new O,iUe=new O,su=new Zze,xl=class extends vz(Ri){constructor(e,i){super(),this.parameters=i,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let i of this.children)i instanceof cs&&i.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(i=>{i instanceof cs&&i.object===e&&(i.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let i;if(e!==void 0?i=e:i=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(i=0),this.parameters.type==="toObject"&&this.objectForSample){for(let r=0,s=this.children.length;r<s;++r)this.remove(this.children[0]);let n=this.children;if(n.length===i)return;if(n.length<i)for(let r=0,s=i-n.length;r<s;++r){let o=new cs(this.object);o.expand(),this.add(o)}else for(let r=0,s=n.length-i;r<s;++r)this.remove(n[r])}else{if(this.children.length===i)return;if(this.children.length<i)for(let n=0,r=i-this.children.length;n<r;++n){let s=new cs(this.object);s.expand(),this.add(s)}else for(let n=0,r=this.children.length-i;n<r;++n)this.remove(this.children[0])}}_updateRadial(e){let i=e.radial,n=i.start*ri.DEG2RAD,r=i.end*ri.DEG2RAD,s=n-r,o=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),a;switch(i.axis){case"z":a=new O(0,0,1);break;case"y":a=new O(0,1,0);break;default:case"x":a=new O(1,0,0);break}let l=e.randomnessObject??id.defaultData([1,1,1]).randomnessObject,c=l.noiseType==="perlin";su.noiseSeed(l.seed);let h=B3((0,nx.default)(l.seed)),u=OA(l.strength,this.parameters.randomness);for(let[d,f]of this.children.entries()){let p=d*(l.freqScale/10)+l.movement,m=c?su.noise(p):h(p,p),g=d+1;f.scale.x=i.scale[0]+u(g,Gt(m,l.scale[0]))||_s,f.scale.y=i.scale[1]+u(g,Gt(m,l.scale[1]))||_s,f.scale.z=i.scale[2]+u(g,Gt(m,l.scale[2]))||_s,f.position.setScalar(0);let v=s/e.count*d-n;switch(i.axis){case"x":f.rotation.set(0,v,0);break;case"y":f.rotation.set(0,0,v);break;case"z":f.rotation.set(v,0,0);break}f.translateOnAxis(a,i.radius),f.position.x+=i.position[0]+u(g,Gt(m,l.position[0])),f.position.y+=i.position[1]+u(g,Gt(m,l.position[1])),f.position.z+=i.position[2]+u(g,Gt(m,l.position[2]));let y=u(g,Gt(m,l.rotation[0])),x=u(g,Gt(m,l.rotation[1])),b=u(g,Gt(m,l.rotation[2]));i.alignment===!0?(f.rotation.x+=o.x+y,f.rotation.y+=o.y+x,f.rotation.z+=o.z+b):f.rotation.set(o.x+y,o.y+x,o.z+b)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let i=e.linear,n=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),r=e.randomnessObject??id.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";su.noiseSeed(r.seed);let o=B3((0,nx.default)(r.seed)),a=OA(r.strength,this.parameters.randomness);for(let[l,c]of this.children.entries()){let h=l*(r.freqScale/10)+r.movement,u=s?su.noise(h):o(h,h),d=l+1,f=a(d,Gt(u,r.rotation[0])),p=a(d,Gt(u,r.rotation[1])),m=a(d,Gt(u,r.rotation[2]));c.scale.x=1+(i.scale[0]-1)*l+a(d,Gt(u,r.scale[0]))||_s,c.scale.y=1+(i.scale[1]-1)*l+a(d,Gt(u,r.scale[1]))||_s,c.scale.z=1+(i.scale[2]-1)*l+a(d,Gt(u,r.scale[2]))||_s,c.rotation.x=n.x*l+f,c.rotation.y=n.y*l+p,c.rotation.z=n.z*l+m,c.position.x=i.position[0]*l+a(d,Gt(u,r.position[0])),c.position.y=i.position[1]*l+a(d,Gt(u,r.position[1])),c.position.z=i.position[2]*l+a(d,Gt(u,r.position[2]))}}_updateGrid(e){let i=0,n=e.grid,r=e.randomnessObject??id.defaultData([1,1,1]).randomnessObject,s=OA(r.strength,this.parameters.randomness),o=r.noiseType==="perlin";su.noiseSeed(r.seed);let a=jFe((0,nx.default)(r.seed));if(n.useCenter===!0){let l={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},c=new O(n.size[0]*(n.count[0]-l.x)*.5,n.size[1]*(n.count[1]-l.y)*.5,n.size[2]*(n.count[2]-l.z)*.5);for(let h=0;h<n.count[0];h++)for(let u=0;u<n.count[1];u++)for(let d=0;d<n.count[2];d++){let f=[(h+1)*(r.freqScale/10)+r.movement,(u+1)*(r.freqScale/10)+r.movement,(d+1)*(r.freqScale/10)+r.movement],p=o?su.noise(...f):a(...f),m=this.children[i++];m.scale.x=1+s(i,Gt(p,r.scale[0]))||_s,m.scale.y=1+s(i,Gt(p,r.scale[1]))||_s,m.scale.z=1+s(i,Gt(p,r.scale[2]))||_s;let g=s(i,Gt(p,r.rotation[0])),v=s(i,Gt(p,r.rotation[1])),y=s(i,Gt(p,r.rotation[2]));m.rotation.set(g,v,y),m.position.x=n.size[0]*h-c.x+s(i,Gt(p,r.position[0])),m.position.y=n.size[1]*u-c.y+s(i,Gt(p,r.position[1])),m.position.z=n.size[2]*d-c.z+s(i,Gt(p,r.position[2]))}}else for(let l=0;l<n.count[0];l++)for(let c=0;c<n.count[1];c++)for(let h=0;h<n.count[2];h++){let u=[(l+1)*(r.freqScale/10)+r.movement,(c+1)*(r.freqScale/10)+r.movement,(h+1)*(r.freqScale/10)+r.movement],d=o?su.noise(...u):a(...u),f=this.children[i++];f.scale.x=1+s(i,Gt(d,r.scale[0]))||_s,f.scale.y=1+s(i,Gt(d,r.scale[1]))||_s,f.scale.z=1+s(i,Gt(d,r.scale[2]))||_s;let p=s(i,Gt(d,r.rotation[0])),m=s(i,Gt(d,r.rotation[1])),g=s(i,Gt(d,r.rotation[2]));f.rotation.set(p,m,g),f.position.x=n.size[0]*l+s(i,Gt(d,r.position[0])),f.position.y=-n.size[1]*c+s(i,Gt(d,r.position[1])),f.position.z=-n.size[2]*h+s(i,Gt(d,r.position[2]))}}_updateToObject(e){var g;if(e.type!=="toObject")throw new Error;let{toObject:i}=e,n=new Er(i.rotation[0],i.rotation[1],i.rotation[2]),r=e.randomnessObject??id.defaultData([1,1,1]).randomnessObject,s=r.noiseType==="perlin";su.noiseSeed(r.seed);let o=B3((0,nx.default)(r.seed)),a=OA(r.strength,this.parameters.randomness);if(!i.object){for(let[,v]of this.children.entries())v.position.set(0,0,0),v.scale.setScalar(1),v.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof pie)if(!((g=this.objectForSample.font)!=null&&g.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let l=this.getSubdivData(),c=[],h=v=>{let y=v.length,x=v.map(A=>A[0]).reduce((A,E)=>A+E,0),b=v.map(A=>A[1]).reduce((A,E)=>A+E,0),S=v.map(A=>A[2]).reduce((A,E)=>A+E,0);return[x/y,b/y,S/y]},u=v=>Math.round(v*1e6)/1e6;l.forEach(v=>{let y=l.filter(x=>u(v.pos[0])===u(x.pos[0])&&u(v.pos[1])===u(x.pos[1])&&u(v.pos[2])===u(x.pos[2]));y.length>1?c.push({pos:v.pos,norm:h(y.map(x=>x.norm))}):c.push(v)});let d=Hze(c);if(l.length>0){let v=Math.round(d.length*i.count/100);this._updateCount(v)}this.objectForSample.updateMatrixWorld();let f=new WFe(this.objectForSample).build(),p=Gze[i.axis],m=this.children;f.setRandomGenerator((0,nx.default)(this.object.uuid+i.seed));for(let[v,y]of m.entries()){let x=v*(r.freqScale/10)+r.movement,b=s?su.noise(x):o(x,x),S=v+1,A=a(S,Gt(b,r.rotation[0])),E=a(S,Gt(b,r.rotation[1])),M=a(S,Gt(b,r.rotation[2]));i.spreadType==="random"?f.sample(ux,J3):(d.length&&(ux.fromArray(d[v].pos),J3.fromArray(d[v].norm)),this.objectForSample instanceof T_&&ux.applyMatrix4($ze.copy(this.objectForSample.matrixWorld).invert())),ux.applyMatrix4(this.object.hiddenMatrix.clone().invert()),y.position.copy(ux),Ch.fromArray(p);let T=i.align==="normal"?J3:this.object.getWorldDirection(iUe),P=Pf.fromArray(i.position);Pf.x+=Pf.x+a(S,Gt(b,r.position[0])),Pf.y+=Pf.y+a(S,Gt(b,r.position[1])),Pf.z+=Pf.z+a(S,Gt(b,r.position[2]));let I=Math.acos(T.dot(Ch)),k=tUe.crossVectors(Ch,T).normalize(),R=eUe.makeRotationAxis(k,I),F=T.clone().cross(this.object.up).normalize(),V=F.clone().cross(T).normalize(),Q=new Qe().makeBasis(F,T,V),X=new O(Ch.y,Ch.z,Ch.x).normalize(),z=X.clone().cross(Ch).normalize(),Y=new Qe().makeBasis(X,Ch,z).invert(),j=new Qe().multiplyMatrices(Q,Y);y.rotation.setFromRotationMatrix(j),P.applyMatrix4(R),y.position.add(P),y.rotation.x=y.rotation.x+n.x+A,y.rotation.y=y.rotation.y+n.y+E,y.rotation.z=y.rotation.z+n.z+M,y.scale.setScalar(1),y.scale.x=y.scale.x+i.scale[0]+a(S,Gt(b,r.scale[0]))||_s,y.scale.y=y.scale.y+i.scale[1]+a(S,Gt(b,r.scale[1]))||_s,y.scale.z=y.scale.z+i.scale[2]+a(S,Gt(b,r.scale[2]))||_s,y.scale.multiply(this.object.scale),y.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof T_){let i=this.objectForSample,n=Vze[e],r=vie[n],s=mie[n],o=gie[n],a=[],l=r(i.subdivPointerNew);for(let c=0;c<=l-1;c++){let h=s(i.subdivPointerNew,c),u=o(i.subdivPointerNew,c);g9.fromArray(h).applyMatrix4(i.matrixWorld),v9.fromArray(u),a.push({pos:g9.toArray(),norm:v9.toArray()})}return a}else return(this.objectForSample.geometry.index?qze(this.objectForSample.geometry):Yze(this.objectForSample.geometry)).map((i,n)=>e==="polygon_center"?{pos:i.midpoint,norm:i.norm}:e==="vertex"?[{pos:i.vertices[0],norm:i.norm},{pos:i.vertices[1],norm:i.norm},{pos:i.vertices[2],norm:i.norm}]:e==="edge"?[{pos:i.faceCenters[0],norm:i.norm},{pos:i.faceCenters[1],norm:i.norm},{pos:i.faceCenters[2],norm:i.norm}]:[]).flat()}updateState(e,i){var n;if(this.parameters=CT(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=i.find(this.parameters.toObject.object);r instanceof go?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new Qe,this.hiddenMatrix=new Qe,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},bw=t=>{var e;return e=class extends t{},e.geometryHelper=new Ic(30,30,30),e},kA=new B0,K3=new qo,y9=new Qe,Sw=(t,e,i,n,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),K3.copy(s.boundingSphere),K3.applyMatrix4(o),i.ray.intersectsSphere(K3)===!1||(y9.copy(o).invert(),kA.copy(i.ray).applyMatrix4(y9),s.boundingBox!==null&&kA.intersectsBox(s.boundingBox)===!1))return;let a,l,c,h,u=s.index,d=s.attributes.position,f=s.drawRange,p,m;if(r===!1){let v=Math.max(0,f.start),y=Math.min(u.count,f.start+f.count);for(p=v,m=y;p<m;p+=3)if(l=u.getX(p),c=u.getX(p+1),h=u.getX(p+2),a=g(t,i,kA,d,l,c,h),a){a.faceIndex=Math.floor(p/3),n.push(a);return}}else{let v=s.attributes.position,y=new O,x=new O,b=new O,S=new O,A=2,E=1/((t.scale.x+t.scale.y+t.scale.z)/3),M=E*E,T=Math.max(0,f.start),P=Math.min(v.count,f.start+f.count);for(let I=T,k=P-1;I<k;I+=A){if(y.fromBufferAttribute(v,I),x.fromBufferAttribute(v,I+1),kA.distanceSqToSegment(y,x,S,b)>M)continue;S.applyMatrix4(t.matrixWorld);let R=i.ray.origin.distanceTo(S);R<i.near||R>i.far||n.push({distance:R,point:b.clone().applyMatrix4(t.matrixWorld),object:t})}}function g(v,y,x,b,S,A,E){let M=new O,T=new O,P=new O,I=new O,k=new O;if(M.fromBufferAttribute(b,S),T.fromBufferAttribute(b,A),P.fromBufferAttribute(b,E),x.intersectTriangle(M,T,P,!1,I)===null)return null;k.copy(I),k.applyMatrix4(v.matrixWorld);let R=y.ray.origin.distanceTo(k);return R<y.near||R>y.far?null:{faceIndex:1,distance:R,point:k.clone(),object:v}}},zA=new O,da=new O0,nUe=class extends vw{constructor(t){let e=new Rt,i=new Jd({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={},o=new Tt(15711266),a=new Tt(15711266),l=new Tt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",a),c("p","n2",a),c("p","n3",a),c("p","n4",a),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,d,f){h(u,f),h(d,f)}function h(u,d){n.push(0,0,0),r.push(d.r,d.g,d.b),s[u]===void 0&&(s[u]=[]),s[u].push(n.length/3-1)}e.setAttribute("position",new gt(n,3)),e.setAttribute("color",new gt(r,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;da.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,n=1,r=.8;sl("n1",e,t,da,-i,-n,r),sl("n2",e,t,da,i,-n,r),sl("n3",e,t,da,-i,n,r),sl("n4",e,t,da,i,n,r);let s=r;sl("f1",e,t,da,-i,-n,s),sl("f2",e,t,da,i,-n,s),sl("f3",e,t,da,-i,n,s),sl("f4",e,t,da,i,n,s);let o=s,a=.5;sl("u1",e,t,da,i*.7*a,n*1.1,o),sl("u2",e,t,da,-i*.7*a,n*1.1,o),sl("u3",e,t,da,0,n*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function sl(t,e,i,n,r,s,o){zA.set(r,s,o).unproject(n);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],zA.x,zA.y,zA.z)}}var rUe=class extends bw(nUe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){Sw(this.object,this.geometry,t,e,!0)}},dO;(t=>t.is=e=>"objectHelper"in e)(dO||(dO={}));var Aw=(t,e)=>class extends yz(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(i,n){this.objectHelper.raycast(i,n)}showGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof zC&&(n.visible=!0)}}updateEntityBoxSize(i,n){this.objectHelper.visible&&this.geometryHelper instanceof Ic?(i.setScalar(0),n.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,n)}hideGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof zC&&(n.visible=!1)}}},UA=790,mg=new O,Z3=new O,$3=new qt,eI=new O,hx=new O,tI=new O,Rs=class extends Aw(O0,rUe){constructor(t="",e={...b_.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=f0.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.previousProjectionMatrix=new Qe,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;this.orthoCamera=new Pk(i*-.5,i*.5,n*.5,n*-.5,-5e4,1e4),this.perspCamera=new os(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,i){typeof t=="number"&&(t=new O(t,e,i)),super.lookAt(t),this.getWorldPosition(mg),this.targetOffset=mg.distanceTo(t)}getTarget(t=new O){return this.getWorldDirection(Z3),this.getWorldPosition(mg),Z3.multiplyScalar(this.targetOffset),t.copy(mg).add(Z3),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(mg),mg.distanceTo(t)}updateUp(){this.getWorldQuaternion($3),eI.set(0,0,1).applyQuaternion($3),hx.copy(Ri.DEFAULT_UP),this.isUpVectorFlipped&&hx.negate(),hx.applyQuaternion($3),tI.copy(Ri.DEFAULT_UP).projectOnPlane(eI),this.angleOffsetFromUp=tI.angleTo(hx),this.angleOffsetFromUp*=tI.cross(hx).dot(eI)>=0?1:-1}updateTransformState(t){let e=super.updateTransformState(t);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),e}getViewFrontToObject(t){let e=t.getWorldPosition(new O),i=t.getWorldDirection(new O).multiplyScalar(this.targetOffset);return{position:e.clone().add(i),target:e}}getViewToTarget(t){let e=this.getWorldDirection(new O).multiplyScalar(this.targetOffset);return{position:t.clone().sub(e),target:t}}getViewToObject(t){let e=new O;return t.getWorldPosition(e),this.getViewToTarget(e)}setViewplaneSize(t,e,i=!1){if(this.aspect=t/e,i){let n=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-UA*.5*n,this.right=UA*.5*n,this.top=UA*.5*(1/r),this.bottom=-UA*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}copyViewPlaneSize(t){this.aspect=t.aspect,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,i,n,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,i,n,r,s):this.orthoCamera.setViewOffset(t,e,i,n,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return yR(e,t)}updateCameraSubtype(t,e){let i=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(i,e.zoom),e.near!==void 0&&this.setNear(i,e.near),e.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},gg=new Qe,sUe=new Qe;function x9(t){let e=!1;return t.scene.objects.traverse((i,n)=>{var r;((r=n.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(e=!0)}),e}var x0=class extends Y0{constructor(t,e,i){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Rt,this.onAfterRender=(n,r,s,o,a,l)=>{super.onAfterRender(n,r,s,o,a,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var n;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof x0&&s.dataPatched.visible===!0&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof go&&s.dataPatched.visible===!0&&((n=s.geometry.attributes.position)==null?void 0:n.count)>0&&s.geometry.drawRange.count>0){if(gg.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=gu.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;gu.transformMeshSet(s.booleanMeshSetAddress,gg),s.booleanMatrixInvOld.copy(gg).invert(),s.booleanWasTransformed=!1}else s instanceof x0&&s.needsTransformForDownstream===!0?(gu.transformMeshSet(s.booleanMeshSetAddress,gg),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(gu.transformMeshSet(s.booleanMeshSetAddress,sUe.multiplyMatrices(gg,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(gg).invert(),s.booleanWasTransformed=!1);gu.hasOpenEdges(s.booleanMeshSetAddress)===!1||r===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new gt([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return gu.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new Rt,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=gu.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Bz(this),Rz(this)}dispose(){super.dispose(),this.geometry.dispose()}},fO;(t=>{function e(i){return fi.is(i)&&i instanceof xw}t.is=e})(fO||(fO={}));var Oz=(t,e)=>class extends Aw(t,e){updateState_Light(i,n){this.updateState_Entity(i,n),i.color!==void 0&&(this.color=n.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},pl=t=>t instanceof go,Bu=t=>t!==null&&t instanceof x0,oUe=t=>t instanceof Rs,aUe=t=>fO.is(t),pO=t=>dO.is(t),OT=class extends bw(CTe){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(t,e){Sw(this.object,OT.geometryHelper,t,e)}update(){}},gE=class extends Aw(iv,OT){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},lUe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,cUe=Xt.lights_fragment_begin,uUe=Xt.shadowmask_pars_fragment,_9=null,hUe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},dUe=(t="medium")=>{if(_9===t)return!1;_9=t;let e=hUe(t);Xt.shadowmap_pars_fragment=lUe(e);let i=cUe.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Xt.lights_fragment_begin=i;let n=uUe.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Xt.shadowmask_pars_fragment=n,!0},fUe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,pUe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,iI=new Wi({vertexShader:fUe,fragmentShader:pUe,uniforms:{depthContrast:{value:1}}}),yie={RED:0,GREEN:1,BLUE:2,ALPHA:3},Mw="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",mUe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,GA=class extends Wi{constructor(t=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:t?"2":"1"},uniforms:{kernel64:new qe(null),kernel16:new qe(null),inputBuffer:new qe(null),cocBuffer:new qe(null),texelSize:new qe(new ge),scale:new qe(1)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:mUe,vertexShader:Mw}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set cocBuffer(t){this.uniforms.cocBuffer.value=t}setCoCBuffer(t){this.uniforms.cocBuffer.value=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(t){return this.uniforms.scale.value=t}setScale(t){this.uniforms.scale.value=t}generateKernel(){let t=2.39996323,e=new Float32Array(128),i=new Float32Array(32),n=0,r=0;for(let a=0;a<80;++a){let l=a*t,c=Math.sqrt(a)/Math.sqrt(80),h=c*Math.cos(l),u=c*Math.sin(l);a%5===0?(i[r++]=h,i[r++]=u):(e[n++]=h,e[n++]=u)}let s=[],o=[];for(let a=0;a<128;)s.push(new Ht(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)o.push(new Ht(i[a++],i[a++],i[a++],i[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}};function w9(t,e,i){return t*(e-i)-e}function mO(t,e,i){return Math.min(Math.max((t+e)/(e-i),0),1)}var gUe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,vUe=class extends Wi{constructor(t){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new qe(null),focusDistance:new qe(0),focusRange:new qe(0),cameraNear:new qe(.3),cameraFar:new qe(1e3)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:gUe,vertexShader:Mw}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(t)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=th){this.depthBuffer=t,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(t){this.uniforms.focusDistance.value=t}get worldFocusDistance(){return-w9(this.focusDistance,this.near,this.far)}set worldFocusDistance(t){this.focusDistance=mO(-t,this.near,this.far)}getFocusDistance(t){this.uniforms.focusDistance.value=t}setFocusDistance(t){this.uniforms.focusDistance.value=t}get focalLength(){return this.focusRange}set focalLength(t){this.focusRange=t}get focusRange(){return this.uniforms.focusRange.value}set focusRange(t){this.uniforms.focusRange.value=t}get worldFocusRange(){return-w9(this.focusRange,this.near,this.far)}set worldFocusRange(t){this.focusRange=mO(-t,this.near,this.far)}getFocalLength(t){return this.focusRange}setFocalLength(t){this.focusRange=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof os?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},yUe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,xUe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",b9=class extends Wi{constructor(t=new ge){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new qe(null),texelSize:new qe(new ge),halfTexelSize:new qe(new ge),kernel:new qe(0),scale:new qe(1)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:yUe,vertexShader:xUe}),this.toneMapped=!1,this.setTexelSize(t.x,t.y)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},_Ue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,wUe=class extends Wi{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new qe(null),opacity:new qe(1)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:_Ue,vertexShader:Mw}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},bUe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,SUe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,FT={DEPTH:0,LUMA:1,COLOR:2},AUe={DISABLED:0,DEPTH:1,CUSTOM:2},MUe=class extends Wi{constructor(t=new ge,e=FT.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:L0.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new qe(null),depthBuffer:new qe(null),predicationBuffer:new qe(null),texelSize:new qe(t)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:bUe,vertexShader:SUe}),this.toneMapped=!1,this.edgeDetectionMode=e}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=th){this.depthBuffer=t,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(t){this.defines.EDGE_DETECTION_MODE=t.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(t){this.edgeDetectionMode=t}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(t){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=t.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(t){this.localContrastAdaptationFactor=t}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("6"),this.defines.DEPTH_THRESHOLD=(t*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(t){this.edgeDetectionThreshold=t}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(t){this.defines.PREDICATION_MODE=t.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(t){this.predicationMode=t}set predicationBuffer(t){this.uniforms.predicationBuffer.value=t}setPredicationBuffer(t){this.uniforms.predicationBuffer.value=t}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(t){this.defines.PREDICATION_THRESHOLD=t.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(t){this.predicationThreshold=t}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(t){this.defines.PREDICATION_SCALE=t.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(t){this.predicationScale=t}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(t){this.defines.PREDICATION_STRENGTH=t.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(t){this.predicationStrength=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},CUe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,EUe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",ol={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},gO=class extends Wi{constructor(t,e,i,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:L0.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new qe(null),depthBuffer:new qe(null),resolution:new qe(new ge),texelSize:new qe(new ge),cameraNear:new qe(.3),cameraFar:new qe(1e3),aspect:new qe(1),time:new qe(0)},blending:$n,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,t&&this.setShaderParts(t),e&&this.setDefines(e),i&&this.setUniforms(i),this.adoptCameraSettings(n)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=th){this.depthBuffer=t,this.depthPacking=e}setShaderParts(t){return this.fragmentShader=CUe.replace(ol.FRAGMENT_HEAD,t.get(ol.FRAGMENT_HEAD)).replace(ol.FRAGMENT_MAIN_UV,t.get(ol.FRAGMENT_MAIN_UV)).replace(ol.FRAGMENT_MAIN_IMAGE,t.get(ol.FRAGMENT_MAIN_IMAGE)),this.vertexShader=EUe.replace(ol.VERTEX_HEAD,t.get(ol.VERTEX_HEAD)).replace(ol.VERTEX_MAIN_SUPPORT,t.get(ol.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(let e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(let e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(let e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof os?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){let i=this.uniforms;i.resolution.value.set(t,e),i.texelSize.value.set(1/t,1/e),i.aspect.value=t/e}static get Section(){return ol}},TUe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,PUe=class extends Wi{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:L0.replace(/\D+/g,"")},uniforms:{inputBuffer:new qe(null),threshold:new qe(0),smoothing:new qe(1),range:new qe(null)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:TUe,vertexShader:Mw}),this.toneMapped=!1,this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},DUe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,xie={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},IUe=class extends Wi{constructor(t=null){super({name:"MaskMaterial",uniforms:{maskTexture:new qe(t),inputBuffer:new qe(null),strength:new qe(1)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:DUe,vertexShader:Mw}),this.toneMapped=!1,this.setColorChannel(yie.RED),this.setMaskFunction(xie.DISCARD)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set maskTexture(t){this.uniforms.maskTexture.value=t,delete this.defines.MASK_PRECISION_HIGH,t.type!==fs&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(t){this.maskTexture=t}set colorChannel(t){this.defines.COLOR_CHANNEL=t.toFixed(0),this.needsUpdate=!0}setColorChannel(t){this.colorChannel=t}set maskFunction(t){this.defines.MASK_FUNCTION=t.toFixed(0),this.needsUpdate=!0}setMaskFunction(t){this.maskFunction=t}get inverted(){return this.defines.INVERTED!==void 0}set inverted(t){this.inverted&&!t?delete this.defines.INVERTED:t&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(t){this.inverted=t}get strength(){return this.uniforms.strength.value}set strength(t){this.uniforms.strength.value=t}getStrength(){return this.strength}setStrength(t){this.strength=t}},LUe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,BUe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",RUe=class extends Wi{constructor(t=new ge,e=new ge){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new qe(null),searchTexture:new qe(null),areaTexture:new qe(null),resolution:new qe(e),texelSize:new qe(t)},blending:$n,depthWrite:!1,depthTest:!1,fragmentShader:LUe,vertexShader:BUe}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(t){this.uniforms.searchTexture.value=t}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(t){this.uniforms.areaTexture.value=t}setLookupTextures(t,e){this.searchTexture=t,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(t){let e=Math.min(Math.max(t,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(t){this.orthogonalSearchSteps=t}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(t){let e=Math.min(Math.max(t,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(t){this.diagonalSearchSteps=t}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(t){t?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(t){this.diagonalDetection=t}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(t){let e=Math.min(Math.max(t,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(t){this.cornerRounding=t}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(t){t?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(t){this.cornerDetection=t}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.resolution.value.set(t,e)}},OUe=new O0,Eh=null;function FUe(){if(Eh===null){let t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);Eh=new Rt,Eh.setAttribute!==void 0?(Eh.setAttribute("position",new Ot(t,3)),Eh.setAttribute("uv",new Ot(e,2))):(Eh.addAttribute("position",new Ot(t,3)),Eh.addAttribute("uv",new Ot(e,2)))}return Eh}var zs=class{constructor(t="Pass",e=new xd,i=OUe){this.name=t,this.renderer=null,this.scene=e,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){let e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!t}}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let e=this.screen;e!==null?e.material=t:(e=new $s(FUe(),t),e.frustumCulled=!1,this.scene===null&&(this.scene=new xd),this.scene.add(e),this.screen=e)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,e=th){}render(t,e,i,n,r){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof xd||e===this.renderer)continue;this[t].dispose()}}}},vO=class extends zs{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new wUe,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Li(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,i,n,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==fs?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt))}},NUe=class extends zs{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,i,n,r){let s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},nI=new Tt,Fz=class extends zs{constructor(t=!0,e=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,i){this.color=t,this.depth=e,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,i,n,r){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,c=o>=0;l?(nI.copy(t.getClearColor(nI)),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(nI,a):c&&t.setClearAlpha(a)}},Th=-1,to=class extends qr{constructor(t,e=Th,i=Th,n=1){super(),this.resizable=t,this.base=new ge(1,1),this.preferred=new ge(e,i),this.target=this.preferred,this.s=n}get width(){let{base:t,preferred:e,scale:i}=this,n;return e.width!==Th?n=e.width:e.height!==Th?n=Math.round(e.height*(t.width/Math.max(t.height,1))):n=Math.round(t.width*i),n}set width(t){this.preferredWidth=t}get height(){let{base:t,preferred:e,scale:i}=this,n;return e.height!==Th?n=e.height:e.width!==Th?n=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n=Math.round(t.height*i),n}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferred.setScalar(Th),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.base.width}set baseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(t){this.base.height!==t&&(this.base.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.base.width!==t||this.base.height!==e)&&(this.base.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(t){this.preferred.width!==t&&(this.preferred.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferred.height}set preferredHeight(t){this.preferred.height!==t&&(this.preferred.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferred.width!==t||this.preferred.height!==e)&&(this.preferred.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(t){this.base.set(t.getBaseWidth(),t.getBaseHeight()),this.preferred.set(t.getPreferredWidth(),t.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Th}},rI=!1,S9=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let i;if(e.material.flatShading)switch(e.material.side){case Ro:i=this.materialsFlatShadedDoubleSide;break;case Tr:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(e.material.side){case Ro:i=this.materialsDoubleSide;break;case Tr:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=i[2]:e.isInstancedMesh?e.material=i[1]:e.material=i[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){let e=this.materials=[t.clone(),t.clone(),t.clone()];for(let i of e)i.uniforms=Object.assign({},t.uniforms),i.side=Il;e[2].skinning=!0,this.materialsBackSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=Tr,n}),this.materialsDoubleSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=Ro,n}),this.materialsFlatShaded=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=Tr,n}),this.materialsFlatShadedDoubleSide=e.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=Ro,n})}}render(t,e,i){let n=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,rI){let r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,i);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,i),e.overrideMaterial=r}t.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){let t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return rI}static set workaroundEnabled(t){rI=t}},kUe=class extends zs{constructor(t,e,i=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new Fz,this.overrideMaterialManager=i===null?null:new S9(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){let t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){let e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new S9(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,i,n,r){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,h=t.shadowMap.autoUpdate,u=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=c,t.shadowMap.autoUpdate=h}},A9=class extends zs{constructor(t,e,{resolutionScale:i=1,width:n=to.AUTO_SIZE,height:r=to.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new kUe(t,e,new v$({depthPacking:n$}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new Tt(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Li(1,1,{minFilter:ji,magFilter:ji,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new to(this,n,r,i);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,n,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}},di={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},zUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",UUe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",GUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",VUe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",HUe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",jUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",WUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",XUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",qUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",YUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",QUe="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",JUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",KUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",ZUe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",$Ue="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",e4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",t4e="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",i4e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",n4e=new Map([[di.SKIP,null],[di.ADD,zUe],[di.ALPHA,UUe],[di.AVERAGE,GUe],[di.COLOR_BURN,VUe],[di.COLOR_DODGE,HUe],[di.DARKEN,jUe],[di.DIFFERENCE,WUe],[di.EXCLUSION,XUe],[di.LIGHTEN,qUe],[di.MULTIPLY,YUe],[di.DIVIDE,QUe],[di.NEGATION,JUe],[di.NORMAL,KUe],[di.OVERLAY,ZUe],[di.REFLECT,$Ue],[di.SCREEN,e4e],[di.SOFT_LIGHT,t4e],[di.SUBTRACT,i4e]]),r4e=class extends qr{constructor(t,e=1){super(),this.f=t,this.opacity=new qe(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this.f}set blendFunction(t){this.f=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return n4e.get(this.blendFunction)}},Cc={NONE:0,DEPTH:1,CONVOLUTION:2},zc=class extends qr{constructor(t,e,{attributes:i=Cc.NONE,blendFunction:n=di.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=i,this.fragmentShader=e,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new r4e(n),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=th){}update(t,e,i){}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof xd||e===this.renderer)continue;this[t].dispose()}}}};function M9(t,e,i){for(let n of e){let r="$1"+t+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let o of i.entries())o[1]!==null&&i.set(o[0],o[1].replace(s,r))}}function s4e(t,e,i,n,r,s,o){let a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),c=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),h=[],u=[],d=!1,f=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(c&&o&Cc.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=gO.Section;if(c){let v=`	${t}MainUv(UV);
`;i.set(m.FRAGMENT_MAIN_UV,i.get(m.FRAGMENT_MAIN_UV)+v),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let v=`	${t}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,i.set(m.VERTEX_MAIN_SUPPORT,i.get(m.VERTEX_MAIN_SUPPORT)+v),h=h.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(h).concat([...a.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...a.get("fragment").matchAll(p)].map(v=>v[1])),u=u.concat([...e.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...e.uniforms.keys()]),e.uniforms.forEach((v,y)=>s.set(t+y.charAt(0).toUpperCase()+y.slice(1),v)),e.defines.forEach((v,y)=>r.set(t+y.charAt(0).toUpperCase()+y.slice(1),v)),M9(t,u,r),M9(t,u,a);let g=e.blendMode;if(n.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${t}MainImage(color0, UV, `;o&Cc.DEPTH&&v.test(a.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let x=t+"BlendOpacity";s.set(x,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${x});

	`,i.set(m.FRAGMENT_MAIN_IMAGE,i.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+y)}i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&i.set(m.VERTEX_HEAD,i.get(m.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:h,transformedUv:d,readDepth:f}}var vE=class extends zs{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new gO(null,null,null,t),this.effects=e.sort((i,n)=>n.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){let e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}verifyResources(){let t=this.renderer.capabilities,e=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniformCount>e&&console.warn("The current rendering context doesn't support more than "+e+" uniforms, but "+this.uniformCount+" were defined"),e=t.maxVaryings,this.varyingCount>e&&console.warn("The current rendering context doesn't support more than "+e+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let t=gO.Section,e=new Map([[t.FRAGMENT_HEAD,""],[t.FRAGMENT_MAIN_UV,""],[t.FRAGMENT_MAIN_IMAGE,""],[t.VERTEX_HEAD,""],[t.VERTEX_MAIN_SUPPORT,""]]),i=new Map,n=new Map,r=new Map,s=new Set,o=0,a=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===di.SKIP)l|=d.getAttributes()&Cc.DEPTH;else if(l&d.getAttributes()&Cc.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+o++,p=s4e(f,d,e,i,n,r,l);if(a+=p.varyings.length,c=c||p.transformedUv,h=h||p.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let u=/\bblend\b/g;for(let d of i.values()){let f=d.getShaderCode().replace(u,`blend${d.blendFunction}`);e.set(t.FRAGMENT_HEAD,e.get(t.FRAGMENT_HEAD)+f+`
`)}if(l&Cc.DEPTH){if(h){let d=`float depth = readDepth(UV);

	`;e.set(t.FRAGMENT_MAIN_IMAGE,d+e.get(t.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;e.set(t.FRAGMENT_MAIN_UV,d+e.get(t.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");e.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(e).setExtensions(s).setUniforms(r).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=th){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(let i of this.effects)i.setDepthTexture(t,e)}render(t,e,i,n,r){for(let s of this.effects)s.update(t,e,n);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=n,t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(let i of this.effects)i.setSize(t,e)}initialize(t,e,i){this.renderer=t;for(let n of this.effects)n.initialize(t,e,i),n.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==fs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},o4e=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],_ie=class extends zs{constructor({resolutionScale:t=.5,width:e=to.AUTO_SIZE,height:i=to.AUTO_SIZE,kernelSize:n=Nz.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Li(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new to(this,e,i,t);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new b9,this.ditheredBlurMaterial=new b9,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,n,r){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=o4e[this.kernelSize],h=this.blurMaterial,u=e,d,f;for(this.fullscreenMaterial=h,d=0,f=c.length-1;d<f;++d){let p=d&1?l:a;h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(p),t.render(s,o),u=p}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(this.renderToScreen?null:i),t.render(s,o)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let n=i.width,r=i.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(n,r),this.ditheredBlurMaterial.setSize(n,r)}initialize(t,e,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==fs?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t.outputEncoding===Vt&&(this.renderTargetA.texture.encoding=Vt,this.renderTargetB.texture.encoding=Vt))}static get AUTO_SIZE(){return to.AUTO_SIZE}},a4e=class extends zs{constructor({width:t=to.AUTO_SIZE,height:e=to.AUTO_SIZE,renderTarget:i,luminanceRange:n,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new PUe(r,n),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Li(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new to(this,t,e);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,i,n,r){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}initialize(t,e,i){i!==void 0&&i!==fs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},l4e=class extends zs{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new Fz(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,i,n,r){let s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,i))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(i),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},uc=class extends zs{constructor(t,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=t,this.inputBufferUniform=null,this.setInput(e)}setInput(t){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let e=this.fullscreenMaterial.uniforms;e!==void 0&&e[t]!==void 0&&(this.inputBufferUniform=e[t])}}render(t,e,i,n,r){this.inputBufferUniform!==null&&e!==null&&(this.inputBufferUniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}initialize(t,e,i){i!==void 0&&i!==fs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},sI=1/1e3,c4e=1e3,u4e=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(t){return this.fixedDeltaEnabled=t,this}isAutoResetEnabled(t){return this.autoReset}setAutoResetEnabled(t){return typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=t),this}getDelta(){return this.delta*sI}getFixedDelta(){return this.fixedDelta*sI}setFixedDelta(t){return this.fixedDelta=t*c4e,this}getElapsed(){return this.elapsed*sI}getTimescale(){return this.timescale}setTimescale(t){return this.timescale=t,this}update(t){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=t!==void 0?t:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(t){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},Nz={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},h4e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,d4e=class extends zc{constructor({blendFunction:t=di.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:i=.025,resolutionScale:n=.5,intensity:r=1,width:s=to.AUTO_SIZE,height:o=to.AUTO_SIZE,kernelSize:a=Nz.LARGE}={}){super("BloomEffect",h4e,{blendFunction:t,uniforms:new Map([["map",new qe(null)],["intensity",new qe(r)]])}),this.renderTarget=new Li(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new a4e({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new _ie({resolutionScale:n,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,i){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,n),this.blurPass.render(t,n,n)):this.blurPass.render(t,e,n)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(t,e,i){this.blurPass.initialize(t,e,i),i!==void 0&&(this.renderTarget.texture.type=i,t.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt))}},f4e="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",p4e=class extends zc{constructor({blendFunction:t=di.NORMAL,brightness:e=0,contrast:i=0}={}){super("BrightnessContrastEffect",f4e,{blendFunction:t,uniforms:new Map([["brightness",new qe(e)],["contrast",new qe(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(t){this.uniforms.get("brightness").value=t}getBrightness(t){return this.brightness}setBrightness(t){this.brightness=t}get contrast(){return this.uniforms.get("contrast").value}set contrast(t){this.uniforms.get("contrast").value=t}getContrast(t){return this.contrast}setContrast(t){this.contrast=t}},m4e="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",g4e=class extends zc{constructor(t=di.NORMAL){super("ColorAverageEffect",m4e,{blendFunction:t})}},v4e="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",y4e="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",x4e=class extends zc{constructor({blendFunction:t=di.NORMAL,offset:e=new ge(.001,5e-4)}={}){super("ChromaticAberrationEffect",v4e,{vertexShader:y4e,blendFunction:t,attributes:Cc.CONVOLUTION,uniforms:new Map([["offset",new qe(e)]])})}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},_4e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,w4e=class extends zc{constructor(t,{blendFunction:e=di.NORMAL,worldFocusDistance:i,worldFocusRange:n,focusDistance:r=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=to.AUTO_SIZE,height:c=to.AUTO_SIZE}={}){super("DepthOfFieldEffect",_4e,{blendFunction:e,attributes:Cc.DEPTH,uniforms:new Map([["nearColorBuffer",new qe(null)],["farColorBuffer",new qe(null)],["nearCoCBuffer",new qe(null)],["scale",new qe(1)]])}),this.camera=t,this.renderTarget=new Li(1,1,{minFilter:Zt,magFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new uc(new vUe(t));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=o,i!==void 0&&(h.worldFocusDistance=i),n!==void 0&&(h.worldFocusRange=n),this.blurPass=new _ie({kernelSize:Nz.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new uc(new IUe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=xie.MULTIPLY,d.colorChannel=yie.GREEN,this.bokehNearBasePass=new uc(new GA(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new uc(new GA(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new uc(new GA(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new uc(new GA(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(t){let e=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of e)i.fullscreenMaterial.setScale(t);this.maskPass.fullscreenMaterial.setStrength(t),this.uniforms.get("scale").value=t}getBokehScale(){return this.bokehScale}setBokehScale(t){this.bokehScale=t}getTarget(){return this.target}setTarget(t){this.target=t}calculateFocusDistance(t){let e=this.camera,i=e.position.distanceTo(t);return mO(-i,e.near,e.far)}setDepthTexture(t,e=th){this.circleOfConfusionMaterial.depthBuffer=t,this.circleOfConfusionMaterial.depthPacking=e}update(t,e,i){let n=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(t,null,r),this.blurPass.render(t,r,s),this.maskPass.render(t,e,o),this.bokehFarBasePass.render(t,o,n),this.bokehFarFillPass.render(t,n,this.renderTargetFar),this.bokehNearBasePass.render(t,e,n),this.bokehNearFillPass.render(t,n,this.renderTargetNear)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let n=i.width,r=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(t,e)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(n,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(n,r))}initialize(t,e,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.initialize(t,e,i)),this.blurPass.initialize(t,e,fs),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,t.outputEncoding===Vt&&(this.renderTarget.texture.encoding=Vt,this.renderTargetNear.texture.encoding=Vt,this.renderTargetFar.texture.encoding=Vt,this.renderTargetMasked.texture.encoding=Vt))}};new O;new Qe;var b4e="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",S4e=class extends zc{constructor({blendFunction:t=di.NORMAL,hue:e=0,saturation:i=0}={}){super("HueSaturationEffect",b4e,{blendFunction:t,uniforms:new Map([["hue",new qe(new O)],["saturation",new qe(i)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(t){this.uniforms.get("saturation").value=t}getSaturation(){return this.saturation}setSaturation(t){this.saturation=t}get hue(){let t=this.uniforms.get("hue").value;return Math.acos((t.x*3-1)/2)}set hue(t){let e=Math.sin(t),i=Math.cos(t);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3)}getHue(){return this.hue}setHue(t){this.hue=t}};new Tt;var A4e=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,M4e=class extends zc{constructor({blendFunction:t=di.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",A4e,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},C4e="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",E4e=class extends zc{constructor(t=30){super("PixelationEffect",C4e,{uniforms:new Map([["active",new qe(!1)],["d",new qe(new ge)]])}),this.resolution=new ge,this.d=0,this.granularity=t}get granularity(){return this.d}set granularity(t){let e=Math.floor(t);e%2>0&&(e+=1),this.d=e,this.uniforms.get("active").value=e>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(t){this.granularity=t}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new O;new O;var C9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",E9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",T4e="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",P4e="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Jf={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},wie=class extends zc{constructor({preset:t=Jf.MEDIUM,edgeDetectionMode:e=FT.COLOR,predicationMode:i=AUe.DISABLED}={}){super("SMAAEffect",T4e,{vertexShader:P4e,blendFunction:di.NORMAL,attributes:Cc.CONVOLUTION|Cc.DEPTH,uniforms:new Map([["weightMap",new qe(null)]])});let n,r;arguments.length>1&&(n=arguments[0],r=arguments[1],arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])),this.renderTargetEdges=new Li(1,1,{minFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Fz(!0,!1,!1),this.clearPass.overrideClearColor=new Tt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new uc(new MUe),this.edgeDetectionMaterial.edgeDetectionMode=e,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new uc(new RUe);let s=new F$;s.onLoad=()=>{let o=new ur(n);o.name="SMAA.Search",o.magFilter=ji,o.minFilter=ji,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new ur(r);a.name="SMAA.Area",a.magFilter=Zt,a.minFilter=Zt,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),n!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(n=new Image,r=new Image,n.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),n.src=C9,r.src=E9),this.applyPreset(t)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(t){this.edgeDetectionMaterial.edgeDetectionThreshold=t}setOrthogonalSearchSteps(t){this.weightsMaterial.orthogonalSearchSteps=t}applyPreset(t){let e=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(t){case Jf.LOW:e.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case Jf.MEDIUM:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case Jf.HIGH:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case Jf.ULTRA:e.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(t,e=th){this.edgeDetectionMaterial.depthBuffer=t,this.edgeDetectionMaterial.depthPacking=e}update(t,e,i){this.clearPass.render(t,this.renderTargetEdges),this.edgeDetectionPass.render(t,e,this.renderTargetEdges),this.weightsPass.render(t,this.renderTargetEdges,this.renderTargetWeights)}setSize(t,e){this.edgeDetectionMaterial.setSize(t,e),this.weightsMaterial.setSize(t,e),this.renderTargetEdges.setSize(t,e),this.renderTargetWeights.setSize(t,e)}dispose(){let{searchTexture:t,areaTexture:e}=this.weightsMaterial;t!==null&&e!==null&&(t.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return C9}static get areaImageDataURL(){return E9}},D4e=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,VA={DEFAULT:0,ESKIL:1},I4e=class extends zc{constructor({blendFunction:t=di.NORMAL,technique:e=VA.DEFAULT,eskil:i=!1,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",D4e,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new qe(n)],["darkness",new qe(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===VA.ESKIL}set eskil(t){this.technique=t?VA.ESKIL:VA.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},ih=class{constructor(t,e){this.enabled=!1,this.effect=new t(e),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=di.NORMAL}},L4e=class extends ih{constructor(){super(d4e),this.blendFunction=di.SCREEN}set intensity(t){this.effect.intensity=t}get intensity(){return this.effect.intensity}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(t){this.effect.luminanceMaterial.smoothing=t}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(t){this.effect.blurPass.scale=t}get blurScale(){return this.effect.blurPass.scale}set kernelSize(t){this.effect.blurPass.kernelSize=t}get kernelSize(){return this.effect.blurPass.kernelSize}},B4e=class extends ih{constructor(){super(p4e)}set contrast(t){this.effect.uniforms.get("contrast").value=t}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(t){this.effect.uniforms.get("brightness").value=t}get brightness(){return this.effect.uniforms.get("brightness").value}},R4e=class extends ih{constructor(){super(x4e),this.effect.offset=new ge(.01,.01)}set offset(t){this.effect.offset.set(t[0]/1e3,t[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},O4e=class extends ih{constructor(){super(g4e)}},F4e=class extends ih{constructor(){super(S4e),this._hue=0}set hue(t){this._hue=t,this.effect.setHue(t)}get hue(){return this._hue}set saturation(t){this.effect.uniforms.get("saturation").value=t}get saturation(){return this.effect.uniforms.get("saturation").value}},N4e=class extends ih{constructor(){super(M4e),this.blendFunction=di.OVERLAY}},k4e=class extends ih{constructor(){super(I4e)}get eskil(){return this.effect.eskil}set eskil(t){this.effect.eskil=t}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(t){this.effect.uniforms.get("darkness").value=t}get offset(){return this.effect.uniforms.get("offset").value}set offset(t){this.effect.uniforms.get("offset").value=t}},z4e=class extends ih{constructor(t){super(w4e,t)}set focalLength(t){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=t}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(t){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=t}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}},U4e=class extends ih{constructor(){super(E4e)}get granularity(){return this.effect.getGranularity()}set granularity(t){this.effect.setGranularity(t)}},G4e=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,V4e=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,H4e=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,j4e=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,yO=class extends Wi{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new qe(null)},blending:$n,depthWrite:!1,depthTest:!1,vertexShader:H4e,fragmentShader:j4e})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}},W4e=class extends zs{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new yO,this.resolutionVector=new ge,this.resolveMaterial=new Wi({name:"TAAResolveMaterial",uniforms:{inputBuffer:new qe(null),historyBuffer:new qe(null),velocityBuffer:new qe(null),depthBuffer:new qe(null),resolution:new qe(new ge)},blending:$n,depthWrite:!1,depthTest:!1,vertexShader:G4e,fragmentShader:V4e}),this.historyRenderTarget=new Li(1024,1024,{minFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Li(1024,1024,{minFilter:Zt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(t,e){this.historyRenderTarget.setSize(t,e),this.resultRenderTarget.setSize(t,e)}render(t,e){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=e.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=e.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=e.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(e.width,e.height),t.setRenderTarget(this.resultRenderTarget),t.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(this.historyRenderTarget),t.render(this.scene,this.camera);let i=this.renderToScreen?null:e;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(i),t.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},X4e=class extends zs{constructor(t,e,i){super("TransmissionPass",void 0,e),this.MRTCompatible=!0,this.depthPass=new A9(t,e,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new yO,this.splineScene=t,this.needsSwap=!1}updatePasses(t){this.passThroughMaterial=new yO,this.depthPass=new A9(this.splineScene,this.camera,{renderTarget:t.transmissionDepthTarget})}setCamera(t){this.camera=t}setScene(t){this.splineScene=t}render(t,e,i){let n=this.camera.layers.mask,r=t;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=e.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(t,e,i),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:e;this.camera.layers.set(3),t.setRenderTarget(s),t.render(this.splineScene,this.camera),this.camera.layers.mask=n}},T9=new xd,q4e=new Wi({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),xO=class extends zs{constructor(t,e,i){super("OpaquePass",e??T9,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=t}setCamera(t){this.camera=t}setScene(t){this.scene=t??T9}getScene(){return this.scene}render(t,e){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof go&&(this.originalMaterials.set(n.id,n.material),n.material=q4e)}),t.shadowMap.needsUpdate=!0,t.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:e;t.setRenderTarget(i),this.clearColorOnly&&t.clear(!0,!1,!0),this.clear&&t.clear(),t.render(this.scene,this.camera),this.clearDepth&&t.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=n)})}},Y4e=class{constructor(t,{depthBuffer:e=!0,stencilBuffer:i=!1,multisampling:n=0,frameBufferType:r=0}={}){this.renderer=t,this.helperStartIndex=0,this.copyPass=new vO,this.depthTexture=null,this.timer=new u4e,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(e,i,r,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(e,i,r,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(e,i,r,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){let e=this.inputBuffer,i=this.multisampling;i>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){var e;if(this.renderer=t,t!==null){let i=t.getSize(new ge),n=((e=t.getContext().getContextAttributes())==null?void 0:e.alpha)??!1,r=this.inputBuffer.texture[0].type;r===fs&&t.outputEncoding===Vt&&(this.inputBuffer.texture[0].encoding=Vt,this.outputBuffer.texture[0].encoding=Vt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),t.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(t,n,r)}}replaceRenderer(t,e=!0){let i=this.renderer,n=i.domElement.parentNode;return this.setRenderer(t),e&&n!==null&&(n.removeChild(i.domElement),n.appendChild(t.domElement)),i}createDepthTexture(){let t=this.depthTexture=new l0(this._width,this._height);return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Xp,t.type=Ep):t.type=$h,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,i,n,r,s){let o=this.renderer,a=o===null?new ge:o.getDrawingBufferSize(new ge),l={minFilter:Zt,magFilter:Zt,wrapS:kn,wrapT:kn,stencilBuffer:e,depthBuffer:t},c;return n>0?(c=new Li(a.width,a.height,l),c.samples=n):(r?(c=new xbe(a.width,a.height,2,l),c.texture[1].type=o0):c=new Li(a.width,a.height,l),c.depthTexture=new l0(2048,2048),c.depthTexture.type=Oo),i===fs&&o!==null&&o.outputEncoding===Vt&&(Array.isArray(c.texture)?c.texture.forEach(h=>h.encoding=Vt):c.texture.encoding=Vt),Array.isArray(c.texture)?c.texture.forEach((h,u)=>{h.name=`EffectComposer.Buffer ${r} ${u}`,h.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${r}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(t,e){var a;let i=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new ge),s=((a=n.getContext().getContextAttributes())==null?void 0:a.alpha)??!1,o;if(t.MRTCompatible&&(o=this.inputBuffer.texture[0].type),t.MRTCompatible||(o=this.inputBuffer.texture.type),t.setRenderer(n),t.setSize(r.width,r.height),t.initialize(n,s,o),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?i.splice(e,0,t):i.push(t),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(t of i)t.setDepthTexture(l)}else t.setDepthTexture(this.depthTexture)}setHelperStartIndex(t){this.helperStartIndex=t}removePass(t){let e=this.passes,i=e.indexOf(t);if(i!==-1&&e.splice(i,1).length>0){if(this.depthTexture!==null){let n=(r,s)=>r||s.needsDepthTexture;e.reduce(n,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){let t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){let e=this.renderer,i=this.copyPass,n=this.inputBuffer,r=this.outputBuffer,s=this.inputBufferSingle,o=this.outputBufferSingle,a=!1,l,c,h,u;t===void 0&&(t=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(e,n,r,t,a):d.render(e,s,o,t,a),d.needsSwap&&(a&&(i.renderToScreen=d.renderToScreen,l=e.getContext(),c=e.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),i.render(e,n,r,t,a),c.setFunc(l.EQUAL,1,4294967295)),h=n,u=s,n=r,s=o,r=h,o=u),d instanceof l4e?a=!0:d instanceof NUe&&(a=!1))}setSize(t,e,i){let n=this.renderer;if(this._width=t,this._height=e,t===void 0||e===void 0){let s=n.getSize(new ge);t=s.width,e=s.height}n.setSize(t,e,i);let r=n.getDrawingBufferSize(new ge);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let t=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(t)}dispose(){for(let t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Q4e=new Wi({name:"CombineMaterial",uniforms:{inputBufferA:new qe(null),inputBufferB:new qe(null)},blending:$n,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),J4e=class extends zs{constructor(t){super("HelperPass",void 0,t),this.MRTCompatible=!1,this.fullscreenMaterial=Q4e,this.helperPass=new xO(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new xO(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let e=new wie({preset:Jf.LOW,edgeDetectionMode:FT.COLOR});this.effectPass=new vE(this.camera,e),this.rt=new Li(10,10,{minFilter:Zt,magFilter:Zt,wrapS:kn,wrapT:kn,depthBuffer:!0})}setSize(t,e){this.rt.setSize(t,e),this.effectPass.setSize(t,e)}set sceneHelpers(t){this.helperPass.setScene(t)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(t){this.helperPassOnTop.setScene(t)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(t){this.helperPass.setCamera(t),this.helperPassOnTop.setCamera(t)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(t,e,i){this.rt.depthTexture=e.depthTexture;let n=t.getClearAlpha();t.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(t,this.rt),this.helperPassOnTop.render(t,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=e.texture,t.setClearAlpha(n),t.setRenderTarget(null),t.clear(),t.render(this.scene,this.camera)}},K4e=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Z4e=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,$4e=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,eGe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,tGe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,iGe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,dx=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],nGe=new Wi({vertexShader:K4e,fragmentShader:Z4e}),HA=new Wi({vertexShader:tGe,fragmentShader:iGe,uniforms:{texture_ao_lrez:new qe(null),texture_depth_lrez:new qe(null),texture_depth_hrez:new qe(null),near:new qe(null),far:new qe(null)}}),rGe=class extends zs{constructor(t,e){super("AmbientOcclusionPass",void 0,e),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,n=1024;this.gBuffer=new Li(i,n,{type:Oo,depthTexture:new l0(i,n),minFilter:Zt,magFilter:Zt}),this.depthBufferHighRes=new Li(i,n,{depthTexture:new l0(i,n)}),this.aoBuffer=new Li(i,n,{minFilter:Zt,magFilter:Zt}),this.splineScene=t,this.splineCamera=e;let r=new Float32Array(dx.length*2);for(let o=0;o<dx.length;o++){let a=o*2;r[a+0]=dx[o][0],r[a+1]=dx[o][1]}this.blueNoiseInDiskTexture=new LC(r,dx.length,1,e$,Oo),this.blueNoiseInDiskTexture.wrapS=Iu,this.blueNoiseInDiskTexture.wrapT=Iu,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Wi({vertexShader:$4e,fragmentShader:eGe,uniforms:{near:new qe(null),far:new qe(null),fov:new qe(null),proj_info:new qe(new Ht),is_ortho:new qe(!1),resolution:new qe(new ge),radius_of_influence:new qe(8),radius_in_screen_space:new qe(1),exponent:new qe(1),ao_color:new qe(new O),bias:new qe(.5),texture_depth:new qe(null),texture_normals:new qe(null),texture_blue_noise:new qe(null),texture_blue_noise_in_disk:new qe(this.blueNoiseInDiskTexture),frame_index:new qe(0),fog_enabled:new qe(!1),fog_near:new qe(1),fog_far:new qe(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Li(i,n,{minFilter:Zt,magFilter:Zt,wrapS:kn,wrapT:kn,depthBuffer:!1,type:Oo});let s=new wie({preset:Jf.ULTRA,edgeDetectionMode:FT.COLOR});this.effectPass=new vE(this.camera,s)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}setBlueNoiseTexture(t){this.hbaoMaterial.uniforms.texture_blue_noise.value=t}setSize(t,e){this._width=t,this._height=e,this.depthBufferHighRes.setSize(t,e);let i=this._runHalfRes?.5:1,n=t*i,r=e*i;this.gBuffer.setSize(n,r),this.aoBuffer.setSize(n,r),this.hbaoMaterial.uniforms.resolution.value.set(n,r),this.aaBuffer.setSize(n,r),this.effectPass.setSize(n,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(t){this._runHalfRes=t,this.setSize(this._width,this._height)}setCamera(t){this.splineCamera=t}setScene(t){this.splineScene=t}render(t,e,i){this.splineScene.overrideMaterial=nGe;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),t.setRenderTarget(this.gBuffer),t.clear(),t.render(this.splineScene,this.splineCamera),t.setRenderTarget(this.depthBufferHighRes),t.clear(),t.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let r=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1-r[8])/r[0],l=-(1+r[9])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),h=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),u=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*h;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let r=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/r[0],o=2/r[5],a=-(1+r[12])/r[0],l=-(1-r[13])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),h=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aoBuffer),t.clear(),t.render(this.scene,this.camera),this.fullscreenMaterial=HA,HA.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,HA.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,HA.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,t.setRenderTarget(t.aoRenderTarget),t.clear(),t.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aaBuffer),t.clear(),t.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.aaBuffer,t.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},sGe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oGe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,aGe=class extends uc{constructor(){super(new Wi({vertexShader:sGe,fragmentShader:oGe,uniforms:{tInput:new qe(null),tMap:new qe(null),uResolution:new qe(new ge),uSize:new qe(new ge),uCoords:new qe(new ge),uScale:new qe(1),uSceneColor:new qe(new Tt(16711680)),uDPR:new qe(1),uCurrent:new qe(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(t){this.uniforms.tMap.value=t}},lGe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,cGe=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,uGe=[],hGe=class extends uc{constructor(){super(new Wi({vertexShader:lGe,fragmentShader:cGe,uniforms:{toScene:new qe(null),fromScene:new qe(null),uResolution:new qe(new ge),uDPR:new qe(1),mixRatio:new qe(0),threshold:new qe(.1),useTexture:new qe(0),tMixTexture:{value:uGe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(t){this.uniforms.fromScene.value=t}};function P9(t,e){return e&&e.enabled&&t.push(e.effect),t}var dGe=t=>Object.values(di).includes(t)?t:di.NORMAL,fGe=class extends qr{constructor(t){super(),this.postprocessingState=rE.defaultData,this._scene=new xd,this._camera=new Rs,this.effects=new Map,this.blueNoiseTexture=new LC,this._renderToScreen=!0,this.clock=new lTe,this.renderer=t,this.debug=!1,this.effects.set("bloom",new L4e),this.effects.set("chromaticAberration",new R4e),this.effects.set("vignette",new k4e),this.effects.set("noise",new N4e),this.effects.set("colorAverage",new O4e),this.effects.set("hueSaturation",new F4e),this.effects.set("brightnessContrast",new B4e),this.effects.set("depthOfField",new z4e),this.effects.set("pixelation",new U4e),this.effectComposer=new Y4e(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new xO(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new X4e(this.scene,this.camera,this.renderer),this.aoPass=new rGe(this.scene,this.camera),this.taaPass=new W4e,this.taaPass.renderToScreen=!1,this.helperPass=new J4e(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new aGe,this.overlayPass.enabled=!1,this.sceneTransitionPass=new hGe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(t){t!==void 0?(this.overlayPass.texture=t,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(t){this.helperPass.sceneHelpers=t}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(t){this.helperPass.sceneHelpersOnTop=t}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(t){this._scene=t,this.opaquePass.setScene(t),this.transmissionPass.setScene(t),this.aoPass.setScene(t)}get camera(){return this._camera}set camera(t){this._camera=t,this.opaquePass.setCamera(t),this.transmissionPass.setCamera(t),this.aoPass.setCamera(t),this.helperPass.setCamera(t)}updateRenderToScreen(){let t=!1;for(let e=this.effectComposer.passes.length-1;e>=0;e--){let i=this.effectComposer.passes[e];if(i.enabled===!0&&!t&&this._renderToScreen){i.renderToScreen=!0,t=!0;continue}i.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(t){this.blueNoiseTexture=new LC(t,128,128),this.blueNoiseTexture.wrapS=Iu,this.blueNoiseTexture.wrapT=Iu,this.blueNoiseTexture.minFilter=ji,this.blueNoiseTexture.magFilter=ji,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(t,e,i,n,r,s,o,a){this.aoPass.enabled=t,this.aoPass.radius=e,this.aoPass.bias=i,this.aoPass.aoColor=n,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!a&&(this.aoPass.runHalfRes=!a)}setTransmissionPassEnabled(t){this.transmissionPass.enabled=t,this.opaquePass.hasTransmissionPass=t}_initPasses(){var t,e;if((t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(P9,[]);i.length>0&&(this.uvEffectPass=new vE(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(P9,[]);n.length>0&&(this.effectPass=new vE(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let t=new ge;this.renderer.getDrawingBufferSize(t),this._rt=new Li(t.x,t.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Iu,wrapT:Iu}),this._rt.samples=0,this._savePass=new vO(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(t){this._rt=t,this._savePass=new vO(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(t){if(this._renderToScreen===t)return;let e=this.effectComposer;!e||(t===!0?e.removePass(this._savePass):e.addPass(this._savePass),this._renderToScreen=t,this.updateRenderToScreen())}set sceneTransitionFromTexture(t){t!==this.sceneTransitionPass.texture&&(t!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=t)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(t){let{enabled:e,...i}=t,n=!1;e!==this.postprocessingState.enabled&&(n=!0);for(let r of Object.entries(i)){let s=r[1],o=this.effects.get(r[0]);if(o){o.enabled!==s.enabled&&(n=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=dGe(l):o[a]=l}}this.postprocessingState=t,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(t,e,i,n){t instanceof Ht?(this.effectComposer.inputBuffer.scissor.set(t.x,t.y,t.z,t.w),this.effectComposer.outputBuffer.scissor.set(t.x,t.y,t.z,t.w)):(this.effectComposer.inputBuffer.scissor.set(t,e,i,n),this.effectComposer.outputBuffer.scissor.set(t,e,i,n));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(t,e,i,n)}setScissorTest(t){this.effectComposer.inputBuffer.scissorTest=t,this.effectComposer.outputBuffer.scissorTest=t,this.renderer.setScissorTest(t)}setViewport(t,e,i,n){t instanceof Ht?(this.effectComposer.inputBuffer.viewport.copy(t),this.effectComposer.outputBuffer.viewport.copy(t)):(this.effectComposer.inputBuffer.viewport.set(t,e,i,n),this.effectComposer.outputBuffer.viewport.set(t,e,i,n))}resize(t,e,i){if(this.effectComposer.setSize(t,e,i),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(t*n,e*n)}}dispose(){var t,e;(t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.dispose()}},D9=new ur,pGe=class extends y${constructor(t){super(t),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new ge,this.pipeline=new fGe(this),this.dummyCamra=new Rs,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(r=!0,s=!0,o=!0)=>{let a=this.getContext(),l=0;r&&(l|=a.COLOR_BUFFER_BIT),s&&(l|=a.DEPTH_BUFFER_BIT),o&&(l|=a.STENCIL_BUFFER_BIT),a.clear(l),a.clearBufferfv(a.COLOR,1,[0,0,0,1])},this.autoClear=!1;let e=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=bk;let n=this.getContext();if(n&&"drawingBufferColorSpace"in n)try{n.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio!==r&&(this._pixelRatio=r,e(r))},this.setSize=(r,s,o=!0)=>{var a,l;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,i(r,s,o),(a=this.normalRenderTarget)==null||a.setSize(r*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(r,s),(l=this.transmissionDepthTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Li(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Zt,magFilter:Zt,wrapS:kn,wrapT:kn,depthBuffer:!1}))}_resizeTransmission(t,e){var i,n;(i=this.transmissionRenderTarget)==null||i.setSize(t*this._pixelRatio/(this.hdTransmission?1:2),e*this._pixelRatio/(this.hdTransmission?1:2)),(n=this.aoRenderTarget)==null||n.setSize(t*this._pixelRatio/1,e*this._pixelRatio/1)}get hdTransmission(){return Et.transmissionLod.value===1}set hdTransmission(t){Et.transmissionLod.value=t===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Li(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:s0,magFilter:Zt,wrapS:kn,wrapT:kn,depthBuffer:!1}),this.transmissionDepthTarget=new Li(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:ji,magFilter:ji,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Li(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ji,magFilter:ji,type:Oo,depthTexture:new l0(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(t,e,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),e.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof Rs?iI.uniforms.depthContrast.value=(i.far-i.near)/1e4:iI.uniforms.depthContrast.value=1,e.overrideMaterial=iI,this.render(e,i),this.setClearColor(e.bgColor,e.bgColor.a),this.setRenderTarget(null),e.overrideMaterial=t.wireframeState?bO:null,i.layers.enable(0),i.layers.enable(3),e.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(t,e,i=1){this.dummyCamra.updateCameraState(e.dataPatched);let n=e.height,r=e.width,s=this.viewportWidth/this.viewportHeight;r<n?r=n*s:n=r/s,this.dummyCamra.setViewplaneSize(r,n);for(let o=0;o<i;o++)this.renderSplineScene(t,this.dummyCamra)}renderSplineScene(t,e,{sceneHelpers:i=void 0,sceneHelpersOnTop:n=void 0,overrideTransmission:r=void 0,overrideNormal:s=void 0}={}){let o=t instanceof Gz?t.activePage:t,a=o.visible;o.visible=!0;let l=o.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(e)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach((d,f)=>{Et.penumbraSize.value[f]=d}),Et.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Et.resolution.value.set(this.resolution.x,this.resolution.y):Et.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(Et.normalRenderTarget.value=s,Et.normalRenderTargetDepth.value=D9):l.needsNormal()&&(this.createNormalRenderTarget(),Et.normalRenderTarget.value=this.normalRenderTarget.texture,Et.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,o,e));let c=o.data.ao,h=c.occlusion;h&&(this.createAORenderTarget(),Et.aoRenderTarget.value=this.aoRenderTarget.texture),Et.aoEnabled.value=h,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,o.aoColor,o.fog!==null,o.backupFog.near,o.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let u=!1;if(r!==void 0)Et.transmissionRenderTarget.value=r,Et.transmissionRenderTargetDepth.value=D9,this.pipeline.setTransmissionPassEnabled(!1);else{let d=l.needsTransmission();d&&(this.transmissionRenderTarget===void 0&&(u=!0),this.createTransmissionRenderTarget(),Et.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Et.aspectRatio.value=Yke(this.viewportWidth,this.viewportHeight),Et.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(d)}e.layers.enable(3),e.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=n,this.pipeline.scene=o,this.pipeline.camera=e,u&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!i&&!n&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),o.overrideMaterial=l.wireframeState?bO:null,this.pipeline.render(),Et.frameIndex.value=(Et.frameIndex.value+1)%16,e instanceof Rs&&e.copyHistory(),o.visible=a}renderFromSceneForSceneTransitionPass(t,e,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(t,e),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let n=this.pipeline.sceneTransitionPass.uniforms;n.uDPR.value=window.devicePixelRatio,n.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var t,e,i,n,r,s;this._superDispose(),this.pipeline.dispose(),(t=this.aoRenderTarget)==null||t.dispose(),(e=this.transmissionRenderTarget)==null||e.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(s=(r=this.normalRenderTarget)==null?void 0:r.depthTexture)==null||s.dispose()}},bie=class extends bw(MTe){constructor(t,e=15,i=10066329){super(t,e,i),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){Sw(this.object,bie.geometryHelper,t,e)}},Sie=class extends bw(ATe){constructor(t,e=15,i=6710886){super(t,e,i),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){Sw(this.object,Sie.geometryHelper,t,e)}},_O=class extends bw(STe){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){Sw(this.object,_O.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=_O._vector,e=this.object.distance?this.object.distance:1e3,i=e*Math.tan(this.object.angle);this.cone.scale.set(i,i,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let n=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(n);else this.cone.material.color.set(n)}}},Aie=_O;Aie._vector=new O;function mGe(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var Mie=class extends Oz(oTe,bie){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let r=new kC(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof kC&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let i=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&mGe(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),i&&this.update()}},I9=new O,L9=new O,B9=new qt,Cie=class extends Oz(iTe,Aie){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=ri.RAD2DEG*2*this.angle,n.aspect=1,n.near=100,n.far=2500;let r=new kC(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof kC&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),L9.setFromMatrixPosition(this.matrixWorld),B9.setFromRotationMatrix(this.matrixWorld),I9.copy(this.up).applyQuaternion(B9).negate().multiplyScalar(this.distance),this.target.position.copy(L9).add(I9),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Ad=class extends yz(xd){constructor(t,e){super(),this.data=e,this.bgColor=new ho(1,1,1,1),this.fog=null,this.backupFog=new x$(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Tt,this.penumbraSizeArrayCache=null,this.super_Entity(t,e),this.personalCamera=new Rs(W0,{...b_.defaultData,...e.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new eTe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=Ds(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.enabled!==void 0&&(t.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(t){this.isActive=!0,t.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(t=>{if(t instanceof Y0)if(Array.isArray(t.material))for(let e of t.material)e.needsUpdate=!0;else t.material.needsUpdate=!0,t.material.dispose()})}updateShadow(t){t.softShadowQuality!==void 0&&this.isActive&&dUe(t.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(t,e){if(t.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let i=this.scene;i.fog=this.fog}this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Ds(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}updateAo(t,e){t.aoColor!==void 0&&(this.aoColor=Ds(t.aoColor,e))}updateByOp(t,e,i,n){super.updateByOp(t,e,i,n);let r=e;Ta(t.path,["fog"])?this.updateFog(r.fog,i.shared):Ta(t.path,["ao"])?this.updateAo(r.ao,i.shared):Ta(t.path,["ambient"])?this.updateAmbientLight(r.ambient,i.shared):Ta(t.path,["shadow"])&&this.updateShadow(r.shadow)}updateState(t,e){this.updateState_Entity(t,e),t.backgroundColor!==void 0&&this.setBackgroundColor(Ds(t.backgroundColor,e.shared)),t.fog!==void 0&&this.updateFog(t.fog,e.shared),t.ambient!==void 0&&this.updateAmbientLight(t.ambient,e.shared),t.ao!==void 0&&this.updateAo(t.ao,e.shared),t.shadow!==void 0&&this.updateShadow(t.shadow)}raycast(t,e){super.raycast(t,e)}switchActiveCamera(t){t&&t.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1)}get playCamera(){var t;return((t=this.scene)==null?void 0:t.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let t=0,e=0;this.traverseEntity(i=>{if(!i.visible)return!0;i instanceof Mie&&i.visible&&t<3&&(this.penumbraSizeArrayCache[t]=i.data.penumbraSize,t+=1),i instanceof Cie&&i.visible&&t<5-3&&(this.penumbraSizeArrayCache[3+e]=i.data.penumbraSize,e+=1)})}raycastWithClones(t){let e=[],i=n=>{for(let r of n.children){let s=r.cloner;fi.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((pl(r)||pO(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),wO(r,t,e,!0)),i(r))}};return i(this),e}},gGe=class extends Oz(rTe,Sie){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let r=new O(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),s=new O(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new Gn(r,s),a=new zC(o,new Tt(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof zC){let i=this.shadow.camera,n=new O(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),r=new O(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);e.box.set(n,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},vGe=class extends fo{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?Cz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},kz=class extends fo{constructor(t,e,i){super(t,e,i),this._shapeId=null,this._context=i}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var n;let t=this.data.geometry.extrusion.shape,e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(n=s.geometry.userData)==null?void 0:n.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=Cte;break;case"Ellipse":r=Az;break;case"Polygon":r=Mte;break;case"Star":r=Ete;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let i=this.geometry;e&&i.inputs&&(i.inputs.shapeData=e,i.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t){return super.updateTransformState(t)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?Cz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},Bv=class extends Aw(iv,OT){constructor(t,e,i){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,i)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let i=e.scene.data.objects.get(t.component);if(i){let n,r;for(let s of nd.rootOverrideProps)t[s]===void 0?(n===void 0&&(n={...t}),n[s]=i.data[s]):(r===void 0&&(r={}),r[s]=t[s],n===void 0&&(n={...t}),n[s]=_d.apply(i.data[s],t[s]));return this.overrideData=r,n}else return{...Bs.defaultData,...t,...zu(Bs.defaultData,nd.rootOverrideProps)}}updateByOp(t,e,i,n){let r;if(this.isInstanceRoot&&!n){if(e=this.transformAssignData(e,i),t.type===0&&t.path.length===0&&this.component)for(let s of nd.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);else if(t.type===0&&t.path.length>0&&nd.rootOverrideProps.includes(t.path[0])){let s=t.path[0];r===void 0&&(r={...t,path:[],props:{[s]:e[s]}})}}super.updateByOp(r??t,e,i,n)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){let i=t.scene.find(e.component)??null,n=!1;if(i!==this.oldComponent){if(this.oldComponent){let r=0;for(let s of this.children)if(fi.is(s))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),zz(s),r+=1;else break;this.children.splice(0,r)}n=!0}if(i){let r={};Eie(t,[this.uuid],e.overrides,this,i,i,0,n,r);for(let s of this.children)if(fi.is(s)){let o=s.data;o.type==="Empty"&&o.animations&&s.traverseEntity(a=>{if(a instanceof fo&&a.isSkinnedMesh){let l=a.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(d=>t.scene.find(r[d])),h=l.boneInverses.map(d=>new Qe().fromArray(d)),u=new Ik(c,h);a.bind(u,a.bindMatrix)}}else a.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function zz(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let i of t.children)fi.is(i)&&zz(i)}}function R9(t,e,i,n){return t.component===e&&sz(t.identity,n)?t.overrideData===i?2:1:0}function Eie(t,e,i,n,r,s,o,a,l){if(o>50)return!1;if(n.component!==r){if(n.component){let h=n.component.instances.indexOf(n);h>=0&&n.component.instances.splice(h,1)}r.instances.push(n),n.component=r}r instanceof Bv&&r.isInstanceRoot&&r.expandInstanceChildren(t);let c=0;for(let h of r.children)if(fi.is(h)){let u=[...e,...typeof h.identity=="string"?[h.identity]:h.identity],d=sE.resolve(i,u,1);d!=null&&!(d instanceof hr)&&(Object.setPrototypeOf(d,hr.prototype),console.error("wrong prototype"));let f=null,p;if(!a){let m=n.children[c];if(f=fi.is(m)?m:null,f!==null){let g=R9(f,h,d,u);p=g>=1?f.stateSelection:void 0,g!==2&&(f=null)}if(f===null&&(f=t.scene.findInstance(u)??null,f!==null)){let g=R9(f,h,d,u);if(p=g>=1?f.stateSelection:void 0,g!==2)f=null;else{let v=f.parent.children.indexOf(f);f.parent.children.splice(v,1),n.children.splice(c,0,f),f.parent===n?v<=c&&console.error("not possible"):(f.parent=n,f.matrixWorldNeedsUpdate=!0,f.resetBBoxNeedsUpdate(),f.updateVisible(),t.pendingDeletes.delete(f))}}}if(f===null){let m=d?_d.apply(h.data,d):h.data;Qp.is(m.type)&&(m={...m,type:"Empty"}),f=rd.createEntity(u,m,t),f.overrideData=d,n.add(f),n.children.splice(n.children.length-1,1),n.children.splice(c,0,f),f.updateState(f.data,t),p&&f.changeSelectedState(p,t),t.scene.registerInstanceAndSetUuid(f)}if(f.isBone){let m=f.identity[f.identity.length-1];l[m]=f.uuid}c+=1,Eie(t,e,i,f,h,s,o+1,a,l)}if(!a){let h=c;for(;;){let u=n.children[c];if(fi.is(u))t.pendingDeletes.add(u);else break;c+=1}n.children.splice(h,c-h)}return!0}var yGe=class extends Aw(_$,OT){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(t,e){this.updateState_Entity(t,e)}};function xGe(t,e,i){let n;return e.geometry.type==="TextGeometry"?new pie(t,e,i):(e.geometry.type==="SubdivGeometry"?n=new T_(t,e,i):e.geometry.type==="PathGeometry"?n=new kz(t,e,i):e.geometry.type==="VectorGeometry"?n=new vGe(t,e,i):e.geometry.type==="BooleanGeometry"?n=new x0(t,e,i):n=new fo(t,e,i),n)}function Uz(t,e,i){return e.type==="Mesh"?xGe(t,e,i):e.type==="Empty"?new gE(t,e):e.type==="Bone"?new yGe(t,e):e.type==="Page"?new Ad(t,e):e.type==="PointLight"?new gGe(t,e,i):e.type==="SpotLight"?new Cie(t,e,i):e.type==="DirectionalLight"?new Mie(t,e,i):e.type==="Component"||e.type==="Instance"?new Bv(t,e,i):Qp.is(e.type)?new Rs(t,e):(console.error(e),new gE(t,e))}rd.createEntity=Uz;function _Ge(t,e,i){let n=Uz(t.identity,e,i),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,c=t.overrideData,h=t.uuid,u=t.stateSelection;t.dispose();for(let d of Object.keys(t))delete t[d];Object.setPrototypeOf(t,Object.getPrototypeOf(n));for(let d of Object.keys(n))t[d]=n[d];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=h,t.overrideData=c,t.updateState(t.data,i),u&&t.changeSelectedState(u,i),t.resetBBoxNeedsUpdate()}rd.changeEntityProptotype=_Ge;rd.Cloner=xl;function wGe(t,e,i,n){t.updateByOp(e,i,n,!1)}function O9(t,e){let i=!1,n=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),n.length>0&&t.layers.enable(3),i=!0,Rz(t),Bz(t)),n.length===0&&r.length===0&&t.layers.set(0),t instanceof Y0&&t.needsAO&&t.layers.enable(5),i}function F9(t,e){if(!e.layers)return!1;let i=!1,n=e.getLayersOfType("transmission").filter(s=>s.data.visible),r=e.getLayersOfType("outline").filter(s=>s.data.visible);return n.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),i=!0),n.length===0&&r.length===0&&t.layers.set(0),t.needsAO&&t.layers.enable(5),i}function bGe(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof Y0)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)O9(i,i.material[n])&&(e=!0);else O9(i,i.material)&&(e=!0)}),e}function SGe(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof Y0)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)F9(i,i.material[n])&&(e=!0);else F9(i,i.material)&&(e=!0)}),e}var AGe=new k$,MGe=new Qe,CGe=new B0;function wO(t,e,i,n=!1){let r=t.cloner;if(r)for(let s of r.children){let o=MGe.copy(s.matrixWorld).invert(),a=CGe.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let c=AGe;c.set(a.origin,a.direction),c.near=e.near,c.far=e.far;let h=c.intersectObject(t,!1);h.length>0&&i.push({...h[0],object:n?s:t})}}var EGe=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((i,n)=>{let r=[n,i],s=i;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let i=t;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===e)return!0;return!1}},bO=new gw;bO.wireframe=!0;var N9=new O,Gz=class extends xd{constructor(t,e){super(),this.data=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new EGe,this.errorPage=new Ad("fdasfa",{...v0.defaultData,name:""}),this.needsRecomputeInstances=!1,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=SGe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=bGe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),i=this.entityIdentityToEntity[e];i&&(t.uuid=i.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}markPenumbraSizeDirty(){for(let t of this.children)t instanceof Ad&&(t.penumbraSizeArrayCache=null)}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let i=[],n=e;for(;n!==this;){let r=n;n=n.parent;let s=n.children.indexOf(r);i.splice(0,0,s)}return{entity:e,sortKey:i}}getAllSorted(t){let e=[];for(let i of t){let n=this.getWithSortKey(i.id);n!==void 0&&e.push(n)}return e.sort((i,n)=>KRe(i.sortKey,n.sortKey)),e.map(i=>i.entity)}nonExistOrDescendantOf(t,e){let i=this.find(t);if(i===void 0)return!0;for(;i;){if(i.uuid===e)return!0;i=i.parent}return!1}find(t){if(this.activePage&&this.activePage.personalCamera.parent){if(t==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(t===W0)return this.activePage.personalCamera}if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateTreeByOp(t,e){var i;if(t.path.length===0&&t.type===7){let n=t.parent===null?this:this.find(t.parent);if(n===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,n,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),pl(r)&&Bu(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r),this.markPenumbraSizeDirty()}else if(t.path.length===0&&t.type===8){let n=this.find(t.id);if(n===void 0)throw new Error("unexpected");this.markToExpandCloner(n),n.resetBBoxNeedsUpdate(),this.unregisterObject(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markPenumbraSizeDirty(),n.parent.remove(n),Bu(n.parent)&&(n.parent.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),pl(n)&&(n.freeBooleanPointer(),r instanceof x0&&r.invalidateDownstreamBooleanData().recomputeBoolean()),n instanceof kz&&n.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),this.pathConstraints.removeDependencies(n.uuid)}else if(t.path.length===0&&t.type===9){let n=this.find(t.id);if(n===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),(i=n.cloner)==null||i.resetOnMove(),this.markToExpandCloner(n);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(n),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(n),n.invalidateClonerTransform(n),n.updateVisible(),n.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),pl(n)&&(n.invalidateUpstreamBooleanData(),Bu(n.parent)?n.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof x0&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(t){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let e of this.children)e instanceof Ad&&(e.visible=e.uuid===t,e.visible&&(this.activePage=e,this.activePage.onActive(this)))}updateEntityByOp(t,e,i,n){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),"visible"in e.props&&this.markPenumbraSizeDirty(),e.path.includes("overrides")&&"states"in e.props){let{rest:s}=e.props;e={...e,props:s},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{wGe(r,e,i,{scene:this,shared:n}),r instanceof fo&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(t){this.activePage.switchActiveCamera(t)}init(t,e){this.createChildrenObjects(t.objects,this,e),this.updatePage(t.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(e,!0),this.traverseEntity(i=>{Bu(i)&&i.recomputeBoolean(),i instanceof Rs&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){fi.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{fi.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,i,n,r,s,o){if(t){let a=n.find(t);a&&a!==n&&r.forInstancesRec(l=>{l.data=QC(l.data,c=>{let h=c.events.data(o.id),u=l.goUp(s);if(u){let d=[...wee(u.identity),t].join("-"),f=this.entityIdentityToEntity[d];if(f){let p=f.uuid,m=Mc.zoom(h,e);m[i]=p}else console.warn("cannot find instance")}}).data})}}rewriteActions(t,e,i,n,r,s){t.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...e,o.id],"object",i,n,r,s):o.data.type==="Animation"&&this.relativeizeInner(o.data.object,[...e,o.id],"object",i,n,r,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof Bv&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,i)=>{e.data.events.forEach(n=>{if(n.data.type==="GameControl"){let r=!1;if(e.forInstancesRec(s=>{s.data=QC(s.data,o=>{s.isInstanceRoot||(o.events.delete(n.id),r=!0)}).data}),r===!1)for(let s of QR.list)this.rewriteActions(n.data.gameActions[s],["gameActions",s],t,e,i,n)}else n.data.type==="Conditional"?(n.data.condition.type==="Distance"?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",t,e,i,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",t,e,i,n)):n.data.condition.type==="State"?this.relativeizeInner(n.data.condition.object,["condition"],"object",t,e,i,n):n.data.condition.type==="Comparison"&&(n.data.condition.lOperand.type==="Property"&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,i,n),n.data.condition.rOperand.type==="Property"&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,i,n)),this.rewriteActions(n.data.inActions,["inActions"],t,e,i,n),this.rewriteActions(n.data.outActions,["outActions"],t,e,i,n)):"actions"in n.data&&this.rewriteActions(n.data.actions,["actions"],t,e,i,n)})}),!0})}expandInstances(t,e,i){let n=new Set;this.traverseEntity(r=>{if(r instanceof Bv&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:t,pendingDeletes:n}),e||r.resetBBoxNeedsUpdate(),i&&r.traverseEntity(s=>{i.addClip(s)}),!0});for(let r of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),zz(r)}recomputeInstances(t,e){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof Bv&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(t,!1,e))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let i=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[i]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[i]),e.dispose()})}clearScene(){for(let t of this.children)fi.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}raycast(t){return this.raycast1(t,!1)}raycast1(t,e){let i=[],n=r=>{for(let s of r.children){let o=s.cloner;if(fi.is(s)&&!s.raycastLock&&(s.visible||o!=null&&o.object.data.visible))if(e===!0&&s.isInstanceRoot){let a=[];if(t.intersectObject(s,!0,a),a.length){let l=a[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),i.push(l)}}else(pl(s)||pO(s)&&this.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,i),wO(s,t,i)),n(s)}};return n(this),i}raycastWithClones(t){let e=[],i=n=>{for(let r of n.children){let s=r.cloner;fi.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((pl(r)||pO(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),wO(r,t,e,!0)),i(r))}};return i(this),e}forEachEntity(t){for(let e of this.children)fi.is(e)&&t(e)}traverseConcreteEntity(t){for(let e of this.children)fi.is(e)&&e.isConcreteEntity&&e.traverseEntity(t)}traverseEntity(t){for(let e of this.children)fi.is(e)&&e.traverseEntity(t)}traverseObject(t){for(let e of this.children)E_.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)fi.is(e)&&e.visible&&e.traverseVisibleEntity(t)}dispose(){this.clearScene()}createChildrenObjects(t,e,i){let n=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,n,i),n+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,i,n,r,s){var l;let o={scene:this,shared:s},a=Uz(t,e,o);return a&&(this.entityByUuid[t]=a,n.add(a),n.children.splice(r,0,n.children.pop()),i.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,a,s)),a.updateState(e,o),a instanceof fo&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),e.type==="Empty"&&e.animations&&a.traverseEntity(c=>{if(c instanceof fo&&c.isSkinnedMesh){let h=c.dataPatched;if(h.bones&&h.boneInverses){let u=h.bones.map(p=>this.find(p)),d=h.boneInverses.map(p=>new Qe().fromArray(p)),f=new Ik(u,d);c.bind(f,c.bindMatrix)}}else c.matrixAutoUpdate=!0}),a}getCenter(t){let e=[];for(let n=0,r=t.length;n<r;++n){let{id:s,recursive:o}=t[n],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let i=new Gn;return i.setFromPoints(e),i.getCenter(N9),N9}copyMatrixWorld(t,e){if(t===null){e.identity();return}let i=this.find(t);i?e.copy(i.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var n;if(t===null){e.identity();return}let i=(n=this.find(t))==null?void 0:n.parent;i?e.copy(i.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof go)if(Array.isArray(e.material))for(let i=0;i<e.material.length;i++)e.material[i]instanceof zd&&t(e.material[i]);else e.material instanceof zd&&t(e.material)})}updateCanvasSize(t,e,i=!1){this.activeCamera.setViewplaneSize(t,e,i)}},IM=(t,e)=>{let i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},TGe=(t,e)=>{let i=e.x-t.x,n=e.y-t.y;return DGe(Math.atan2(n,i))},PGe=(t,e,i)=>{let n={x:0,y:0};return i=SO(i),n.x=t.x-e*Math.cos(i),n.y=t.y-e*Math.sin(i),n},SO=t=>t*(Math.PI/180),DGe=t=>t*(180/Math.PI),IGe=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,oI=new Map,k9=t=>{oI.has(t)&&clearTimeout(oI.get(t)),oI.set(t,setTimeout(t,100))},yE=(t,e,i)=>{let n=e.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],t.addEventListener?t.addEventListener(r,i,!1):t.attachEvent&&t.attachEvent(r,i)},z9=(t,e,i)=>{let n=e.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],t.removeEventListener?t.removeEventListener(r,i):t.detachEvent&&t.detachEvent(r,i)},Tie=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),U9=()=>{if(typeof window>"u")return;let t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},AO=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},Vz=(t,e,i)=>{let n=Pie(t);for(let r in n)if(n.hasOwnProperty(r))if(typeof e=="string")n[r]=e+" "+i;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+i+", ";n[r]=s.slice(0,-2)}return n},LGe=(t,e)=>{let i=Pie(t);for(let n in i)i.hasOwnProperty(n)&&(i[n]=e);return i},Pie=t=>{let e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},aI=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},BGe=(t,e)=>{let i={};for(let n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:t.hasOwnProperty(n)&&(i[n]=t[n]);return i},MO=(t,e)=>{if(t.length)for(let i=0,n=t.length;i<n;i+=1)e(t[i]);else e(t)},RGe=(t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)});typeof window<"u"&&(Die="ontouchstart"in window,Iie=!!window.PointerEvent,Lie=!!window.MSPointerEvent);var Die,Iie,Lie,fx={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},ov,P_={};Iie?ov=fx.pointer:Lie?ov=fx.MSPointer:Die?(ov=fx.touch,P_=fx.mouse):ov=fx.mouse;function hm(){}hm.prototype.on=function(t,e){var i=this,n=t.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]=i._handlers_[r]||[],i._handlers_[r].push(e);return i};hm.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},t===void 0?i._handlers_={}:e===void 0?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i};hm.prototype.trigger=function(t,e){var i=this,n=t.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]&&i._handlers_[r].length&&i._handlers_[r].forEach(function(o){o.call(i,{type:r,target:i},e)})};hm.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=BGe(e.options,t))};hm.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},yE(t,ov[e],i._domHandlers_[e]),P_[e]&&yE(t,P_[e],i._domHandlers_[e]),i};hm.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},z9(t,ov[e],i._domHandlers_[e]),P_[e]&&z9(t,P_[e],i._domHandlers_[e]),delete i._domHandlers_[e],this};var Hz=hm;function gr(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=gr.id,gr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}gr.prototype=new Hz;gr.constructor=gr;gr.id=0;gr.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};gr.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=LGe("borderRadius","50%"),i=Vz("transition","opacity",t),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},aI(n.el,i),this.options.shape==="circle"&&aI(n.back,e),aI(n.front,e),this.applyStyles(n),this};gr.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this};gr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};gr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};gr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};gr.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};gr.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=i,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){let i=e.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,n)}return e};gr.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",r={};r.front=Vz("transition",["top","left"],n);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(r),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i),i.restCallback()},i.options.fadeTime)};gr.prototype.restCallback=function(){var t=this,e={};e.front=Vz("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};gr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};gr.prototype.computeDirection=function(t){var e=t.angle.radian,i=Math.PI/4,n=Math.PI/2,r,s,o;if(e>i&&e<i*3&&!t.lockX?r="up":e>-i&&e<=i&&!t.lockY?r="left":e>-i*3&&e<=-i&&!t.lockX?r="down":t.lockY||(r="right"),t.lockY||(e>-n&&e<n?s="left":s="right"),t.lockX||(e>0?o="up":o="down"),t.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var c={};this.direction={x:s,y:o,angle:r},t.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return t;(!c.x||!c.y)&&this.trigger("plain",t),c.x||this.trigger("plain:"+s,t),c.y||this.trigger("plain:"+o,t),c.angle||this.trigger("dir dir:"+r,t)}else this.resetDirection();return t};var OGe=gr;function Un(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=Un.id,Un.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}Un.prototype=new Hz;Un.constructor=Un;Un.id=0;Un.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(i){if(i===void 0)return e[0];for(var n=0,r=e.length;n<r;n+=1)if(e[n].identifier===i)return e[n];return!1}};Un.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};Un.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}};Un.prototype.createNipple=function(t,e){var i=this,n=i.manager.scroll,r={},s=i.options,o={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(t.x&&t.y)r={x:t.x-o.x,y:t.y-o.y};else if(t.top||t.right||t.bottom||t.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=t.top,a.style.right=t.right,a.style.bottom=t.bottom,a.style.left=t.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),r=t,t={x:l.left+n.x,y:l.top+n.y}}var c=new OGe(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:t,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(AO(c.ui.el,r),AO(c.ui.front,c.frontPosition)),i.nipples.push(c),i.trigger("added "+c.identifier+":added",c),i.manager.trigger("added "+c.identifier+":added",c),i.bindNipple(c),c};Un.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};Un.prototype.bindNipple=function(t){var e=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)};Un.prototype.pressureFn=function(t,e,i){var n=this,r=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval((function(){var s=t.force||t.pressure||t.webkitForce||0;s!==r&&(e.trigger("pressure",s),n.trigger("pressure "+e.identifier+":pressure",s),r=s)}).bind(n),100)};Un.prototype.onstart=function(t){var e=this,i=e.options,n=t;t=Tie(t),e.updateBox();var r=function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(n.touches).findIndex(function(l){return l.identifier===o})<0){var a=[t[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))};return MO(t,r),e.manager.bindDocument(),!1};Un.prototype.processOnStart=function(t){var e=this,i=e.options,n,r=e.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,o={x:t.pageX,y:t.pageY},a=e.getOrCreate(r,o);a.identifier!==r&&e.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(h){h.trigger("start",h),e.trigger("start "+h.id+":start",h),h.show(),s>0&&e.pressureFn(t,h,h.identifier),e.processOnMove(t)};if((n=e.idles.indexOf(a))>=0&&e.idles.splice(n,1),e.actives.push(a),e.ids.push(a.identifier),i.mode!=="semi")l(a);else{var c=IM(o,a.position);if(c<=i.catchDistance)l(a);else{a.destroy(),e.processOnStart(t);return}}return a};Un.prototype.getOrCreate=function(t,e){var i=this,n=i.options,r;return/(semi|static)/.test(n.mode)?(r=i.idles[0],r?(i.idles.splice(0,1),r):n.mode==="semi"?i.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(r=i.createNipple(e,t),r)};Un.prototype.processOnMove=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),r=e.nipples.get(n),s=e.manager.scroll;if(!IGe(t)){this.processOnEnd(t);return}if(!r){console.error("Found zombie joystick with ID "+n),e.manager.removeIdentifier(n);return}if(i.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:s.x+o.left,y:s.y+o.top}}r.identifier=n;var a=r.options.size/2,l={x:t.pageX,y:t.pageY};i.lockX&&(l.y=r.position.y),i.lockY&&(l.x=r.position.x);var c=IM(l,r.position),h=TGe(l,r.position),u=SO(h),d=c/a,f={distance:c,position:l},p,m;if(r.options.shape==="circle"?(p=Math.min(c,a),m=PGe(r.position,p,h)):(m=RGe(l,r.position,a),p=IM(m,r.position)),i.follow){if(c>a){let x=l.x-m.x,b=l.y-m.y;r.position.x+=x,r.position.y+=b,r.el.style.top=r.position.y-(e.box.top+s.y)+"px",r.el.style.left=r.position.x-(e.box.left+s.x)+"px",c=IM(l,r.position)}}else l=m,c=p;var g=l.x-r.position.x,v=l.y-r.position.y;r.frontPosition={x:g,y:v},i.dataOnly||AO(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:d,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:u,degree:h},vector:{x:g/a,y:-v/a},raw:f,instance:r,lockX:i.lockX,lockY:i.lockY};y=r.computeDirection(y),y.angle={radian:SO(180-h),degree:180-h},r.trigger("move",y),e.trigger("move "+r.id+":move",y)};Un.prototype.processOnEnd=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),r=e.nipples.get(n),s=e.manager.removeIdentifier(r.identifier);!r||(i.dataOnly||r.hide(function(){i.mode==="dynamic"&&(r.trigger("removed",r),e.trigger("removed "+r.id+":removed",r),e.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(e.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),e.trigger("end "+r.id+":end",r),e.ids.indexOf(r.identifier)>=0&&e.ids.splice(e.ids.indexOf(r.identifier),1),e.actives.indexOf(r)>=0&&e.actives.splice(e.actives.indexOf(r),1),/(semi|static)/.test(i.mode)?e.idles.push(r):e.nipples.indexOf(r)>=0&&e.nipples.splice(e.nipples.indexOf(r),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[s.id]=s.identifier))};Un.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()};Un.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(i){i.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};var FGe=Un;function Rr(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=U9(),e.config(t),e.prepareCollections();var i=function(){var r;e.collections.forEach(function(s){s.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+r.left,y:e.scroll.y+r.top}})})};if(typeof window>"u")return e.collections;yE(window,"resize",function(){k9(i)});var n=function(){e.scroll=U9()};return yE(window,"scroll",function(){k9(n)}),e.collections}Rr.prototype=new Hz;Rr.constructor=Rr;Rr.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(n){return i=n.get(e),!i}),i}};Rr.prototype.create=function(t){return this.createCollection(t)};Rr.prototype.createCollection=function(t){var e=this,i=new FGe(e,t);return e.bindCollection(i),e.collections.push(i),i};Rr.prototype.bindCollection=function(t){var e=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)};Rr.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};Rr.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Rr.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Rr.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e};Rr.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};Rr.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};Rr.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};Rr.prototype.onAny=function(t,e){var i=this,n,r="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=Tie(e);var s=function(a,l,c){c.ids.indexOf(l)>=0&&(c[r](a),a._found_=!0)},o=function(a){n=i.getIdentifier(a),MO(i.collections,s.bind(null,a,n)),a._found_||i.removeIdentifier(n)};return MO(e,o),!1};Rr.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};Rr.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};var NGe=Rr,G9=new NGe,kGe={create:function(t){return G9.create(t)},factory:G9},Bie=new Map,g1=new Map,dp=class{constructor(t,e,i,n){this.data=e;let{audio:r,volume:s,delay:o,loop:a}=e;if(!r)throw new Error("Missing property");let l=typeof r=="string"?n.getAudio(r).src:r.data;this.audioPlayer=new zx({src:l,volume:s,delay:o,loop:a}),g1.has(i.uuid)?g1.get(i.uuid).push(this):g1.set(i.uuid,[this]),Bie.set(t,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},CO=class{constructor(t){this.data=t}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(t){let e=Bie.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):e.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(t){let e=g1.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let t=[...g1.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},v1=class{constructor(t,e,i,n){if(this.data=e,e.interaction==="play")this.interaction=new dp(t,e,i,n);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new CO(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof dp?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof dp?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(t){this.interaction instanceof dp&&(t==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},zGe="text/plain",UGe="us-ascii",V9=(t,e)=>e.some(i=>i instanceof RegExp?i.test(t):i===t),GGe=(t,{stripHash:e})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!i)throw new Error(`Invalid URL: ${t}`);let{type:n,data:r,hash:s}=i.groups,o=n.split(";");s=e?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(h=>{let[u,d=""]=h.split("=").map(f=>f.trim());return u==="charset"&&(d=d.toLowerCase(),d===UGe)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return a&&c.push("base64"),(c.length>0||l&&l!==zGe)&&c.unshift(l),`data:${c.join(";")},${a?r.trim():r}${s?`#${s}`:""}`};function VGe(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return GGe(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=t.startsWith("//");!i&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let n=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&n.protocol==="https:"&&(n.protocol="http:"),e.forceHttps&&n.protocol==="http:"&&(n.protocol="https:"),e.stripAuthentication&&(n.username="",n.password=""),e.stripHash?n.hash="":e.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let c=s.exec(n.pathname);if(!c)break;let h=c[0],u=c.index,d=n.pathname.slice(o,u);a+=d.replace(/\/{2,}/g,"/"),a+=h,o=u+h.length}let l=n.pathname.slice(o,n.pathname.length);a+=l.replace(/\/{2,}/g,"/"),n.pathname=a}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=n.pathname.split("/"),o=s[s.length-1];V9(o,e.removeDirectoryIndex)&&(s=s.slice(0,-1),n.pathname=s.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...n.searchParams.keys()])V9(s,e.removeQueryParameters)&&n.searchParams.delete(s);if(e.removeQueryParameters===!0&&(n.search=""),e.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch{}}e.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let r=t;return t=n.toString(),!e.removeSingleSlash&&n.pathname==="/"&&!r.endsWith("/")&&n.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||n.pathname==="/")&&n.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),i&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var HGe=class{constructor({url:t,context:e},i){if(this.eventManager=i,!t)throw new Error("Missing property");this.url=t.startsWith("mailto:")?t:VGe(t,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=e??"tab"}dispatch(){var t;_ee?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(t=this.eventManager.controlsManager.orbitControls)==null||t.onPointerUp(It[0]),ZRe())}},Rie=class{constructor(t,e,i){this.data=t,this.page=e,this.eventManager=i,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=n=>{var a,l;this.timeoutIdQueue.shift();let r=this.page.scene.find(n);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,o=s?(a=r.dataPatched.physics)==null?void 0:a.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)o?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(o||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0))}else r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.eventManager.requestRender()},this.objects=[...t.objects],this.controlsManager=i.controlsManager}dispatch(t){this.clone=t,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t))}},jGe=class{constructor(t,e,i){this.page=t,this.eventManager=i,this.sharedAssets=e}dispatch(){var t;$z(this.page,this.sharedAssets,!0),this.eventManager.reset(),(t=this.eventManager.controlsManager.gameControl)==null||t.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender()}},Oie={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},jz={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},WGe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],xE={CSS:{},springs:{}};function _l(t,e,i){return Math.min(Math.max(t,e),i)}function y1(t,e){return t.indexOf(e)>-1}function lI(t,e){return t.apply(null,e)}var Bt={arr:function(t){return Array.isArray(t)},obj:function(t){return y1(Object.prototype.toString.call(t),"Object")},pth:function(t){return Bt.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return!("isNode"in t)&&(t.nodeType||Bt.svg(t))},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return Bt.hex(t)||Bt.rgb(t)||Bt.hsl(t)},key:function(t){return!Oie.hasOwnProperty(t)&&!jz.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function Fie(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(i){return parseFloat(i)}):[]}function Nie(t,e){var i=Fie(t),n=_l(Bt.und(i[0])?1:i[0],.1,100),r=_l(Bt.und(i[1])?100:i[1],.1,100),s=_l(Bt.und(i[2])?10:i[2],.1,100),o=_l(Bt.und(i[3])?0:i[3],.1,100),a=Math.sqrt(r/n),l=s/(2*Math.sqrt(r*n)),c=l<1?a*Math.sqrt(1-l*l):0,h=1,u=l<1?(l*a+-o)/c:-o+a;function d(p){var m=e?e*p/1e3:p;return l<1?m=Math.exp(-m*l*a)*(h*Math.cos(c*m)+u*Math.sin(c*m)):m=(h+u*m)*Math.exp(-m*a),p===0||p===1?p:1-m}function f(){var p=xE.springs[t];if(p)return p;for(var m=1/6,g=0,v=0;;)if(g+=m,d(g)===1){if(v++,v>=16)break}else v=0;var y=g*m*1e3;return xE.springs[t]=y,y}return e?d:f}function XGe(t){return t===void 0&&(t=10),function(e){return Math.ceil(_l(e,1e-6,1)*t)*(1/t)}}var qGe=function(){var t=11,e=1/(t-1);function i(h,u){return 1-3*u+3*h}function n(h,u){return 3*u-6*h}function r(h){return 3*h}function s(h,u,d){return((i(u,d)*h+n(u,d))*h+r(u))*h}function o(h,u,d){return 3*i(u,d)*h*h+2*n(u,d)*h+r(u)}function a(h,u,d,f,p){var m,g,v=0;do g=u+(d-u)/2,m=s(g,f,p)-h,m>0?d=g:u=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(h,u,d,f){for(var p=0;p<4;++p){var m=o(u,d,f);if(m===0)return u;var g=s(u,d,f)-h;u-=g/m}return u}function c(h,u,d,f){if(!(0<=h&&h<=1&&0<=d&&d<=1))return;var p=new Float32Array(t);if(h!==u||d!==f)for(var m=0;m<t;++m)p[m]=s(m*e,h,d);function g(v){for(var y=0,x=1,b=t-1;x!==b&&p[x]<=v;++x)y+=e;--x;var S=(v-p[x])/(p[x+1]-p[x]),A=y+S*e,E=o(A,h,d);return E>=.001?l(v,A,h,d):E===0?A:a(v,y,y+e,h,d)}return function(v){return h===u&&d===f||v===0||v===1?v:s(g(v),u,f)}}return c}(),kie=function(){var t={linear:function(){return function(n){return n}}},e={Sine:function(){return function(n){return 1-Math.cos(n*Math.PI/2)}},Circ:function(){return function(n){return 1-Math.sqrt(1-n*n)}},Back:function(){return function(n){return n*n*(3*n-2)}},Bounce:function(){return function(n){for(var r,s=4;n<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-n,2)}},Elastic:function(n,r){n===void 0&&(n=1),r===void 0&&(r=.5);var s=_l(n,1,10),o=_l(r,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(n,r){e[n]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(e).forEach(function(n){var r=e[n];t["easeIn"+n]=r,t["easeOut"+n]=function(s,o){return function(a){return 1-r(s,o)(1-a)}},t["easeInOut"+n]=function(s,o){return function(a){return a<.5?r(s,o)(a*2)/2:1-r(s,o)(a*-2+2)/2}}}),t}();function Wz(t,e){if(Bt.fnc(t))return t;var i=t.split("(")[0],n=kie[i],r=Fie(t);switch(i){case"spring":return Nie(t,e);case"cubicBezier":return lI(qGe,r);case"steps":return lI(XGe,r);default:return lI(n,r)}}function zie(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function NT(t,e){for(var i=t.length,n=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<i;s++)if(s in t){var o=t[s];e.call(n,o,s,t)&&r.push(o)}return r}function kT(t){return t.reduce(function(e,i){return e.concat(Bt.arr(i)?kT(i):i)},[])}function H9(t){return Bt.arr(t)?t:(Bt.str(t)&&(t=zie(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function Xz(t,e){return t.some(function(i){return i===e})}function qz(t){var e={};for(var i in t)e[i]=t[i];return e}function EO(t,e){var i=qz(t);for(var n in t)i[n]=e.hasOwnProperty(n)?e[n]:t[n];return i}function zT(t,e){var i=qz(t);for(var n in e)i[n]=Bt.und(t[n])?e[n]:t[n];return i}function YGe(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function QGe(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=t.replace(e,function(a,l,c,h){return l+l+c+c+h+h}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);return"rgba("+r+","+s+","+o+",1)"}function JGe(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),i=parseInt(e[1],10)/360,n=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100,s=e[4]||1;function o(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var a,l,c;if(n==0)a=l=c=r;else{var h=r<.5?r*(1+n):r+n-r*n,u=2*r-h;a=o(u,h,i+1/3),l=o(u,h,i),c=o(u,h,i-1/3)}return"rgba("+a*255+","+l*255+","+c*255+","+s+")"}function KGe(t){if(Bt.rgb(t))return YGe(t);if(Bt.hex(t))return QGe(t);if(Bt.hsl(t))return JGe(t)}function Gu(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function ZGe(t){if(y1(t,"translate")||t==="perspective")return"px";if(y1(t,"rotate")||y1(t,"skew"))return"deg"}function TO(t,e){return Bt.fnc(t)?t(e.target,e.id,e.total):t}function yc(t,e){return t.getAttribute(e)}function Yz(t,e,i){var n=Gu(e);if(Xz([i,"deg","rad","turn"],n))return e;var r=xE.CSS[e+i];if(!Bt.und(r))return r;var s=100,o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+i;var l=s/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(e);return xE.CSS[e+i]=c,c}function Uie(t,e,i){if(e in t.style){var n=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=t.style[e]||getComputedStyle(t).getPropertyValue(n)||"0";return i?Yz(t,r,i):r}}function Qz(t,e){if(Bt.dom(t)&&!Bt.inp(t)&&(yc(t,e)||Bt.svg(t)&&t[e]))return"attribute";if(Bt.dom(t)&&Xz(WGe,e))return"transform";if(Bt.dom(t)&&e!=="transform"&&Uie(t,e))return"css";if(t[e]!=null)return"object"}function Gie(t){if(Bt.dom(t)){for(var e=t.style.transform||"",i=/(\w+)\(([^)]*)\)/g,n=new Map,r;r=i.exec(e);)n.set(r[1],r[2]);return n}}function $Ge(t,e,i,n){var r=y1(e,"scale")?1:0+ZGe(e),s=Gie(t).get(e)||r;return i&&(i.transforms.list.set(e,s),i.transforms.last=e),n?Yz(t,s,n):s}function Jz(t,e,i,n){switch(Qz(t,e)){case"transform":return $Ge(t,e,n,i);case"css":return Uie(t,e,i);case"attribute":return yc(t,e);default:return t[e]||0}}function Kz(t,e){var i=/^(\*=|\+=|-=)/.exec(t);if(!i)return t;var n=Gu(t)||0,r=parseFloat(e),s=parseFloat(t.replace(i[0],""));switch(i[0][0]){case"+":return r+s+n;case"-":return r-s+n;case"*":return r*s+n}}function Vie(t,e){if(Bt.col(t))return KGe(t);if(/\s/g.test(t))return t;var i=Gu(t),n=i?t.substr(0,t.length-i.length):t;return e?n+e:n}function Zz(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function e5e(t){return Math.PI*2*yc(t,"r")}function t5e(t){return yc(t,"width")*2+yc(t,"height")*2}function i5e(t){return Zz({x:yc(t,"x1"),y:yc(t,"y1")},{x:yc(t,"x2"),y:yc(t,"y2")})}function Hie(t){for(var e=t.points,i=0,n,r=0;r<e.numberOfItems;r++){var s=e.getItem(r);r>0&&(i+=Zz(n,s)),n=s}return i}function n5e(t){var e=t.points;return Hie(t)+Zz(e.getItem(e.numberOfItems-1),e.getItem(0))}function jie(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return e5e(t);case"rect":return t5e(t);case"line":return i5e(t);case"polyline":return Hie(t);case"polygon":return n5e(t)}}function r5e(t){var e=jie(t);return t.setAttribute("stroke-dasharray",e),e}function s5e(t){for(var e=t.parentNode;Bt.svg(e)&&Bt.svg(e.parentNode);)e=e.parentNode;return e}function Wie(t,e){var i=e||{},n=i.el||s5e(t),r=n.getBoundingClientRect(),s=yc(n,"viewBox"),o=r.width,a=r.height,l=i.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function o5e(t,e){var i=Bt.str(t)?zie(t)[0]:t,n=e||100;return function(r){return{property:r,el:i,svg:Wie(i),totalLength:jie(i)*(n/100)}}}function a5e(t,e){function i(a){a===void 0&&(a=0);var l=e+a>=1?e+a:0;return t.el.getPointAtLength(l)}var n=Wie(t.el,t.svg),r=i(),s=i(-1),o=i(1);switch(t.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function j9(t,e){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=Vie(Bt.pth(t)?t.totalLength:t,e)+"";return{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:Bt.str(t)||e?n.split(i):[]}}function Xie(t){var e=t?kT(Bt.arr(t)?t.map(H9):H9(t)):[];return NT(e,function(i,n,r){return r.indexOf(i)===n})}function qie(t){var e=Xie(t);return e.map(function(i,n){return{target:i,id:n,total:e.length,transforms:{list:Gie(i)}}})}function l5e(t,e){var i=qz(e);if(/^spring/.test(i.easing)&&(i.duration=Nie(i.easing)),Bt.arr(t)){var n=t.length,r=n===2&&!Bt.obj(t[0]);r?t={value:t}:Bt.fnc(e.duration)||(i.duration=e.duration/n)}var s=Bt.arr(t)?t:[t];return s.map(function(o,a){var l=Bt.obj(o)&&!Bt.pth(o)?o:{value:o};return Bt.und(l.delay)&&(l.delay=a?0:e.delay),Bt.und(l.endDelay)&&(l.endDelay=a===s.length-1?e.endDelay:0),l}).map(function(o){return zT(o,i)})}function c5e(t){for(var e=NT(kT(t.map(function(s){return Object.keys(s)})),function(s){return Bt.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),i={},n=function(s){var o=e[s];i[o]=t.map(function(a){var l={};for(var c in a)Bt.key(c)?c==o&&(l.value=a[c]):l[c]=a[c];return l})},r=0;r<e.length;r++)n(r);return i}function u5e(t,e){var i=[],n=e.keyframes;n&&(e=zT(c5e(n),e));for(var r in e)Bt.key(r)&&i.push({name:r,tweens:l5e(e[r],t)});return i}function h5e(t,e){var i={};for(var n in t){var r=TO(t[n],e);Bt.arr(r)&&(r=r.map(function(s){return TO(s,e)}),r.length===1&&(r=r[0])),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function d5e(t,e){var i;return t.tweens.map(function(n){var r=h5e(n,e),s=r.value,o=Bt.arr(s)?s[1]:s,a=Gu(o),l=Jz(e.target,t.name,a,e),c=i?i.to.original:l,h=Bt.arr(s)?s[0]:c,u=Gu(h)||Gu(l),d=a||u;return Bt.und(o)&&(o=c),r.from=j9(h,d),r.to=j9(Kz(o,h),d),r.start=i?i.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=Wz(r.easing,r.duration),r.isPath=Bt.pth(s),r.isColor=Bt.col(r.from.original),r.isColor&&(r.round=1),i=r,r})}var Yie={css:function(t,e,i){return t.style[e]=i},attribute:function(t,e,i){return t.setAttribute(e,i)},object:function(t,e,i){return t[e]=i},transform:function(t,e,i,n,r){if(n.list.set(e,i),e===n.last||r){var s="";n.list.forEach(function(o,a){s+=a+"("+o+") "}),t.style.transform=s}}};function Qie(t,e){var i=qie(t);i.forEach(function(n){for(var r in e){var s=TO(e[r],n),o=n.target,a=Gu(s),l=Jz(o,r,a,n),c=a||Gu(l),h=Kz(Vie(s,c),l),u=Qz(o,r);Yie[u](o,r,h,n.transforms,!0)}})}function f5e(t,e){var i=Qz(t.target,e.name);if(i){var n=d5e(e,t),r=n[n.length-1];return{type:i,property:e.name,animatable:t,tweens:n,duration:r.end,delay:n[0].delay,endDelay:r.endDelay}}}function p5e(t,e){return NT(kT(t.map(function(i){return e.map(function(n){return f5e(i,n)})})),function(i){return!Bt.und(i)})}function Jie(t,e){var i=t.length,n=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=i?Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+l+s.duration*(s.loop??1)})):e.duration,r.delay=i?Math.min.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return n(s)+o+a+s.delay})):e.delay,r.endDelay=i?r.duration-Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):e.endDelay,r}var W9=0;function m5e(t){var e=EO(Oie,t),i=EO(jz,t),n=u5e(i,t),r=qie(t.targets),s=p5e(r,n),o=Jie(s,i),a=W9;return W9++,zT(e,{id:a,children:[],animatables:r,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var ka=[],X9=[],LM,g5e=function(){function t(){LM=requestAnimationFrame(e)}function e(i){var n=ka.length;if(n){for(var r=0;r<n;){var s=ka[r];s.paused?(ka.splice(r,1),n-=1):(s.tick(i),r++)}t()}else LM=cancelAnimationFrame(LM)}return t}();function v5e(t){document.hidden?(ka.forEach(function(e){return e.pause(t.timeStamp)}),X9=ka.slice(0),zn.running=ka=[]):X9.forEach(function(e){return e.play(t.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",v5e);function zn(t){t===void 0&&(t={});var e=0,i=0,n=0,r,s,o=0,a=null;function l(A){var E=window.Promise&&new Promise(function(M){return a=M});return A.finished=E,E}var c=m5e(t);l(c);function h(){var A=c.direction;A!=="alternate"&&(c.direction=A!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(E){(E.loop===1||E.loop%2===0)&&(E.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(A){return A.reversed=!1})}function d(A){return c.reversed?c.duration-A:A}function f(){e=0,i=d(c.currentTime)*(1/zn.speed)}function p(A,E,M=!1){E&&(c.reversed?E.seek(E.duration*E.loop-(A-E.timelineOffset-E.pingPongDelayCorrection),M):E.seek(A-E.timelineOffset-E.startOnceDelay-E.pingPongDelayCorrection,M))}function m(A,E=!1){if(c.reversed)for(var M=o;M--;)p(A,s[M],E);else for(var T=0;T<o;T++)p(A,s[T],E)}function g(A){var ve,de,pe,ce,ye,ae,le,Ee,Te,Be;var E=0,M=c.animations,T=M.length;for(c.direction!=="alternate"&&((ve=c.parent)==null?void 0:ve.direction)==="alternate"?((de=c.parent)==null?void 0:de.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((pe=c.parent)!=null&&pe.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A):b(!1,(ce=c.parent)==null?void 0:ce.rewind,c.rewind,(ye=c.parent)==null?void 0:ye.reversePlayback,c.reversePlayback)&&((ae=c.parent)!=null&&ae.reversed&&c.direction==="alternate"?A=c.duration-c.delay+c.endDelay-A:A=c.duration+c.delay-c.endDelay-A);E<T;){var P=M[E],I=P.animatable,k=P.tweens,R=k.length-1,F=k[R];R&&(F=NT(k,function(Ie){return A<Ie.end})[0]||F);let Ue;(le=c.parent)!=null&&le.reversed&&c.direction==="alternate"?Ue=_l(A-F.start-F.endDelay,0,F.duration)/F.duration:Ue=_l(A-F.start-F.delay,0,F.duration)/F.duration;for(var V=isNaN(Ue)?1:F.easing(Ue),Q=F.to.strings,X=F.round,z=[],Y=F.to.numbers.length,j=void 0,J=0;J<Y;J++){var H=void 0;let Ie,Pe;c.direction!=="alternate"?((Ee=c.parent)==null?void 0:Ee.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ie=F.to.numbers[J],Pe=F.from.numbers[J]||0):(Pe=F.to.numbers[J],Ie=F.from.numbers[J]||0):b(!0,(Te=c.parent)==null?void 0:Te.rewind,c.rewind,(Be=c.parent)==null?void 0:Be.reversePlayback,c.reversePlayback)?(Ie=F.to.numbers[J],Pe=F.from.numbers[J]||0):(Pe=F.to.numbers[J],Ie=F.from.numbers[J]||0),F.isPath?H=a5e(F.value,V*Pe):H=Ie+V*(Pe-Ie),X&&(F.isColor&&J>2||(H=Math.round(H*X)/X)),z.push(H)}var Z=Q.length;if(!Z)j=z[0];else{j=Q[0];for(var K=0;K<Z;K++){Q[K];var ne=Q[K+1],W=z[K];isNaN(W)||(ne?j+=W+ne:j+=W+" ")}}Yie[P.type](I.target,P.property,j,I.transforms),P.currentValue=j,E++}}function v(A){c[A]&&!c.passThrough&&c[A](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(A,E,M,T,P){return x[A<<4|E<<3|M<<2|T<<1|P]}function S(A,E=!1){var k;var M=c.duration;let T=c.delay,P=M-c.endDelay;(k=c.parent)!=null&&k.reversed&&c.direction==="alternate"&&(T=c.endDelay,P=M-c.delay);var I=d(A);if(c.progress=_l(I/M*100,0,100),E||(c.reversePlayback=I<c.currentTime),o&&m(I,E),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||I>=0)&&I<=T&&c.currentTime!==0&&(g(0),v("change")),(I>=P&&c.currentTime!==M+c.pingPongDelayCorrection||!M)&&(g(M),v("change")),I>T&&I<P?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),g(I),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),o&&v("timelineChangeComplete")):c.began&&I>P&&v("changeComplete"),c.currentTime=_l(I,0,M+c.pingPongDelayCorrection),c.began&&v("update"),A>=M)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(a(),l(c)));else{o?e+=c.duration/zn.speed:e+=c.duration;for(let R of s)R.setStartTime(0),R.remaining=R.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?h():o&&u()}}return c.reset=function(){var A=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=A==="reverse",c.remaining=c.loop,s=c.children,o=s.length;for(var E=o;E--;)c.children[E].reset();(c.reversed&&c.loop!==!0||A==="alternate"&&c.loop===1)&&c.remaining++,g(c.reversed?c.duration:0)},c.setStartTime=function(A){e=A},c.set=function(A,E){return Qie(A,E),c},c.tick=function(A){n=A,e||(e=n),S((n+(i-e))*zn.speed)},c.seek=function(A,E=!1){S(A-e,E)},c.pause=function(A){c.paused=!0,o&&(r=A??performance.now())},c.play=function(A){!c.paused||(c.completed&&c.reset(),c.paused=!1,ka.push(c),o&&r!==void 0&&(e+=(A??performance.now())-r),LM||g5e())},c.reverse=function(){h(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function q9(t,e){for(var i=e.length;i--;)Xz(t,e[i].animatable.target)&&e.splice(i,1)}function y5e(t){for(var e=Xie(t),i=ka.length;i--;){var n=ka[i],r=n.animations,s=n.children;q9(e,r);for(var o=s.length;o--;){var a=s[o],l=a.animations;q9(e,l),!l.length&&!a.children.length&&s.splice(o,1)}!r.length&&!s.length&&n.pause()}}function x5e(t,e){e===void 0&&(e={});var i=e.direction||"normal",n=e.easing?Wz(e.easing):null,r=e.grid,s=e.axis,o=e.from||0,a=o==="first",l=o==="center",c=o==="last",h=Bt.arr(t),u=parseFloat(h?t[0]:t),d=h?parseFloat(t[1]):0,f=Gu(h?t[1]:t)||0,p=e.start||0+(h?u:0),m=[],g=0;return function(v,y,x){if(a&&(o=0),l&&(o=(x-1)/2),c&&(o=x-1),!m.length){for(var b=0;b<x;b++){if(!r)m.push(Math.abs(o-b));else{var S=l?(r[0]-1)/2:o%r[0],A=l?(r[1]-1)/2:Math.floor(o/r[0]),E=b%r[0],M=Math.floor(b/r[0]),T=S-E,P=A-M,I=Math.sqrt(T*T+P*P);s==="x"&&(I=-T),s==="y"&&(I=-P),m.push(I)}g=Math.max.apply(Math,m)}n&&(m=m.map(function(R){return n(R/g)*g})),i==="reverse"&&(m=m.map(function(R){return s?R<0?R*-1:-R:Math.abs(g-R)}))}var k=h?(d-u)/g:u;return p+k*(Math.round(m[y]*100)/100)+f}}function _5e(t){t===void 0&&(t={});var e=zn(t);return e.duration=0,e.add=function(i,n){var r=ka.indexOf(e),s=e.children;r>-1&&ka.splice(r,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=zT(i,EO(jz,t));l.targets=l.targets||t.targets;var c=e.duration;l.autoplay=!1,l.timelineOffset=Bt.und(n)?c:Kz(n,c),o(e);var h=zn(l);o(h),s.push(h),h.parent=e;var u=Jie(s,t);return e.delay=u.delay,e.endDelay=u.endDelay,e.duration=u.duration,h.loop===!0&&(e.duration=1/0),e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}zn.version="3.2.0";zn.speed=1;zn.running=ka;zn.remove=y5e;zn.get=Jz;zn.set=Qie;zn.convertPx=Yz;zn.path=o5e;zn.setDashoffset=r5e;zn.stagger=x5e;zn.timeline=_5e;zn.easing=Wz;zn.penner=kie;zn.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var Kie=zn,Y9=new O,Q9=new O,J9=new qt;function w5e(t,e,i,n){if(n===0)return i.copy(t);if(n===1)return i.copy(e);let r=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(r>=1)return i.copy(t);let s=1-r*r;if(s<=Number.EPSILON){let h=1-n;return i.w=h*t.w+n*e.w,i.x=h*t.x+n*e.x,i.y=h*t.y+n*e.y,i.z=h*t.z+n*e.z,i.normalize(),i}let o=Math.sqrt(s),a=Math.atan2(o,r),l=Math.sin((1-n)*a)/o,c=Math.sin(n*a)/o;return i.w=t.w*l+e.w*c,i.x=t.x*l+e.x*c,i.y=t.y*l+e.y*c,i.z=t.z*l+e.z*c,i}function Jp(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(o==null)return;let a=s??e[t],l=o;if(a!==l)return{update:c=>{let h=ri.lerp(a,l,c);r?e[t]=Math.trunc(h):e[t]=h},start:()=>{e[t]=a},end:()=>{e[t]=l}}}function Zie(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(!o)return;let a=e[t],l=[...s??a],c=[...o];if(!(l.length!==c.length||sz(l,c)))return{update:h=>{l.forEach((u,d)=>{let f=ri.lerp(u,c[d],h);e[t][d]=r?Math.trunc(f):f})},start:()=>{Object.assign(e[t],l)},end:()=>{Object.assign(e[t],c)}}}function K9(t,e,i,n){let r=i[t]?i[t]:void 0,s=n[t];if(!s)return;let o=e[t],a=r?new O().fromArray(r):o.clone(),l=new O().fromArray(s);if(!a.equals(l))return{update:c=>{o.lerpVectors(a,l,c)},start:()=>{o.copy(a)},end:()=>{o.copy(l)}}}function b5e(t,e,i,n){let r=i[t]?i[t]:void 0,s=n[t];if(!s)return;let o=e[t],a=r?new Qe().fromArray(r):o.clone(),l=new O,c=new qt,h=new O;a.decompose(l,c,h);let u=new Qe().fromArray(s),d=new O,f=new qt,p=new O;if(u.decompose(d,f,p),!a.equals(u))return{update:m=>{J9.slerpQuaternions(c,f,m),Y9.lerpVectors(l,d,m),Q9.lerpVectors(h,p,m),o.compose(Y9,J9,Q9)},start:()=>{o.compose(l,c,h)},end:()=>{o.compose(d,f,p)}}}function S5e(t,e,i,n,r){let s=i[t]?i[t]:void 0,o=n[t];if(!o)return;let a=e[t],l=s?typeof s=="string"?r.getColor(s).clone():new Tt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Tt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return e[t]=h,{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function Zd(t,e,i,n){if(typeof e[t]=="number")return Jp(t,e,i??{},n);if(Array.isArray(e[t]))return Zie(t,e,i??{},n)}function A5e(t,e,i){var o,a,l,c;let n=[],r=t.cameraType==="OrthographicCamera"?(o=e.orthographic)==null?void 0:o.zoom:(a=e.perspective)==null?void 0:a.zoom,s=t.cameraType==="OrthographicCamera"?(l=i.orthographic)==null?void 0:l.zoom:(c=i.perspective)==null?void 0:c.zoom;if(s!==void 0){let h=r??t.zoom,u=s;h!==u&&n.push({update:d=>{t.zoom=ri.lerp(h,u,d),t.updateProjectionMatrix()},start:()=>{t.zoom=h,t.updateProjectionMatrix()},end:()=>{t.zoom=u,t.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let h=Jp("targetOffset",t,e,i);h&&n.push(h)}return n}function M5e(t,e,i,n){if(i.scaleBaked===void 0)return;let r=e.scaleBaked??t.data.geometry.scaleBaked,s=i.scaleBaked;if(Dp.isEqual(r,s))return;let o=[];return o.push({update:a=>{t.updateGeometryInteractions({scaleBaked:[ri.lerp(r[0],s[0],a),ri.lerp(r[1],s[1],a),ri.lerp(r[2],s[2],a)]},n),t.invalidateDownstreamBooleanData()},start:()=>{t.updateGeometryInteractions({scaleBaked:r},n),t.invalidateDownstreamBooleanData()},end:()=>{t.updateGeometryInteractions({scaleBaked:s},n),t.invalidateDownstreamBooleanData()}}),o}function C5e(t,e,i){if(!i.extrusion)return;let n=t.extrusion,r=e.extrusion??{},s=i.extrusion,o=[];return ite.forEach(a=>{let l=Zd(a,n,r,s);l&&o.push(l)}),o}function E5e(t,e,i,n){let r=[];if(!("geometry"in i))return r;let s=t.geometry.userData.parameters,o="geometry"in e?e.geometry:{},a=i.geometry;if(t instanceof T_){let l=M5e(t,o,a,n);l&&r.push(...l)}else{let l={};if(Object.assign(l,zu(s,n8)),n8.forEach(c=>{let h=Zd(c,l,o,a);h&&r.push(h)}),t instanceof kz){Object.assign(l,{extrusion:{...s.extrusion}});let c=C5e(l,o,a);c&&r.push(...c)}r.length&&r.push({update:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()},start:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()},end:c=>{t.updateGeometryInteractions(l,n),t.updateGeometryGroupsIfNeeded()}})}return r}function T5e(t,e,i,n){let r=[];if(i.intensity!==void 0){let s=Jp("intensity",t,e,i);s&&r.push(s)}if(i.color!==void 0){let s=S5e("color",t,e,i,n);s&&r.push(s)}return r}function P5e(t,e,i,n){let r=[];if(Array.isArray(t.material)){if(!("materials"in i&&i.materials))return r;let s="materials"in e&&e.materials?e.materials:[],o=i.materials;t.material.forEach((a,l)=>{if(!o[l])return;let c=s[l]??{},h=o[l];typeof c=="string"||typeof h=="string"||r.push(...Z9(a,c,h,n))})}else{if(!("material"in i&&i.material))return r;let s="material"in e&&e.material?e.material:{},o=i.material;if(typeof s=="string"||typeof o=="string")return r;r.push(...Z9(t.material,s,o,n))}return r}function Z9(t,e,i,n){var o;let r=[],s=pE(i,n)||!!e.layers&&pE(e,n);r.push(k5e(t,s));for(let a of t.layers){let l=(o=e.layers)==null?void 0:o.data(a.uuid),c=i.layers.data(a.uuid);if(!c||!(a.visible??!0)||!(c.visible??!0))continue;let h=a.getNames().filter(u=>!$ee.some(d=>u.includes(d)));for(let u of h)try{let d=a.getValue(u),f;if(u==="colors")f=F5e(a,l,c,u);else if(Array.isArray(d))u==="steps"&&(f=O5e(a,l,c,u));else if(typeof d=="number")f=D5e(a,l,c,u);else{if(typeof d=="boolean")continue;d instanceof ge?f=I5e(a,l,c,u):d instanceof O?f=L5e(a,l,c,u):d instanceof ho?f=R5e(a,l,c,u,n):d instanceof Tt?f=B5e(a,l,c,u,n):"isTexture"in d&&(f=N5e(a,l,c,u))}f&&(Array.isArray(f)?r.push(...f):r.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return r}function D5e(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=e?e[n]:t.getValue(n),s=i[n];if(r!==s)return{update:o=>{t.setValue(n,ri.lerp(r,s,o))},start:()=>{t.setValue(n,r)},end:()=>{t.setValue(n,s)}}}function I5e(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=t.getValue(n),s=e?new ge().fromArray(e[n]):r.clone(),o=new ge().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function L5e(t,e,i,n){if(!t.hasValue(n)||!(n in i))return;let r=t.getValue(n),s=e?new O().fromArray(e[n]):r.clone(),o=new O().fromArray(i[n]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function B5e(t,e,i,n,r){if(!t.hasValue(n)||!(n in i))return;let s=e?e[n]:void 0,o=i[n],a=t.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new Tt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Tt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return{update:u=>{t.getValue(n)!==h&&t.setValue(n,h),h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function R5e(t,e,i,n,r){if(!t.hasValue(n)||!(n in i))return;let s=e?e[n]:void 0,o=i[n],a=t.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new Tt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new ho(o.r,o.g,o.b,o.a);if(l.equals(c))return;let h=a.clone();return{update:u=>{t.getValue(n)!==h&&t.setValue(n,h),h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function O5e(t,e,i,n="steps"){if(!t.hasValue(n)||!(n in i))return;let r=[],s=t.getValue(n),o=e?e[n]:s,a=i[n];for(let l=0;l<s.length;++l){let c=o[l],h=a[l];c!==h&&r.push({update:u=>{s[l]=ri.lerp(c,h,u)},start:()=>{s[l]=c},end:()=>{s[l]=h}})}return r.length?r:void 0}function F5e(t,e,i,n="colors"){if(!t.hasValue(n)||!(n in i))return;let r=[],s=t.getValue(n),o=e?e[n]:s.map(l=>l.toArray()),a=i[n];for(let l=0;l<s.length;++l){let c=[...o[l]],h=[...a[l]];$C.isEqual(c,h)||r.push({update:u=>{s[l].fromArray($C.lerp(c,h,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(h)}})}return r.length?r:void 0}function N5e(t,e,i,n="texture"){if(!t.hasValue(n)||!(n in i))return;let r=t.getNode("mat");if(!r)return;let s=e?e[n]:r,o=i[n],a=[...s.repeat],l=[...s.offset],c=[...o.repeat],h=[...o.offset];if(!rv.isEqual(a,c)||!rv.isEqual(l,h))return{update:u=>{r.repeat=rv.lerp(a,c,u),r.offset=rv.lerp(l,h,u),r.updateMatrix()},start:()=>{r.repeat=[...a],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...h],r.updateMatrix()}}}function k5e(t,e){return{update:()=>{t.transparent=e}}}var cI=new O,$9=new Er;function z5e(t,e,i,n){let r=[],s,o,a,l,c,h,u={slide:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).slide,offset:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).offset};if(c=Jp("slide",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping),c&&r.push(c),h=Jp("offset",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping),h&&r.push(h),!c&&!h&&(s=K9("position",t,e,i),s&&r.push(s),o=K9("scale",t,e,i),o&&r.push(o),a=U5e(t,e,i,n),a&&r.push(a),l=b5e("hiddenMatrix",t,e,i),l&&r.push(l)),s||o||a||l||c||h){let d=()=>{var f;t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),(f=t.parent)!=null&&f.matrixWorldFusedFalse&&(t.matrixWorld.multiplyMatrices(t.parent.matrixWorldFusedFalse,t.matrix),t.matrixWorldNeedsUpdate=!1),pl(t)&&Bu(t.parent)&&t.invalidateDownstreamBooleanData(!0),t.updatePathSnapping(Object.assign({},e.pathSnapping,u))};r.push({update:d,start:d,end:d})}return r}function U5e(t,e,i,n){let r=e!=null&&e.rotation?e.rotation:void 0,s=i.rotation;if(!s)return;let o=r?new O().fromArray(r):new O().setFromEuler(t.rotation),a=new O().fromArray(s);if(o.equals(a))return;let l=cI.subVectors(a,o);if(n&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new qt().setFromEuler($9.setFromVector3(o)),h=new qt().setFromEuler($9.setFromVector3(a));return{update:u=>{w5e(c,h,t.quaternion,u)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}else return{update:c=>{cI.lerpVectors(o,a,c),t.rotation.setFromVector3(cI)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}function G5e(t,e,i){let n=[];if(!("cloner"in i)||!t.cloner)return n;let r=t.cloner,s="cloner"in e?e.cloner:{},o=i.cloner;qee.forEach(d=>{let f;d==="count"?f=Jp("count",r.parameters,s,o,!0):f=Zd(d,r.parameters,s??{},o),f&&n.push(f)});let a=V5e(r,s,o);a!=null&&a.length&&n.push(...a);let l=H5e(r,s,o);l!=null&&l.length&&n.push(...l);let c=j5e(r,s,o);c!=null&&c.length&&n.push(...c);let h=W5e(r,s,o);h!=null&&h.length&&n.push(...h);let u=X5e(r,s,o);return u!=null&&u.length&&n.push(...u),n.length&&n.push({update:()=>{r.update()}}),n}function V5e(t,e,i){if(t.parameters.type!=="radial")return;let n=e.radial,r=i.radial;if(!r)return;let s=t.parameters.radial,o=[];return Yee.forEach(a=>{let l=Zd(a,s,n??{},r);l&&o.push(l)}),o}function H5e(t,e,i){if(t.parameters.type!=="linear")return;let n=e.linear,r=i.linear;if(!r)return;let s=[],o=t.parameters.linear;return Qee.forEach(a=>{let l=Zd(a,o,n??{},r);l&&s.push(l)}),s}function j5e(t,e,i){if(t.parameters.type!=="grid")return;let n=e.grid,r=i.grid;if(!r)return;let s=[],o=t.parameters.grid;return Jee.forEach(a=>{let l;a==="count"?l=Zie(a,o,n??{},r,!0):l=Zd(a,o,n??{},r),l&&s.push(l)}),s}function W5e(t,e,i){if(t.parameters.type!=="toObject")return;let n=e.toObject,r=i.toObject;if(!r)return;let s=[],o=t.parameters.toObject;return Kee.forEach(a=>{let l;a==="count"?l=Jp(a,o,n??{},r,!0):l=Zd(a,o,n??{},r),l&&s.push(l)}),s}function X5e(t,e,i){if(!t.parameters.randomness)return;let n=e.randomnessObject,r=i.randomnessObject;if(!r)return;let s=[],o=t.parameters.randomnessObject;return Zee.forEach(a=>{let l=Zd(a,o,n??{},r);l&&s.push(l)}),s}function e7(t,e,i,n,r){let s=[];return t.data.visible&&s.push(...z5e(t,e,i,r)),t.data.visible&&s.push(...G5e(t,e,i)),pl(t)?(t instanceof fo&&t.data.visible&&s.push(...E5e(t,e,i,n)),t.data.visible&&s.push(...P5e(t,e,i,n))):aUe(t)?t.data.visible&&s.push(...T5e(t,e,i,n)):oUe(t)&&s.push(...A5e(t,e,i)),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var t7=new O;function $z(t,e,i=!1){let n=[];t.traverseChildren(r=>{var l,c,h,u,d;if(i&&((l=r.rigidBody)==null||l.setTranslation(r.position0,!0),(c=r.rigidBody)==null||c.setRotation(r.rotation0,!0),(h=r.rigidBody)==null||h.setLinvel(t7,!0),(u=r.rigidBody)==null||u.setAngvel(t7,!0)),!fi.is(r))return;let s=r.uuid,o=r.data;if(delete r.states,r.uuid===W0)return;let a=!1;n.some(f=>{var p;return(p=t.scene.find(s))==null?void 0:p.isDescendantOf(f)})?a=!0:((d=o.physics)==null?void 0:d.fusedBody)===!0&&o.physics.rigidBody==="dynamic"&&n.push(s),r.data=o,r.currentState=null,r.reversibleToState=null,r.currentTransitionEvent=null;for(let f of o.states){let p={...f.data};t.data.globalPhysics.usePhysics===!0&&o.physics&&(o.physics.rigidBody==="dynamic"||a)&&(f.data.position!==void 0&&delete p.position,f.data.rotation!==void 0&&delete p.rotation,f.data.hiddenMatrix!==void 0&&delete p.hiddenMatrix),r.states||(r.states={}),r.states[f.id]=cp.patch(o,p)}Y5e(t.scene,r,null,e,o.events.find(f=>f.data.type==="Follow"||f.data.type==="LookAt")!==void 0),q5e(t)})}function q5e(t){t.traverseEntity(e=>{for(let i of e.data.events){let n=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":n.push(...i.data.actions);break;case"GameControl":for(let r of Object.values(i.data.gameActions))n.push(...r);break;case"DragDrop":n.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":n.push(...i.data.inActions,...i.data.outActions);break}for(let r of n)if(r.data.type==="Create"&&r.data.hideBase==="Yes"){let s=t.scene.find(r.data.object);s&&(s.visible=!1)}}})}function Y5e(t,e,i,n,r=!1){if(e instanceof fo&&e.removeInteractionGeometry(),e.changeSelectedState(i,{scene:t,shared:n},r),e instanceof fo&&e.updateGeometryGroupsIfNeeded(),e instanceof Rs&&e.updateCameraState(e.dataPatched,{scene:t,shared:n}),e.cloner)for(let s of e.cloner.children)s.playModeVisible=void 0;e.updateVisible()}function $ie(t){let e;if(t.easing===5){let{control1:i,control2:n}=t;e=`cubicBezier(
			${i[0]}, ${i[1]}, ${n[0]}, ${n[1]}
		)`}else if(t.easing===6){let{mass:i,stiffness:n,damping:r,velocity:s}=t;e=`spring( ${i}, ${n}, ${r}, ${s} )`}else{let i;switch(t.easing){case 0:i=Gh.linear;break;case 1:i=Gh.ease;break;case 2:i=Gh.easeIn;break;case 3:i=Gh.easeOut;break;case 4:i=Gh.easeInOut;break;default:i=Gh.linear}let[n,r,s,o]=i;e=`cubicBezier( ${n}, ${r}, ${s}, ${o} )`}return{duration:t.duration,easing:e}}function ene(t){let e={delay:0,loop:t.repeat===-1?!0:t.repeat+1};if(t.repeat===0)e.direction="normal",e.rewind=!1;else switch(t.direction){case"pingpong":e.direction="alternate",e.rewind=!1;break;case"pingpong-rewind":e.direction="alternate",e.rewind=!0;break;default:e.direction="normal",e.rewind=!1;break}switch(e.delay=0,e.endDelay=0,e.startOnceDelay=0,e.pingPongDelayCorrection=0,e.pingPongEndDelayCorrection=0,t.delayDirection){case"start-once":e.startOnceDelay=t.delay;break;case"start":e.delay=t.delay;break;case"end":e.endDelay=t.delay;break;case"start-end":case void 0:e.delay=t.delay,e.endDelay=t.delay;break}return e.direction==="alternate"&&(e.delay/=2,e.endDelay/=2,t.delayDirection==="start"?(e.pingPongDelayCorrection=e.delay,typeof e.loop=="number"&&e.loop%2===0&&(e.pingPongEndDelayCorrection=e.delay)):t.delayDirection==="end"?typeof e.loop=="number"&&e.loop%2!==0&&(e.pingPongEndDelayCorrection=e.endDelay):t.delayDirection==="start-end"&&(e.pingPongDelayCorrection=e.delay,e.pingPongEndDelayCorrection=e.endDelay)),e}var Q5e={type:"beginState"},J5e={type:"completeState",isfromEntity:!1},i7=class{constructor(t,e,i,n,r,s){if(this.object=t,this.data=n,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Rs&&a.dispatchEvent(Q5e)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Rs&&a.dispatchEvent(J5e)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=e7(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},e===void 0){let o=BM(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=BM(this.object,e);if(!o)throw new Error("Missing property");this.from=o}if(i===void 0)throw new Error("Missing property");{let o=BM(this.object,i);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=e===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...ene(n),...$ie(n),change:this.onChange},this.callback=e7(this.object,e===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},x1=class extends qr{constructor(t,e,i){if(super(),this.data=t,this.page=e,this.sharedAssets=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let n=this.page.scene.find(t.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(t=>t.changeBegan)??!1}init(){this.initialCurrentState=BM(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:t=!0,isRebuild:e=!1}={}){var i,n,r,s;try{let o=ene(this.data.tweens[0].data),a=o.loop;e&&typeof o.loop=="number"&&o.loop--,(i=this.timeline)==null||i.pause(),this.timeline=Kie.timeline({autoplay:!1,...o,...a===!0||a>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(a===!0||a>1),o.pingPongDelayCorrection&&e===!1&&(this.timelineNeedsRebuild=!0),t){let c=l===-1?0:l;for(let h=c;h<this.data.tweens.length-1;h++){let u=this.data.tweens[h],d=this.data.tweens[h+1],f;h===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(f=void 0,this.object instanceof Rs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new i7(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.delay:0)+(h===c&&!e?o.pingPongDelayCorrection:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let h=c;h>0;h--){let u=this.data.tweens[h],d=this.data.tweens[h-1],f;h===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(f=void 0,this.object instanceof Rs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new i7(this.object,f,d.data.state===void 0?this.currentState:d.data.state,u.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h-1]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.endDelay:0))}this.timeline.duration+=o.delay+(e?0:o.pingPongDelayCorrection)}}catch(o){o instanceof Error&&console.error(o.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay)}pause(){var t;(t=this.timeline)==null||t.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let t=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(t,{scene:this.page.scene,shared:this.sharedAssets}),this.object.currentState=t}seek(t){var e;this.timeline===void 0&&this.buildTimeline(),(e=this.timeline)==null||e.seek(t*this.timeline.duration,!0)}toggle(t){var e;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.timeline)==null||e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function BM(t,e){var r;let i,n;if(typeof e=="string"?(i=e,n=(r=t.states)==null?void 0:r[i]):e===null&&(i=null,n=t.data),!(i===void 0||n===void 0))return{id:i,data:n}}var K5e={type:"beginState"},n7={type:"completeState",isfromEntity:!1},r7={type:"requestRender"},tne=class extends qr{constructor(t,e){super(),this.data=t,this.page=e,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new O,this.posEnd=new O,this.qStart=new qt,this.qEnd=new qt,this.zoomStart=1,this.zoomEnd=1,this.toCamera=this.page.scene.find(t.targetCamera)}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(t=!1){if(!this.data.animate)return;let e={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Kie({targets:e,t:1,...$ie(this.data),update:()=>{e.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera)):(this.posEnd.copy(this.toCamera.position),this.qEnd.copy(this.toCamera.quaternion),this.zoomEnd=this.toCamera.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(this.toCamera)),this.page.activeCamera.dispatchEvent(K5e));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,e.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,e.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*e.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(r7),e.t===1&&i.dispatchEvent(n7)}})}switchCamera(t){this.page.switchActiveCamera(t),this.page.activeCamera.dispatchEvent({type:"cameraChange",camera:t})}play(){this.playing||this.page.activeCamera!==this.toCamera&&(clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;delete this.timeoutId;try{this.data.animate?(this.buildAnimation(),(t=this.animation)==null||t.play()):this.switchCamera(this.toCamera)}catch(e){e instanceof Error&&console.error(e.message)}},this.data.delay*1e3))}pause(){var t;(t=this.animation)==null||t.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(t){var e,i;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.animation)==null||e.pause(),this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var n,r;delete this.timeoutId,this.data.animate?((n=this.animation)==null||n.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.toCamera)):this.switchCamera(this.fromCamera),this.page.activeCamera.dispatchEvent(n7),this.page.activeCamera.dispatchEvent(r7))},this.data.delay*1e3)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},_1=class extends qr{constructor(t,e,i){var a,l,c;super(),this.page=e,this.animationControls=i,this.startOnceDelay=0,this.toggleIsForward=!1;let n=t.object,r=e.scene.find(t.object);r&&Array.isArray(r.identity)&&(n=r.identity[0]),this.data={...t,object:n};let s=this.animationControls.clipIdToAction[t.clipId+"/"+n];this.duration=((a=s==null?void 0:s.getClip())==null?void 0:a.duration)??1;let o=((c=(l=s==null?void 0:s.getClip())==null?void 0:l.tracks[0])==null?void 0:c.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/o*this.duration,this.rightFrameTime=this.data.crop[1]/o*this.duration,this.startOnceDelay=t.delay}get playing(){var t;return((t=this.threeAnimAction)==null?void 0:t.isRunning())??!1}play(t=!1){window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let e=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([n,r])=>{let s=n.split("/")[1];this.threeAnimAction!==r&&s===e&&r.isRunning()&&(t?r.fadeOut(.2):r.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var t;(t=this.threeAnimAction)==null||t.fadeOut(.2)}seek(t){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=ri.clamp(this.threeAnimAction.time+1/60*t,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(t,e=!1){this.toggleIsForward=t??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let n=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([r,s])=>{let o=r.split("/")[1];this.threeAnimAction!==s&&o===n&&s.isRunning()&&(e?s.fadeOut(.2):s.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},ine=class{constructor(t,e,i,n){this.data=t,this.page=e,this.eventManager=i,this.shared=n,this.timeOutId=-1,this.scene=e.scene}dispatch(){this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(e=>e.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let t=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(t),$z(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}};function Wa(t,e,i,n,r,s){let o={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[]};return e.forEach(({id:a,data:l})=>{try{l.type==="Audio"?Yl[t.type].includes("Audio")&&o.Audio.push(new v1(a,l,s,n)):l.type==="Video"?Yl[t.type].includes("Video")&&o.Video.push(new eU(a,l,s)):l.type==="Link"?Yl[t.type].includes("Link")&&o.Link.push(new HGe(l,r)):l.type==="Create"?Yl[t.type].includes("Create")&&o.Create.push(new b1(l,i,r.controlsManager)):l.type==="Destroy"?Yl[t.type].includes("Destroy")&&o.Destroy.push(new Rie(l,i,r)):l.type==="Reset"?Yl[t.type].includes("Reset")&&o.Reset.push(new jGe(i,n,r)):l.type==="Transition"?Yl[t.type].includes("Transition")&&o.Transition.push(new x1(l,i,n)):l.type==="SwitchCamera"?Yl[t.type].includes("SwitchCamera")&&o.SwitchCamera.push(new tne(l,i)):l.type==="SceneTransition"?Yl[t.type].includes("SceneTransition")&&o.SceneTransition.push(new ine(l,i,r,n)):l.type==="Animation"&&Yl[t.type].includes("Animation")&&o.Animation.push(new _1(l,i,r.animationControls))}catch{}}),o}function Yo(t){Object.values(t).forEach(e=>{e.forEach(i=>{(i instanceof v1||i instanceof eU||i instanceof _1||i instanceof x1||i instanceof b1||i instanceof Rie||i instanceof tne||i instanceof ine)&&i.dispose()})})}function Z5e(t,e){let i;if("material"in t){let n=t.material;Array.isArray(n)?i=t.material[0].layers.find(r=>r.uuid===e):i=t.material.layers.find(r=>r.uuid===e)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var nne=new Map,w1=new Map,Rv=class{constructor(t,e,i){this.data=e,this.delay=0,this.status="stopped";let{layerId:n,loop:r,volume:s,delay:o}=e;if(this.object=i,n===void 0)throw new Error("Missing property");let a=Z5e(i,n);a&&(this.videoElement=a,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),o!==void 0&&(this.delay=o),w1.has(i.uuid)?w1.get(i.uuid).push(this):w1.set(i.uuid,[this]),nne.set(t,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(t){if(!this.videoElement)return;let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t?(this.mute(),this.delay+=150):e?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(n=>{}).catch(n=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},PO=class{constructor(t){this.data=t}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(t){let e=nne.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e[this.data.interaction](),this.disposeDelay()},this.data.delay)):e[this.data.interaction]())}pauseAllVideosFromObject(t){let e=w1.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let t=[...w1.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},eU=class{constructor(t,e,i){if(this.data=e,e.interaction==="play")this.interaction=new Rv(t,e,i);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new PO(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Rv?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Rv?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},s7=(()=>{let t,e,i,n;function r(a){!t&&!o7()&&(e==null?void 0:e.sharedGameControlGlobals.createdObjects.length)>0&&(t=requestAnimationFrame(s)),a&&(e=a,n=a.requestRender)}function s(a){let l=i?a-i:0,c=e.sharedGameControlGlobals.createdObjects,h=e.sharedGameControlGlobals.nCreatedPerAction,u=c.length,d=0;for(;d<u;){let f=c[d];f.userData.createdTime===void 0&&(f.userData.createdTime=a),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&a-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&h[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),n()),d++):(h[f.userData.actionId]>f.userData.quantity&&h[f.userData.actionId]--,c.splice(d,1),f.removeFromParent(),e.sharedGameControlGlobals.rapierWorld&&f.rigidBody?(e.sharedGameControlGlobals.colliderToEntity.delete(f.rigidBody.collider(0).handle),e.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody)):(f.bvhGeometry=void 0,e.sharedGameControlGlobals.entitiesWithTransformAnim=e.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.bvhGeometry!==void 0)),u--,n())}t=d>0?requestAnimationFrame(s):void 0,i=d>0?a:void 0}function o(){o7()?t&&(cancelAnimationFrame(t),t=void 0,i=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),r})();function o7(){return!!document&&document.hidden}var a7=new qt,$5e=new O,eVe=new O,b1=class{constructor(t,e,i){this.data=t,this.page=e,this.controlsManager=i,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=ri.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=zRe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let r=new cs(this.object);if(r.playModeVisible=!0,r.expand(),this.data.coordinateSystem!=="world"){let o=this.data.coordinateSystem,a=this.page.scene.find(o);a&&(a.updateMatrixWorldSVD(),r.hiddenMatrix.copy(a.matrixWorldRigid))}r.position.fromArray(this.data.position),r.rotation.fromArray(this.data.rotation),r.updateMatrix(),this.page.add(r);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(r),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,r.updateWorldMatrix(!0,!0),r.traverseObject(this.traverseObjectCB),s7(),this.controlsManager.requestRender()},this.traverseObjectCB=r=>{var l,c,h,u;r.hasNonUniformScale&&r.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(r instanceof xl)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof cs)s=r.object;else if(s=r,(l=s.dataPatched.cloner)==null?void 0:l.hideBase)return!0}else{if(r instanceof xl)return;r instanceof cs?s=r.object:s=r}this.data.destroy==="Time"?r.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(r.userData.quantity=this.data.destroyAfterQuantity,r.userData.actionId=this.uniqueId);let o=new O().fromArray(this.data.velocity),a=s.dataPatched;if(!(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(r,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((c=r.rigidBody)==null||c.collider(0).setActiveEvents(1),r.userData.hasCollisionDestroy=!0),r.matrixWorld.decompose($5e,a7,eVe),o.applyQuaternion(a7),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&((h=r.rigidBody)==null||h.setLinvel(o.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in r.object&&this.controlsManager.addBoundsTree(r),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&(r.userData.velocity=o)),((u=s.dataPatched.physics)==null?void 0:u.fusedBody)===!0))return!0};let n=this.page.scene.find(this.data.object);if(!n)throw new Error("Missing Property");if(this.object=n,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");s7(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(t=>window.clearTimeout(t)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},rne=200,uI=.02,hI=.3,tVe=65;new O;var l7=new O,c7=new O,iVe=new O,kr=new O,ws=new O,Ph=new O,jA=new Qe,dI=new Qe,nVe=new Qe;new Qe;var Co=new qt,ou=new qt,ec=new Er(0,0,0,"YXZ"),rVe=new O(1,0,0),al=new O(0,1,0),sVe=new O(0,0,1),fI=new O(1,1,1),pI=new qo,oVe=1,aVe=.025,lVe=16e-6,u7=12,cVe=20,Ar=new Na,fa=new Gn,uVe={type:"requestRender"},hVe={type:"updateMatrix"},h7=Math.PI/6,DO=class extends qr{constructor(t,e,i,n,r,s,o,a,l){var p;super(),this.object=t,this.domElement=e,this.data=i,this.gloabalPhysics=n,this.controlsManager=r,this.cameraFollow=s,this.camera=o,this.page=a,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new Qe,this.target0=new O,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=rne,this.euler0=new Er(0,0,0,"YXZ"),this.position0Cam=new O,this.quat0Cam=new qt,this.scale0Cam=new O,this.hiddenMatrix0Cam=new Qe,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Na(new O(0,-40,0),new O(0,40,0)),matrix:new Qe,position:new O,rotation:new qt},this.euler=new Er(0,0,0,"YXZ"),this.eulerDelta=new O,this.lastPosition=new O,this.lastCameraQuaternion=new qt,this.lastCameraPosition=new O,this.PI_2=Math.PI/2,this.prevMouse=new ge,this.velocityTarget=new O,this.velocity=new O,this.directionXZ=new O,this.rotVelocityStick=new O,this.rotVelocityTarget=new O,this.rotVelocity=new O,this.rotDirection=new O,this.nonColliderRotOffset=new Qe,this.nonColliderPosOffset=new Qe,this.firstPointerId=-1,this.rot=new O,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Qe,this.objectToTarget=new O,this.objectToTarget0=new O,this.objectToCamXZ=new O,this.objectToCamXZ0=new O,this.targetToCamera=new O,this.targetToCamera0=new O,this.cameraPolarAxis0=new O,this.targetPos=new O,this.targetQuat=new qt,this.lerpFactorPos=new O().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new qt,this.objXZQuatInv=new qt,this.objXZRotMat=new Qe,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new O,this.pushedVelocity=new O,this.groundYRotation=0,this.objectRealQuat=new qt,this.colliderWorldQuat=new qt,this.groundNormal=new O,this.groundTilt=new qt,this.groundTiltInv=new qt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new O,this.quaternion=new qt,this.scale=new O,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!Fo&&(!PW||DW>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,v=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(PW&&DW<15.5&&!Fo?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?DO.isLocked=!0:DO.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let v=2;v<4;v++){let y=m.axes[v];g===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,t===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),h=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,h,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new O(0,0,-1).applyQuaternion(this.camera.quaternion),g=new O().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,y=g.projectOnVector(m)):g.y/m.y>0?y=m.multiplyScalar(g.y/m.y):y=m.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let x=new Er().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof Rs&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*oVe,this.speedOrbit=(i.speedRotate??100)*aVe,this.mouseOrbitSensitivity=(i.speedRotate??100)*lVe,this.keyAssignments=i.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]===""?g[1]="ArrowUp":g[1]===""?g[1]="ArrowLeft":g[1]===""?g[1]="ArrowDown":g[1]===""?g[1]="ArrowRight":g[1]===""?g[1]="Shift":g[1]===""?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]===""?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),i.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??m0.defaultData.gravity)*u7,this.usePhysics=this.gloabalPhysics.usePhysics??m0.defaultData.usePhysics,this.jumpPower=i.jumpPower*cVe,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??lE.defaultDataThirdPerson.orientWith,this.slopeThresh=tVe*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*uI/this.pixelsPerMeter,this.stepThresh=i.collider.height*hI/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*uI/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*hI/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*uI/this.pixelsPerMeter,this.stepThresh=i.collider.height*hI/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let u=new O().fromArray(i.collider.position),d=new qt().setFromEuler(new Er().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(u).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(u,d,fI),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.runMultiplier=i.runMultiplier??2;let f=i.navmesh.destinationHelperRadius*2;if(f>0){let m=new jt;m.push({fi:0,data:{...Xs.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...Xs.defaultData("color"),color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a},id:"layer2"});let g=new Iz({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new $s(lte.create({parameters:{width:f,height:f/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(t=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),t){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=new Er().setFromQuaternion(this.quaternion,"YXZ"),i=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,i,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof Rs?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var t;this.deactivate(),(t=this.navMeshPathDest)!=null&&t.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let t=this.data,e=this.page,i=this.sharedAssets,n=this.object;t.gameActions!==void 0&&Object.entries(t.gameActions).forEach(([r,s],o)=>{s.forEach(({id:a,data:l})=>{try{this.actions[r]===void 0&&(this.actions[r]=[]),l.type==="Transition"?this.actions[r].push(new x1(l,e,i)):l.type==="Animation"?this.actions[r].push(new _1(l,e,this.controlsManager.eventManager.animationControls)):l.type==="Audio"?this.actions[r].push(new v1(a,l,n,i)):l.type==="Video"?this.actions[r].push(new eU(a,l,n)):l.type==="Create"&&this.actions[r].push(new b1(l,e,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Yo(this.actions)}dispatchStartEvent(t){this.actions[t]!==void 0&&(this.actionState[t]||(this.actionState[t]=!0,this.actions[t].forEach(e=>{e instanceof x1?e.play():e instanceof _1?e.play(this.initialAction===!1):e instanceof b1?e.dispatchStart():e instanceof v1&&e.dispatchGameControl("start")})))}dispatchStopEvent(t){this.actions[t]!==void 0&&(!this.actionState[t]||(this.actionState[t]=!1,this.actions[t].forEach(e=>{e instanceof x1?(e.stop(),e.object.currentState!==null&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})):e instanceof _1||(e instanceof b1?e.dispatchStop():e instanceof v1&&e.dispatchGameControl("stop"))})))}get colliderWorldPosition(){return kr.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(t,e,i){var a,l,c,h,u,d,f,p,m,g,v;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let n=(this.isFirstFrame?16.6:t)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=n*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=ws.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*u7),1)*(this.gravity>0?1:-1):this.velocity.y)*n,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let b=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let S of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(S.rigidBody===b&&S.userData.isFollowingObj!==this.object.uuid){(S.hasNonUniformScale?S.matrixWorldRigid:S.matrixWorld).decompose(kr,ou,ws),this.groundVelocity.subVectors(kr,S.prevT),this.object.getWorldPosition(ws).add(this.collider.position).sub(kr),this.groundYRotation=ec.setFromQuaternion(ou).y-S.prevR.y,Ph.copy(ws).applyAxisAngle(al,this.groundYRotation),this.groundVelocity.add(Ph.sub(ws)).divideScalar(n);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=kr.subVectors(this.path[1],this.position),b=ws.subVectors(this.path[1],this.path[0]);x.dot(b)<0?this.path.shift():(this.directionXZ.x=b.x,this.directionXZ.z=b.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let o=iVe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=ws.copy(o);y.y=0,o.set(0,o.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let y=kr;this.camera.getWorldDirection(y);let x=Ph.copy(al).multiplyScalar(y.dot(al));y.sub(x);let b=ws.copy(this.directionXZ);b.x*=-1,this.rot.y=y.angleTo(b)*(y.cross(b).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(ec.setFromVector3(this.rot),this.moveMode==="walk"&&(ec.x=0),o.applyEuler(ec),s&&(ou.setFromUnitVectors(al,this.groundNormal),o.applyQuaternion(ou)),i){let y=ec.set(0,this.vrEulerYOffset*h7,0);i.applyEuler(y),o.x+=i.x,o.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*n}if(this.usePhysics===!0){let y=ws;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let b=Ph.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(n).divideScalar(this.pixelsPerMeter),S=x.rigidBody.collider(0).castCollider(b,this.object.rigidBody.collider(0),kr.copy(o).divideScalar(this.pixelsPerMeter),n,!1);b.multiplyScalar(this.pixelsPerMeter);let A=fi.is(x)?x:x.object;if(S!==null&&this.lastHitObj!==A){let E;x instanceof cs&&(E=x);let M=this.sharedGameControlGlobals.entityToCollisionEvents[A.uuid];if(M)for(let T of M)T.data.target==="character"&&(T.dispatch(E),A.dispatchEvent(BO));this.lastHitObj=A}if(S!==null){this.pushedVelocity.copy(b),y.copy(S.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(o);x<0&&o.addScaledVector(y,-x),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(n),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*n,this.euler.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*n),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(al,this.euler.y-this.euler0.y);let y=ws.copy(this.objectToCamXZ).normalize(),x=Ph.copy(o).multiplyScalar(n);x.y=0;let b=x.sub(kr.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(b,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=ri.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=ri.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=ri.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(e?(ec.copy(e),ec.y=0):(ec.copy(this.euler),ec.y=0),this.nonColliderRotOffset.makeRotationFromEuler(ec)),e&&(this.moveMode==="walk"?(this.rot.y=e.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(e),this.rot.y+=this.vrEulerYOffset*h7),Co.setFromAxisAngle(rVe,this.rot.x),ou.setFromAxisAngle(al,this.rot.y),ou.multiply(Co),Co.setFromAxisAngle(sVe,this.rot.z),ou.multiply(Co),this.quaternion.copy(ou),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=ws.copy(o).multiplyScalar(n/this.pixelsPerMeter),x=null;this.didHit=!1;let b=new O;for(let S=0;S<5;S++){let A=y.length(),E=Ph.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),this.colliderWorldQuat,E,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,A,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let M=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(M!==this.lastHitObj&&S===0){this.lastHitObj=M;let k=this.sharedGameControlGlobals.entityToCollisionEvents[M==null?void 0:M.uuid];if(k){for(let R of k)if(R.data.target==="character"){let F=((h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.getCollider(x.collider.handle))._parent,V;if(M.cloner){for(let Q of M.cloner.children)if(Q.rigidBody===F){V=Q;break}}R.dispatch(V),M.dispatchEvent(BO)}}}let T=l7.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),P=c7.copy(E).multiplyScalar(x.toi).dot(T),I=x.toi;if(I===0&&(this.position.y+=this.offset*this.pixelsPerMeter),P>this.offset&&(I=x.toi*(P-this.offset)/P,b.addScaledVector(E,I)),y.copy(E).multiplyScalar(A-I),Math.acos(-T.y)>this.slopeThresh){let k=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(b),R=Ph.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);R.y=0;let F=k.add(R);F.y+=this.stepThresh;let V=this.sharedGameControlGlobals.rapierWorld.castShape(F,this.colliderWorldQuat,y,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);V!==null&&V.toi===0&&(T.y=0,T.normalize())}y.addScaledVector(T,-y.dot(T))}else{S===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),b.add(y);break}}this.position.addScaledVector(b,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(kr.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Co.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=o.multiplyScalar(n/y);for(let b=0;b<y;b++)this.position.add(x),b===0&&this.checkTrigger(),this.collisionAdjustment(n/y)}else this.position.addScaledVector(o,n);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);jA.lookAt(x,y,al).setPosition(x),jA.decompose(this.targetPos,this.targetQuat,kr),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=ri.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=ri.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(hVe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((m=(p=this.navMeshPathDest)==null?void 0:p.material)==null?void 0:m.opacity)<-.04*((v=(g=this.navMeshPathDest)==null?void 0:g.material)==null?void 0:v.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(uVe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let t=Co.setFromAxisAngle(al,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?ri.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(t);let e;this.cameraXAxis==="Limit"?e=ri.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):e=ri.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=kr.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(t);let n=ou.setFromAxisAngle(i,e);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(t),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(t){al.angleTo(t)*180/Math.PI<15||al.angleTo(t)*180/Math.PI>85?Co.identity():Co.setFromUnitVectors(al,t),this.groundTilt.slerp(Co,.06),this.groundTiltInv.copy(this.groundTilt).invert()}checkTrigger(){let t;for(let e=0;e<this.sharedGameControlGlobals.triggers.length;e++){let[i,n,r,s]=this.sharedGameControlGlobals.triggers[e];for(let o=0;o<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;o++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[o];if(r===a||s.isValidTriggeringObject(fi.is(a)?a:a.object)===!1)continue;let l=dI.copy(r.matrixWorld).decompose(kr,Co,ws).compose(kr,Co,fI).multiply(n),c=jA.copy(a.matrixWorld).invert().multiply(l);i instanceof Gn?t=a.bvhGeometry.boundsTree.intersectsBox(i,c):(pI.radius=i,pI.center.setFromMatrixPosition(c),t=a.bvhGeometry.boundsTree.intersectsSphere(pI)),t?s.currentIntersectedObjects.indexOf(a)===-1&&(s.currentIntersectedObjects.push(a),s.dispatch(),r.dispatchEvent(xHe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(h=>h!==a)}}}collisionAdjustment(t){var r;let e=c7.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=jA.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(kr,Co,ws).compose(kr,Co,fI);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;fa.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=dI.copy(o).invert(),l=nVe.copy(dI).multiply(i);Ar.copy(this.collider.segment),Ar.start.applyMatrix4(l),Ar.end.applyMatrix4(l);let c=l7.copy(this.position).applyMatrix4(a);fa.expandByPoint(Ar.start),fa.expandByPoint(Ar.end),fa.min.addScalar(-this.collider.radius),fa.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(h){return h.distanceToPoint(Ar.end)},intersectsBounds:h=>h.intersectsBox(fa),intersectsTriangle:h=>{let u=kr,d=ws,f=h.closestPointToSegment(Ar,u,d);if(f<this.collider.radius){let p=this.collider.radius-f,m=d.sub(u).normalize(),g=Ph.copy(c);g.addScaledVector(m,p);let v=g.applyMatrix4(o).sub(this.position);e.add(v),Ar.start.addScaledVector(m,p),Ar.end.addScaledVector(m,p)}}})}),fa.makeEmpty(),Ar.copy(this.collider.segment),Ar.start.applyMatrix4(i),Ar.end.applyMatrix4(i),fa.expandByPoint(Ar.start),fa.expandByPoint(Ar.end),fa.min.addScalar(-this.collider.radius),fa.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(Ar.end)},intersectsBounds:s=>s.intersectsBox(fa),intersectsTriangle:s=>{let o=kr,a=ws,l=s.closestPointToSegment(Ar,o,a);if(l<this.collider.radius){let c=this.collider.radius-l,h=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(h),e.addScaledVector(h,c),Ar.start.addScaledVector(h,c),Ar.end.addScaledVector(h,c)}}}),this.onObject=Math.abs(e.y)>Math.abs(t*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let n=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(n),this.position.add(e)}},sne=DO;sne.isLocked=!1;var dVe=I0(YZ());function bu(t,e){let i=new Rt;if(!t.getAttribute("position"))return i.setAttribute("position",new gt([],3)),i.setIndex([]),i;let{positions:n,triIndices:r}=RT(t.getAttribute("position"),t.getIndex());return i.setAttribute("position",new gt(n,3)),i.setIndex(r),e&&i.applyMatrix4(e),i}var fVe=new Qe,pVe=new Qe,tc=[[0,0,0],[0,0,0],[0,0,0]];function one(t){let e=t.elements;tc[0][0]=e[0],tc[0][1]=e[4],tc[0][2]=e[8],tc[1][0]=e[1],tc[1][1]=e[5],tc[1][2]=e[9],tc[2][0]=e[2],tc[2][1]=e[6],tc[2][2]=e[10];let{u:i,v:n}=(0,dVe.SVD)(tc),r=fVe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=pVe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var mVe=class extends k${constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(t,e){e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):e.isPerspectiveCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(t,e=!0,i=[]){return t.forEach(n=>{n.visible&&this.intersectObject(n,e,i)}),i}createRaycastLineHelper(){let t=new Jd({color:65280,linewidth:10}),e=new O(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new O(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,r=new O().addVectors(e,i.multiplyScalar(n)),s=new Rt;return s.setFromPoints([e,r]),new BC(s,t)}},ane=t=>t instanceof gE||t instanceof Bv;function gVe(t,e){return t.distance-e.distance}function lne(t,e,i){if(!(!wu(e)||!e.visible)){pl(e)&&e.raycast(t,i);for(let n of e.children)lne(t,n,i)}}function IO(t,e,i){if(!i.some(r=>_E(t,r)!==void 0))return[];let n=[];return e.children.forEach(r=>lne(t,r,n)),n.sort(gVe),n}function LO(t){let e=[];if(t.length){let i=t[0].object;wu(i)&&e.push(i);let n=i.parent;for(;n;)ane(n)&&e.push(n),n=n.parent}return e}function _E(t,e){if(pl(e)){if(e.visible){let i=[];return e.raycast(t,i),i.length?i[0]:void 0}}else if(ane(e))return cne(t,e)}function cne(t,e){if(!(!wu(e)||!e.visible)){if(pl(e)){let i=[];if(e.raycast(t,i),i.length)return i[0]}for(let i of e.children){let n=cne(t,i);if(n)return n}}}function vVe(t,e,i){return{x:(t-(i.left+window.scrollX))/i.width*2-1,y:-((e-(i.top+window.scrollY))/i.height)*2+1}}var yVe=class{constructor(t,e,i,n,r,s,o){this.renderer=t,this.publish=e,this.scene=i,this.getCamera=n,this.sharedAssets=r,this.requestRender=s,this.isExport=o,this.raycaster=new mVe,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this._useWindowEvents=e.mouseEventTarget==="window",this.domElement=t.domElement,this.eventElement=this._useWindowEvents?window:t.domElement}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(t){this._useWindowEvents=t,this.eventElement=t?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(t){var r;if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:e,pageY:i}=((r=t.touches)==null?void 0:r.length)>0?t.touches[0]:t,n=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(vVe(e,i,n),this.getCamera())}},une=(t=>(t[t.keydown=0]="keydown",t[t.keyup=1]="keyup",t[t.pointerdown=2]="pointerdown",t[t.pointerup=3]="pointerup",t[t.pointermove=4]="pointermove",t[t.wheel=5]="wheel",t[t.scroll=6]="scroll",t))(une||{}),nh=class{constructor(t){this.eventContext=t,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},tU=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],hne=t=>{var e;return(e=tU.find(([i,n])=>n===t))==null?void 0:e[0]},Cw=t=>{var e;return(e=tU.find(([i])=>i===t))==null?void 0:e[1]},xVe=(t,e)=>{let i=hne(t);if(i){let n=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(n,"target",{writable:!1,value:e}),n}},_Ve=class extends nh{constructor(t){super(t),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=i=>{var s;if(!i.eventName||!i.target||i.eventName==="Scroll")return;let n=(s=this.splineEvents[hne(i.eventName)])==null?void 0:s[i.target.uuid];if(!n)return;i.eventName==="Scroll"&&i.deltaY!==void 0&&Object.assign(n,{deltaY:i.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(n)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var n,r;if((n=i.data)!=null&&n.events.length){for(let[s,o]of tU)if(i.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(i):this.objectsPerEvents.set(s,[i]);let a={id:i.uuid,name:i.name},l=xVe(o,a),c=this.splineEvents[s];c?c[i.uuid]=l:this.splineEvents[s]={[i.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},wVe=class{constructor(t,e,i,n,r,s){if(this.id=t,this.data=e,this.object=i,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=e.toggle,(e.type==="KeyDown"||e.type==="KeyUp"||e.type==="KeyPress")&&!e.key)throw new Error("Missing property");this.actions=Wa(e,e.actions,n,r,s,i)}disconnect(){Yo(this.actions)}dispatchHeld(t){this.actions.Create.forEach(e=>{t&&e.dispatchThrottled.cancel(),e.dispatchThrottled()})}dispatch(t=!1){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this?(e.object.currentTransitionEvent=this,e.init()):this.useToggle===!1&&this.alreadyPlayedNonTogglingActions.add(e)}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStart())):(this.actions.Transition.some(e=>e.playing)||this.actions.Transition.forEach(e=>{this.alreadyPlayedNonTogglingActions.has(e)===!1&&e.play()}),this.actions.SwitchCamera.some(e=>e.playing)||this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),t===!1&&this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStop()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}},bVe=class extends nh{constructor(t,e){super(t),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c,h,u;if(!r||!s)return;let a=Cw(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:a}),(c=(l=this.eventsPerObjects[a])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(o)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:a}),(u=(h=this.eventsPerObjects[a])==null?void 0:h[s.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var o,a;if(!((o=r.data)!=null&&o.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:h})=>h.type===l&&h.disabled!==!0).forEach(({id:h,data:u})=>{try{let d=new wVe(h,u,r,i,n,e);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&(u.mode==="Canvas"||u.mode==="Window")?u.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(a=c[r.uuid])!=null&&a.length&&this.objectsPerTypes[l].push(r)}})}connect(){var e,i,n,r,s,o;let{domElement:t}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(e=this.objectsPerTypes.MouseDown)!=null&&e.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown)),(i=this.objectsPerTypes.MouseUp)!=null&&i.length&&(this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),(n=this.objectsPerTypes.MousePress)!=null&&n.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerdown",this.onMousePressDown),t.removeEventListener("pointerup",this.onMouseUp),t.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(i=>{i.forEach(n=>{n.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([e,i])=>{i.forEach(n=>{n.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(t){let{stopRaycast:e,raycaster:i,page:n}=this.eventContext,r=this.objectsPerTypes[t];if(r.length)if(e){let s=IO(i,n,r);LO(s).forEach(o=>{this.eventsPerObjects[t][o.uuid]&&this.handleObjectMouseEventDispatch(o,t)})}else r.forEach(s=>{_E(i,s)&&this.handleObjectMouseEventDispatch(s,t)})}handleMousePressEvent(t=!1){let e="MousePress",i=this.objectsPerTypes[e],n=[];if(i.length){if(!t){let{stopRaycast:r,raycaster:s,page:o}=this.eventContext;if(r){let a=IO(s,o,i);n=LO(a)}else i.forEach(a=>{_E(s,a)&&n.push(a)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{n.includes(r)||this.handleObjectMouseEventDispatchRelease(r,e)}),n.length&&n.forEach(r=>{this.handleObjectMouseEventDispatch(r,e)}),this._prevObjects=n}}handleObjectMouseEventDispatch(t,e){var i,n;t.dispatchEvent({type:"beginEvent",eventName:e}),(n=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||n.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(t,e){var i,n;t.dispatchEvent({type:"beginEvent",eventName:e}),(n=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||n.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(t,e,i=!1){this.objectsPerTypes[e].forEach(n=>{let r=this.eventsPerObjects[e][n.uuid];r.some(({data:s})=>"key"in s&&s.key===t.key)&&n.dispatchEvent({type:"beginEvent",eventName:e}),r.forEach(s=>{"key"in s.data&&s.data.key===t.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(t,e,i=!1){this.objectsPerTypes[e].forEach(n=>{this.eventsPerObjects[e][n.uuid].forEach(r=>{"key"in r.data&&r.data.key===t.key&&r.dispatchHeld(i)})})}},SVe=new O,AVe=new O,dne=class{constructor(t,e,i,n,r){this.actionsIn=Wa(t,t.inActions,i,n,r,e),this.actionsOut=Wa(t,t.outActions,i,n,r,e)}disconnect(){Yo(this.actionsIn),Yo(this.actionsOut)}},MVe=class extends dne{constructor(t,e,i,n,r,s){super(e,i,n,r,s),this.id=t,this.data=e,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{for(let d of this.objects)if(!d.visible)return;let c=SVe.setFromMatrixPosition(this.objects[0].matrixWorld),h=AVe.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(h)<=this.distance?"in":"out";if(this.stage!==u){this.stage=u;let d=u==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Link.forEach(f=>f.dispatch()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Reset.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.Animation.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),d.SceneTransition.forEach(f=>f.dispatch())}};let{distance:o,fromObject:a,toObject:l}=e.condition;this.distance=o;for(let c of[a,l]){if(!c)throw new Error("Missing property");let h=n.find(c);if(!h)throw new Error("Missing property");this.objects.push(h)}}connect(){window.setTimeout(()=>{this.objects.forEach(t=>{t.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(t=>{t.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},CVe=class extends dne{constructor(t,e,i,n,r,s){var l;super(e,i,n,r,s),this.id=t,this.data=e,this.object=i,this.onBegin=({target:c,state:h})=>{this.toState!==h&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Link.forEach(u=>u.dispatch()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Reset.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsOut.Animation.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()),this.actionsOut.SceneTransition.forEach(u=>u.dispatch()))},this.onComplete=({target:c,state:h})=>{this.toState===h&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Link.forEach(u=>u.dispatch()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Reset.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsIn.Animation.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()),this.actionsIn.SceneTransition.forEach(u=>u.dispatch()))};let{condition:o}=e;if(!o.object)throw new Error("Missing property");let a=n.find(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},EVe=class extends nh{constructor(t,e){super(t),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:o,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new MVe(o,a,r,i,n,e):a.condition.type==="State"&&(l=new CVe(o,a,r,i,n,e))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.disconnect()))}},px=new O,Dh=new O,Df=new O,d7=new Do,TVe=.01,Mi=new O,sr=new O,f7=new O,fp=new qt,mI=new Er,PVe=new Qe,gI=new Pr,vg=new O,ic=new O,yg=.2;function vI(t,e){!e||(e[0]<e[1]&&(t.x=Math.min(Math.max(t.x,e[0]),e[1])),e[2]<e[3]&&(t.y=Math.min(Math.max(t.y,e[2]),e[3])),e[4]<e[5]&&(t.z=Math.min(Math.max(t.z,e[4]),e[5])))}var DVe=function(){let t=new Qe;return(e,i,n)=>{let r=e.obj;t.copy(r.hiddenMatrix),r.parent!==null&&t.premultiply(r.parent.matrixWorld),t.invert(),r.position.copy(i),e.reference==="global"&&vI(r.position,e.limits),r.position.applyMatrix4(t),e.reference==="parent"?vI(r.position,e.limits):e.reference==="local"&&(fp.copy(e.quat0).invert(),r.position.sub(e.position0),r.position.applyQuaternion(fp),vI(r.position,e.limits),fp.invert(),r.position.applyQuaternion(fp),r.position.add(e.position0)),t.multiply(n??r.matrixWorld).decompose(Mi,r.quaternion,sr),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof go&&Bu(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),IVe=class{constructor(t,e,i,n,r,s){this.object=t,this.data=e,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Wa(e,e.dragDropActions.drag,i,n,r,this.object),this.actionsDrop=Wa(e,e.dragDropActions.drop,i,n,r,this.object);let o=[];this.data.objects.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(o.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.data.visible!==!1&&o.push(h)}))}),this.data.dropDestinations.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let h=i.find(c);!h||h.data.visible!==!1&&this.dropDestIds.push(h.uuid)}))}),this.dragItems=o.map(a=>(this.data.planeMode==="locked"&&(a.userData.lockedPlane=!0),a.userData.worldPosition0=new O().setFromMatrixPosition(a.matrixWorld),{obj:a,fromPosition:new O().setFromMatrixPosition(a.matrixWorld),pointStart:new O,pointEnd:new O,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new O().copy(a.position),quat0:new qt().copy(a.quaternion),snapped:!1,orientationMatrix:new Qe,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Yo(this.actionsDrag),Yo(this.actionsDrop),this.dragItems.forEach(t=>{t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.obj.recursiveBBoxNeedsUpdate=!0,t.obj.userData.lockedPlane=void 0,t.obj.position.copy(t.position0),t.obj.quaternion.copy(t.quat0),t.obj.updateMatrix()})}},LVe=class extends nh{constructor(t,e){super(t),this.eventManager=e,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var a;if(It.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,o=s.raycastWithClones(r);if(this.lastDropDestination=null,o.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:h,pointEnd:u,pointStart:d}of l.dragItems){if(h===o[0].object||h===o[0].object.object||fi.is(h)&&h.isAncestorOf(o[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let f=l.activeDragItem.obj;h.hasNonUniformScale&&h.updateMatrixWorldSVD(),(f.hasNonUniformScale?f.matrixWorldRigid:f.matrixWorld).decompose(Mi,fp,sr),mI.setFromQuaternion(fp),f.prevR===void 0?(f.prevR=mI.clone(),f.prevT=Mi.clone()):(f.prevR.copy(mI),f.prevT.copy(Mi)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(h,d,l.data.plane,l.data.referenceFrame),u.copy(d),(this.eventManager.controlsManager.usePhysics&&((a=h.data.physics)==null?void 0:a.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=n=>{var a,l,c,h;if(It.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,o=s.raycastWithClones(r);if(It.length===0){let u=!1;for(let d of this.events){for(let{obj:f}of d.dragItems)if(f===((a=o[0])==null?void 0:a.object)||f===((c=(l=o[0])==null?void 0:l.object)==null?void 0:c.object)||fi.is(f)&&f.isAncestorOf((h=o[0])==null?void 0:h.object.uuid)){switch(u=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(u)break}u||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let u=this.activeEvent.activeDragItem;u.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=o.filter(f=>u.obj!==f.object&&!u.obj.isAncestorOf(f.object.uuid)&&!(f.object instanceof gE)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(p=>p===f.object.uuid||s.scene.find(p).isAncestorOf(f.object.uuid))))[0]),d){let f=f7.copy(d.face.normal).applyMatrix3(gI.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")u.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(u.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Mi.copy(f).applyMatrix3(gI.setFromMatrix4(u.obj.matrixWorld).transpose());let p=u.obj;Mi.x>yg?sr.x=-p.recursiveBBox.min.x:Mi.x<-yg&&(sr.x=-p.recursiveBBox.max.x),Mi.y>yg?sr.y=-p.recursiveBBox.min.y:Mi.y<-yg&&(sr.y=-p.recursiveBBox.max.y),Mi.z>yg?sr.z=-p.recursiveBBox.min.z:Mi.z<-yg&&(sr.z=-p.recursiveBBox.max.z),sr.applyMatrix3(gI.invert())}else sr.copy(f).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);u.fromPosition.add(sr)}this.activeEvent.data.autoOrient&&(Mi.set(0,1,0).cross(f),Mi.length()<1e-4&&Mi.set(-1,0,0).cross(f),sr.crossVectors(f7,Mi),u.orientationMatrix.makeBasis(Mi,sr,f)),u.pointStart.copy(u.fromPosition),u.pointEnd.copy(u.pointStart),u.currentDampingFactor=this.activeEvent.snapDampingFactor,u.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(p=>{p.dispatchThrottled()}))}else u.orientationMatrix.makeRotationFromQuaternion(u.quat0),this.lastDropDestination=null,u.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(u.obj,u.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.stop()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(f=>{f.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(f=>{f.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(f=>{f.stop(),f.object.currentState!==null&&f.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(f=>{f.stop()}))},500),this.updateDragItem(u),u.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=n=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((r=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(o=>{o.stop(),o.object.currentState!==null&&o.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(o=>{o.stop()}),this.activeEvent.actionsDrag.Audio.forEach(o=>{o.dispatchGameControl("stop")})),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let i={};t.page.traverseEntity(n=>{n.component&&(i[n.component.uuid]?i[n.component.uuid].push(n.uuid):i[n.component.uuid]=[n.uuid])}),t.page.traverseEntity(n=>{var r;(r=n.data)==null||r.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new IVe(n,s.data,t.page,t.sharedAssets,e,i))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let e of t.dragItems)e.paused||this.updateDragItem(e,!0)}calcPlaneIntersectPos(t,e,i,n){let{getCamera:r,raycaster:s}=this.eventContext;r().getWorldDirection(Dh),Dh.negate();let o=fp.identity();switch(n==="parent"?PVe.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix).decompose(Mi,o,sr):n==="local"&&t.matrixWorld.decompose(Mi,o,sr),i){case"x":Mi.set(1,0,0).applyQuaternion(o),vg.copy(Dh).cross(Mi),ic.copy(Mi).cross(vg);break;case"y":Mi.set(0,1,0).applyQuaternion(o),vg.copy(Dh).cross(Mi),ic.copy(Mi).cross(vg);break;case"z":Mi.set(0,0,1).applyQuaternion(o),vg.copy(Dh).cross(Mi),ic.copy(Mi).cross(vg);break;case"xy":ic.set(0,0,1).applyQuaternion(o);break;case"yz":ic.set(1,0,0).applyQuaternion(o);break;case"xz":ic.set(0,1,0).applyQuaternion(o);break;case"adaptive":Dh.angleTo(sr.set(0,1,0))>Math.PI/6?(Mi.crossVectors(sr.set(0,1,0),Dh),ic.crossVectors(Mi,sr)):ic.set(0,1,0);break;default:ic.copy(Dh);break}Df.setFromMatrixPosition(t.matrixWorld);let a=t.userData.lockedPlane?t.userData.worldPosition0:Df;if(d7.setFromNormalAndCoplanarPoint(ic,a),!!s.ray.intersectPlane(d7,e)&&(i==="x"||i==="y"||i==="z")){let l=sr.subVectors(e,a).dot(Mi);e.copy(a).addScaledVector(Mi,l)}}updateDragItem(t,e=!1){var i,n;Df.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?px.subVectors(t.fromPosition,Df).divideScalar(t.currentDampingFactor):t.reset==="original"?(px.subVectors(t.obj.userData.worldPosition0,Df).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):px.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(Df).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?px.length()<TVe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||e)&&DVe(t,px.add(Df),(i=this.activeEvent)!=null&&i.data.drop&&((n=this.activeEvent)!=null&&n.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},xg=new O,yI=new O,au=new O,lu=new O,p7=new Do,BVe=.01,RVe={type:"requestRender"},OVe=function(){let t=new O,e=new O;return(i,n,r)=>r>0?(t.subVectors(i,n),t.length()<=r?i:e.copy(n).add(t.normalize().multiplyScalar(r))):n}(),m7=function(){let t=new Qe;return(e,i)=>{e.position.copy(i),e.parent!==null&&(t.copy(e.parent.matrixWorld).invert(),e.position.applyMatrix4(t)),t.copy(e.hiddenMatrix).invert(),e.position.applyMatrix4(t),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof go&&Bu(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),FVe=class{constructor(t,e,i,n,r){this.data=t,this.object=e,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new O,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...CR.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Wa(t,t.actions,i,n,r,e)}},NVe=class extends nh{constructor(t,e){super(t),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=n=>{if(!(It.length>1)){this.eventContext.updateRaycaster(n);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=n=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=n=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)};let{page:i}=this.eventContext;i.traverseEntity(n=>{var s,o;let r=(s=n.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);r&&(!i.data.globalPhysics.usePhysics||((o=n.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new FVe(r.data,n,i,t.sharedAssets,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),Fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,r=this.onTargetChange(i);this.pairOfEventListeners.push([n,r]),n.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),Fo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let i of this.events)i.paused=!0,i.isReset=!1,Yo(i.actions)}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t,!0)}updateSingleEvent(t,e=!1){var o;this.events.forEach(a=>{a.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:n,limitDistanceEnabled:r}=t.data;if(t.object.getWorldPosition(au),t.isReset)lu.copy(t.worldPosition0);else if(t.target)t.target.getWorldPosition(lu);else{let{getCamera:a,raycaster:l}=this.eventContext;if(i==="custom"?(a().getWorldDirection(yI),yI.negate(),xg.copy(yI)):i==="xy"?xg.set(0,0,1):i==="xz"?xg.set(0,1,0):i==="yz"&&xg.set(1,0,0),p7.setFromNormalAndCoplanarPoint(xg,au),!l.ray.intersectPlane(p7,lu))return}if(!t.isReset){if(lu.distanceTo(t.worldPosition0)>n&&r&&t.target)if(t.snapComplete=!1,t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)lu.copy(t.worldPosition0),t.currentDampingFactor=t.resetDampingFactor;else return;else if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return}t.data.enabledTranslation[0]===!1&&(lu.x=au.x),t.data.enabledTranslation[1]===!1&&(lu.y=au.y),t.data.enabledTranslation[2]===!1&&(lu.z=au.z);let s=OVe(au,lu,t.wasOutside?0:t.data.maxDelta);if(t.currentDampingFactor>1){let a=xg.subVectors(s,au).divideScalar(t.currentDampingFactor);au.add(a),e&&m7(t.object,au),t.paused=a.length()<BVe}else m7(t.object,s),t.paused=!0;(o=t.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),t.object.dispatchEvent(RVe)}},mx=new O,WA=new O,gx=new Qe,_g=new qt,Ih=new qt,vx=new O,yx=new O,If=new O,cu=new O,xI=new Do,kVe=1e-6,zVe={type:"requestRender"},UVe={type:"changeRotation"},g7=function(){let t=new Qe;return function(e,i){e.parent!==null?t.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix):t.copy(e.hiddenMatrix),i.premultiply(one(t).invert()),e.rotation.setFromRotationMatrix(i),e.updateMatrix(),e instanceof go&&Bu(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),GVe=class{constructor(t,e,i){this.object=e,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new qt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...ER.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},VVe=class extends nh{constructor(t){super(t),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=i=>{if(!(It.length>1)){this._lastMouseEvent=i,this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onScroll=i=>{if(this._lastMouseEvent){let n=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(n)}},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)},this.createUserEventListener=i=>({eventName:n,target:r})=>{if(!n||!r)return;let s=Cw(n);s&&s==="LookAt"&&this.updateSingleEvent(i)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var r,s;let n=(r=i.data)==null?void 0:r.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((s=i.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new GVe(n.data,i,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),Fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?e.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let s=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let n=this.createUserEventListener(i),r=i.object;this.pairOfUserEventListeners.push([r,n]),r.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),Fo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave),e.removeEventListener("scroll",this.onScroll);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let[i,n]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",n);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var d;let{tilt:e,axis:i,distance:n,plane:r,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=t.data,{getCamera:l,raycaster:c}=this.eventContext,{object:h,target:u}=t;if(h.getWorldPosition(vx),!t.isReset)if(t.target)t.target.getWorldPosition(yx);else{if(r==="custom"?(l().getWorldDirection(WA),WA.negate(),xI.setFromNormalAndCoplanarPoint(WA,vx)):(r==="xy"?mx.set(0,0,1):r==="xz"?mx.set(0,1,0):r==="yz"&&mx.set(1,0,0),xI.setFromNormalAndCoplanarPoint(mx,vx)),!c.ray.intersectPlane(xI,yx))return;n>0&&(r==="custom"||r===void 0)&&yx.addScaledVector(WA,n)}if(t.isReset||(u?e==="target"?If.copy(u.up).applyMatrix4(gx.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(i==="x"?(cu.set(0,0,1),o[2]===!1&&cu.set(0,1,0)):i==="y"?(cu.set(1,0,0),o[0]===!1&&cu.set(0,0,1)):(cu.set(0,1,0),o[1]===!1&&cu.set(1,0,0)),If.copy(cu).applyQuaternion(t.worldQuaternion0).normalize()):If.set(0,1,0):r==="custom"?If.set(0,1,0):If.copy(mx)),t.isReset)Ih.copy(t.worldQuaternion0);else if(vx.distanceTo(yx)>s&&a&&u)if(t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Ih.copy(t.worldQuaternion0),t.currentDampingFactor=t.resetDampingFactor;else return;else{if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return;HVe(gx,yx,vx,If,i,cu),Ih.setFromRotationMatrix(gx),_g.setFromUnitVectors(cu.applyQuaternion(Ih),If),o.some(f=>f===!1)&&e!=="target"&&Ih.premultiply(_g).normalize()}t.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),_g.setFromRotationMatrix(one(h.matrixWorld)),_g.slerp(Ih,1/t.currentDampingFactor),g7(h,gx.makeRotationFromQuaternion(_g)),t.paused=8*(1-_g.dot(Ih))<kVe):(g7(h,gx.makeRotationFromQuaternion(Ih)),t.paused=!0),(d=t.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(zVe),h.dispatchEvent(UVe)}},pa=new O,rr=new O,Rn=new O;function HVe(t,e,i,n,r,s){let o=t.elements;Rn.subVectors(e,i),Rn.lengthSq()===0&&(Rn.z=1),Rn.normalize(),rr.crossVectors(n,Rn),rr.lengthSq()===0&&(Math.abs(n.z)===1?Rn.x+=1e-4:Rn.z+=1e-4,Rn.normalize(),rr.crossVectors(n,Rn)),rr.normalize(),pa.crossVectors(Rn,rr),r==="x"?s.z===1?[rr,pa,Rn]=[Rn,rr,pa]:(rr.negate(),[rr,Rn]=[Rn,rr]):r==="y"?s.x===1?[rr,pa,Rn]=[pa,Rn,rr]:(rr.negate(),[pa,Rn]=[Rn,pa]):s.x===1&&(rr.negate(),[rr,pa]=[pa,rr]),o[0]=rr.x,o[4]=pa.x,o[8]=Rn.x,o[1]=rr.y,o[5]=pa.y,o[9]=Rn.y,o[2]=rr.z,o[6]=pa.z,o[10]=Rn.z}var jVe=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.entered=!1,this.actions=Wa(e,e.actions,n,r,s,i)}disconnect(){Yo(this.actions)}dispatchEnter(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.play()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.SceneTransition.forEach(t=>t.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch())}},WVe=class extends nh{constructor(t,e){super(t),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{It.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{It.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l;if(!r||!s)return;let a=Cw(r);a&&a==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(o)))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s,o;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:a,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new jVe(a,l,r,i,n,e);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(o=this.eventsPerObjects[r.uuid])!=null&&o.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),Fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),Fo&&(t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerup",this.onMouseUp)),t.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(i=>{i.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(t=!1){let e=[];if(!t){let{stopRaycast:i,raycaster:n,page:r}=this.eventContext;if(i){let s=IO(n,r,this.objects);e=LO(s)}else this.objects.forEach(s=>{_E(n,s)&&e.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var n;e.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchLeave()))}),e.length&&e.forEach(i=>{var n;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchEnter())}),this._prevObjects=e}},XVe=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.scrollCounter=0,this.actions=Wa(e,e.actions,n,r,s,i)}connect(){this.scrollCounter=0}disconnect(){Yo(this.actions)}dispatch(t){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let e=t>0?1:-1;this.scrollCounter+=e,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(e)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled())}},qVe=class{constructor(t,e,i,n,r,s,o){this.id=t,this.data=e,this.object=i,this.domElement=s,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=Wa(e,e.actions,n,r,o,i)}computeScrollBounds(){let t=this.domElement.getBoundingClientRect(),e=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||e.scrollTop,r=i.clientTop||e.clientTop||0,s=Math.round(t.top+n-r);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=t.height,l=this.data.enterAnchor,c=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.dispatch({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Yo(this.actions)}handleResize(){this.computeScrollBounds()}dispatch({x:t,y:e}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let i=this.scrollEnd-this.scrollStart,n=Math.min(1,Math.max(0,(e-this.scrollStart)/i));this.actions.Transition.forEach(r=>r.seek(n)),this.actions.Animation.forEach(r=>r.seek(n)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled())}},YVe=class extends nh{constructor(t,e){super(t),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,a])=>{a.forEach(l=>l.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let a={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:a}),c.forEach(h=>h.dispatch(a))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([a,l])=>{a.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),l.forEach(c=>c.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:a,reverse:l})=>{var h;if(!o||!a)return;let c=Cw(o);c&&c==="Scroll"&&(a.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(a))==null||h.forEach(u=>{u.dispatchUserEvent(l)}))};let{page:i,sharedAssets:n,domElement:r,isExport:s}=this.eventContext;i.traverseEntity(o=>{var a,l,c;if((a=o.data)!=null&&a.events.length){for(let{id:h,data:u}of o.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!s){let d=new XVe(h,u,o,i,n,e);this.wheelEventsPerObject.has(o)?(l=this.wheelEventsPerObject.get(o))==null||l.push(d):this.wheelEventsPerObject.set(o,[d])}else{let d=new qVe(h,u,o,i,n,r,e);this.scrollEventsPerObject.has(o)?(c=this.scrollEventsPerObject.get(o))==null||c.push(d):this.scrollEventsPerObject.set(o,[d])}}}),this.intersectionObserver=new IntersectionObserver(o=>{let a=o[0];a&&(this.isInview=a.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},QVe=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.actions=Wa(e,e.actions,n,r,s,i)}disconnect(){Yo(this.actions)}dispatch(){this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatchFromStart()}),this.actions.Destroy.forEach(t=>{t.dispatchFromStart()})}dispatchAfter(t){this.actions.Audio.forEach(e=>{(e.interaction.data.triggerAfter??"any")===t&&(e.interaction instanceof dp?e.interaction.audioPlayer.play():e.interaction instanceof CO&&e.interaction.dispatch())}),this.actions.Video.forEach(e=>{let i=e.interaction.data.triggerAfter??"autoplay";i===t&&(e.interaction instanceof Rv?e.interaction.play(i==="autoplay"):e.interaction instanceof PO&&e.interaction.dispatch())})}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof dp?e.interaction.audioPlayer.play():e.interaction instanceof CO&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof Rv?e.interaction.play():e.interaction instanceof PO&&e.interaction.dispatch()})}},JVe=class extends nh{constructor(t,e){super(t),this.eventManager=e,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:n}=this.eventContext;(n?document:i).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.actions.Audio.forEach(s=>{s.interaction instanceof dp&&s.interaction.audioPlayer.play()}),r.actions.Video.forEach(s=>{let o=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof Rv&&s.interaction.play(o==="autoplay")})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:n,reverse:r})=>{var o,a;if(!i||!n)return;let s=Cw(i);s&&s==="Start"&&(n.dispatchEvent({type:"beginEvent",eventName:"Start"}),(o=this.eventsPerObject.get(n))==null||o.forEach(l=>{l.dispatchUserEvent(r)}),(a=this.eventsAfterPerObject.get(n))==null||a.forEach(l=>{l.dispatchUserEvent(r)}))}}connect(){let{sharedAssets:t,page:e}=this.eventContext;if(e.traverseEntity(i=>{var n,r,s,o;if((n=i.data)!=null&&n.events.length)for(let{id:a,data:l}of i.data.events){if(l.disabled||l.type!=="Start")continue;let c=new QVe(a,l,i,e,t,this.eventManager);(c.actions.Transition.length||c.actions.Animation.length||c.actions.SwitchCamera.length||c.actions.Create.length||c.actions.Destroy.length||c.actions.SceneTransition.length)&&(this.eventsPerObject.has(i)?(r=this.eventsPerObject.get(i))==null||r.push(c):this.eventsPerObject.set(i,[c])),c.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(s=this.eventsAfterPerObject.get(i))==null||s.push(c):this.eventsAfterPerObject.set(i,[c])),c.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(c):this.eventsAfterPerObject.set(i,[c]))}}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,r=n?document:i;r.addEventListener("pointerdown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),r.addEventListener("pointerdown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,o])=>{s.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>r.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,i=e?document:t;i.removeEventListener("pointerdown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,r])=>{n.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.removeEventListener("userEvent",this.onUserEvent),e.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},KVe=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.disabled=!1,this.actions=Wa(e,e.actions,n,r,s,i),this.target=e.target,this.useToggle=e.toggle}disconnect(){Yo(this.actions)}dispatch(t){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(t??!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}))}},ZVe="https://unpkg.com/@splinetool/runtime@0.9.419/build/",$Ve="https://unpkg.com/@splinetool/navmesh-wasm@0.9.419/build/",eHe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${ZVe}' + 'navmesh.js'),
		fetch('${$Ve}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,tHe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,iHe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,nHe=.001,rHe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},fne,li,zr;tOe.then(t=>{fne=t,li=new t.Vec3,zr=new t.Vec3});var sHe=new O,oHe=class{constructor(t=!1,e=!1){this.usePhysics=t,this.isExport=e,this.onPointerDown=i=>{if(It.length!==1)return;let{raycaster:n,page:r}=this.eventContext;this.eventContext.updateRaycaster(i);let s=r.raycastWithClones(n);if(s.length!==0){if(this.gameControl){let o=sHe.copy(this.gameControl.colliderWorldPosition);o.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(o,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,n)=>r=>{var d,f,p,m,g,v,y;let s;if(r instanceof xl)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof cs)s=r.object;else if(s=r,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((f=s.dataPatched.cloner)==null?void 0:f.hideBase)&&((p=s.dataPatched.physics)==null?void 0:p.fusedBody)!==!0)return!0;if(n&&!s.userData.navmesh)return;let o=s.dataPatched;if(!o.visible&&((m=o.physics)==null?void 0:m.enabled)!==!0)return!0;r.updateMatrixWorldSVD();let a=wE(o),l=s.userData.hasDestroy,c=s.userData.hasDrag,h=!1,u=!1;for(let x of o.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?h=!0:x.data.type==="Follow"&&(u=!0));if(h||a||u||l||c)return!0;if(this.usePhysics&&((g=o.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((v=o.physics)!=null&&v.fusedBody))return!0}else if("geometry"in r&&r.geometry&&i.push(bu(r.geometry,r.matrixWorld)),this.usePhysics&&((y=o.physics)==null?void 0:y.fusedBody))return r.traverseObject((x,b)=>{var E,M;if(b===0)return;let S;if(x instanceof xl)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;S=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof cs)S=x.object;else if(S=x,(E=x.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let A=S.dataPatched;if(!A.visible&&((M=A.physics)==null?void 0:M.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&i.push(bu(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(i,n)=>r=>{let s;if(r instanceof xl)return;r instanceof cs?s=r.object:s=r;let o=s.dataPatched;if(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)return!0;if(n&&!s.userData.navmesh)return;let a=r.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(wE(o)||l||c||s.dataPatched.events.some(h=>h.data.disabled!==!0&&h.data.type==="GameControl"))return!0;a&&i.push(bu(a,r.matrixWorld))},this.navmeshWasm=fne,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(e?eHe:tHe)+iHe])),this._worker=new Worker(this._workerURL)}init(t,e,i){this.gameControl=e,this.eventContext=i,this.resolution=t.ch,this.setDefaultQueryExtent(new O().setScalar(t.ch*t.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,t,n=>{this.buildFromNavmeshData(n.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(t,e,i){e.objects.forEach(l=>{var h;let c=t.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=!0})});let n=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,e.zones==="custom");if(t.traverseChildren(r),e.objects.forEach(l=>{var h;let c=t.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),(h=c.cloner)==null||h.traverseObject(u=>{u.userData.navmesh=void 0})}),n.length===0)return!1;let s=up(n),{positions:o,triIndices:a}=RT(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([o,o.length/3,a,a.length,{...rHe,...e}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let t,e,i=this.navMesh.getDebugNavMesh(),n=i.getTriangleCount(),r=new Uint32Array(n*3),s=new Float32Array(n*3*3);for(t=0;t<n*3;t++)r[t]=t;for(t=0;t<n;t++)for(e=0;e<3;e++){let a=i.getTriangle(t).getPoint(e);s[t*9+e*3+0]=a.x,s[t*9+e*3+1]=a.y,s[t*9+e*3+2]=a.z}let o=new Rt;return o.setIndex(new Ot(r,1)),o.setAttribute("position",new Ot(s,3)),o}getClosestPoint(t){return li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.getClosestPoint(li)}getClosestPointToRef(t,e){li.x=t.x,li.y=t.y,li.z=t.z;let i=this.navMesh.getClosestPoint(li);e.set(i.x,i.y,i.z)}getRandomPointAround(t,e){return li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.getRandomPointAround(li,e)}getRandomPointAroundToRef(t,e,i){li.x=t.x,li.y=t.y,li.z=t.z;let n=this.navMesh.getRandomPointAround(li,e);i.set(n.x,n.y,n.z)}moveAlong(t,e){return li.x=t.x,li.y=t.y,li.z=t.z,zr.x=e.x,zr.y=e.y,zr.z=e.z,this.navMesh.moveAlong(li,zr)}moveAlongToRef(t,e,i){return li.x=t.x,li.y=t.y,li.z=t.z,zr.x=e.x,zr.y=e.y,zr.z=e.z,this.navMesh.moveAlong(li,zr)}computePath(t,e){let i=this.getClosestPoint(e);zr.x=i.x,zr.y=i.y,zr.z=i.z,this.getClosestPoint(t);let n=this.navMesh.computePath(li,zr),r=n.getPointCount(),s=[];for(let o=0;o<r;o++){let a=n.getPoint(o);s.push(new O(a.x,a.y,a.z))}return s}createCrowd(t,e){return new aHe(this,t,e)}setDefaultQueryExtent(t){li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.setDefaultQueryExtent(li)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(t){let e=t.length*t.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(e),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,e);n.set(t);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=n.byteOffset,r.size=t.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let t=this.navMesh.getNavmeshData(),e=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,t.dataPointer,t.size),i=new Uint8Array(t.size);return i.set(e),this.navMesh.freeNavmeshData(t),i}getDefaultQueryExtentToRef(t){let e=this.navMesh.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}dispose(){var t;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(t=this.eventContext)==null||t.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(t,e,i){return li.x=t.x,li.y=t.y,li.z=t.z,this.navMesh.addCylinderObstacle(li,e,i)}addBoxObstacle(t,e,i){return li.x=t.x,li.y=t.y,li.z=t.z,zr.x=e.x,zr.y=e.y,zr.z=e.z,this.navMesh.addBoxObstacle(li,zr,i)}removeObstacle(t){this.navMesh.removeObstacle(t)}isSupported(){return this.navmeshWasm!==void 0}},aHe=class{constructor(t,e,i){this.navmeshWasmWrapper=t,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(e,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(t,e){}addAgent(t,e,i){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=e.radius,n.height=e.height,n.maxAcceleration=e.maxAcceleration,n.maxSpeed=e.maxSpeed,n.collisionQueryRange=e.collisionQueryRange,n.pathOptimizationRange=e.pathOptimizationRange,n.separationWeight=e.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z),n);return this.transforms.push(i),this.agents.push(r),this.reachRadii.push(e.reachRadius?e.reachRadius:e.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new O(0,0,0)),r}getAgentPosition(t){return this.crowd.getAgentPosition(t)}getAgentPositionToRef(t,e){let i=this.crowd.getAgentPosition(t);e.set(i.x,i.y,i.z)}getAgentVelocity(t){return this.crowd.getAgentVelocity(t)}getAgentVelocityToRef(t,e){let i=this.crowd.getAgentVelocity(t);e.set(i.x,i.y,i.z)}getAgentNextTargetPath(t){return this.crowd.getAgentNextTargetPath(t)}getAgentNextTargetPathToRef(t,e){let i=this.crowd.getAgentNextTargetPath(t);e.set(i.x,i.y,i.z)}getAgentState(t){return this.crowd.getAgentState(t)}overOffmeshConnection(t){return this.crowd.overOffmeshConnection(t)}agentGoto(t,e){this.crowd.agentGoto(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z));let i=this.agents.indexOf(t);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(e.x,e.y,e.z))}agentTeleport(t,e){this.crowd.agentTeleport(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z))}updateAgentParameters(t,e){let i=this.crowd.getAgentParameters(t);e.radius!==void 0&&(i.radius=e.radius),e.height!==void 0&&(i.height=e.height),e.maxAcceleration!==void 0&&(i.maxAcceleration=e.maxAcceleration),e.maxSpeed!==void 0&&(i.maxSpeed=e.maxSpeed),e.collisionQueryRange!==void 0&&(i.collisionQueryRange=e.collisionQueryRange),e.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=e.pathOptimizationRange),e.separationWeight!==void 0&&(i.separationWeight=e.separationWeight),this.crowd.setAgentParameters(t,i)}removeAgent(t){this.crowd.removeAgent(t);let e=this.agents.indexOf(t);e>-1&&(this.agents.splice(e,1),this.transforms.splice(e,1),this.reachRadii.splice(e,1),this._agentDestinationArmed.splice(e,1),this._agentDestination.splice(e,1))}getAgents(){return this.agents}update(t){if(this.navmeshWasmWrapper.navMesh.update(),t<=nHe)return;let e=1/60,i=10;{let n=Math.floor(t/e);n>i&&(n=i),n<1&&(n=1);let r=t/n;for(let s=0;s<n;s++)this.crowd.update(r)}for(let n=0;n<this.agents.length;n++){let r=this.agents[n],s=this.getAgentPosition(r);if(this.transforms[n].copy(s),this._agentDestinationArmed[n]){let o=s.x-this._agentDestination[n].x,a=s.z-this._agentDestination[n].z,l=this.reachRadii[n],c=this._agentDestination[n].y-this.reachRadii[n],h=this._agentDestination[n].y+this.reachRadii[n],u=o*o+a*a;s.y>c&&s.y<h&&u<l*l&&(this.onReachTarget(r,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(t){let e=new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z);this.crowd.setDefaultQueryExtent(e)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(t){let e=this.crowd.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}getCorners(t){let e,i=this.crowd.getCorners(t),n=i.getPointCount(),r=[];for(e=0;e<n;e++){let s=i.getPoint(e);r.push(new O(s.x,s.y,s.z))}return r}dispose(){this.crowd.destroy()}};function lHe(t){let e=!1;return t.scene.objects.forEach(i=>{i.data.type==="Page"&&!e&&i.data.publish.gameControlObject&&S_.traverseModuleInstances(t.scene.objects,i.id,(n,r,s)=>{for(let o of s)o.data.type==="GameControl"&&o.data.navmesh.enabled&&(e=!0)})}),e}var cHe={type:"change"},v7={type:"changeZoom"},uHe={type:"changePan"},wg={type:"start"},bg={type:"end",changed:!0},hHe={type:"end",changed:!1},_I=new qt,y7=new ge,dHe=2*Math.PI,fHe=1e-8,pHe=.01,wI=new O,XA=new ge,bI=new O,qA=new qt,x7=new Qe,mHe={type:"requestRender"},pne=class extends qr{constructor(t,e,i={isPlayMode:!1,isExport:!1}){super(),this.object=t,this.domElement=e,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,ca.DOLLY_ROTATE,ca.PAN],this.offset=new O,this.eye=new O,this.lastPosition=new O,this.lastQuaternion=new qt,this.current=new ge,this.overShoot=new ge,this.overRatio=new ge,this.spherical=new Gj,this.sphericalDelta=new Gj,this.panOffset=new O,this.panLeftV=new O,this.panUpV=new O,this.panV=new O,this.rotateStart=new ge,this.rotateEnd=new ge,this.rotateDelta=new ge,this.panStart=new ge,this.panEnd=new ge,this.panDelta=new ge,this.dollyStart=new ge,this.dollyEnd=new ge,this.dollyDelta=new ge,this.rotationRangeFactor=new ge,this.panRangeFactor=new ge,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=n=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=n.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(bI,qA,wI),this.offset.copy(bI).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(_I.copy(qA).invert()),this.panOffset.applyQuaternion(_I),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(qA),this.panOffset.applyQuaternion(qA)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),bI.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(x7.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(x7));let n=this.spherical.phi%dHe;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Ri.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),n>0&&n>Math.PI||n<0&&n>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>pHe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>fHe?(this.dispatchEvent(cHe),this.object.dispatchEvent(mHe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&Fo?this.onPointerDownTouch(n):this.onPointerDownMouse(n),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(wg),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&Fo||this.domElement.setPointerCapture(n.pointerId)))},this.onPointerLeave=n=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,wI.subVectors(this.position0,this.target0),this.spherical.setFromVector3(wI),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=n},this.onPointerEnter=n=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?XA.set(n.clientX-this.domElement.clientWidth/2,n.clientY-this.domElement.clientHeight/2):XA.set(n.clientX-this.pointerLeaveEvent.clientX,n.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(XA).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(y7,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(n.clientX,n.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(XA).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(n.clientX,n.clientY)),this.update()},this.onPointerMove=n=>{this.enabled!==!1&&(this.checkRaycastLock()||(n.pointerType==="touch"||n.pointerType==="pen"&&Fo?this.onPointerMoveTouch(n):this.onPointerMoveMouse(n),n.stopPropagation()))},this.onPointerUp=n=>{this.isPointerDown=!1,It.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),It.length>1&&n.preventDefault(),this.hasChange?this.dispatchEvent(bg):this.dispatchEvent(hHe),this.state=-1,n&&(n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&Fo||this.domElement.releasePointerCapture(n.pointerId))},this.onPointerDownMouse=n=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[n.button]:r=this.mouseButtonsPlay[n.button],r){case 0:if(n.altKey===!0&&!n.shiftKey&&!uA(n)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2;break;case 3:if(uA(n)||n.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}break;case 5:if(uA(n)||n.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=n=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(n);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(n);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(n);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=n=>{switch(It.length>1&&n.preventDefault(),this.touches[It.length-1]){case ca.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case ca.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case ca.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case ca.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=n=>{switch(It.length>1&&n.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(n),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(n),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(n),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=rz(()=>this.dispatchEvent(bg),33),this.onMouseWheel=n=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(this.options.isExport===!1&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&n.preventDefault(),this.dispatchEvent(wg),this.handleMouseWheel(n),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=n=>{if(n.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!_ee)if(n.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(wg),n.scale>this.prevScale?this.dollyIn(this.getZoomScale()):n.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=n.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(bg)},this.onContextMenu=n=>{n.preventDefault()},this.onTouchEnd=n=>{n.preventDefault()},this.onKeyDown=n=>{this.enabled!==!1&&(this.key=n.key,n.key===" "&&this.dispatchEvent(wg))},this.onKeyUp=n=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&n.key==="Alt"&&this.onPointerUp(It[0]),n.key===" "&&this.dispatchEvent(bg))},this.onPointerHover=n=>{n.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(n,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(n,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=n=>{n.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(t){t.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(t)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(t){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=t,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(t,e){this.setEnableDampingSpeed(t.enableDamping),this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.enableRotate=t.enableRotate,this.rotationLimitsMode=t.rotationLimitsMode,this.thetaIsFree=t.rotationHorizontalOffset.min===t.rotationHorizontalOffset.max&&t.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=t.rotationVerticalOffset.min===t.rotationVerticalOffset.max&&t.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=t.panLimitsMode,this.panSoftLimit=t.panSoftLimit,this.rotationSoftLimit=t.rotationSoftLimit,this.hoverRotatePanMode=t.hoverRotatePanMode,this.useWindowEvents=e==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=t.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=t.zoomLimitsEnabled,this.minZoom=t.zoomLimits.min,this.maxZoom=Math.max(t.zoomLimits.min,t.zoomLimits.max),this.minDistance=1e3/t.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/t.zoomLimits.min),this.autoRotate=t.autoRotate,this.autoRotateSpeed=t.autoRotateSpeed,this.autoRotateClockwise=t.autoRotateClockwise;let n=this.object.getTarget().applyQuaternion(_I.copy(this.object.quaternion).invert());this.minV=-t.panVerticalOffset.min+n.y,this.maxV=t.panVerticalOffset.max+n.y,this.minH=-t.panHorizontalOffset.min+n.x,this.maxH=t.panHorizontalOffset.max+n.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=nc(this.spherical.phi-t.rotationVerticalOffset.min),this.maxPhi=nc(this.spherical.phi+t.rotationVerticalOffset.max),this.minTheta=nc(nc(this.spherical.theta)-t.rotationHorizontalOffset.min),this.maxTheta=nc(nc(this.spherical.theta)+t.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,t.orbitTouches===1&&(this.touches[0]=ca.ROTATE),t.panTouches===1&&(this.touches[0]=ca.PAN),t.orbitTouches===2&&(this.touches[1]=ca.DOLLY_ROTATE),t.panTouches===2&&(this.touches[1]=ca.DOLLY_PAN),t.orbitTouches===3&&(this.touches[2]=ca.ROTATE),t.panTouches===3&&(this.touches[2]=ca.PAN),this.isTouchZoom=t.isTouchZoom,this.resetHoverEffectOnPointerLeave=t.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(t,e,i,n,r,s,o,a){this.overShoot.set(0,0);let l,c,h;t instanceof O?(l=t.x,c=t.y,this.current.set(this.target.x,this.target.y),h=!0):(l=t.theta,c=t.phi,this.current.set(nc(this.spherical.theta),nc(this.spherical.phi)),h=!1),i===0&&(this.current.x+=l,this.current.y+=c),(e===3||e===2)&&(!h&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(e===3||e===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),h||(this.overShoot.x=nc(this.overShoot.x),this.overShoot.y=nc(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=_7(Math.abs(this.overRatio.x)),this.overRatio.y=_7(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):i===2&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),t instanceof O?(t.x=l,t.y=c):(this.thetaIsFree||(t.theta=l),this.phiIsFree||(t.phi=c))}setEnableDampingSpeed(t){this.enableDamping=t,this.rotateSpeed=t===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*r/i.clientHeight,this.object.matrixWorld),this.panUp(2*e*r/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(uHe)}dollyOut(t){this.object.isPerspectiveCamera?this.scale/=t:this.object.isOrthographicCamera&&(this.object.zoom*=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(v7)}dollyIn(t){this.object.isPerspectiveCamera?this.scale*=t:this.object.isOrthographicCamera&&(this.object.zoom/=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(v7)}zoomOut(t=this.getZoomScale()){this.dispatchEvent(wg),this.dollyOut(t),this.dispatchEvent(bg)}zoomIn(t=this.getZoomScale()){this.dispatchEvent(wg),this.dollyIn(t),this.dispatchEvent(bg)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t,e=1){t.movementX!==void 0?this.rotateDelta.set(t.movementX,t.movementY):(this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*e).rotateAround(y7,-this.object.angleOffsetFromUp);let i=this.domElement,n=this.useWindowEvents?window.innerHeight:i.clientHeight,r=2*Math.PI*this.rotateDelta.x/n,s=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t,e=1){t.movementX!==void 0?this.panDelta.set(t.movementX,t.movementY):(this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*e),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(t){if(JRe===!1&&uA(t)===!1&&gHe(t)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-t.deltaX,-t.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),t.altKey?this.pan(0,this.panDelta.y):t.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;t.deltaY===0?t.deltaX<0?this.dollyIn(this.getZoomScale()):t.deltaX>0&&this.dollyOut(this.getZoomScale()):t.deltaY<0?this.dollyIn(this.getZoomScale()):t.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(It.length===2){let t=.5*(It[0].pageX+It[1].pageX),e=.5*(It[0].pageY+It[1].pageY);this.rotateStart.set(t,e)}else this.rotateStart.set(It[0].pageX,It[0].pageY)}handleTouchStartPan(){if(It.length===2){let t=.5*(It[0].pageX+It[1].pageX),e=.5*(It[0].pageY+It[1].pageY);this.panStart.set(t,e)}else this.panStart.set(It[0].pageX,It[0].pageY)}handleTouchStartDolly(){let t=It[0].pageX-It[1].pageX,e=It[0].pageY-It[1].pageY,i=Math.sqrt(t*t+e*e);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(t){if(It.length===2){let i=b3(t),n=.5*(t.pageX+i.x),r=.5*(t.pageY+i.y);this.rotateEnd.set(n,r)}else{if(t.pointerId!==It[0].pointerId)return;this.rotateEnd.set(t.pageX,t.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;e&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(t){if(It.length===2){let e=b3(t),i=.5*(t.pageX+e.x),n=.5*(t.pageY+e.y);this.panEnd.set(i,n)}else{if(t.pointerId!==It[0].pointerId)return;this.panEnd.set(t.pageX,t.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(t){let e=b3(t),i=t.pageX-e.x,n=t.pageY-e.y,r=Math.sqrt(i*i+n*n);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enablePan&&this.handleTouchMovePan(t)}handleTouchMoveDollyRotate(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enableRotate&&this.handleTouchMoveRotate(t)}checkRaycastLock(){var t;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let e=(t=this.options)==null?void 0:t.showCameraLock;return e&&e(),!0}}else return!1}};function nc(t){let e=Math.PI*2;for(;t<=-Math.PI;)t+=e;for(;t>Math.PI;)t-=e;return t}function _7(t){return 1-Math.pow(1-t,4)}function gHe(t){return t.wheelDeltaY===0||t.deltaY===0?ET&&t.shiftKey&&Math.abs(t.wheelDeltaX)>=120?!1:t.wheelDeltaX?t.wheelDeltaX===-3*t.deltaX:t.deltaMode===0:t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY:t.deltaMode===0}var w7=class{constructor(t,e,i,n,r,s){this.id=t,this.data=e,this.object=i,this.currentIntersectedObjects=[],this.disabled=!1,this.actions=Wa(e,e.actions,n,r,s,i),this.target=e.target,this.useToggle=e.toggle,this.triggeringObjects=e.triggeringObjects.map(o=>n.scene.find(o))}isValidTriggeringObject(t){return this.target==="all"?!0:this.triggeringObjects.some(e=>e===t||e.isAncestorOf(t.uuid)||t.isAncestorOf(e.uuid))}disconnect(){Yo(this.actions)}dispatch(){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}))}},hi;nOe.then(t=>hi=t);var Xn=new O,ll=new qt,Lh=new O,SI=new Er(0,0,0,"YXZ"),b7=new Er(0,0,0,"XYZ"),uu=new O,S7=new O,A7=new O(1,1,1),Sg=new qt,AI=new Qe,vHe=new Qe,yHe={type:"updateMatrix"},BO={type:"beginEvent",eventName:"Collision"},xHe={type:"beginEvent",eventName:"Trigger"};function _He(t){if(S_.physicsEnabled(t.scene.objects))return!0;let e=!1;return t.scene.objects.traverse((i,n)=>{if(n.events){for(let r of n.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){e=!0;break}}}),e}var wE=t=>t.states.some(e=>e.data.position!==void 0||e.data.rotation!==void 0||e.data.hiddenMatrix!==void 0||e.data.cloner!==void 0||e.data.pathSnapping!==void 0),wHe=class{constructor(t){this.eventContext=t,this.orbitControlsNeedsUpdate=!0,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==hi.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[i,n,r]=this.rigidBodyToMesh.get(e.handle);if(Xn.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),ll.copy(e.rotation()),i.matrixWorld.compose(Xn,ll,n),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(yHe),r){let s=i.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(i.matrixWorld);for(let o of s.children)o.updateMatrixWorld(!0)}for(let o of i.children)o.updateMatrixWorld(!0)}},this.handleCollisionEvents=(e,i,n)=>{var o,a,l,c;if(n===!1)return;let r,s;if(this.sensorToTriggerEvent[e]?(r=this.sensorToTriggerEvent[e],s=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(r=this.sensorToTriggerEvent[i],s=this.sharedGameControlGlobals.colliderToEntity.get(e)),r&&s&&r.isValidTriggeringObject(s)){r.dispatch();return}for(let h=this.sharedGameControlGlobals.createdObjects.length-1;h>=0;h--){let u=this.sharedGameControlGlobals.createdObjects[h];if(u.userData.hasCollisionDestroy&&(((o=u.rigidBody)==null?void 0:o.collider(0).handle)===e||((a=u.rigidBody)==null?void 0:a.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(h,1),u.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(u.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(e)){let h=this.sharedGameControlGlobals.colliderToEntity.get(i),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u===void 0)return;for(let d of u)d.data.target==="character"&&this.dispatchCollisionEvent(d,h,i)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(i)){let h=this.sharedGameControlGlobals.colliderToEntity.get(e),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u===void 0)return;for(let d of u)d.data.target==="character"&&this.dispatchCollisionEvent(d,h,e)}else{let h=this.sharedGameControlGlobals.colliderToEntity.get(e),u=this.sharedGameControlGlobals.entityToCollisionEvents[h.uuid];if(u!==void 0)for(let p of u)p.data.target==="scene"&&this.dispatchCollisionEvent(p,h,e);let d=this.sharedGameControlGlobals.colliderToEntity.get(i),f=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(f!==void 0)for(let p of f)p.data.target==="scene"&&this.dispatchCollisionEvent(p,d,i)}},this.isExport=t.isExport,this.sharedAssets=t.sharedAssets,this.renderer=t.renderer,this.requestRender=t.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=rne,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(t){t.forEach(e=>{e.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(t=>{var i,n;let e=t.dataPatched;for(let r of e.events){if(r.data.disabled===!0)continue;let s=(n=(i=r.data.actions)==null?void 0:i.find(o=>o.data.type==="Destroy"))==null?void 0:n.data;if(s)for(let o of s.objects){let a=this.page.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(t=>{let e=t.dataPatched;for(let i of e.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let n of i.data.objects){let r=this.page.scene.find(n);r&&(r.userData.hasDrag=!0)}})}initBVH(){let t=[];if(this.page.traverseChildren(e=>{var a,l;let i;if(e instanceof xl)return;e instanceof cs?i=e.object:i=e;let n=i.dataPatched;if(((a=n.physics)==null?void 0:a.enabled)==="visibility"?!n.visible:!((l=n.physics)!=null&&l.enabled))return!0;let r=e.geometry,s=i.userData.hasDestroy===!0,o=i.userData.hasDrag===!0;if(wE(n)||s||o||i.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return e.updateMatrixWorldSVD(),this.addBoundsTree(e),!0;r&&t.push(bu(r,e.matrixWorld))}),t.length>0){let e=up(t,!1);this.sharedGameControlGlobals.staticMeshBVH=new p1(e)}}addRigidBody(t,e,i){let n=[],r="geometry"in t?t.geometry:void 0,s=e.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&n.push(bu(r,t.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(t,n);t.traverseObject(o),t.children.forEach(l=>l.updateMatrixWorld(!0));let a=t.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(n.length>0){let o,a=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;a?(o=hi.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(o=hi.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)):o=hi.RigidBodyDesc.fixed();let l=up(n);(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Xn,ll,Lh),t.position0=Xn.clone().divideScalar(this.pixelsPerMeter),t.rotation0=ll.clone(),Xn.divideScalar(this.pixelsPerMeter),o.setTranslation(Xn.x,Xn.y,Xn.z).setRotation(ll),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Lh.x/this.pixelsPerMeter,Lh.y/this.pixelsPerMeter,Lh.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(c.handle,[t,Lh.clone(),s.physics.fusedBody]);let h=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,e,h)}catch{try{this.addCollider(c,s.physics,l,e,!1)}catch(u){console.error(u)}}t.rigidBody=c}}addBoundsTree(t){var i;let e=[];if(((i=t.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&e.push(bu(t.geometry,t.shearScale)),t.traverseObject(this.gatherChildrenGeom(t,e)),t.children.forEach(n=>n.updateMatrixWorld(!0)),e.length>0){let n=up(e,!1);t.bvhGeometry=n,t.bvhGeometry.boundsTree=new p1(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)}}addCollider(t,e,i,n,r=!0){var a,l;if((i==null?void 0:i.getAttribute("position").count)===0||((a=i==null?void 0:i.getIndex())==null?void 0:a.count)===0)return;let s;i&&(e.colliderType==="trimesh"?s=hi.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=hi.ColliderDesc.convexMesh(i.getAttribute("position").array,r?i.getIndex().array:void 0)),s.setFrictionCombineRule(hi.CoefficientCombineRule.Average).setRestitutionCombineRule(hi.CoefficientCombineRule.Average).setDensity(e.density).setFriction(e.friction).setRestitution(e.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,t);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,n),(l=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(hi.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(t,e){return(i,n)=>{var a;if(n===0)return;let r;if(i instanceof xl)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof cs)r=i.object;else if(r=i,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=r.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;n===1?t.hasNonUniformScale?i.matrixWorld.multiplyMatrices(t.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let o=i.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&e.push(bu(o,i.matrixWorld))}}activate(t){var d,f;this.eventManager=t,this.usePhysics=this.page.data.globalPhysics.usePhysics;let e=this.page.playCamera,i=!1,n=5,r=8,s=9,o="drag",a=this.page.data.publish.gameControlObject,l=a!==null?this.page.find(a):null,c=null;if(l)for(let p of l.data.events){if(p.data.disabled||p.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null&&!((f=m.data.physics)!=null&&f.fusedBody););p.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=p.data)}if(l&&c){i=i||c.camera===e.uuid||l.uuid===e.uuid;let p=new sne(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==e.uuid&&c.camera===e.uuid,e,this.page,this.sharedAssets);this.gameControl=p,c.keyAssignments,n=c.joystickPosLoc,r=c.joystickRotLoc,s=c.jumpTouchButtonLoc,o=c.rotByTouch,Fo&&c.touchControl&&(this.joystickToGameControls[n]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),o==="joystick"&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let p=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new oHe(this.usePhysics,this.isExport);let m;p.collider.type==="sphere"?m=p.collider.radius*2:m=p.collider.height,m=Math.floor(m/p.navmesh.ch-1),this.navigationMeshWrapper.init({...p.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:p,enablePan:m,enableZoom:g,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(p||m||g||v||y!==0)&&(this.orbitControls=new pne(e,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let h=this.renderer.domElement.width/this.renderer.getPixelRatio(),u=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((p,m)=>{let g=document.body.appendChild(document.createElement("div")),[v,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],b=(h-5*v)/4+v,S={},A=p==="jmp",E=A?0:v;m<10?(m<5?S.top=E/2:S.bottom=E/2,S.left=E/2+m%5*b):m===10?(S.left=E/2,S.top=u/2):(S.right=E/2,S.top=u/2),S.top?S.top-=y[1]:S.bottom+=y[1],S.left?S.left+=y[0]:S.right-=y[0];for(let P in S)S[P]+="px";if(A){let P=g.appendChild(document.createElement("div"));Object.assign(P.style,S,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let I=v/16*16*.4;x==="show"&&(P.innerHTML=`
						<svg width="${I}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),P.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),P.addEventListener("touchend",k=>k.preventDefault()),this.joysticks[m]=[void 0,g];return}let M={zone:g,mode:"static",position:S,size:v};x==="hide"&&(M.restOpacity=0);let T=kGe.create(M);T.on("move",(P,I)=>{let k=this.gameControl;p==="pos"?I.force<.2?k.moveForce=0:(k.movementState.movePosZ=Math.sin(-I.angle.radian),k.movementState.movePosX=Math.cos(-I.angle.radian),I.force>1.2?k.movementState.run=1:k.movementState.run=0,I.force<.3?k.moveForce=(I.force-.2)/.1:k.moveForce=1):p==="rot"&&(I.force<.2?k.rotForce=0:(k.movementState.rotPosX=I.vector.y,k.movementState.rotPosY=-I.vector.x,I.force<.3?k.rotForce=(I.force-.2)/.1:k.rotForce=1)),this.requestRender()}),T.on("end",(P,I)=>{let k=this.gameControl;p==="pos"?(k.movementState.movePosZ=0,k.movementState.movePosX=0,k.moveForce=1):p==="rot"&&(k.movementState.rotPosX=0,k.movementState.rotPosY=0,k.rotForce=1)}),this.joysticks[m]=[T,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(p=>p.disabled=!1)},80)}initPhysics(){var o;(o=this.sharedGameControlGlobals.rapierWorld)==null||o.free(),this.sharedGameControlGlobals.rapierWorld=new hi.World(new hi.Vector3(0,this.gravity,0)),this.events=new hi.EventQueue(!0);let t=[],e=[];if(this.page.traverseChildren(a=>{var v,y,x,b;let l;if(a instanceof xl)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;l=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof cs)l=a.object;else if(l=a,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0;let c=l.dataPatched,h;for(let S of c.events)S.data.disabled!==!0&&S.data.type==="GameControl"&&(h=S.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;a.updateMatrixWorldSVD();let u=wE(c),d=!1,f=l.userData.hasDestroy,p=l.userData.hasDrag,m=!1;for(let S of c.events)if(S.data.disabled!==!0){if(S.data.type==="Collision"){d=!0;let A=new KVe(S.id,S.data,l,this.page,this.sharedAssets,this.eventManager);A.disabled=!0,this.collisionEvents.push(A),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(E=>E.id!==S.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(A):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[A]}else if(S.data.type==="Follow"){m=!0;let A=S.data.target;a.traverseVisible(E=>{E.userData.isFollowingObj=A})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(a.matrixWorldFusedFalse=a.matrixWorld.clone());let g=a.geometry;if(h!==void 0){let S=hi.RigidBodyDesc.kinematicPositionBased();(a.hasNonUniformScale?a.matrixWorldRigid:a.matrixWorld).decompose(Xn,ll,Lh),a.position0=Xn.clone().divideScalar(this.pixelsPerMeter),a.rotation0=ll.clone(),Xn.divideScalar(this.pixelsPerMeter),S.setTranslation(Xn.x,Xn.y,Xn.z).setRotation(ll);let A=this.sharedGameControlGlobals.rapierWorld.createRigidBody(S);a.rigidBody=A;let E;h.collider.type==="sphere"?E=hi.ColliderDesc.ball(h.collider.radius/this.pixelsPerMeter):h.collider.type==="capsule"?E=hi.ColliderDesc.capsule((h.collider.height/2-h.collider.radius)/this.pixelsPerMeter,h.collider.radius/this.pixelsPerMeter):E=hi.ColliderDesc.cuboid(h.collider.width/this.pixelsPerMeter/2,h.collider.height/this.pixelsPerMeter/2,h.collider.depth/this.pixelsPerMeter/2),E.setFrictionCombineRule(hi.CoefficientCombineRule.Average).setRestitutionCombineRule(hi.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let M=this.sharedGameControlGlobals.rapierWorld.createCollider(E,A);this.sharedGameControlGlobals.colliderToEntity.set(M.handle,l),Xn.fromArray(h.collider.position).multiply(Lh.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),M.setTranslationWrtParent(Xn);let T=new qt().setFromEuler(new Er().setFromVector3(new O().fromArray(h.collider.rotation)));M.setRotationWrtParent(T),M.setActiveEvents(hi.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||u||m||f||p||d?(this.addRigidBody(a,l,{hasFollow:m,hasTransformAnim:u,hasDrag:p}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(g&&t.push(bu(g,a.matrixWorld)),c.physics.fusedBody&&a.traverseObject((S,A)=>{var P;if(A===0)return;let E;if(S instanceof xl)if(S.objectForSample){if(S.objectForSample.dataPatched.physics.fusedBody)return;E=S.object}else return S.object.dataPatched.physics.fusedBody===!0&&S.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(S instanceof cs)E=S.object;else if(E=S,(P=E.dataPatched.cloner)==null?void 0:P.hideBase)return!0;let M=E.dataPatched;if(M.physics.enabled==="visibility"?!M.visible:!M.physics.enabled)return!0;let T=S.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&t.push(bu(T,S.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,e));if(((b=c.physics)==null?void 0:b.fusedBody)===!0||h)return!0}),t.length===0)return;let i=up(t);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let n=hi.RigidBodyDesc.fixed(),r=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n),s=hi.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(hi.CoefficientCombineRule.Multiply).setRestitutionCombineRule(hi.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,r);for(let[a,l]of e){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(a,r);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?(this.gameControl===null||this.needsCollisionDetection)&&this.initPhysics():(this.page.traverseEntity(t=>{for(let e of t.dataPatched.events)if(e.data.type==="Trigger"&&e.data.disabled!==!0){let i=new w7(e.id,e.data,t,this.page,this.sharedAssets,this.eventManager),n=new Qe().compose(uu.fromArray(e.data.position),Sg.setFromEuler(b7.fromArray(e.data.rotation)),A7);if(e.data.triggerZone==="box"){let r=new Gn;r.min.fromArray(e.data.size).multiplyScalar(-.5),r.max.fromArray(e.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,n,t,i])}else this.sharedGameControlGlobals.triggers.push([e.data.radius,n,t,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(t=>t.disconnect()),this.sharedGameControlGlobals.triggers.forEach(t=>t[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var t,e,i,n;this.page.traverse(r=>{let s=r;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(e=this.gameControl)==null||e.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([r,s])=>{r==null||r.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(n=this.navigationMeshWrapper)==null||n.dispose(),this.navigationMeshWrapper=void 0;for(let r of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))r.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}update(t,e,i){var r;let n=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(n=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,n=!1):this.initializationCounter===2&&this.gameControl&&(n=!this.gameControl.update(t,e,i)&&n),this.usePhysics){for(let s of this.sharedGameControlGlobals.entitiesWithTransformAnim){(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Xn,ll,Lh),SI.setFromQuaternion(ll);let o=s;o.prevR===void 0?(o.prevR=SI.clone(),o.prevT=Xn.clone()):(o.prevR.copy(SI),o.prevT.copy(Xn)),s.rigidBody.setNextKinematicTranslation(Xn.divideScalar(this.pixelsPerMeter)),s.rigidBody.setNextKinematicRotation(ll)}this.sharedGameControlGlobals.rapierWorld.step(this.events),(r=this.events)==null||r.drainCollisionEvents(this.handleCollisionEvents),n=!this.updatePositions()&&n}return n}dispatchCollisionEvent(t,e,i){var s;let n=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,r;if(e.cloner){for(let o of e.cloner.children)if(o.rigidBody===n){r=o;break}}t.dispatch(r),e.dispatchEvent(BO)}updateUseWindowEvents(t){var e;(e=this.orbitControls)==null||e.updateUseWindowEvents(t)}generateSensorColliderDescs(t,e,i){let n=vHe.copy(t.matrixWorld).invert();t.traverseEntity((r,s)=>{if(e===!1&&s===1)return!0;for(let o of r.dataPatched.events)if(o.data.type==="Trigger"&&o.data.disabled!==!0){let a=new w7(o.id,o.data,r,this.page,this.sharedAssets,this.eventManager),l;if(o.data.triggerZone==="box"?l=hi.ColliderDesc.cuboid(...o.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=hi.ColliderDesc.ball(o.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(hi.ActiveEvents.COLLISION_EVENTS),uu.fromArray(o.data.position),Sg.setFromEuler(b7.fromArray(o.data.rotation)),AI.compose(uu,Sg,A7).premultiply(r.matrixWorld),i?(AI.decompose(uu,Sg,S7),l.setActiveCollisionTypes(hi.ActiveCollisionTypes.KINEMATIC_FIXED|hi.ActiveCollisionTypes.DYNAMIC_FIXED)):(AI.premultiply(n).decompose(uu,Sg,S7),t.rigidBody.bodyType()===hi.RigidBodyType.Dynamic||(t.rigidBody.bodyType()===hi.RigidBodyType.Fixed?l.setActiveCollisionTypes(hi.ActiveCollisionTypes.KINEMATIC_FIXED|hi.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(hi.ActiveCollisionTypes.KINEMATIC_KINEMATIC|hi.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),uu.divideScalar(this.pixelsPerMeter),l.setTranslation(uu.x,uu.y,uu.z),l.setRotation(Sg),i)i.push([l,a]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,t.rigidBody);this.sensorToTriggerEvent[c.handle]=a}}})}};function bHe(t){let e=this._clip.duration,i=this._clip.start??0,n=this.loop,r=this.time+t,s=this._loopCount,o=n===Sk;if(t===0)return s===-1?r:o&&(s&1)===1?e-(r-i):r;if(n===t$){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=e||r<i){let a=Math.floor((r-i)/(e-i));r-=(e-i)*a,s+=Math.abs(a);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(r=t>0?e:i,this.repetitions===1&&(r=e)),this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){let c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return e-(r-i)}return r}var M7=!1,SHe=class{constructor(t,e,i,n){this.scene=t,this.requestRender=e,this.updateDisplayProgress=i,this.animationInspectorState=n,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=r=>{r.data.type==="Empty"&&r.data.animations&&r.data.animations.forEach((s,o)=>{let a=s[0]+"/";if(Array.isArray(r.identity)?a+=r.identity[0]:a+=r.uuid,this.clipIdToAction[a])return;let l=lR.parse(JSON.parse(s[2]));r.animations[o]=l;let c=this.mixer.clipAction(l,r);M7===!1&&(Object.getPrototypeOf(c)._updateTime=bHe,M7=!0),c.clampWhenFinished=!0,this.clipIdToAction[a]=c})},this.mixer=new wTe(t),this.scene.traverseEntity(this.addClip)}deleteClip(t,e){let i=this.scene.find(e);if(!i)return;let n=i.animations.find(s=>s.uuid===t);if(!n)return;let r=this.clipIdToAction[t];!r||(r.stop(),this.mixer.uncacheClip(n),delete this.clipIdToAction[t],i.animations=i.animations.filter(s=>s.uuid!==t))}get isPlaying(){return Object.values(this.clipIdToAction).some(t=>t.isRunning())}playFromInspector(t){this.mixer.stopAllAction();let e=this.clipIdToAction[t];!e||(e.play(),this.activeClip=e.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(t=>{t.repetitions=1/0,t.loop=i$}),this.mixer.stopAllAction(),this.requestRender()}play(t){let e=t.clipId+"/"+t.object,i=this.clipIdToAction[e];if(i)return t&&(t.repeat>=0&&(i.repetitions=t.repeat+1),t.direction==="pingpong"&&t.repeat!==0&&(i.loop=Sk)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(t){let e=this.clipIdToAction[t];!e||(e.play(),e.paused=!1,this.requestRender())}pauseFromInspector(t){let e=this.clipIdToAction[t];!e||(e.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(t){var e;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(e=this.animationInspectorState)!=null&&e.isScrubbing)return;this.mixer.update(t/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var t,e;return((e=(t=this.activeClip)==null?void 0:t.tracks[0])==null?void 0:e.times.length)??0}setProgressFromInspector(t,e){if(!this.clipIdToAction[e])return;this.activeClip!==this.clipIdToAction[e].getClip()&&this.playFromInspector(e);let i=this.clipIdToAction[e].paused;this.clipIdToAction[e].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?t/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[e].paused=!0)}},MI=new WeakMap,AHe=class extends Nk{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,i,n){let r=new cR(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(t,s=>{this.decodeDracoFile(s,e).catch(n)},i,n)}decodeDracoFile(t,e,i,n){let r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(t,r).then(e)}decodeGeometry(t,e){let i=JSON.stringify(e);if(MI.has(t)){let a=MI.get(t);if(a.key===i)return a.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,r=this.workerNextTaskID++,s=t.byteLength,o=this._getWorker(r,s).then(a=>(n=a,new Promise((l,c)=>{n._callbacks[r]={resolve:l,reject:c},n.postMessage({type:"decode",id:r,taskConfig:e,buffer:t},[t])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{n&&r&&this._releaseTask(n,r)}),MI.set(t,{key:i,promise:o}),o}_createGeometry(t){let e=new Rt;t.index&&e.setIndex(new Ot(t.index.array,1));for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i],r=n.name,s=n.array,o=n.itemSize;e.setAttribute(r,new Ot(s,o))}return e}_loadLibrary(t,e){let i=new cR(this.manager);return i.setPath(this.decoderPath),i.setResponseType(e),i.setWithCredentials(this.withCredentials),new Promise((n,r)=>{i.load(t,n,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(i=>{let n=i[0];t||(this.decoderConfig.wasmBinary=i[1]);let r=MHe.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(r){let s=r.data;switch(s.type){case"decode":n._callbacks[s.id].resolve(s);break;case"error":n._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,r){return n._taskLoad>r._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function MHe(){let t,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":let l=a.buffer,c=a.taskConfig;e.then(h=>{let u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=i(u,d,f,c),m=p.attributes.map(g=>g.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function i(o,a,l,c){let h=c.attributeIDs,u=c.attributeTypes,d,f,p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let m={index:null,attributes:[]};for(let g in h){let v=self[u[g]],y,x;if(c.useUniqueIDs)x=h[g],y=a.GetAttributeByUniqueId(d,x);else{if(x=a.GetAttributeId(d,o[h[g]]),x===-1)continue;y=a.GetAttribute(d,x)}m.attributes.push(r(o,a,d,g,v,y))}return p===o.TRIANGULAR_MESH&&(m.index=n(o,a,d)),o.destroy(d),m}function n(o,a,l){let c=l.num_faces()*3,h=c*4,u=o._malloc(h);a.GetTrianglesUInt32Array(l,h,u);let d=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:d,itemSize:1}}function r(o,a,l,c,h,u){let d=u.num_components(),f=l.num_points()*d,p=f*h.BYTES_PER_ELEMENT,m=s(o,h),g=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,m,p,g);let v=new h(o.HEAPF32.buffer,g,f).slice();return o._free(g),{name:c,array:v,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var od;function CHe(){return od||(od=new AHe,od.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),od.decoderPending}async function EHe(t){if(od){let e={attributeIDs:od.defaultAttributeIDs,attributeTypes:od.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await od.decodeGeometry(new Int8Array(t).buffer,e)}catch(n){console.error(n)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([n,r])=>({name:n,itemSize:r.itemSize,array:r.array}))}}return null}async function THe(t,e){let[i,n]=Ree(AR.deserialize(new Uint8Array(t)));gFe(i);let r=[];i.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await CHe();for(let s of r){let o=await EHe(Lr(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:c,itemSize:h})=>{a[l]={array:c,itemSize:h,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(i),n.result().data}var C7=Object.keys(une).filter(t=>isNaN(Number(t))),PHe=class{constructor(t,e,i,n){this.publish=t,this.controlsManager=e,this.animationControls=i,this.eventContext=n,this.isEnable=!1,this._isPaused=!1,this.activateCount=0,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=r=>{(r.touches.length>1||this.preventTouchScroll)&&r.preventDefault()},this.onMouseWheelPreventScroll=r=>{this.preventScroll&&r.preventDefault()},this.stopRaycast=t.stopRaycast,this.preventScroll=t.preventScroll,this.preventTouchScroll=t.preventTouchScroll,this.hideCursor=t.hideCursor,this.requestRender=n.requestRender}activate(){if(this.handlers={Spline:new _Ve(this.eventContext),Conditional:new EVe(this.eventContext,this),Start:new JVe(this.eventContext,this),Basic:new bVe(this.eventContext,this),MouseHover:new WVe(this.eventContext,this),Scroll:new YVe(this.eventContext,this),Follow:new NVe(this.eventContext,this),DragDrop:new LVe(this.eventContext,this),LookAt:new VVe(this.eventContext)},this.isPaused)return;let{page:t,domElement:e,eventElement:i}=this.eventContext;this.hideCursor&&(e.style.cursor="none"),this.isEnable=!0,t.traverseEntity(n=>{n.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(n=>n.connect()),C7.forEach(n=>{(Object.values(this.handlers).some(r=>r.domEventsNeeded.has(n))||n==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(e.addEventListener(n,this.onResetRaycaster),i.addEventListener(n,this.onResetRaycaster))}),e.addEventListener("wheel",this.onMouseWheelPreventScroll),e.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var i;let{page:t,domElement:e}=this.eventContext;this.isEnable=!1,e.style.cursor="",Object.values(this.handlers).forEach(n=>n.disconnect()),(i=this.controlsManager.gameControl)==null||i.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(n=>{n.removeEventListener("requestRender",this.requestRender)}),C7.forEach(n=>{e.removeEventListener(n,this.onResetRaycaster)}),e.removeEventListener("touchmove",this.onTouchMovePreventScroll),e.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this._isPaused}pause(){this._isPaused=!0,this.deactivate()}resume(){this._isPaused=!1,this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(t){let e=this.isEnable;e&&this.deactivate(),this.eventContext.useWindowEvents=t,e&&this.activate()}},DHe=class{constructor(t,e,i,n,r){this._aspect=1,this.enableResponsive=!1,this._renderer=t,this._camera=e,this._frameSize=new ge().copy(i),this._editorSize=new ge().copy(n),this._aspect=e.aspect,this._fov=r??e.fov}set frameSize(t){this._frameSize.copy(t)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let t=this._frameSize.x,e=this._frameSize.y,i=this._editorSize.y;this._aspect=t/e,e<=i&&(this._camera.zoom*=i/e),this._renderer.setViewport(0,0,t,e)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,e=this._editorSize.y,i=this._fov;if(t>e){let n=IHe(t,1080,2160,1,15)/100;i*=t/e,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(t){this._camera=t,this._aspect=t.aspect,this._fov=t.fov}revert(){let t=window.innerWidth,e=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,t,e),this._renderer.setSize(t,e)),this._camera&&(this._camera.aspect=t/e,this._camera.fov=this._fov,this._camera.setViewplaneSize(t,e,this.enableResponsive),this._camera.updateProjectionMatrix())}};function IHe(t,e,i,n,r){return(t-e)/(i-e)*(r-n)+n}var LHe=class{get sharedAssets(){return this.shared}constructor(t,e={}){this.shared=new Lz(t.shared,e),this.scene=new Gz(t.scene,this.sharedAssets)}reset(t,e){this.scene.clearScene(),this.sharedAssets.reset(t.shared),this.scene.resetAfterClear(t.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let t of this.scene.children)t instanceof Ad&&t.personalCamera.updateState(t.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(t=>{t instanceof fo&&t.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},BHe=class{constructor({x:t=10,y:e=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}dispose(){var t;(t=this.element.parentElement)==null||t.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let t=performance.now()-this._startTime;this.element.innerHTML=t.toFixed(3)+" ms"}};function RHe(t){let e;if(t.index)for(let i=0;i<t.index.array.length;i+=3)e=t.index.array[i],t.index.array[i]=t.index.array[i+2],t.index.array[i+2]=e}function S1(t){return t instanceof T_?"SubdivObject":t.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function OHe(t,e){let i={};return t.traverseEntity(n=>{var l;if(!n.visible||!(n instanceof go)||n.type!=="Mesh"||Array.isArray(n.material)||n.states&&Object.keys(n.states).length)return;let r=n.parent;for(;r;){if(r instanceof go&&n.states&&Object.keys(n.states).length)return;r=r.parent}let s=n.material.uuid,o=e.shared.materials[s];if(o){if(!uo.isMergable(o))return}else{let c=(l=e.scene.objects.get(n.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!uo.isMergable(c.material))return;s=uo.getHash(c.material)}}i[s]||(i[s]={});let a=i[s][S1(n)];if(a){if(a.push(n),n.cloner)for(let c of n.cloner.children)a.push(c)}else if(i[s][S1(n)]=[n],n.cloner)for(let c of n.cloner.children)i[s][S1(n)].push(c)}),i}function FHe(t){let e=0;return Object.values(t).forEach(i=>{Object.values(i).forEach(n=>{let r=n.length;r>e&&(e=r)})}),e}function NHe(t,e){let i=OHe(e,t),n=FHe(i),r=new Array(n),s=0,o=new Array(n),a=0,l=new Array(n),c=0,h=new Array(n),u=0;for(let[d,f]of Object.entries(i))for(let p of Object.values(f)){if(a=0,c=0,p.forEach(g=>{g instanceof go&&(o[a++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),o[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&RHe(o[g]);let m=up(o.slice(0,a),!1);if(m){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new $s(m,l[0].material);break}default:{g=new $s(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,e.add(g);let v=y=>{u=0;for(let x of y)x.children&&v(x.children),x instanceof go&&(Array.isArray(x.material)||i[x.material.uuid]&&i[x.material.uuid][S1(x)]&&i[x.material.uuid][S1(x)].length>1||(h[u++]=x));for(let x=0;x<u;x++)e.attach(h[x])};for(let y=0;y<c;y++){let x=l[y];v(x.children),r[s++]=x}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var kHe=I0(lwe(),1),zHe=new ge;function UHe(t){let e="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";t.endsWith(".spline")?console.warn(e+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(e)}var GHe=class{constructor(t,{renderOnDemand:e,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this._lastTime=performance.now(),this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=n=>{var r,s,o,a,l,c,h,u,d,f,p;if(this.time=n,this.dt=this.time-this._lastTime,this._lastTime=this.time,(r=this._perfs)==null||r.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((a=this._eventManager.handlers)!=null&&a.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(h=this._animationControls)==null||h.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),this._eventManager&&(this._eventManager.isEnable||this._eventManager.activate(),((u=this._eventManager.handlers)==null?void 0:u.Follow).onAnimationFrameDamping(),((d=this._eventManager.handlers)==null?void 0:d.LookAt).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let m=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=m,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(p=this._perfs)==null||p.end()},this._resize=()=>{var n,r,s;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=zHe.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(n=this._scene)==null?void 0:n.activeCamera,this._camera&&((r=this._frameView)==null||r.setCamera(this._camera),(s=this._frameView)==null||s.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),this._requestRenderAutoMode())},this._debouncedResize=rz(this._resize,10),this.canvas=t,this.renderMode=e?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new BHe({x:10,y:10})),$Re(t)}async load(t,e){UHe(t),this.disposed=!1;let i=await(await fetch(t,e)).arrayBuffer();await this.start(i)}async start(t,{interactive:e=!0}={}){var s,o,a;if(this.disposed)return;let i=await THe(t);this._data=i,i.version&&(0,kHe.default)(i.version,"0.9.419")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([x9(i)&&yke(),zze(i)&&mke(),S_.physicsEnabled(i.scene.objects)&&rOe(),m9(i)&&Cze(),lHe(i)&&iOe()].filter(Boolean)),(s=this._eventManager)==null||s.deactivate(),(o=this._controls)==null||o.deactivate(),(a=this._scene)==null||a.dispose();let n=new LHe(i);if(n.resetPersonalCameraFromDocumentData(),this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let l=performance.now();NHe(i,n.scene);let c=performance.now();console.log("Merged geometries in ",c-l," ms")}x9(i)&&this._scene.traverse(l=>{Bu(l)&&l.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var l;this._requestRenderAutoMode(),(l=this._scene)==null||l.traverse(c=>{c instanceof xl&&c.pendingMediaLoad&&c.update()})});let r=Object.keys(i.shared.fonts).map(l=>this._sharedAssetsManager.getFont(l).loadingPromise);if(Promise.all(r).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),m9(i)&&_He(i)&&await Promise.all(r),this._scene.rewriteEventsBeforeGoToPlayMode(),$z(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new pGe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData),this._frameView)this._frameView.setCamera(this._camera);else{let l=Object.values(i.frames)[0];l.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=l.size[0],this._viewportHeight=l.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new DHe(this._renderer,this._camera,new ge(this._viewportWidth,this._viewportHeight),new ge(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(l.allowResponsive??!1)&&l.preset==="fullscreen"}if(e){let l=new yVe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0);this._scene.updateMatrixWorld(!0),this._controls=new wHe(l),this._animationControls=new SHe(this._scene,this._requestRenderAutoMode),this._eventManager=new PHe(i.scene.publish,this._controls,this._animationControls,l),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),this._renderer.setAnimationLoop(this.render)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",t);return this._createProxyObject(e)}findObjectByName(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByName(t);return this._createProxyObject(e)}getAllObjects(){var e;let t=[];return(e=this._scene)==null||e.traverseEntity(i=>{if(i.uuid!==W0&&!(i instanceof Ad)){let n=this._createProxyObject(i);n&&t.push(n)}}),t}getSplineEvents(){var t;return((t=this._eventManager)==null?void 0:t.handlers.Spline).splineEvents}emitEvent(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEvent(t)}emitEventReverse(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEventReverse(t)}addEventListener(t,e){this.canvas.addEventListener(t,e)}removeEventListener(t,e){this.canvas.removeEventListener(t,e)}setZoom(t){var e,i;((e=this._controls)==null?void 0:e.orbitControls)instanceof pne&&((i=this._controls)==null||i.orbitControls.zoomOut(t))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(t,e){this._viewportWidth=t,this._viewportHeight=e,this._viewportMode=2,this._resize()}setBackgroundColor(t){var o;let{r:e,g:i,b:n,a:r}={r:0,g:0,b:0,a:1},s=new ho(e,i,n,r);try{s.setStyle(t)}catch{console.error("This is not a valid css color",t)}(o=this._scene)==null||o.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var t,e,i,n,r,s,o;this.disposed=!0,(t=this._eventManager)==null||t.deactivate(),(e=this._scene)==null||e.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(a=>{Kj.unsubscribe(a)}),(n=this._renderer)==null||n.setAnimationLoop(null),(r=this._renderer)==null||r.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),eOe(this.canvas)}get isStopped(){return this._isPaused}stop(){var t,e,i;this._isPaused||((t=this._renderer)==null||t.setAnimationLoop(null),this._isPaused=!0,(e=this._eventManager)==null||e.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var t,e,i;!this._isPaused||(this._isPaused=!1,(t=this._eventManager)==null||t.resume(),(e=this._controls)!=null&&e.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(t){var e;(e=this._eventManager)==null||e.updateUseWindowEvents(t)}get data(){return this._data}_createProxyObject(t){var r;if(t==null)return;if(this._proxyObjectCache.has(t.uuid))return this._proxyObjectCache.get(t.uuid);let e;t.traverseAncestors(s=>{s instanceof Ad&&(e=s.name)});let i={name:t.name,uuid:t.uuid,visible:t.visible,intensity:t.intensity,position:t.position,rotation:t.rotation,scale:t.scale,type:t.data.type,page:e,parentUuid:t.parent instanceof Ad||t instanceof Gz||(r=t.parent)==null?void 0:r.uuid,emitEvent(s){t.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){t.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},n=Kj(i,(s,o)=>{var a;typeof t[s]!="object"&&((a=Object.getOwnPropertyDescriptor(t,s))!=null&&a.writable)&&(t[s]=o),this._requestRenderAutoMode(),t.updateMatrix()});return this._proxyObjectCache.set(t.uuid,n),n}},YA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},RO={},VHe={get exports(){return RO},set exports(t){RO=t}},xx={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E7;function HHe(){if(E7)return xx;E7=1;var t=w0,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)n.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:u,_owner:r.current}}return xx.Fragment=i,xx.jsx=o,xx.jsxs=o,xx}(function(t){t.exports=HHe()})(VHe);const OO=RO.jsx;var jHe="Expected a function",T7=0/0,WHe="[object Symbol]",XHe=/^\s+|\s+$/g,qHe=/^[-+]0x[0-9a-f]+$/i,YHe=/^0b[01]+$/i,QHe=/^0o[0-7]+$/i,JHe=parseInt,KHe=typeof YA=="object"&&YA&&YA.Object===Object&&YA,ZHe=typeof self=="object"&&self&&self.Object===Object&&self,$He=KHe||ZHe||Function("return this")(),e6e=Object.prototype,t6e=e6e.toString,i6e=Math.max,n6e=Math.min,CI=function(){return $He.Date.now()};function r6e(t,e,i){var n,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(jHe);e=P7(e)||0,FO(i)&&(h=!!i.leading,u="maxWait"in i,s=u?i6e(P7(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function f(A){var E=n,M=r;return n=r=void 0,c=A,o=t.apply(M,E),o}function p(A){return c=A,a=setTimeout(v,e),h?f(A):o}function m(A){var E=A-l,M=A-c,T=e-E;return u?n6e(T,s-M):T}function g(A){var E=A-l,M=A-c;return l===void 0||E>=e||E<0||u&&M>=s}function v(){var A=CI();if(g(A))return y(A);a=setTimeout(v,m(A))}function y(A){return a=void 0,d&&n?f(A):(n=r=void 0,o)}function x(){a!==void 0&&clearTimeout(a),c=0,n=l=r=a=void 0}function b(){return a===void 0?o:y(CI())}function S(){var A=CI(),E=g(A);if(n=arguments,r=this,l=A,E){if(a===void 0)return p(l);if(u)return a=setTimeout(v,e),f(l)}return a===void 0&&(a=setTimeout(v,e)),o}return S.cancel=x,S.flush=b,S}function FO(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function s6e(t){return!!t&&typeof t=="object"}function o6e(t){return typeof t=="symbol"||s6e(t)&&t6e.call(t)==WHe}function P7(t){if(typeof t=="number")return t;if(o6e(t))return T7;if(FO(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=FO(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(XHe,"");var i=YHe.test(t);return i||QHe.test(t)?JHe(t.slice(2),i?2:8):qHe.test(t)?T7:+t}var a6e=r6e;function l6e(t){return e=>{t.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}const c6e=[],u6e={width:"100%",height:"100%"},h6e=me.forwardRef(function({className:t,children:e,debounceTime:i=300,ignoreDimensions:n=c6e,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const c=me.useRef(null),h=me.useRef(0),[u,d]=me.useState({width:0,height:0,top:0,left:0}),f=me.useMemo(()=>{const p=Array.isArray(n)?n:[n];return a6e(m=>{d(g=>Object.keys(g).filter(v=>g[v]!==m[v]).every(v=>p.includes(v))?g:m)},i,{leading:s})},[i,s,n]);return me.useEffect(()=>{const p=o||window.ResizeObserver,m=new p(g=>{g.forEach(v=>{const{left:y,top:x,width:b,height:S}=(v==null?void 0:v.contentRect)??{};h.current=window.requestAnimationFrame(()=>{f({width:b,height:S,top:x,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(h.current),m.disconnect(),f.cancel()}},[f,o]),OO("div",{style:{...u6e,...r},ref:l6e([l,c]),className:t,...a,children:e({...u,ref:c.current,resize:f})})}),d6e=me.forwardRef(({scene:t,style:e,onMouseDown:i,onMouseUp:n,onMouseHover:r,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:c,onWheel:h,onLoad:u,renderOnDemand:d=!0,...f},p)=>{const m=me.useRef(null),[g,v]=me.useState(!0);return me.useEffect(()=>{v(!0);let y;const x=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:n},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:h}];if(m.current){y=new GHe(m.current,{renderOnDemand:d});async function b(){await y.load(t);for(let S of x)S.cb&&y.addEventListener(S.name,S.cb);v(!1),u==null||u(y)}b()}return()=>{for(let b of x)b.cb&&y.removeEventListener(b.name,b.cb);y.dispose()}},[t]),OO(h6e,{ref:p,parentSizeStyles:e,debounceTime:50,...f,children:()=>OO("canvas",{ref:m,style:{display:g?"none":"block"}})})});setTimeout(()=>{new Y_e({parent:document.querySelector(".sticky-images-wrapper"),intensity:.3,image1:I1e,image2:L1e,displacementImage:B1e})},1e3);const f6e=()=>Ye("section",{className:"relative w-full h-screen mx-auto",children:ei("div",{className:`absolute inset-0 top-[120px] max-w-7xl ${jr.paddingX} mx-auto md:flex-col sm:flex-col md:flex-col lg:flex-row xl:flex-row 2xl:flex-row gap-10 lg:flex xl:flex 2xl:flex-row`,children:[ei("div",{className:"lg:w-1/2 xl:w-1/2 2xl:w-1/2 md:w-full sm:w-full",children:[ei("h1",{className:`${jr.heroHeadText} text-white`,children:["Hey, I'm ",Ye("span",{className:"text-[#915EFF]",children:"Paul"})]}),Ye("br",{}),ei("p",{className:`${jr.heroSubText} mt-2 text-white-100`,children:["I  to develop modern user",Ye("br",{}),"interfaces and web applications"]}),Ye("br",{}),Ye("br",{}),ei("p",{className:"text-white-100 tracking-[.2em] text-base/loose",children:["Got a project?",Ye("br",{}),"Big or small. Hit me up."]}),Ye("br",{}),Ye("br",{}),ei("div",{className:"flex flex-row gap-x-4",children:[Ye("button",{onClick:()=>location.href="mailto:p.elmatsidis@gmail.com",className:"w-1/2 text-lg tracking-[.2em] bg-transparent hover:bg-white text-white font-bold hover:text-black py-2 px-8 border border-white hover:border-white rounded",children:"HIRE ME"}),Ye("button",{onClick:()=>window.open("https://drive.google.com/file/d/1fbVHQ9i1FjhWGWB8-YTHfj1no78ahyIr/view?usp=drive_link","_blank"),className:"w-1/2 text-lg tracking-[.2em] bg-white hover:bg-transparent text-black font-bold hover:text-white py-2 px-8 border border-white hover:border-white rounded",children:"RESUME"})]})]}),Ye("div",{className:"sm:w-full md:w-full lg:w-1/2 xl:w-1/2 2xl:w-1/2 sm:my-10 md:my-10 canvas-wrap",children:Ye(d6e,{scene:"https://prod.spline.design/JI26FE1UF-qwqVHJ/scene.splinecode"})})]})}),p6e="/assets/backend-565fc01f.png",m6e="/assets/creator-dbbffaec.png",g6e="/assets/mobile-896ef2f5.png",v6e="/assets/web-0d05165f.png",y6e="/assets/link-dca3f42a.png",x6e="/assets/menu-242d80a8.svg",_6e="/assets/close-ad0e0ca6.svg",w6e="/assets/prodyna-f470d234.png",b6e="/assets/ds-0ad37e2b.png",S6e="/assets/epsilonbratanis-e6d187b6.jpg",A6e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAACqBAMAAADPWMmxAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAHlBMVEX////x9//g7v/H4f+s0v+Nwv9xs/9Jnf8xkf8Dd/92hpT3AAAAAWJLR0QAiAUdSAAAAAd0SU1FB+cICBMaAJwcBUYAAAABb3JOVAHPoneaAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA4LTA4VDE5OjI1OjU5KzAwOjAwNvGb1AAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wOC0wOFQxOToyNTo1OSswMDowMEesI2gAAABaZVhJZk1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAAACEwADAAAAAQABAAAAAAAAAAAASAAAAAEAAABIAAAAAR9S9zQAAAZDSURBVGje7dtLV9s4GAZgO2H2idPusbmcmV0CKXNmVxInzCy5lyUlMbAcWkhYz6GYP9DG/3ZkKbI+2ZItyfIOb1rAeVA+vzi62XGUj676qeqHF3SaQAP7bDcIPOssQtPDt8pi1LPMugFVA3tBcD2mBr5ddK3aau1ao6qdIFAsaAX22Mxian2WUUCte8Vchm61A0ssRMONsR2WZipFh+FGuM9Y83zxKFKtsAwNEDruhWG4V5sF6D4Cx+2QY81uNF0eDUOsjuuxAN3CKGlrCIOgzbp5lKphjXxBdMir5mwuU7wajgyDwGcqr8J8aZRWhELViM0FNVPP6rBdITqZtefgV+jmqxBUgkY37cicFWQqRS9SVcZWo54ExWp0zth9dVaMhgglanQmZCtiK8wURqObVpRjVW+LYvQ8AupcO18A3YaXHx9ficpdMRW2eJ8CaKZKghAYodFXNypl/So0AOhFUYX5qmBLMkWOa6ZK8uWXoYEQhW1VzldZpvCxeHAXuqz45gfQ2/jBXb6yr0FspR+7rhCdAHSZqjFkhbHlStsSZuoColiNF2JWnNoW7Z7n7lP0QB5RX5/YNwX58nIqYcWZwmh87d6l/wB2ls+Xl29r4HvSTC1ioEI2F4RuoQKYLUMz9VXGdj2BGnSL9ymSKV6VBCHEb7aoBt1hCcpUMbvnBWJ17A1FQc3UL7Gc3euNJGo4ImwuqOvjmKkwtufrlg6lavrDYlCLbeWCkLJ7qHhydTxArBh9u3bvYyF7htCtsEQNx74HiroAaHLtXiXsa5ivUYqWqeG4s30hRJNj5yoRsmeb6eimVA33u5S95VCiApZesTO/N6xUJyfudh6NE6z+k3AsydfMb03CSnU6P8QsyBRGqbri2ZnvTiIFNZr33R3u8mM0+UxUyP6I5gMHnauiRrOO8wlmiqp/JXn2ceB8iFTUNFinHecojzKVlXbx2eldKKlTnMCOe5RDk36mUnZx7Hj4dEU1GjmtSx5d9Z3fE45dnDgt8iejqj4NCJuhyfeO076D7Oup4x48Karkty8f+07vkl5+dDxuotO2n7OWI7Tj7CxV1en6tjLbRGyGvvTxeTsZ++um42zfoWzpqa/py+7Xxo8BOc89oCX5vonfi15b07qdZG/51yE90Z1mKK67alsn2Y316XDNrkbgzKN1ld2DZazbVvyn9dR33B30lk+4U7+gKqPu1O4y1mgrUN9eOimLCgyP3n2K/vYGPhI06pqG9Rv6WWF04qGQtZ6TWKetE9DW9PYnPFz6sWBQV6SuDoXon/Sv1qSu6LU/BwJ0N7sXGNUVHQ9FtfWc6LaVr2uS/FdU28+GbVVVDetqta2x5ba+1/W9ru91fa9rvq7ld23Duoo+YZzdmnWt+jQ0q+u1Izy6V3XqWtnLMKhrTHpE33iW9Ig+vpnWlfbeuI6WdwV7b/p1ZT1N0Cls/U17mtOlSV0XoFecdWBJ95X1inXrmvbgP9Ae/M91wNwp6MG3L/Xryo82yMCADQvoaEOzrvmR0QuKk7PDxnR4ZPRJeWRE6kpHcWDA1XE+ZuMi7VEcaWtxxInGsX9A1GDE2cjomBvJU4qN5Ff6I/lJYdYhr67Yj5RnHXRmSBbR3FecIVGfzUnnnhRnc0QzT29A5VHVmaex6iwZnS5VmSVrZEbPZPZxPupUzD760pnShJsp5afMK2ZK8ayuhC2d1fVKZnUbmYFWni0XrMbIZ8trzewPPLFqsAoRsVdIViGkKyZ3vCpfMRGoqqs7UlS4uoPbX7YS9S9WJahkJcrH365cNcsHdX1IVs3WKL9syMdWf4WvYjE6W42UoHvZq/mFXo+x9lZOFVZ5b7lVXskugvzicTMr0tVs9eq5aBuF+Iox1milv6FdCdw+R3s7KGT5qrnbo6GdKQ3toinLV40dP2a7k6p3v8HtWRybqjpBVYvtrM6uL+lmsno71GSxPQW76RSDqpCvujv/GtqlKIwtUwG6qYGW7/7U2EZXxvJqrZ3QjeyqLW6sHNvYAVyMbds0qDIWX7ENnZtfyRXj87VhZxd4MzvWc/v2bO2ub+hJAI5tsf/WRGEQPHtoQ0+DNPTkSkNP2fBPBFl80Iipth4zyljP+D4lO7pEtYvSu61ltKGn7Rp6MlDrKcb/AZSwTBDQmqi5AAAAAElFTkSuQmCC",M6e="/assets/carrent-aba013d1.png",C6e="/assets/mindpeer-dd24c81b.png",E6e="/assets/happimag-037905aa.png",D7=[{id:"about",title:"About"},{id:"work",title:"Work"},{id:"contact",title:"Contact"}],T6e=[{title:"Frontend Developer",icon:v6e},{title:"Backend Developer",icon:p6e},{title:"Cloud Engineer",icon:m6e},{title:"IT Consultant",icon:g6e}],P6e=[{title:"Full Stack Developer",company_name:"MIND-ALLIANCE",icon:A6e,iconBg:"#383E56",date:"January 2021 - Present",points:["Developed 25+ UI features and utilized 8+ AWS services","Collaborated with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementedresponsive design and ensuring cross-browser compatibility.","Participated in code reviews and providing constructive feedback to other developers.","Mentored junior developers and helped with code reviews","Led the development and maintenance of new product, technical documentation and workflows","Implemented an internal API for SaaS platform"]},{title:"Senior Frontend Developer",company_name:"PRODYNA",icon:w6e,iconBg:"#E6DEDD",date:"Jan 2020 - Feb 2021",points:["Implemented new features by translating from wireframes to code","Wrote 70+ unit tests to ensure 100% of code within SDLC was without bugs","Collaborated with 3 engineering and design teams to integrate external APIs into web applications"]},{title:"Full Stack Web Developer",company_name:"DS TRANSPORT SOLUTIONS",icon:b6e,iconBg:"#383E56",date:"Nov 2017 - Dec 2019",points:["Evaluated and improved existing data system under mentor supervision","Implemented a cross platform mobile application","Designed, built and automated data flows to save 10+ hours of tedious work per week"]},{title:".NET Developer",company_name:"EPSILON BRATANIS",icon:S6e,iconBg:"#E6DEDD",date:"Aug 2015 - Nov 2017",points:["Developed 3 Desktop applications for over 100+ clients"]}],D6e=[{testimonial:"I thought it was impossible to make a website as beautiful as our product, but Paul proved me wrong.",name:"Leon F.",designation:"CEO",company:"Nearix",image:""},{testimonial:"I've never met a web developer who truly cares about the project like Paul does.",name:"Nicolas A.",designation:"CTO",company:"MA",image:""},{testimonial:"After Paul optimized our website, our traffic increased by 50%. We can't thank them enough!",name:"Lia Z.",designation:"SEO Specialist",company:"Aktis",image:""}],I6e=[{name:"Car Rent",description:"Web-based platform that allows users to search, book, and manage car rentals from various providers, providing a convenient and efficient solution for transportation needs.",tags:[{name:"react",color:"blue-text-gradient"},{name:"mongodb",color:"green-text-gradient"},{name:"tailwind",color:"pink-text-gradient"}],image:M6e,source_code_link:"https://aktis.taxi/"},{name:"Mindpeer",description:"SAAS Platform that enables lawers to search for any company, view/edit details, and generate the reports.",tags:[{name:"react",color:"blue-text-gradient"},{name:"graphql",color:"green-text-gradient"},{name:"nest.js",color:"pink-text-gradient"}],image:C6e,source_code_link:"https://mindpeer.com/"},{name:"Travel Guide",description:"A comprehensive travel booking platform that allows users to book hotels and offers curated recommendations for popular destinations.",tags:[{name:"react",color:"blue-text-gradient"},{name:"graphql",color:"green-text-gradient"},{name:"typescript",color:"pink-text-gradient"},{name:"MUI",color:"grey-text-gradient"}],image:E6e,source_code_link:"https://www.hapimag.com/"}],L6e="/assets/ep-30b16777.jpg",B6e=()=>{const[t,e]=me.useState(""),[i,n]=me.useState(!1),[r,s]=me.useState(!1);return me.useEffect(()=>{const o=()=>{window.scrollY>100?s(!0):s(!1)};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]),Ye("nav",{className:`${jr.paddingX} w-full flex items-center py-5 fixed top-0 z-20 ${r?"bg-primary":"bg-transparent"}`,children:ei("div",{className:"w-full flex justify-between items-center max-w-7xl mx-auto",children:[ei(pae,{to:"/",className:"flex items-center gap-2",onClick:()=>{e(""),window.scrollTo(0,0)},children:[Ye("img",{src:L6e,alt:"logo",className:"w-9 h-9 object-contain rounded-full"}),Ye("p",{className:"text-white text-[18px] font-bold cursor-pointer flex ",children:Ye("span",{children:" Elmatsidis Paul "})})]}),Ye("ul",{className:"list-none hidden sm:flex flex-row gap-10",children:D7.map(o=>Ye("li",{className:`${t===o.title?"text-white":"text-secondary"} hover:text-white text-[18px] font-medium cursor-pointer`,onClick:()=>e(o.title),children:Ye("a",{href:`#${o.id}`,children:o.title})},o.id))}),ei("div",{className:"sm:hidden flex flex-1 justify-end items-center",children:[Ye("img",{src:i?_6e:x6e,alt:"menu",className:"w-[28px] h-[28px] object-contain",onClick:()=>n(!i)}),Ye("div",{className:`${i?"flex":"hidden"} p-6 black-gradient absolute top-20 right-0 mx-4 my-2 min-w-[140px] z-10 rounded-xl`,children:Ye("ul",{className:"list-none flex justify-end items-start flex-1 flex-col gap-4",children:D7.map(o=>Ye("li",{className:`font-poppins font-medium cursor-pointer text-[16px] ${t===o.title?"text-white":"text-secondary"}`,onClick:()=>{n(!i),e(o.title)},children:Ye("a",{href:`#${o.id}`,children:o.title})},o.id))})})]})]})})};var R6e=Object.defineProperty,O6e=Object.defineProperties,F6e=Object.getOwnPropertyDescriptors,I7=Object.getOwnPropertySymbols,N6e=Object.prototype.hasOwnProperty,k6e=Object.prototype.propertyIsEnumerable,L7=(t,e,i)=>e in t?R6e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,_x=(t,e)=>{for(var i in e||(e={}))N6e.call(e,i)&&L7(t,i,e[i]);if(I7)for(var i of I7(e))k6e.call(e,i)&&L7(t,i,e[i]);return t},wx=(t,e)=>O6e(t,F6e(e)),mne=class extends me.Component{constructor(t){super(t),this.ref=w0.createRef(),this.state={style:{}};const e={reverse:!1,max:35,perspective:1e3,easing:"cubic-bezier(.03,.98,.52,.99)",scale:"1.1",speed:"1000",transition:!0,axis:null,reset:!0};this.width=null,this.height=null,this.left=null,this.top=null,this.transitionTimeout=null,this.updateCall=null,this.element=null,this.settings=Object.assign({},e,this.props.options),this.reverse=this.settings.reverse?-1:1,this.onMouseEnter=this.onMouseEnter.bind(this,this.props.onMouseEnter),this.onMouseMove=this.onMouseMove.bind(this,this.props.onMouseMove),this.onMouseLeave=this.onMouseLeave.bind(this,this.props.onMouseLeave)}componentDidMount(){this.element=this.ref.current,setTimeout(()=>{this.element.parentElement.querySelector(":hover")===this.element&&this.onMouseEnter()},0)}componentWillUnmount(){clearTimeout(this.transitionTimeout),cancelAnimationFrame(this.updateCall)}onMouseEnter(t=()=>{},e){return this.updateElementPosition(),this.setState(Object.assign({},this.state,{style:wx(_x({},this.state.style),{willChange:"transform"})})),this.setTransition(),t(e)}reset(){window.requestAnimationFrame(()=>{this.setState(Object.assign({},this.state,{style:wx(_x({},this.state.style),{transform:`perspective(${this.settings.perspective}px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)`})}))})}onMouseMove(t=()=>{},e){return e.persist(),this.updateCall!==null&&window.cancelAnimationFrame(this.updateCall),this.event=e,this.updateCall=requestAnimationFrame(this.update.bind(this,e)),t(e)}setTransition(){clearTimeout(this.transitionTimeout),this.setState(Object.assign({},this.state,{style:wx(_x({},this.state.style),{transition:`${this.settings.speed}ms ${this.settings.easing}`})})),this.transitionTimeout=setTimeout(()=>{this.setState(Object.assign({},this.state,{style:wx(_x({},this.state.style),{transition:""})}))},this.settings.speed)}onMouseLeave(t=()=>{},e){return this.setTransition(),this.settings.reset&&this.reset(),t(e)}getValues(t){const e=(t.nativeEvent.clientX-this.left)/this.width,i=(t.nativeEvent.clientY-this.top)/this.height,n=Math.min(Math.max(e,0),1),r=Math.min(Math.max(i,0),1),s=(this.reverse*(this.settings.max/2-n*this.settings.max)).toFixed(2),o=(this.reverse*(r*this.settings.max-this.settings.max/2)).toFixed(2),a=n*100,l=r*100;return{tiltX:s,tiltY:o,percentageX:a,percentageY:l}}updateElementPosition(){const t=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=t.left,this.top=t.top}update(t){const e=this.getValues(t);this.setState(Object.assign({},this.state,{style:wx(_x({},this.state.style),{transform:`perspective(${this.settings.perspective}px) rotateX(${this.settings.axis==="x"?0:e.tiltY}deg) rotateY(${this.settings.axis==="y"?0:e.tiltX}deg) scale3d(${this.settings.scale}, ${this.settings.scale}, ${this.settings.scale})`})})),this.updateCall=null}render(){const t=Object.assign({},this.props.style,this.state.style);return Ye("div",{style:t,ref:this.ref,className:this.props.className,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:this.props.children})}};const UT=t=>({hidden:{y:-50,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",duration:1.25,delay:t}}}),Ew=(t,e,i,n)=>({hidden:{x:t==="left"?100:t==="right"?-100:0,y:t==="up"?100:t==="down"?-100:0,opacity:0},show:{x:0,y:0,opacity:1,transition:{type:e,delay:i,duration:n,ease:"easeOut"}}}),B7=(t,e,i,n)=>({hidden:{x:t==="left"?"-100%":t==="right"?"100%":0,y:t==="up"||t==="down"?"100%":0},show:{x:0,y:0,transition:{type:e,delay:i,duration:n,ease:"easeOut"}}}),z6e=(t,e)=>({hidden:{},show:{transition:{staggerChildren:t,delayChildren:e||0}}}),Tw=(t,e)=>function(){return ei(Ga.section,{variants:z6e(),initial:"hidden",whileInView:"show",viewport:{once:!0,amount:.25},className:`${jr.padding} max-w-7xl mx-auto relative z-0`,children:[Ye("span",{className:"hash-span",id:e,children:""}),Ye(t,{})]})},U6e=({index:t,title:e,icon:i})=>Ye(mne,{className:"xs:w-[250px] w-full",children:Ye(Ga.div,{variants:Ew("right","spring",t*.5,.75),className:"w-full green-pink-gradient p-[1px] rounded-[20px] shadow-card",children:ei("div",{options:{max:45,scale:1,speed:450},className:"bg-tertiary rounded-[20px] py-5 px-12 min-h-[280px] flex justify-evenly items-center flex-col",children:[Ye("img",{src:i,alt:"web-development",className:"w-16 h-16 object-contain"}),Ye("h3",{className:"text-white text-[20px] font-bold text-center",children:e})]})})}),G6e=()=>ei(XO,{children:[ei(Ga.div,{variants:UT(),children:[Ye("p",{className:jr.sectionSubText,children:"Introduction"}),Ye("h2",{className:jr.sectionHeadText,children:"Overview"})]}),Ye(Ga.p,{variants:Ew("","",.1,1),className:"mt-4 text-secondary text-[17px] leading-[30px]",children:"I'm a skilled software developer with experience in TypeScript/JavaScript, and expertise in frameworks like React, Angular, Node.js, Nest.js and Next.js. I'm a quick learner and collaborate closely with clients to create efficient, scalable, and user-friendly solutions that solve real-world problems. Let's work together to bring your ideas to life!"}),Ye("div",{className:"mt-20 flex flex-wrap gap-10",children:T6e.map((t,e)=>Ye(U6e,{index:e,...t},t.title))})]}),V6e=Tw(G6e,"about");var GT={},gne={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function i(){for(var n=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o==="string"||o==="number")n.push(s);else if(Array.isArray(s)){if(s.length){var a=i.apply(null,s);a&&n.push(a)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){n.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&n.push(l)}}}return n.join(" ")}t.exports?(i.default=i,t.exports=i):window.classNames=i})()})(gne);var vne=gne.exports;GT.__esModule=!0;GT.default=void 0;var H6e=iU(me),Bh=iU(LJ),j6e=iU(vne);function iU(t){return t&&t.__esModule?t:{default:t}}const yne=({animate:t=!0,className:e="",layout:i="2-columns",lineColor:n="#FFF",children:r})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",n),H6e.default.createElement("div",{className:(0,j6e.default)(e,"vertical-timeline",{"vertical-timeline--animate":t,"vertical-timeline--two-columns":i==="2-columns","vertical-timeline--one-column-left":i==="1-column"||i==="1-column-left","vertical-timeline--one-column-right":i==="1-column-right"})},r));yne.propTypes={children:Bh.default.oneOfType([Bh.default.arrayOf(Bh.default.node),Bh.default.node]).isRequired,className:Bh.default.string,animate:Bh.default.bool,layout:Bh.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:Bh.default.string};var W6e=yne;GT.default=W6e;var VT={};function NO(){return NO=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},NO.apply(this,arguments)}function X6e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,kO(t,e)}function kO(t,e){return kO=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},kO(t,e)}function q6e(t,e){if(t==null)return{};var i={},n=Object.keys(t),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(i[r]=t[r]);return i}var zO=new Map,QA=new WeakMap,R7=0,xne=void 0;function Y6e(t){xne=t}function Q6e(t){return t?(QA.has(t)||(R7+=1,QA.set(t,R7.toString())),QA.get(t)):"0"}function J6e(t){return Object.keys(t).sort().filter(function(e){return t[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?Q6e(t.root):t[e])}).toString()}function K6e(t){var e=J6e(t),i=zO.get(e);if(!i){var n=new Map,r,s=new IntersectionObserver(function(o){o.forEach(function(a){var l,c=a.isIntersecting&&r.some(function(h){return a.intersectionRatio>=h});t.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=c),(l=n.get(a.target))==null||l.forEach(function(h){h(c,a)})})},t);r=s.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),i={id:e,observer:s,elements:n},zO.set(e,i)}return i}function nU(t,e,i,n){if(i===void 0&&(i={}),n===void 0&&(n=xne),typeof window.IntersectionObserver>"u"&&n!==void 0){var r=t.getBoundingClientRect();return e(n,{isIntersecting:n,target:t,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),function(){}}var s=K6e(i),o=s.id,a=s.observer,l=s.elements,c=l.get(t)||[];return l.has(t)||l.set(t,c),c.push(e),a.observe(t),function(){c.splice(c.indexOf(e),1),c.length===0&&(l.delete(t),a.unobserve(t)),l.size===0&&(a.disconnect(),zO.delete(o))}}var Z6e=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function O7(t){return typeof t.children!="function"}var bE=function(t){X6e(e,t);function e(n){var r;return r=t.call(this,n)||this,r.node=null,r._unobserveCb=null,r.handleNode=function(s){r.node&&(r.unobserve(),!s&&!r.props.triggerOnce&&!r.props.skip&&r.setState({inView:!!r.props.initialInView,entry:void 0})),r.node=s||null,r.observeNode()},r.handleChange=function(s,o){s&&r.props.triggerOnce&&r.unobserve(),O7(r.props)||r.setState({inView:s,entry:o}),r.props.onChange&&r.props.onChange(s,o)},r.state={inView:!!n.initialInView,entry:void 0},r}var i=e.prototype;return i.componentDidUpdate=function(r){(r.rootMargin!==this.props.rootMargin||r.root!==this.props.root||r.threshold!==this.props.threshold||r.skip!==this.props.skip||r.trackVisibility!==this.props.trackVisibility||r.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},i.componentWillUnmount=function(){this.unobserve(),this.node=null},i.observeNode=function(){if(!(!this.node||this.props.skip)){var r=this.props,s=r.threshold,o=r.root,a=r.rootMargin,l=r.trackVisibility,c=r.delay,h=r.fallbackInView;this._unobserveCb=nU(this.node,this.handleChange,{threshold:s,root:o,rootMargin:a,trackVisibility:l,delay:c},h)}},i.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},i.render=function(){if(!O7(this.props)){var r=this.state,s=r.inView,o=r.entry;return this.props.children({inView:s,entry:o,ref:this.handleNode})}var a=this.props,l=a.children,c=a.as,h=q6e(a,Z6e);return me.createElement(c||"div",NO({ref:this.handleNode},h),l)},e}(me.Component);bE.displayName="InView";bE.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function $6e(t){var e=t===void 0?{}:t,i=e.threshold,n=e.delay,r=e.trackVisibility,s=e.rootMargin,o=e.root,a=e.triggerOnce,l=e.skip,c=e.initialInView,h=e.fallbackInView,u=me.useRef(),d=me.useState({inView:!!c}),f=d[0],p=d[1],m=me.useCallback(function(v){u.current!==void 0&&(u.current(),u.current=void 0),!l&&v&&(u.current=nU(v,function(y,x){p({inView:y,entry:x}),x.isIntersecting&&a&&u.current&&(u.current(),u.current=void 0)},{root:o,rootMargin:s,threshold:i,trackVisibility:r,delay:n},h))},[Array.isArray(i)?i.toString():i,o,s,a,l,r,h,n]);me.useEffect(function(){!u.current&&f.entry&&!a&&!l&&p({inView:!!c})});var g=[m,f.inView,f.entry];return g.ref=g[0],g.inView=g[1],g.entry=g[2],g}const eje=Object.freeze(Object.defineProperty({__proto__:null,InView:bE,default:bE,defaultFallbackInView:Y6e,observe:nU,useInView:$6e},Symbol.toStringTag,{value:"Module"})),tje=vre(eje);VT.__esModule=!0;VT.default=void 0;var Rh=rU(me),nn=rU(LJ),JA=rU(vne),ije=tje;function rU(t){return t&&t.__esModule?t:{default:t}}const _ne=({children:t="",className:e="",contentArrowStyle:i=null,contentStyle:n=null,date:r="",dateClassName:s="",icon:o=null,iconClassName:a="",iconOnClick:l=null,onTimelineElementClick:c=null,iconStyle:h=null,id:u="",position:d="",style:f=null,textClassName:p="",intersectionObserverProps:m={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:g=!1})=>Rh.default.createElement(ije.InView,m,({inView:v,ref:y})=>Rh.default.createElement("div",{ref:y,id:u,className:(0,JA.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":d==="left","vertical-timeline-element--right":d==="right","vertical-timeline-element--no-children":t===""}),style:f},Rh.default.createElement(Rh.default.Fragment,null,Rh.default.createElement("span",{style:h,onClick:l,className:(0,JA.default)(a,"vertical-timeline-element-icon",{"bounce-in":v||g,"is-hidden":!(v||g)})},o),Rh.default.createElement("div",{style:n,onClick:c,className:(0,JA.default)(p,"vertical-timeline-element-content",{"bounce-in":v||g,"is-hidden":!(v||g)})},Rh.default.createElement("div",{style:i,className:"vertical-timeline-element-content-arrow"}),t,Rh.default.createElement("span",{className:(0,JA.default)(s,"vertical-timeline-element-date")},r)))));_ne.propTypes={children:nn.default.oneOfType([nn.default.arrayOf(nn.default.node),nn.default.node]),className:nn.default.string,contentArrowStyle:nn.default.shape({}),contentStyle:nn.default.shape({}),date:nn.default.node,dateClassName:nn.default.string,icon:nn.default.element,iconClassName:nn.default.string,iconStyle:nn.default.shape({}),iconOnClick:nn.default.func,onTimelineElementClick:nn.default.func,id:nn.default.string,position:nn.default.string,style:nn.default.shape({}),textClassName:nn.default.string,visible:nn.default.bool,intersectionObserverProps:nn.default.shape({root:nn.default.object,rootMargin:nn.default.string,threshold:nn.default.number,triggerOnce:nn.default.bool})};var nje=_ne;VT.default=nje;var wne={VerticalTimeline:GT.default,VerticalTimelineElement:VT.default};const rje=({experience:t})=>ei(wne.VerticalTimelineElement,{contentStyle:{background:"#1d1836",color:"#fff"},contentArrowStyle:{borderRight:"7px solid  #232631"},date:t.date,iconStyle:{background:t.iconBg},icon:Ye("div",{className:"flex justify-center items-center w-full h-full",children:Ye("img",{src:t.icon,alt:t.company_name,className:"w-[60%] h-[60%] object-contain"})}),children:[ei("div",{children:[Ye("h3",{className:"text-white text-[24px] font-bold",children:t.title}),Ye("p",{className:"text-secondary text-[16px] font-semibold",style:{margin:0},children:t.company_name})]}),Ye("ul",{className:"mt-5 list-disc ml-5 space-y-2",children:t.points.map((e,i)=>Ye("li",{className:"text-white-100 text-[14px] pl-1 tracking-wider",children:e},`experience-point-${i}`))})]}),sje=()=>ei(XO,{children:[ei(Ga.div,{variants:UT(),children:[Ye("p",{className:`${jr.sectionSubText} text-center`,children:"What I have done so far"}),Ye("h2",{className:`${jr.sectionHeadText} text-center`,children:"Work Experience"})]}),Ye("div",{className:"mt-20 flex flex-col",children:Ye(wne.VerticalTimeline,{children:P6e.map((t,e)=>Ye(rje,{experience:t},`experience-${e}`))})})]}),oje=Tw(sje,"work"),aje=({index:t,name:e,description:i,tags:n,image:r,source_code_link:s})=>Ye(Ga.div,{variants:Ew("up","spring",t*.5,.75),children:ei(mne,{options:{max:45,scale:1,speed:450},className:"bg-tertiary p-5 rounded-2xl sm:w-[360px] w-full",children:[ei("div",{className:"relative w-full h-[230px]",children:[Ye("img",{src:r,alt:"project_image",className:"w-full h-full object-cover rounded-2xl"}),Ye("div",{className:"absolute inset-0 flex justify-end m-3 card-img_hover",children:Ye("div",{onClick:()=>window.open(s,"_blank"),className:"black-gradient w-10 h-10 rounded-full flex justify-center items-center cursor-pointer",children:Ye("img",{src:y6e,alt:"source code",className:"w-1/2 h-1/2 object-contain"})})})]}),ei("div",{className:"mt-5",children:[Ye("h3",{className:"text-white font-bold text-[24px]",children:e}),Ye("p",{className:"mt-2 text-secondary text-[14px]",children:i})]}),Ye("div",{className:"mt-4 flex flex-wrap gap-2",children:n.map(o=>ei("p",{className:`text-[14px] ${o.color}`,children:["#",o.name]},`${e}-${o.name}`))})]})}),lje=()=>ei(XO,{children:[ei(Ga.div,{variants:UT(),children:[Ye("p",{className:`${jr.sectionSubText} `,children:"My work"}),Ye("h2",{className:`${jr.sectionHeadText}`,children:"Projects"})]}),Ye("div",{className:"w-full flex",children:Ye(Ga.p,{variants:Ew("","",.1,1),className:"mt-3 text-secondary text-[17px] leading-[30px]",children:"Following projects showcases my skills and experience through real-world examples of my work. Each project is briefly described with links to code repositories and live demos in it. It reflects my ability to solve complex problems, work with different technologies, and manage projects effectively."})}),Ye("div",{className:"mt-20 flex flex-wrap gap-7",children:I6e.map((t,e)=>Ye(aje,{index:e,...t},`project-${e}`))})]}),cje=Tw(lje,""),uje=({index:t,testimonial:e,name:i,designation:n,company:r,image:s})=>ei(Ga.div,{variants:Ew("","spring",t*.5,.75),className:"bg-black-200 p-10 rounded-3xl xs:w-[320px] w-full",children:[Ye("p",{className:"text-white font-black text-[48px]",children:'"'}),ei("div",{className:"mt-1",children:[Ye("p",{className:"text-white tracking-wider text-[18px]",children:e}),Ye("div",{className:"mt-7 flex justify-between items-center gap-1",children:ei("div",{className:"flex-1 flex flex-row gap-x-4",children:[ei("p",{className:"text-white font-medium text-[16px]",children:[Ye("span",{className:"blue-text-gradient",children:"@"})," ",i]}),ei("p",{className:"mt-1 text-secondary text-[12px]",children:[n," of ",r]})]})})]})]}),hje=()=>ei("div",{className:"mt-12 bg-black-100 rounded-[20px]",children:[Ye("div",{className:`bg-tertiary rounded-2xl ${jr.padding} min-h-[300px]`,children:ei(Ga.div,{variants:UT(),children:[Ye("p",{className:jr.sectionSubText,children:"What others say"}),Ye("h2",{className:jr.sectionHeadText,children:"Testimonials"})]})}),Ye("div",{className:`-mt-20 pb-14 ${jr.paddingX} flex flex-wrap gap-7`,children:D6e.map((t,e)=>Ye(uje,{index:e,...t},t.name))})]}),dje=Tw(hje,""),D_={_origin:"https://api.emailjs.com"},fje=(t,e="https://api.emailjs.com")=>{D_._userID=t,D_._origin=e},bne=(t,e,i)=>{if(!t)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class F7{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const Sne=(t,e,i={})=>new Promise((n,r)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new F7(o);a.status===200||a.text==="OK"?n(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new F7(o))}),s.open("POST",D_._origin+t,!0),Object.keys(i).forEach(o=>{s.setRequestHeader(o,i[o])}),s.send(e)}),pje=(t,e,i,n)=>{const r=n||D_._userID;return bne(r,t,e),Sne("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:r,service_id:t,template_id:e,template_params:i}),{"Content-type":"application/json"})},mje=t=>{let e;if(typeof t=="string"?e=document.querySelector(t):e=t,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},gje=(t,e,i,n)=>{const r=n||D_._userID,s=mje(i);bne(r,t,e);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",t),o.append("template_id",e),o.append("user_id",r),Sne("/api/v1.0/email/send-form",o)},vje={init:fje,send:pje,sendForm:gje},yje=()=>{const t=me.useRef(),[e,i]=me.useState({name:"",email:"",message:""}),[n,r]=me.useState(!1),s=a=>{const{target:l}=a,{name:c,value:h}=l;i({...e,[c]:h})},o=a=>{a.preventDefault(),r(!0),vje.send({}.VITE_APP_EMAILJS_SERVICE_ID,{}.VITE_APP_EMAILJS_TEMPLATE_ID,{from_name:e.name,to_name:"JavaScript Mastery",from_email:e.email,to_email:"sujata@jsmastery.pro",message:e.message},{}.VITE_APP_EMAILJS_PUBLIC_KEY).then(()=>{r(!1),alert("Thank you. I will get back to you as soon as possible."),i({name:"",email:"",message:""})},l=>{r(!1),console.error(l),alert("Ahh, something went wrong. Please try again.")})};return ei("div",{className:"xl:mt-12 flex xl:flex-row flex-col-reverse gap-10 overflow-hidden",children:[Ye(_ve,{}),ei(Ga.div,{variants:B7("left","tween",.2,1),className:"flex-[0.75] bg-black-100 p-8 rounded-2xl",children:[Ye("p",{className:jr.sectionSubText,children:"Get in touch"}),Ye("h3",{className:jr.sectionHeadText,children:"Contact"}),ei("form",{ref:t,onSubmit:o,className:"mt-12 flex flex-col gap-8",children:[ei("label",{className:"flex flex-col",children:[Ye("span",{className:"text-white font-medium mb-4",children:"Your Name"}),Ye("input",{type:"text",name:"name",value:e.name,onChange:s,placeholder:"What's your good name?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),ei("label",{className:"flex flex-col",children:[Ye("span",{className:"text-white font-medium mb-4",children:"Your email"}),Ye("input",{type:"email",name:"email",value:e.email,onChange:s,placeholder:"What's your email?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),ei("label",{className:"flex flex-col",children:[Ye("span",{className:"text-white font-medium mb-4",children:"Your Message"}),Ye("textarea",{rows:7,name:"message",value:e.message,onChange:s,placeholder:"What you want to say?",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-lg outline-none border-none font-medium"})]}),Ye("button",{type:"submit",className:"bg-tertiary py-3 px-8 rounded-xl outline-none w-fit text-white font-bold shadow-md shadow-primary",children:n?"Sending...":"Send"})]})]}),Ye(Ga.div,{variants:B7("right","tween",.2,1),className:"xl:flex-1 xl:h-auto md:h-[550px] h-[350px]",children:Ye(hve,{})})]})},xje=Tw(yje,"contact"),_je=()=>Ye(hae,{children:ei("div",{className:"relative z-0 bg-primary",children:[Ye(B6e,{}),Ye(f6e,{}),Ye(V6e,{}),Ye(oje,{}),Ye(cje,{}),Ye(dje,{}),Ye(xje,{})]})});EI.createRoot(document.getElementById("root")).render(Ye(w0.StrictMode,{children:Ye(_je,{})}))});export default wje();
